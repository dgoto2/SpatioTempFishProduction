FUNCTION AgeLengthConvert, p_age0, p_age1, p_age2, p_age3, p_age4, p_age5, p_age6, p_age7, p_age8, p_age9, p_age10 $
  , p_age11, p_age12, p_age13, p_age14, p_age15, p_age16, p_age17, p_age18, p_age19, p_age20, p_age21, p_age22 $
  , p_age23, p_age24, p_age25, p_age26 $
  , Slt100, S100to120, S120to140, S140to160, S160to180, S180to200, S200to220, S220to240, S240to260, S260to280 $
  , S280to300, S300to320, S320to340, S340to360, S360to380, S380to400, S400to420, S420to440, S440to460, S460to480 $
  , S480to500, S500to520, S520to540, S540to560, S560to580, S580to600, S600to620, S620to640, S640to660, S660to680 $
  , S680to700, S700to720, S720to740, S740to760, S760to780, S780to800, Sge800 $
  , INDEX_data2, LoopIndex1, LoopIndex2, length_mean, length_bin, Length_prod, FishAge


; requred input data
;INDEX_data2; index for length-age key availability 
;Length_prod; length distribution
;FishAge; an empty array for age
;LoopIndex1=i+NumLengthBin+adj; loop index
;LoopIndex2=i*NumLengthBin+adj
; requried arrays
;length_mean = length_mean
;length_bin = length_bin

  ; 1.Assign age semi-randomly to lengths - all fish
  IF SizeLT100count GT 0 then begin
    LengthIndex1 = 0
    LengthIndex2 = SizeLT100
    FishProb = AgeLengthKey(p_age0, p_age1, p_age2, p_age3, p_age4, p_age5 $
      , p_age6, p_age7, p_age8, p_age9, p_age10, p_age11, p_age12 $
      , p_age13, p_age14, p_age15, p_age16, p_age17, p_age18, p_age19 $
      , p_age20, p_age21, p_age22, p_age23, p_age24, p_age25 $
      , p_age26, INDEX_data2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssign = WalleyeAgeAssign(Length_prod[LengthIndex2], LengthIndex2, $
      FishProb, FishAge[LengthIndex2], LoopIndex1)
    length_mean[10:36, LoopIndex2+LengthIndex1] = AgeAssign[0, *]
    length_bin[10:36, LoopIndex2+LengthIndex1] = AgeAssign[1, *]
    AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthIndex2], LengthIndex2 $
      , FishProb, FishAge[LengthIndex2], LoopIndex1)
  ENDIF
  IF Size100to120count GT 0 then begin
    LengthIndex1 = 1
    LengthIndex2 = Size100to120
    FishProb = AgeLengthKey(p_age0, p_age1, p_age2, p_age3, p_age4, p_age5 $
      , p_age6, p_age7, p_age8, p_age9, p_age10, p_age11, p_age12 $
      , p_age13, p_age14, p_age15, p_age16, p_age17, p_age18, p_age19 $
      , p_age20, p_age21, p_age22, p_age23, p_age24, p_age25 $
      , p_age26, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssign = WalleyeAgeAssign(Length_prod[LengthIndex2], LengthIndex2, FishProb, FishAge[LengthIndex2] $
      , LoopIndex1)
    length_mean[10:36, LoopIndex2+LengthIndex1] = AgeAssign[0, *]
    length_bin[10:36, LoopIndex2+LengthIndex1] = AgeAssign[1, *]
    AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthIndex2], LengthIndex2, FishProb, FishAge[LengthIndex2] $
      , LoopIndex1)
    ;FishAge[LengthIndex2]= AgeAssignInd
  ENDIF
  IF Size120to140count GT 0 then begin
    LengthIndex1 = 2
    LengthIndex2 = Size120to140
    FishProb = AgeLengthKey(p_age0, p_age1, p_age2, p_age3, p_age4, p_age5 $
      , p_age6, p_age7, p_age8, p_age9, p_age10, p_age11, p_age12 $
      , p_age13, p_age14, p_age15, p_age16, p_age17, p_age18, p_age19 $
      , p_age20, p_age21, p_age22, p_age23, p_age24, p_age25 $
      , p_age26, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssign = WalleyeAgeAssign(Length_prod[LengthIndex2], LengthIndex2, FishProb, FishAge[LengthIndex2] $
      , LoopIndex1)
    length_mean[10:36, LoopIndex2+LengthIndex1] = AgeAssign[0, *]
    length_bin[10:36, LoopIndex2+LengthIndex1] = AgeAssign[1, *]
    AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthIndex2], LengthIndex2, FishProb, FishAge[LengthIndex2] $
      , LoopIndex1)
    ;FishAge[LengthIndex2]= AgeAssignInd
  ENDIF
  IF Size140to160count GT 0 then begin
    LengthIndex1 = 3
    LengthIndex2 = Size140to160
    FishProb = AgeLengthKey(p_age0, p_age1, p_age2, p_age3, p_age4, p_age5 $
      , p_age6, p_age7, p_age8, p_age9, p_age10, p_age11, p_age12 $
      , p_age13, p_age14, p_age15, p_age16, p_age17, p_age18, p_age19 $
      , p_age20, p_age21, p_age22, p_age23, p_age24, p_age25 $
      , p_age26, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssign = WalleyeAgeAssign(Length_prod[LengthIndex2], LengthIndex2, FishProb, FishAge[LengthIndex2] $
      , LoopIndex1)
    length_mean[10:36, LoopIndex2+LengthIndex1] = AgeAssign[0, *]
    length_bin[10:36, LoopIndex2+LengthIndex1] = AgeAssign[1, *]
    AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthIndex2], LengthIndex2, FishProb, FishAge[LengthIndex2] $
      , LoopIndex1)
    ;FishAge[LengthIndex2]= AgeAssignInd
  ENDIF
  IF Size160to180count GT 0 THEN BEGIN
    LengthIndex1 = 4
    LengthIndex2 = Size160to180
    FishProb = AgeLengthKey(p_age0, p_age1, p_age2, p_age3, p_age4, p_age5 $
      , p_age6, p_age7, p_age8, p_age9, p_age10, p_age11, p_age12 $
      , p_age13, p_age14, p_age15, p_age16, p_age17, p_age18, p_age19 $
      , p_age20, p_age21, p_age22, p_age23, p_age24, p_age25 $
      , p_age26, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb

    AgeAssign = WalleyeAgeAssign(Length_prod[LengthIndex2], LengthIndex2, FishProb, FishAge[LengthIndex2] $
      , LoopIndex1)
    length_mean[10:36, LoopIndex2+LengthIndex1] = AgeAssign[0, *]
    length_bin[10:36, LoopIndex2+LengthIndex1] = AgeAssign[1, *]
    AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthIndex2], LengthIndex2, FishProb, FishAge[LengthIndex2] $
      , LoopIndex1)
    ;FishAge[LengthIndex2]= AgeAssignInd
  ENDIF
  IF Size180to200count GT 0 then begin
    LengthIndex1 = 5
    LengthIndex2 = Size180to200
    FishProb = AgeLengthKey(p_age0, p_age1, p_age2, p_age3, p_age4, p_age5 $
      , p_age6, p_age7, p_age8, p_age9, p_age10, p_age11, p_age12 $
      , p_age13, p_age14, p_age15, p_age16, p_age17, p_age18, p_age19 $
      , p_age20, p_age21, p_age22, p_age23, p_age24, p_age25 $
      , p_age26, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssign = WalleyeAgeAssign(Length_prod[LengthIndex2], LengthIndex2, FishProb, FishAge[LengthIndex2] $
      , LoopIndex1)
    length_mean[10:36, LoopIndex2+LengthIndex1] = AgeAssign[0, *]
    length_bin[10:36, LoopIndex2+LengthIndex1] = AgeAssign[1, *]
    AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthIndex2], LengthIndex2, FishProb, FishAge[LengthIndex2] $
      , LoopIndex1)
    ;FishAge[LengthIndex2]= AgeAssignInd
  ENDIF
  IF Size200to220count GT 0 then begin
    LengthIndex1 = 6
    LengthIndex2 = Size200to220
    FishProb = AgeLengthKey(p_age0, p_age1, p_age2, p_age3, p_age4, p_age5 $
      , p_age6, p_age7, p_age8, p_age9, p_age10, p_age11, p_age12 $
      , p_age13, p_age14, p_age15, p_age16, p_age17, p_age18, p_age19 $
      , p_age20, p_age21, p_age22, p_age23, p_age24, p_age25 $
      , p_age26, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssign = WalleyeAgeAssign(Length_prod[LengthIndex2], LengthIndex2, FishProb, FishAge[LengthIndex2] $
      , LoopIndex1)
    length_mean[10:36, LoopIndex2+LengthIndex1] = AgeAssign[0, *]
    length_bin[10:36, LoopIndex2+LengthIndex1] = AgeAssign[1, *]
    AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthIndex2], LengthIndex2, FishProb, FishAge[LengthIndex2] $
      , LoopIndex1)
    ;FishAge[LengthIndex2]= AgeAssignInd
  ENDIF
  IF Size220to240count GT 0 then begin
    LengthIndex1 = 7
    LengthIndex2 = Size220to240
    FishProb = AgeLengthKey(p_age0, p_age1, p_age2, p_age3, p_age4, p_age5 $
      , p_age6, p_age7, p_age8, p_age9, p_age10, p_age11, p_age12 $
      , p_age13, p_age14, p_age15, p_age16, p_age17, p_age18, p_age19 $
      , p_age20, p_age21, p_age22, p_age23, p_age24, p_age25 $
      , p_age26, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssign = WalleyeAgeAssign(Length_prod[LengthIndex2], LengthIndex2, FishProb, FishAge[LengthIndex2] $
      , LoopIndex1)
    length_mean[10:36, LoopIndex2+LengthIndex1] = AgeAssign[0, *]
    length_bin[10:36, LoopIndex2+LengthIndex1] = AgeAssign[1, *]
    AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthIndex2], LengthIndex2, FishProb, FishAge[LengthIndex2] $
      , LoopIndex1)
    ;FishAge[LengthIndex2]= AgeAssignInd
  ENDIF
  IF Size240to260count GT 0 then begin
    LengthIndex1 = 8
    LengthIndex2 = Size240to260
    FishProb = AgeLengthKey(p_age0, p_age1, p_age2, p_age3, p_age4, p_age5 $
      , p_age6, p_age7, p_age8, p_age9, p_age10, p_age11, p_age12 $
      , p_age13, p_age14, p_age15, p_age16, p_age17, p_age18, p_age19 $
      , p_age20, p_age21, p_age22, p_age23, p_age24, p_age25 $
      , p_age26, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssign = WalleyeAgeAssign(Length_prod[LengthIndex2], LengthIndex2, FishProb, FishAge[LengthIndex2] $
      , LoopIndex1)
    length_mean[10:36, LoopIndex2+LengthIndex1] = AgeAssign[0, *]
    length_bin[10:36, LoopIndex2+LengthIndex1] = AgeAssign[1, *]
    AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthIndex2], LengthIndex2, FishProb, FishAge[LengthIndex2] $
      , LoopIndex1)
    ;FishAge[LengthIndex2]= AgeAssignInd
  ENDIF
  IF Size260to280count GT 0 then begin
    LengthIndex1 = 9
    LengthIndex2 = Size260to280
    FishProb = AgeLengthKey(p_age0, p_age1, p_age2, p_age3, p_age4, p_age5 $
      , p_age6, p_age7, p_age8, p_age9, p_age10, p_age11, p_age12 $
      , p_age13, p_age14, p_age15, p_age16, p_age17, p_age18, p_age19 $
      , p_age20, p_age21, p_age22, p_age23, p_age24, p_age25 $
      , p_age26, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssign = WalleyeAgeAssign(Length_prod[LengthIndex2], LengthIndex2, FishProb, FishAge[LengthIndex2] $
      , LoopIndex1)
    length_mean[10:36, LoopIndex2+LengthIndex1] = AgeAssign[0, *]
    length_bin[10:36, LoopIndex2+LengthIndex1] = AgeAssign[1, *]
    AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthIndex2], LengthIndex2, FishProb, FishAge[LengthIndex2] $
      , LoopIndex1)
    ;FishAge[LengthIndex2]= AgeAssignInd
  ENDIF
  IF Size280to300count GT 0 then begin
    LengthIndex1 = 10
    LengthIndex2 = Size280to300
    FishProb = AgeLengthKey(p_age0, p_age1, p_age2, p_age3, p_age4, p_age5 $
      , p_age6, p_age7, p_age8, p_age9, p_age10, p_age11, p_age12 $
      , p_age13, p_age14, p_age15, p_age16, p_age17, p_age18, p_age19 $
      , p_age20, p_age21, p_age22, p_age23, p_age24, p_age25 $
      , p_age26, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssign = WalleyeAgeAssign(Length_prod[LengthIndex2], LengthIndex2, FishProb, FishAge[LengthIndex2] $
      , LoopIndex1)
    length_mean[10:36, LoopIndex2+LengthIndex1] = AgeAssign[0, *]
    length_bin[10:36, LoopIndex2+LengthIndex1] = AgeAssign[1, *]
    AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthIndex2], LengthIndex2, FishProb, FishAge[LengthIndex2] $
      , LoopIndex1)
    ;FishAge[LengthIndex2]= AgeAssignInd
  ENDIF
  IF Size300to320count GT 0 then begin
    LengthIndex1 = 11
    LengthIndex2 = Size300to320
    FishProb = AgeLengthKey(p_age0, p_age1, p_age2, p_age3, p_age4, p_age5 $
      , p_age6, p_age7, p_age8, p_age9, p_age10, p_age11, p_age12 $
      , p_age13, p_age14, p_age15, p_age16, p_age17, p_age18, p_age19 $
      , p_age20, p_age21, p_age22, p_age23, p_age24, p_age25 $
      , p_age26, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssign = WalleyeAgeAssign(Length_prod[LengthIndex2], LengthIndex2, FishProb, FishAge[LengthIndex2] $
      , LoopIndex1)
    length_mean[10:36, LoopIndex2+LengthIndex1] = AgeAssign[0, *]
    length_bin[10:36, LoopIndex2+LengthIndex1] = AgeAssign[1, *]
    AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthIndex2], LengthIndex2, FishProb, FishAge[LengthIndex2] $
      , LoopIndex1)
    ;FishAge[LengthIndex2]= AgeAssignInd
  ENDIF
  IF Size320to340count GT 0 then begin
    LengthIndex1 = 12
    LengthIndex2 = Size320to340
    FishProb = AgeLengthKey(p_age0, p_age1, p_age2, p_age3, p_age4, p_age5 $
      , p_age6, p_age7, p_age8, p_age9, p_age10, p_age11, p_age12 $
      , p_age13, p_age14, p_age15, p_age16, p_age17, p_age18, p_age19 $
      , p_age20, p_age21, p_age22, p_age23, p_age24, p_age25 $
      , p_age26, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssign = WalleyeAgeAssign(Length_prod[LengthIndex2], LengthIndex2, FishProb, FishAge[LengthIndex2] $
      , LoopIndex1)
    length_mean[10:36, LoopIndex2+LengthIndex1] = AgeAssign[0, *]
    length_bin[10:36, LoopIndex2+LengthIndex1] = AgeAssign[1, *]
    AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthIndex2], LengthIndex2, FishProb, FishAge[LengthIndex2] $
      , LoopIndex1)
    ;FishAge[LengthIndex2]= AgeAssignInd
  ENDIF
  IF Size340to360count GT 0 then begin
    LengthIndex1 = 13
    LengthIndex2 = Size340to360
    FishProb = AgeLengthKey(p_age0, p_age1, p_age2, p_age3, p_age4, p_age5 $
      , p_age6, p_age7, p_age8, p_age9, p_age10, p_age11, p_age12 $
      , p_age13, p_age14, p_age15, p_age16, p_age17, p_age18, p_age19 $
      , p_age20, p_age21, p_age22, p_age23, p_age24, p_age25 $
      , p_age26, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssign = WalleyeAgeAssign(Length_prod[LengthIndex2], LengthIndex2, FishProb, FishAge[LengthIndex2] $
      , LoopIndex1)
    length_mean[10:36, LoopIndex2+LengthIndex1] = AgeAssign[0, *]
    length_bin[10:36, LoopIndex2+LengthIndex1] = AgeAssign[1, *]
    AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthIndex2], LengthIndex2, FishProb, FishAge[LengthIndex2] $
      , LoopIndex1)
    ;FishAge[LengthIndex2]= AgeAssignInd
  ENDIF
  IF Size360to380count GT 0 then begin
    LengthIndex1 = 14
    LengthIndex2 = Size360to380
    FishProb = AgeLengthKey(p_age0, p_age1, p_age2, p_age3, p_age4, p_age5 $
      , p_age6, p_age7, p_age8, p_age9, p_age10, p_age11, p_age12 $
      , p_age13, p_age14, p_age15, p_age16, p_age17, p_age18, p_age19 $
      , p_age20, p_age21, p_age22, p_age23, p_age24, p_age25 $
      , p_age26, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssign = WalleyeAgeAssign(Length_prod[LengthIndex2], LengthIndex2, FishProb, FishAge[LengthIndex2] $
      , LoopIndex1)
    length_mean[10:36, LoopIndex2+LengthIndex1] = AgeAssign[0, *]
    length_bin[10:36, LoopIndex2+LengthIndex1] = AgeAssign[1, *]
    AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthIndex2], LengthIndex2, FishProb, FishAge[LengthIndex2] $
      , LoopIndex1)
  ENDIF
  IF Size380to400count GT 0 then begin
    LengthIndex1 = 15
    LengthIndex2 = Size380to400
    FishProb = AgeLengthKey(p_age0, p_age1, p_age2, p_age3, p_age4, p_age5 $
      , p_age6, p_age7, p_age8, p_age9, p_age10, p_age11, p_age12 $
      , p_age13, p_age14, p_age15, p_age16, p_age17, p_age18, p_age19 $
      , p_age20, p_age21, p_age22, p_age23, p_age24, p_age25 $
      , p_age26, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssign = WalleyeAgeAssign(Length_prod[LengthIndex2], LengthIndex2, FishProb, FishAge[LengthIndex2] $
      , LoopIndex1)
    length_mean[10:36, LoopIndex2+LengthIndex1] = AgeAssign[0, *]
    length_bin[10:36, LoopIndex2+LengthIndex1] = AgeAssign[1, *]
    AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthIndex2], LengthIndex2, FishProb, FishAge[LengthIndex2] $
      , LoopIndex1)
    ;FishAge[LengthIndex2]= AgeAssignInd
  ENDIF
  IF Size400to420count GT 0 then begin
    LengthIndex1 = 16
    LengthIndex2 = Size400to420
    FishProb = AgeLengthKey(p_age0, p_age1, p_age2, p_age3, p_age4, p_age5 $
      , p_age6, p_age7, p_age8, p_age9, p_age10, p_age11, p_age12 $
      , p_age13, p_age14, p_age15, p_age16, p_age17, p_age18, p_age19 $
      , p_age20, p_age21, p_age22, p_age23, p_age24, p_age25 $
      , p_age26, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssign = WalleyeAgeAssign(Length_prod[LengthIndex2], LengthIndex2, FishProb, FishAge[LengthIndex2] $
      , LoopIndex1)
    length_mean[10:36, LoopIndex2+LengthIndex1] = AgeAssign[0, *]
    length_bin[10:36, LoopIndex2+LengthIndex1] = AgeAssign[1, *]
    AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthIndex2], LengthIndex2, FishProb, FishAge[LengthIndex2] $
      , LoopIndex1)
    ;FishAge[LengthIndex2]= AgeAssignInd
  ENDIF
  IF Size420to440count GT 0 then begin
    LengthIndex1 = 17
    LengthIndex2 = Size420to440
    FishProb = AgeLengthKey(p_age0, p_age1, p_age2, p_age3, p_age4, p_age5 $
      , p_age6, p_age7, p_age8, p_age9, p_age10, p_age11, p_age12 $
      , p_age13, p_age14, p_age15, p_age16, p_age17, p_age18, p_age19 $
      , p_age20, p_age21, p_age22, p_age23, p_age24, p_age25 $
      , p_age26, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssign = WalleyeAgeAssign(Length_prod[LengthIndex2], LengthIndex2, FishProb, FishAge[LengthIndex2] $
      , LoopIndex1)
    length_mean[10:36, LoopIndex2+LengthIndex1] = AgeAssign[0, *]
    length_bin[10:36, LoopIndex2+LengthIndex1] = AgeAssign[1, *]
    AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthIndex2], LengthIndex2, FishProb, FishAge[LengthIndex2] $
      , LoopIndex1)
    ;FishAge[LengthIndex2]= AgeAssignInd
  ENDIF
  IF Size440to460count GT 0 then begin
    LengthIndex1 = 18
    LengthIndex2 = Size440to460
    FishProb = AgeLengthKey(p_age0, p_age1, p_age2, p_age3, p_age4, p_age5 $
      , p_age6, p_age7, p_age8, p_age9, p_age10, p_age11, p_age12 $
      , p_age13, p_age14, p_age15, p_age16, p_age17, p_age18, p_age19 $
      , p_age20, p_age21, p_age22, p_age23, p_age24, p_age25 $
      , p_age26, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssign = WalleyeAgeAssign(Length_prod[LengthIndex2], LengthIndex2, FishProb, FishAge[LengthIndex2] $
      , LoopIndex1)
    length_mean[10:36, LoopIndex2+LengthIndex1] = AgeAssign[0, *]
    length_bin[10:36, LoopIndex2+LengthIndex1] = AgeAssign[1, *]
    AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthIndex2], LengthIndex2, FishProb, FishAge[LengthIndex2] $
      , LoopIndex1)
    ;FishAge[LengthIndex2]= AgeAssignInd
  ENDIF
  IF Size460to480count GT 0 then begin
    LengthIndex1 = 19
    LengthIndex2 = Size460to480
    FishProb = AgeLengthKey(p_age0, p_age1, p_age2, p_age3, p_age4, p_age5 $
      , p_age6, p_age7, p_age8, p_age9, p_age10, p_age11, p_age12 $
      , p_age13, p_age14, p_age15, p_age16, p_age17, p_age18, p_age19 $
      , p_age20, p_age21, p_age22, p_age23, p_age24, p_age25 $
      , p_age26, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb

    AgeAssign = WalleyeAgeAssign(Length_prod[LengthIndex2], LengthIndex2, FishProb, FishAge[LengthIndex2] $
      , LoopIndex1)
    length_mean[10:36, LoopIndex2+LengthIndex1] = AgeAssign[0, *]
    length_bin[10:36, LoopIndex2+LengthIndex1] = AgeAssign[1, *]
    AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthIndex2], LengthIndex2, FishProb, FishAge[LengthIndex2] $
      , LoopIndex1)
    ;FishAge[LengthIndex2]= AgeAssignInd
  ENDIF
  IF Size480to500count GT 0 then begin
    LengthIndex1 = 20
    LengthIndex2 = Size480to500
    FishProb = AgeLengthKey(p_age0, p_age1, p_age2, p_age3, p_age4, p_age5 $
      , p_age6, p_age7, p_age8, p_age9, p_age10, p_age11, p_age12 $
      , p_age13, p_age14, p_age15, p_age16, p_age17, p_age18, p_age19 $
      , p_age20, p_age21, p_age22, p_age23, p_age24, p_age25 $
      , p_age26, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb

    AgeAssign = WalleyeAgeAssign(Length_prod[LengthIndex2], LengthIndex2, FishProb, FishAge[LengthIndex2] $
      , LoopIndex1)
    length_mean[10:36, LoopIndex2+LengthIndex1] = AgeAssign[0, *]
    length_bin[10:36, LoopIndex2+LengthIndex1] = AgeAssign[1, *]
    AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthIndex2], LengthIndex2, FishProb, FishAge[LengthIndex2] $
      , LoopIndex1)
    ;FishAge[LengthIndex2]= AgeAssignInd
  ENDIF
  IF Size500to520count GT 0 then begin
    LengthIndex1 = 21
    LengthIndex2 = Size500to520
    FishProb = AgeLengthKey(p_age0, p_age1, p_age2, p_age3, p_age4, p_age5 $
      , p_age6, p_age7, p_age8, p_age9, p_age10, p_age11, p_age12 $
      , p_age13, p_age14, p_age15, p_age16, p_age17, p_age18, p_age19 $
      , p_age20, p_age21, p_age22, p_age23, p_age24, p_age25 $
      , p_age26, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb

    AgeAssign = WalleyeAgeAssign(Length_prod[LengthIndex2], LengthIndex2, FishProb, FishAge[LengthIndex2] $
      , LoopIndex1)
    length_mean[10:36, LoopIndex2+LengthIndex1] = AgeAssign[0, *]
    length_bin[10:36, LoopIndex2+LengthIndex1] = AgeAssign[1, *]
    AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthIndex2], LengthIndex2, FishProb, FishAge[LengthIndex2] $
      , LoopIndex1)
    ;FishAge[LengthIndex2]= AgeAssignInd
  ENDIF
  IF Size520to540count GT 0 then begin
    LengthIndex1 = 22
    LengthIndex2 = Size520to540
    FishProb = AgeLengthKey(p_age0, p_age1, p_age2, p_age3, p_age4, p_age5 $
      , p_age6, p_age7, p_age8, p_age9, p_age10, p_age11, p_age12 $
      , p_age13, p_age14, p_age15, p_age16, p_age17, p_age18, p_age19 $
      , p_age20, p_age21, p_age22, p_age23, p_age24, p_age25 $
      , p_age26, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb

    AgeAssign = WalleyeAgeAssign(Length_prod[LengthIndex2], LengthIndex2, FishProb, FishAge[LengthIndex2] $
      , LoopIndex1)
    length_mean[10:36, LoopIndex2+LengthIndex1] = AgeAssign[0, *]
    length_bin[10:36, LoopIndex2+LengthIndex1] = AgeAssign[1, *]
    AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthIndex2], LengthIndex2, FishProb, FishAge[LengthIndex2] $
      , LoopIndex1)
    ;FishAge[LengthIndex2]= AgeAssignInd
  ENDIF
  IF Size540to560count GT 0 then begin
    LengthIndex1 = 23
    LengthIndex2 = Size540to560
    FishProb = AgeLengthKey(p_age0, p_age1, p_age2, p_age3, p_age4, p_age5 $
      , p_age6, p_age7, p_age8, p_age9, p_age10, p_age11, p_age12 $
      , p_age13, p_age14, p_age15, p_age16, p_age17, p_age18, p_age19 $
      , p_age20, p_age21, p_age22, p_age23, p_age24, p_age25 $
      , p_age26, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb

    AgeAssign = WalleyeAgeAssign(Length_prod[LengthIndex2], LengthIndex2, FishProb, FishAge[LengthIndex2] $
      , LoopIndex1)
    length_mean[10:36, LoopIndex2+LengthIndex1] = AgeAssign[0, *]
    length_bin[10:36, LoopIndex2+LengthIndex1] = AgeAssign[1, *]
    AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthIndex2], LengthIndex2, FishProb, FishAge[LengthIndex2] $
      , LoopIndex1)
    ;FishAge[LengthIndex2]= AgeAssignInd
  ENDIF
  IF Size560to580count GT 0 then begin
    LengthIndex1 = 24
    LengthIndex2 = Size560to580
    FishProb = AgeLengthKey(p_age0, p_age1, p_age2, p_age3, p_age4, p_age5 $
      , p_age6, p_age7, p_age8, p_age9, p_age10, p_age11, p_age12 $
      , p_age13, p_age14, p_age15, p_age16, p_age17, p_age18, p_age19 $
      , p_age20, p_age21, p_age22, p_age23, p_age24, p_age25 $
      , p_age26, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssign = WalleyeAgeAssign(Length_prod[LengthIndex2], LengthIndex2, FishProb, FishAge[LengthIndex2] $
      , LoopIndex1)
    length_mean[10:36, LoopIndex2+LengthIndex1] = AgeAssign[0, *]
    length_bin[10:36, LoopIndex2+LengthIndex1] = AgeAssign[1, *]
    AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthIndex2], LengthIndex2, FishProb, FishAge[LengthIndex2] $
      , LoopIndex1)
    ;FishAge[LengthIndex2]= AgeAssignInd
  ENDIF
  IF Size580to600count GT 0 then begin
    LengthIndex1 = 25
    LengthIndex2 = Size580to600
    FishProb = AgeLengthKey(p_age0, p_age1, p_age2, p_age3, p_age4, p_age5 $
      , p_age6, p_age7, p_age8, p_age9, p_age10, p_age11, p_age12 $
      , p_age13, p_age14, p_age15, p_age16, p_age17, p_age18, p_age19 $
      , p_age20, p_age21, p_age22, p_age23, p_age24, p_age25 $
      , p_age26, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssign = WalleyeAgeAssign(Length_prod[LengthIndex2], LengthIndex2, FishProb, FishAge[LengthIndex2] $
      , LoopIndex1)
    length_mean[10:36, LoopIndex2+LengthIndex1] = AgeAssign[0, *]
    length_bin[10:36, LoopIndex2+LengthIndex1] = AgeAssign[1, *]
    AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthIndex2], LengthIndex2, FishProb, FishAge[LengthIndex2] $
      , LoopIndex1)
    ;FishAge[LengthIndex2]= AgeAssignInd
  ENDIF
  IF Size600to620count GT 0 then begin
    LengthIndex1 = 26
    LengthIndex2 = Size600to620
    FishProb = AgeLengthKey(p_age0, p_age1, p_age2, p_age3, p_age4, p_age5 $
      , p_age6, p_age7, p_age8, p_age9, p_age10, p_age11, p_age12 $
      , p_age13, p_age14, p_age15, p_age16, p_age17, p_age18, p_age19 $
      , p_age20, p_age21, p_age22, p_age23, p_age24, p_age25 $
      , p_age26, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb

    AgeAssign = WalleyeAgeAssign(Length_prod[LengthIndex2], LengthIndex2, FishProb, FishAge[LengthIndex2] $
      , LoopIndex1)
    length_mean[10:36, LoopIndex2+LengthIndex1] = AgeAssign[0, *]
    length_bin[10:36, LoopIndex2+LengthIndex1] = AgeAssign[1, *]
    AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthIndex2], LengthIndex2, FishProb, FishAge[LengthIndex2] $
      , LoopIndex1)
    ;FishAge[LengthIndex2]= AgeAssignInd
  ENDIF
  IF Size620to640count GT 0 then begin
    LengthIndex1 = 27
    LengthIndex2 = Size620to640
    FishProb = AgeLengthKey(p_age0, p_age1, p_age2, p_age3, p_age4, p_age5 $
      , p_age6, p_age7, p_age8, p_age9, p_age10, p_age11, p_age12 $
      , p_age13, p_age14, p_age15, p_age16, p_age17, p_age18, p_age19 $
      , p_age20, p_age21, p_age22, p_age23, p_age24, p_age25 $
      , p_age26, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssign = WalleyeAgeAssign(Length_prod[LengthIndex2], LengthIndex2, FishProb, FishAge[LengthIndex2] $
      , LoopIndex1)
    length_mean[10:36, LoopIndex2+LengthIndex1] = AgeAssign[0, *]
    length_bin[10:36, LoopIndex2+LengthIndex1] = AgeAssign[1, *]
    AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthIndex2], LengthIndex2, FishProb, FishAge[LengthIndex2] $
      , LoopIndex1)
    ;FishAge[LengthIndex2]= AgeAssignInd
  ENDIF
  IF Size640to660count GT 0 then begin
    LengthIndex1 = 28
    LengthIndex2 = Size640to660
    FishProb = AgeLengthKey(p_age0, p_age1, p_age2, p_age3, p_age4, p_age5 $
      , p_age6, p_age7, p_age8, p_age9, p_age10, p_age11, p_age12 $
      , p_age13, p_age14, p_age15, p_age16, p_age17, p_age18, p_age19 $
      , p_age20, p_age21, p_age22, p_age23, p_age24, p_age25 $
      , p_age26, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb

    AgeAssign = WalleyeAgeAssign(Length_prod[LengthIndex2], LengthIndex2, FishProb, FishAge[LengthIndex2] $
      , LoopIndex1)
    length_mean[10:36, LoopIndex2+LengthIndex1] = AgeAssign[0, *]
    length_bin[10:36, LoopIndex2+LengthIndex1] = AgeAssign[1, *]
    AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthIndex2], LengthIndex2, FishProb, FishAge[LengthIndex2] $
      , LoopIndex1)
    ;FishAge[LengthIndex2]= AgeAssignInd
  ENDIF
  IF Size660to680count GT 0 then begin
    LengthIndex1 = 29
    LengthIndex2 = Size660to680
    FishProb = AgeLengthKey(p_age0, p_age1, p_age2, p_age3, p_age4, p_age5 $
      , p_age6, p_age7, p_age8, p_age9, p_age10, p_age11, p_age12 $
      , p_age13, p_age14, p_age15, p_age16, p_age17, p_age18, p_age19 $
      , p_age20, p_age21, p_age22, p_age23, p_age24, p_age25 $
      , p_age26, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb

    AgeAssign = WalleyeAgeAssign(Length_prod[LengthIndex2], LengthIndex2, FishProb, FishAge[LengthIndex2] $
      , LoopIndex1)
    length_mean[10:36, LoopIndex2+LengthIndex1] = AgeAssign[0, *]
    length_bin[10:36, LoopIndex2+LengthIndex1] = AgeAssign[1, *]
    AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthIndex2], LengthIndex2, FishProb, FishAge[LengthIndex2] $
      , LoopIndex1)
    ;FishAge[LengthIndex2]= AgeAssignInd
  ENDIF
  IF Size680to700count GT 0 then begin
    LengthIndex1 = 30
    LengthIndex2 = Size680to700
    FishProb = AgeLengthKey(p_age0, p_age1, p_age2, p_age3, p_age4, p_age5 $
      , p_age6, p_age7, p_age8, p_age9, p_age10, p_age11, p_age12 $
      , p_age13, p_age14, p_age15, p_age16, p_age17, p_age18, p_age19 $
      , p_age20, p_age21, p_age22, p_age23, p_age24, p_age25 $
      , p_age26, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssign = WalleyeAgeAssign(Length_prod[LengthIndex2], LengthIndex2, FishProb, FishAge[LengthIndex2] $
      , LoopIndex1)
    length_mean[10:36, LoopIndex2+LengthIndex1] = AgeAssign[0, *]
    length_bin[10:36, LoopIndex2+LengthIndex1] = AgeAssign[1, *]
    AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthIndex2], LengthIndex2, FishProb, FishAge[LengthIndex2] $
      , LoopIndex1)
    ;FishAge[LengthIndex2]= AgeAssignInd
  ENDIF
  IF Size700to720count GT 0 then begin
    LengthIndex1 = 31
    LengthIndex2 = Size700to720
    FishProb = AgeLengthKey(p_age0, p_age1, p_age2, p_age3, p_age4, p_age5 $
      , p_age6, p_age7, p_age8, p_age9, p_age10, p_age11, p_age12 $
      , p_age13, p_age14, p_age15, p_age16, p_age17, p_age18, p_age19 $
      , p_age20, p_age21, p_age22, p_age23, p_age24, p_age25 $
      , p_age26, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssign = WalleyeAgeAssign(Length_prod[LengthIndex2], LengthIndex2, FishProb, FishAge[LengthIndex2] $
      , LoopIndex1)
    length_mean[10:36, LoopIndex2+LengthIndex1] = AgeAssign[0, *]
    length_bin[10:36, LoopIndex2+LengthIndex1] = AgeAssign[1, *]
    AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthIndex2], LengthIndex2, FishProb, FishAge[LengthIndex2] $
      , LoopIndex1)
    ;FishAge[LengthIndex2]= AgeAssignInd
  ENDIF
  IF Size720to740count GT 0 then begin
    LengthIndex1 = 32
    LengthIndex2 = Size720to740
    FishProb = AgeLengthKey(p_age0, p_age1, p_age2, p_age3, p_age4, p_age5 $
      , p_age6, p_age7, p_age8, p_age9, p_age10, p_age11, p_age12 $
      , p_age13, p_age14, p_age15, p_age16, p_age17, p_age18, p_age19 $
      , p_age20, p_age21, p_age22, p_age23, p_age24, p_age25 $
      , p_age26, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssign = WalleyeAgeAssign(Length_prod[LengthIndex2], LengthIndex2, FishProb, FishAge[LengthIndex2] $
      , LoopIndex1)
    length_mean[10:36, LoopIndex2+LengthIndex1] = AgeAssign[0, *]
    length_bin[10:36, LoopIndex2+LengthIndex1] = AgeAssign[1, *]
    AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthIndex2], LengthIndex2, FishProb, FishAge[LengthIndex2] $
      , LoopIndex1)
  ENDIF
  IF Size740to760count GT 0 then begin
    LengthIndex1 = 33
    LengthIndex2 = Size740to760
    FishProb = AgeLengthKey(p_age0, p_age1, p_age2, p_age3, p_age4, p_age5 $
      , p_age6, p_age7, p_age8, p_age9, p_age10, p_age11, p_age12 $
      , p_age13, p_age14, p_age15, p_age16, p_age17, p_age18, p_age19 $
      , p_age20, p_age21, p_age22, p_age23, p_age24, p_age25 $
      , p_age26, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssign = WalleyeAgeAssign(Length_prod[LengthIndex2], LengthIndex2, FishProb, FishAge[LengthIndex2] $
      , LoopIndex1)
    length_mean[10:36, LoopIndex2+LengthIndex1] = AgeAssign[0, *]
    length_bin[10:36, LoopIndex2+LengthIndex1] = AgeAssign[1, *]
    AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthIndex2], LengthIndex2, FishProb, FishAge[LengthIndex2] $
      , LoopIndex1)
    ;FishAge[LengthIndex2]= AgeAssignInd
  ENDIF
  IF Size760to780count GT 0 then begin
    LengthIndex1 = 34
    LengthIndex2 = Size760to780
    FishProb = AgeLengthKey(p_age0, p_age1, p_age2, p_age3, p_age4, p_age5 $
      , p_age6, p_age7, p_age8, p_age9, p_age10, p_age11, p_age12 $
      , p_age13, p_age14, p_age15, p_age16, p_age17, p_age18, p_age19 $
      , p_age20, p_age21, p_age22, p_age23, p_age24, p_age25 $
      , p_age26, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssign = WalleyeAgeAssign(Length_prod[LengthIndex2], LengthIndex2, FishProb, FishAge[LengthIndex2] $
      , LoopIndex1)
    length_mean[10:36, LoopIndex2+LengthIndex1] = AgeAssign[0, *]
    length_bin[10:36, LoopIndex2+LengthIndex1] = AgeAssign[1, *]
    AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthIndex2], LengthIndex2, FishProb, FishAge[LengthIndex2] $
      , LoopIndex1)
    ;FishAge[LengthIndex2]= AgeAssignInd
  ENDIF
  IF Size780to800count GT 0 then begin
    LengthIndex1 = 35
    LengthIndex2 = Size780to800
    FishProb = AgeLengthKey(p_age0, p_age1, p_age2, p_age3, p_age4, p_age5 $
      , p_age6, p_age7, p_age8, p_age9, p_age10, p_age11, p_age12 $
      , p_age13, p_age14, p_age15, p_age16, p_age17, p_age18, p_age19 $
      , p_age20, p_age21, p_age22, p_age23, p_age24, p_age25 $
      , p_age26, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssign = WalleyeAgeAssign(Length_prod[LengthIndex2], LengthIndex2, FishProb, FishAge[LengthIndex2] $
      , LoopIndex1)
    length_mean[10:36, LoopIndex2+LengthIndex1] = AgeAssign[0, *]
    length_bin[10:36, LoopIndex2+LengthIndex1] = AgeAssign[1, *]
    AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthIndex2], LengthIndex2, FishProb, FishAge[LengthIndex2] $
      , LoopIndex1)
    ;FishAge[LengthIndex2]= AgeAssignInd
  ENDIF
  IF Sizege800count GT 0 then begin
    LengthIndex1 = 36
    LengthIndex2 = SizeGE800
    FishProb = AgeLengthKey(p_age0, p_age1, p_age2, p_age3, p_age4, p_age5 $
      , p_age6, p_age7, p_age8, p_age9, p_age10, p_age11, p_age12 $
      , p_age13, p_age14, p_age15, p_age16, p_age17, p_age18, p_age19 $
      , p_age20, p_age21, p_age22, p_age23, p_age24, p_age25 $
      , p_age26, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssign = WalleyeAgeAssign(Length_prod[LengthIndex2], LengthIndex2, FishProb, FishAge[LengthIndex2] $
      , LoopIndex1)
    length_mean[10:36, LoopIndex2+LengthIndex1] = AgeAssign[0, *]
    length_bin[10:36, LoopIndex2+LengthIndex1] = AgeAssign[1, *]
    AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthIndex2], LengthIndex2, FishProb, FishAge[LengthIndex2] $
      , LoopIndex1)
  ENDIF

  ; 1. Assign age semi-randomly to lengths - MALES
  IF SizeLT100Mcount GT 0 THEN BEGIN
    LengthIndex1 = 0
    LengthIndex2 = SizeLT100M
    FishProb = AgeLengthKey(p_age0M, p_age1M, p_age2M, p_age3M, p_age4M, p_age5M $
      , p_age6M, p_age7M, p_age8M, p_age9M, p_age10M, p_age11M, p_age12M $
      , p_age13M, p_age14M, p_age15M, p_age16M, p_age17M, p_age18M, p_age19M $
      , p_age20M, p_age21M, p_age22M, p_age23M, p_age24M, p_age25M $
      , p_age26M, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthIndex2]] $
      , male[LengthIndex2], FishProb, FishAge[male[LengthIndex2]] $
      , LoopIndex1)
    length_meanM[10:36, LoopIndex2+LengthIndex1] = AgeAssignM[0, *]
    length_binM[10:36, LoopIndex2+LengthIndex1] = AgeAssignM[1, *]
    ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
    AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[male[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
    FishAge[male[LengthIndex2]] = AgeAssignIndM[0,*]
    FishLength[male[LengthIndex2]] = AgeAssignIndM[1,*]
  ENDIF
  IF Size100to120Mcount GT 0 THEN BEGIN
    LengthIndex1 = 1
    LengthIndex2 = Size100to120M
    FishProb = AgeLengthKey(p_age0M, p_age1M, p_age2M, p_age3M, p_age4M, p_age5M $
      , p_age6M, p_age7M, p_age8M, p_age9M, p_age10M, p_age11M, p_age12M $
      , p_age13M, p_age14M, p_age15M, p_age16M, p_age17M, p_age18M, p_age19M $
      , p_age20M, p_age21M, p_age22M, p_age23M, p_age24M, p_age25M $
      , p_age26M, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthIndex2]] $
      , male[LengthIndex2], FishProb, FishAge[male[LengthIndex2]] $
      , LoopIndex1)
    length_meanM[10:36, LoopIndex2+LengthIndex1] = AgeAssignM[0, *]
    length_binM[10:36, LoopIndex2+LengthIndex1] = AgeAssignM[1, *]
    ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
    AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[male[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
    FishAge[male[LengthIndex2]] = AgeAssignIndM[0,*]
    FishLength[male[LengthIndex2]] = AgeAssignIndM[1,*]
  ENDIF
  IF Size120to140Mcount GT 0 THEN BEGIN
    LengthIndex1 = 2
    LengthIndex2 = Size120to140M
    FishProb = AgeLengthKey(p_age0M, p_age1M, p_age2M, p_age3M, p_age4M, p_age5M $
      , p_age6M, p_age7M, p_age8M, p_age9M, p_age10M, p_age11M, p_age12M $
      , p_age13M, p_age14M, p_age15M, p_age16M, p_age17M, p_age18M, p_age19M $
      , p_age20M, p_age21M, p_age22M, p_age23M, p_age24M, p_age25M $
      , p_age26M, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthIndex2]] $
      , male[LengthIndex2], FishProb, FishAge[male[LengthIndex2]] $
      , LoopIndex1)
    length_meanM[10:36, LoopIndex2+LengthIndex1] = AgeAssignM[0, *]
    length_binM[10:36, LoopIndex2+LengthIndex1] = AgeAssignM[1, *]
    ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
    AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[male[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
    FishAge[male[LengthIndex2]] = AgeAssignIndM[0,*]
    FishLength[male[LengthIndex2]] = AgeAssignIndM[1,*]
  ENDIF
  IF Size140to160Mcount GT 0 THEN BEGIN
    LengthIndex1 = 3
    LengthIndex2 = Size140to160M
    FishProb = AgeLengthKey(p_age0M, p_age1M, p_age2M, p_age3M, p_age4M, p_age5M $
      , p_age6M, p_age7M, p_age8M, p_age9M, p_age10M, p_age11M, p_age12M $
      , p_age13M, p_age14M, p_age15M, p_age16M, p_age17M, p_age18M, p_age19M $
      , p_age20M, p_age21M, p_age22M, p_age23M, p_age24M, p_age25M $
      , p_age26M, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthIndex2]] $
      , male[LengthIndex2], FishProb, FishAge[male[LengthIndex2]] $
      , LoopIndex1)
    length_meanM[10:36, LoopIndex2+LengthIndex1] = AgeAssignM[0, *]
    length_binM[10:36, LoopIndex2+LengthIndex1] = AgeAssignM[1, *]
    ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
    AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[male[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
    FishAge[male[LengthIndex2]] = AgeAssignIndM[0,*]
    FishLength[male[LengthIndex2]] = AgeAssignIndM[1,*]
  ENDIF
  IF Size160to180Mcount GT 0 THEN BEGIN
    LengthIndex1 = 4
    LengthIndex2 = Size160to180M
    FishProb = AgeLengthKey(p_age0M, p_age1M, p_age2M, p_age3M, p_age4M, p_age5M $
      , p_age6M, p_age7M, p_age8M, p_age9M, p_age10M, p_age11M, p_age12M $
      , p_age13M, p_age14M, p_age15M, p_age16M, p_age17M, p_age18M, p_age19M $
      , p_age20M, p_age21M, p_age22M, p_age23M, p_age24M, p_age25M $
      , p_age26M, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthIndex2]] $
      , male[LengthIndex2], FishProb, FishAge[male[LengthIndex2]] $
      , LoopIndex1)
    length_meanM[10:36, LoopIndex2+LengthIndex1] = AgeAssignM[0, *]
    length_binM[10:36, LoopIndex2+LengthIndex1] = AgeAssignM[1, *]
    ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
    AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[male[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
    FishAge[male[LengthIndex2]] = AgeAssignIndM[0,*]
    FishLength[male[LengthIndex2]] = AgeAssignIndM[1,*]
  ENDIF
  IF Size180to200Mcount GT 0 THEN BEGIN
    LengthIndex1 = 5
    LengthIndex2 = Size180to200M
    FishProb = AgeLengthKey(p_age0M, p_age1M, p_age2M, p_age3M, p_age4M, p_age5M $
      , p_age6M, p_age7M, p_age8M, p_age9M, p_age10M, p_age11M, p_age12M $
      , p_age13M, p_age14M, p_age15M, p_age16M, p_age17M, p_age18M, p_age19M $
      , p_age20M, p_age21M, p_age22M, p_age23M, p_age24M, p_age25M $
      , p_age26M, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthIndex2]] $
      , male[LengthIndex2], FishProb, FishAge[male[LengthIndex2]] $
      , LoopIndex1)
    length_meanM[10:36, LoopIndex2+LengthIndex1] = AgeAssignM[0, *]
    length_binM[10:36, LoopIndex2+LengthIndex1] = AgeAssignM[1, *]
    ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
    AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[male[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
    FishAge[male[LengthIndex2]] = AgeAssignIndM[0,*]
    FishLength[male[LengthIndex2]] = AgeAssignIndM[1,*]
  ENDIF
  IF Size200to220Mcount GT 0 THEN BEGIN
    LengthIndex1 = 6
    LengthIndex2 = Size200to220M
    FishProb = AgeLengthKey(p_age0M, p_age1M, p_age2M, p_age3M, p_age4M, p_age5M $
      , p_age6M, p_age7M, p_age8M, p_age9M, p_age10M, p_age11M, p_age12M $
      , p_age13M, p_age14M, p_age15M, p_age16M, p_age17M, p_age18M, p_age19M $
      , p_age20M, p_age21M, p_age22M, p_age23M, p_age24M, p_age25M $
      , p_age26M, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthIndex2]] $
      , male[LengthIndex2], FishProb, FishAge[male[LengthIndex2]] $
      , LoopIndex1)
    length_meanM[10:36, LoopIndex2+LengthIndex1] = AgeAssignM[0, *]
    length_binM[10:36, LoopIndex2+LengthIndex1] = AgeAssignM[1, *]
    ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
    AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[male[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
    FishAge[male[LengthIndex2]] = AgeAssignIndM[0,*]
    FishLength[male[LengthIndex2]] = AgeAssignIndM[1,*]
  ENDIF
  IF Size220to240Mcount GT 0 THEN BEGIN
    LengthIndex1 = 7
    LengthIndex2 = Size220to240M
    FishProb = AgeLengthKey(p_age0M, p_age1M, p_age2M, p_age3M, p_age4M, p_age5M $
      , p_age6M, p_age7M, p_age8M, p_age9M, p_age10M, p_age11M, p_age12M $
      , p_age13M, p_age14M, p_age15M, p_age16M, p_age17M, p_age18M, p_age19M $
      , p_age20M, p_age21M, p_age22M, p_age23M, p_age24M, p_age25M $
      , p_age26M, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthIndex2]] $
      , male[LengthIndex2], FishProb, FishAge[male[LengthIndex2]] $
      , LoopIndex1)
    length_meanM[10:36, LoopIndex2+LengthIndex1] = AgeAssignM[0, *]
    length_binM[10:36, LoopIndex2+LengthIndex1] = AgeAssignM[1, *]
    ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
    AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[male[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
    FishAge[male[LengthIndex2]] = AgeAssignIndM[0,*]
    FishLength[male[LengthIndex2]] = AgeAssignIndM[1,*]
  ENDIF
  IF Size240to260Mcount GT 0 THEN BEGIN
    LengthIndex1 = 8
    LengthIndex2 = Size240to260M
    FishProb = AgeLengthKey(p_age0M, p_age1M, p_age2M, p_age3M, p_age4M, p_age5M $
      , p_age6M, p_age7M, p_age8M, p_age9M, p_age10M, p_age11M, p_age12M $
      , p_age13M, p_age14M, p_age15M, p_age16M, p_age17M, p_age18M, p_age19M $
      , p_age20M, p_age21M, p_age22M, p_age23M, p_age24M, p_age25M $
      , p_age26M, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthIndex2]] $
      , male[LengthIndex2], FishProb, FishAge[male[LengthIndex2]] $
      , LoopIndex1)
    length_meanM[10:36, LoopIndex2+LengthIndex1] = AgeAssignM[0, *]
    length_binM[10:36, LoopIndex2+LengthIndex1] = AgeAssignM[1, *]
    ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
    AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[male[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
    FishAge[male[LengthIndex2]] = AgeAssignIndM[0,*]
    FishLength[male[LengthIndex2]] = AgeAssignIndM[1,*]
  ENDIF
  IF Size260to280Mcount GT 0 THEN BEGIN
    LengthIndex1 = 9
    LengthIndex2 = Size260to280M
    FishProb = AgeLengthKey(p_age0M, p_age1M, p_age2M, p_age3M, p_age4M, p_age5M $
      , p_age6M, p_age7M, p_age8M, p_age9M, p_age10M, p_age11M, p_age12M $
      , p_age13M, p_age14M, p_age15M, p_age16M, p_age17M, p_age18M, p_age19M $
      , p_age20M, p_age21M, p_age22M, p_age23M, p_age24M, p_age25M $
      , p_age26M, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthIndex2]] $
      , male[LengthIndex2], FishProb, FishAge[male[LengthIndex2]] $
      , LoopIndex1)
    length_meanM[10:36, LoopIndex2+LengthIndex1] = AgeAssignM[0, *]
    length_binM[10:36, LoopIndex2+LengthIndex1] = AgeAssignM[1, *]
    ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
    AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[male[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
    FishAge[male[LengthIndex2]] = AgeAssignIndM[0,*]
    FishLength[male[LengthIndex2]] = AgeAssignIndM[1,*]
  ENDIF
  IF Size280to300Mcount GT 0 THEN BEGIN
    LengthIndex1 = 10
    LengthIndex2 = Size280to300M
    FishProb = AgeLengthKey(p_age0M, p_age1M, p_age2M, p_age3M, p_age4M, p_age5M $
      , p_age6M, p_age7M, p_age8M, p_age9M, p_age10M, p_age11M, p_age12M $
      , p_age13M, p_age14M, p_age15M, p_age16M, p_age17M, p_age18M, p_age19M $
      , p_age20M, p_age21M, p_age22M, p_age23M, p_age24M, p_age25M $
      , p_age26M, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthIndex2]] $
      , male[LengthIndex2], FishProb, FishAge[male[LengthIndex2]] $
      , LoopIndex1)
    length_meanM[10:36, LoopIndex2+LengthIndex1] = AgeAssignM[0, *]
    length_binM[10:36, LoopIndex2+LengthIndex1] = AgeAssignM[1, *]
    ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
    AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[male[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
    FishAge[male[LengthIndex2]] = AgeAssignIndM[0,*]
    FishLength[male[LengthIndex2]] = AgeAssignIndM[1,*]
  ENDIF
  IF Size300to320Mcount GT 0 THEN BEGIN
    LengthIndex1 = 11
    LengthIndex2 = Size300to320M
    FishProb = AgeLengthKey(p_age0M, p_age1M, p_age2M, p_age3M, p_age4M, p_age5M $
      , p_age6M, p_age7M, p_age8M, p_age9M, p_age10M, p_age11M, p_age12M $
      , p_age13M, p_age14M, p_age15M, p_age16M, p_age17M, p_age18M, p_age19M $
      , p_age20M, p_age21M, p_age22M, p_age23M, p_age24M, p_age25M $
      , p_age26M, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthIndex2]] $
      , male[LengthIndex2], FishProb, FishAge[male[LengthIndex2]] $
      , LoopIndex1)
    length_meanM[10:36, LoopIndex2+LengthIndex1] = AgeAssignM[0, *]
    length_binM[10:36, LoopIndex2+LengthIndex1] = AgeAssignM[1, *]
    ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
    AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[male[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
    FishAge[male[LengthIndex2]] = AgeAssignIndM[0,*]
    FishLength[male[LengthIndex2]] = AgeAssignIndM[1,*]
  ENDIF
  IF Size320to340Mcount GT 0 THEN BEGIN
    LengthIndex1 = 12
    LengthIndex2 = Size320to340M
    FishProb = AgeLengthKey(p_age0M, p_age1M, p_age2M, p_age3M, p_age4M, p_age5M $
      , p_age6M, p_age7M, p_age8M, p_age9M, p_age10M, p_age11M, p_age12M $
      , p_age13M, p_age14M, p_age15M, p_age16M, p_age17M, p_age18M, p_age19M $
      , p_age20M, p_age21M, p_age22M, p_age23M, p_age24M, p_age25M $
      , p_age26M, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthIndex2]] $
      , male[LengthIndex2], FishProb, FishAge[male[LengthIndex2]] $
      , LoopIndex1)
    length_meanM[10:36, LoopIndex2+LengthIndex1] = AgeAssignM[0, *]
    length_binM[10:36, LoopIndex2+LengthIndex1] = AgeAssignM[1, *]
    ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
    AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[male[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
    FishAge[male[LengthIndex2]] = AgeAssignIndM[0,*]
    FishLength[male[LengthIndex2]] = AgeAssignIndM[1,*]
  ENDIF
  IF Size340to360Mcount GT 0 THEN BEGIN
    LengthIndex1 = 13
    LengthIndex2 = Size340to360M
    FishProb = AgeLengthKey(p_age0M, p_age1M, p_age2M, p_age3M, p_age4M, p_age5M $
      , p_age6M, p_age7M, p_age8M, p_age9M, p_age10M, p_age11M, p_age12M $
      , p_age13M, p_age14M, p_age15M, p_age16M, p_age17M, p_age18M, p_age19M $
      , p_age20M, p_age21M, p_age22M, p_age23M, p_age24M, p_age25M $
      , p_age26M, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthIndex2]] $
      , male[LengthIndex2], FishProb, FishAge[male[LengthIndex2]] $
      , LoopIndex1)
    length_meanM[10:36, LoopIndex2+LengthIndex1] = AgeAssignM[0, *]
    length_binM[10:36, LoopIndex2+LengthIndex1] = AgeAssignM[1, *]
    ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
    AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[male[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
    FishAge[male[LengthIndex2]] = AgeAssignIndM[0,*]
    FishLength[male[LengthIndex2]] = AgeAssignIndM[1,*]
  ENDIF
  IF Size360to380Mcount GT 0 THEN BEGIN
    LengthIndex1 = 14
    LengthIndex2 = Size360to380M
    FishProb = AgeLengthKey(p_age0M, p_age1M, p_age2M, p_age3M, p_age4M, p_age5M $
      , p_age6M, p_age7M, p_age8M, p_age9M, p_age10M, p_age11M, p_age12M $
      , p_age13M, p_age14M, p_age15M, p_age16M, p_age17M, p_age18M, p_age19M $
      , p_age20M, p_age21M, p_age22M, p_age23M, p_age24M, p_age25M $
      , p_age26M, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthIndex2]] $
      , male[LengthIndex2], FishProb, FishAge[male[LengthIndex2]] $
      , LoopIndex1)
    length_meanM[10:36, LoopIndex2+LengthIndex1] = AgeAssignM[0, *]
    length_binM[10:36, LoopIndex2+LengthIndex1] = AgeAssignM[1, *]
    ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
    AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[male[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
    FishAge[male[LengthIndex2]] = AgeAssignIndM[0,*]
    FishLength[male[LengthIndex2]] = AgeAssignIndM[1,*]
  ENDIF
  IF Size380to400Mcount GT 0 THEN BEGIN
    LengthIndex1 = 15
    LengthIndex2 = Size380to400M
    FishProb = AgeLengthKey(p_age0M, p_age1M, p_age2M, p_age3M, p_age4M, p_age5M $
      , p_age6M, p_age7M, p_age8M, p_age9M, p_age10M, p_age11M, p_age12M $
      , p_age13M, p_age14M, p_age15M, p_age16M, p_age17M, p_age18M, p_age19M $
      , p_age20M, p_age21M, p_age22M, p_age23M, p_age24M, p_age25M $
      , p_age26M, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthIndex2]] $
      , male[LengthIndex2], FishProb, FishAge[male[LengthIndex2]] $
      , LoopIndex1)
    length_meanM[10:36, LoopIndex2+LengthIndex1] = AgeAssignM[0, *]
    length_binM[10:36, LoopIndex2+LengthIndex1] = AgeAssignM[1, *]
    ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
    AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[male[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
    FishAge[male[LengthIndex2]] = AgeAssignIndM[0,*]
    FishLength[male[LengthIndex2]] = AgeAssignIndM[1,*]
  ENDIF
  IF Size400to420Mcount GT 0 THEN BEGIN
    LengthIndex1 = 16
    LengthIndex2 = Size400to420M
    FishProb = AgeLengthKey(p_age0M, p_age1M, p_age2M, p_age3M, p_age4M, p_age5M $
      , p_age6M, p_age7M, p_age8M, p_age9M, p_age10M, p_age11M, p_age12M $
      , p_age13M, p_age14M, p_age15M, p_age16M, p_age17M, p_age18M, p_age19M $
      , p_age20M, p_age21M, p_age22M, p_age23M, p_age24M, p_age25M $
      , p_age26M, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthIndex2]] $
      , male[LengthIndex2], FishProb, FishAge[male[LengthIndex2]] $
      , LoopIndex1)
    length_meanM[10:36, LoopIndex2+LengthIndex1] = AgeAssignM[0, *]
    length_binM[10:36, LoopIndex2+LengthIndex1] = AgeAssignM[1, *]
    ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
    AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[male[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
    FishAge[male[LengthIndex2]] = AgeAssignIndM[0,*]
    FishLength[male[LengthIndex2]] = AgeAssignIndM[1,*]
  ENDIF
  IF Size420to440Mcount GT 0 THEN BEGIN
    LengthIndex1 = 17
    LengthIndex2 = Size420to440M
    FishProb = AgeLengthKey(p_age0M, p_age1M, p_age2M, p_age3M, p_age4M, p_age5M $
      , p_age6M, p_age7M, p_age8M, p_age9M, p_age10M, p_age11M, p_age12M $
      , p_age13M, p_age14M, p_age15M, p_age16M, p_age17M, p_age18M, p_age19M $
      , p_age20M, p_age21M, p_age22M, p_age23M, p_age24M, p_age25M $
      , p_age26M, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb

    AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthIndex2]] $
      , male[LengthIndex2], FishProb, FishAge[male[LengthIndex2]] $
      , LoopIndex1)
    length_meanM[10:36, LoopIndex2+LengthIndex1] = AgeAssignM[0, *]
    length_binM[10:36, LoopIndex2+LengthIndex1] = AgeAssignM[1, *]
    ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
    AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[male[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
    FishAge[male[LengthIndex2]] = AgeAssignIndM[0,*]
    FishLength[male[LengthIndex2]] = AgeAssignIndM[1,*]
  ENDIF
  IF Size440to460Mcount GT 0 THEN BEGIN
    LengthIndex1 = 18
    LengthIndex2 = Size440to460M
    FishProb = AgeLengthKey(p_age0M, p_age1M, p_age2M, p_age3M, p_age4M, p_age5M $
      , p_age6M, p_age7M, p_age8M, p_age9M, p_age10M, p_age11M, p_age12M $
      , p_age13M, p_age14M, p_age15M, p_age16M, p_age17M, p_age18M, p_age19M $
      , p_age20M, p_age21M, p_age22M, p_age23M, p_age24M, p_age25M $
      , p_age26M, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthIndex2]] $
      , male[LengthIndex2], FishProb, FishAge[male[LengthIndex2]] $
      , LoopIndex1)
    length_meanM[10:36, LoopIndex2+LengthIndex1] = AgeAssignM[0, *]
    length_binM[10:36, LoopIndex2+LengthIndex1] = AgeAssignM[1, *]
    ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
    AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[male[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
    FishAge[male[LengthIndex2]] = AgeAssignIndM[0,*]
    FishLength[male[LengthIndex2]] = AgeAssignIndM[1,*]
  ENDIF
  IF Size460to480Mcount GT 0 THEN BEGIN
    LengthIndex1 = 19
    LengthIndex2 = Size460to480M
    FishProb = AgeLengthKey(p_age0M, p_age1M, p_age2M, p_age3M, p_age4M, p_age5M $
      , p_age6M, p_age7M, p_age8M, p_age9M, p_age10M, p_age11M, p_age12M $
      , p_age13M, p_age14M, p_age15M, p_age16M, p_age17M, p_age18M, p_age19M $
      , p_age20M, p_age21M, p_age22M, p_age23M, p_age24M, p_age25M $
      , p_age26M, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthIndex2]] $
      , male[LengthIndex2], FishProb, FishAge[male[LengthIndex2]] $
      , LoopIndex1)
    length_meanM[10:36, LoopIndex2+LengthIndex1] = AgeAssignM[0, *]
    length_binM[10:36, LoopIndex2+LengthIndex1] = AgeAssignM[1, *]
    ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
    AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[male[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
    FishAge[male[LengthIndex2]] = AgeAssignIndM[0,*]
    FishLength[male[LengthIndex2]] = AgeAssignIndM[1,*]
  ENDIF
  IF Size480to500Mcount GT 0 THEN BEGIN
    LengthIndex1 = 20
    LengthIndex2 = Size480to500M
    FishProb = AgeLengthKey(p_age0M, p_age1M, p_age2M, p_age3M, p_age4M, p_age5M $
      , p_age6M, p_age7M, p_age8M, p_age9M, p_age10M, p_age11M, p_age12M $
      , p_age13M, p_age14M, p_age15M, p_age16M, p_age17M, p_age18M, p_age19M $
      , p_age20M, p_age21M, p_age22M, p_age23M, p_age24M, p_age25M $
      , p_age26M, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthIndex2]] $
      , male[LengthIndex2], FishProb, FishAge[male[LengthIndex2]] $
      , LoopIndex1)
    length_meanM[10:36, LoopIndex2+LengthIndex1] = AgeAssignM[0, *]
    length_binM[10:36, LoopIndex2+LengthIndex1] = AgeAssignM[1, *]
    ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
    AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[male[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
    FishAge[male[LengthIndex2]] = AgeAssignIndM[0,*]
    FishLength[male[LengthIndex2]] = AgeAssignIndM[1,*]
  ENDIF
  IF Size500to520Mcount GT 0 THEN BEGIN
    LengthIndex1 = 21
    LengthIndex2 = Size500to520M
    FishProb = AgeLengthKey(p_age0M, p_age1M, p_age2M, p_age3M, p_age4M, p_age5M $
      , p_age6M, p_age7M, p_age8M, p_age9M, p_age10M, p_age11M, p_age12M $
      , p_age13M, p_age14M, p_age15M, p_age16M, p_age17M, p_age18M, p_age19M $
      , p_age20M, p_age21M, p_age22M, p_age23M, p_age24M, p_age25M $
      , p_age26M, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthIndex2]] $
      , male[LengthIndex2], FishProb, FishAge[male[LengthIndex2]] $
      , LoopIndex1)
    length_meanM[10:36, LoopIndex2+LengthIndex1] = AgeAssignM[0, *]
    length_binM[10:36, LoopIndex2+LengthIndex1] = AgeAssignM[1, *]
    ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
    AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[male[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
    FishAge[male[LengthIndex2]] = AgeAssignIndM[0,*]
    FishLength[male[LengthIndex2]] = AgeAssignIndM[1,*]
  ENDIF
  IF Size520to540Mcount GT 0 THEN BEGIN
    LengthIndex1 = 22
    LengthIndex2 = Size520to540M
    FishProb = AgeLengthKey(p_age0M, p_age1M, p_age2M, p_age3M, p_age4M, p_age5M $
      , p_age6M, p_age7M, p_age8M, p_age9M, p_age10M, p_age11M, p_age12M $
      , p_age13M, p_age14M, p_age15M, p_age16M, p_age17M, p_age18M, p_age19M $
      , p_age20M, p_age21M, p_age22M, p_age23M, p_age24M, p_age25M $
      , p_age26M, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthIndex2]] $
      , male[LengthIndex2], FishProb, FishAge[male[LengthIndex2]] $
      , LoopIndex1)
    length_meanM[10:36, LoopIndex2+LengthIndex1] = AgeAssignM[0, *]
    length_binM[10:36, LoopIndex2+LengthIndex1] = AgeAssignM[1, *]
    ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
    AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[male[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
    FishAge[male[LengthIndex2]] = AgeAssignIndM[0,*]
    FishLength[male[LengthIndex2]] = AgeAssignIndM[1,*]
  ENDIF
  IF Size540to560Mcount GT 0 THEN BEGIN
    LengthIndex1 = 23
    LengthIndex2 = Size540to560M
    FishProb = AgeLengthKey(p_age0M, p_age1M, p_age2M, p_age3M, p_age4M, p_age5M $
      , p_age6M, p_age7M, p_age8M, p_age9M, p_age10M, p_age11M, p_age12M $
      , p_age13M, p_age14M, p_age15M, p_age16M, p_age17M, p_age18M, p_age19M $
      , p_age20M, p_age21M, p_age22M, p_age23M, p_age24M, p_age25M $
      , p_age26M, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthIndex2]] $
      , male[LengthIndex2], FishProb, FishAge[male[LengthIndex2]] $
      , LoopIndex1)
    length_meanM[10:36, LoopIndex2+LengthIndex1] = AgeAssignM[0, *]
    length_binM[10:36, LoopIndex2+LengthIndex1] = AgeAssignM[1, *]
    ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
    AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[male[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
    FishAge[male[LengthIndex2]] = AgeAssignIndM[0,*]
    FishLength[male[LengthIndex2]] = AgeAssignIndM[1,*]
  ENDIF
  IF Size560to580Mcount GT 0 THEN BEGIN
    LengthIndex1 = 24
    LengthIndex2 = Size560to580M
    FishProb = AgeLengthKey(p_age0M, p_age1M, p_age2M, p_age3M, p_age4M, p_age5M $
      , p_age6M, p_age7M, p_age8M, p_age9M, p_age10M, p_age11M, p_age12M $
      , p_age13M, p_age14M, p_age15M, p_age16M, p_age17M, p_age18M, p_age19M $
      , p_age20M, p_age21M, p_age22M, p_age23M, p_age24M, p_age25M $
      , p_age26M, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthIndex2]] $
      , male[LengthIndex2], FishProb, FishAge[male[LengthIndex2]] $
      , LoopIndex1)
    length_meanM[10:36, LoopIndex2+LengthIndex1] = AgeAssignM[0, *]
    length_binM[10:36, LoopIndex2+LengthIndex1] = AgeAssignM[1, *]
    ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
    AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[male[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
    FishAge[male[LengthIndex2]] = AgeAssignIndM[0,*]
    FishLength[male[LengthIndex2]] = AgeAssignIndM[1,*]
  ENDIF
  IF Size580to600Mcount GT 0 THEN BEGIN
    LengthIndex1 = 25
    LengthIndex2 = Size580to600M
    FishProb = AgeLengthKey(p_age0M, p_age1M, p_age2M, p_age3M, p_age4M, p_age5M $
      , p_age6M, p_age7M, p_age8M, p_age9M, p_age10M, p_age11M, p_age12M $
      , p_age13M, p_age14M, p_age15M, p_age16M, p_age17M, p_age18M, p_age19M $
      , p_age20M, p_age21M, p_age22M, p_age23M, p_age24M, p_age25M $
      , p_age26M, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthIndex2]] $
      , male[LengthIndex2], FishProb, FishAge[male[LengthIndex2]] $
      , LoopIndex1)
    length_meanM[10:36, LoopIndex2+LengthIndex1] = AgeAssignM[0, *]
    length_binM[10:36, LoopIndex2+LengthIndex1] = AgeAssignM[1, *]
    ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
    AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[male[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
    FishAge[male[LengthIndex2]] = AgeAssignIndM[0,*]
    FishLength[male[LengthIndex2]] = AgeAssignIndM[1,*]
  ENDIF
  IF Size600to620Mcount GT 0 THEN BEGIN
    LengthIndex1 = 26
    LengthIndex2 = Size600to620M
    FishProb = AgeLengthKey(p_age0M, p_age1M, p_age2M, p_age3M, p_age4M, p_age5M $
      , p_age6M, p_age7M, p_age8M, p_age9M, p_age10M, p_age11M, p_age12M $
      , p_age13M, p_age14M, p_age15M, p_age16M, p_age17M, p_age18M, p_age19M $
      , p_age20M, p_age21M, p_age22M, p_age23M, p_age24M, p_age25M $
      , p_age26M, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthIndex2]] $
      , male[LengthIndex2], FishProb, FishAge[male[LengthIndex2]] $
      , LoopIndex1)
    length_meanM[10:36, LoopIndex2+LengthIndex1] = AgeAssignM[0, *]
    length_binM[10:36, LoopIndex2+LengthIndex1] = AgeAssignM[1, *]
    ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
    AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[male[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
    FishAge[male[LengthIndex2]] = AgeAssignIndM[0,*]
    FishLength[male[LengthIndex2]] = AgeAssignIndM[1,*]
  ENDIF
  IF Size620to640Mcount GT 0 THEN BEGIN
    LengthIndex1 = 27
    LengthIndex2 = Size620to640M
    FishProb = AgeLengthKey(p_age0M, p_age1M, p_age2M, p_age3M, p_age4M, p_age5M $
      , p_age6M, p_age7M, p_age8M, p_age9M, p_age10M, p_age11M, p_age12M $
      , p_age13M, p_age14M, p_age15M, p_age16M, p_age17M, p_age18M, p_age19M $
      , p_age20M, p_age21M, p_age22M, p_age23M, p_age24M, p_age25M $
      , p_age26M, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthIndex2]] $
      , male[LengthIndex2], FishProb, FishAge[male[LengthIndex2]] $
      , LoopIndex1)
    length_meanM[10:36, LoopIndex2+LengthIndex1] = AgeAssignM[0, *]
    length_binM[10:36, LoopIndex2+LengthIndex1] = AgeAssignM[1, *]
    ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
    AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[male[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
    FishAge[male[LengthIndex2]] = AgeAssignIndM[0,*]
    FishLength[male[LengthIndex2]] = AgeAssignIndM[1,*]
  ENDIF
  IF Size640to660Mcount GT 0 THEN BEGIN
    LengthIndex1 = 28
    LengthIndex2 = Size640to660M
    FishProb = AgeLengthKey(p_age0M, p_age1M, p_age2M, p_age3M, p_age4M, p_age5M $
      , p_age6M, p_age7M, p_age8M, p_age9M, p_age10M, p_age11M, p_age12M $
      , p_age13M, p_age14M, p_age15M, p_age16M, p_age17M, p_age18M, p_age19M $
      , p_age20M, p_age21M, p_age22M, p_age23M, p_age24M, p_age25M $
      , p_age26M, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthIndex2]] $
      , male[LengthIndex2], FishProb, FishAge[male[LengthIndex2]] $
      , LoopIndex1)
    length_meanM[10:36, LoopIndex2+LengthIndex1] = AgeAssignM[0, *]
    length_binM[10:36, LoopIndex2+LengthIndex1] = AgeAssignM[1, *]
    ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
    AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[male[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
    FishAge[male[LengthIndex2]] = AgeAssignIndM[0,*]
    FishLength[male[LengthIndex2]] = AgeAssignIndM[1,*]
  ENDIF
  IF Size660to680Mcount GT 0 THEN BEGIN
    LengthIndex1 = 29
    LengthIndex2 = Size660to680M
    FishProb = AgeLengthKey(p_age0M, p_age1M, p_age2M, p_age3M, p_age4M, p_age5M $
      , p_age6M, p_age7M, p_age8M, p_age9M, p_age10M, p_age11M, p_age12M $
      , p_age13M, p_age14M, p_age15M, p_age16M, p_age17M, p_age18M, p_age19M $
      , p_age20M, p_age21M, p_age22M, p_age23M, p_age24M, p_age25M $
      , p_age26M, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthIndex2]] $
      , male[LengthIndex2], FishProb, FishAge[male[LengthIndex2]] $
      , LoopIndex1)
    length_meanM[10:36, LoopIndex2+LengthIndex1] = AgeAssignM[0, *]
    length_binM[10:36, LoopIndex2+LengthIndex1] = AgeAssignM[1, *]
    ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
    AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[male[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
    FishAge[male[LengthIndex2]] = AgeAssignIndM[0,*]
    FishLength[male[LengthIndex2]] = AgeAssignIndM[1,*]
  ENDIF
  IF Size680to700Mcount GT 0 THEN BEGIN
    LengthIndex1 = 30
    LengthIndex2 = Size680to700M
    FishProb = AgeLengthKey(p_age0M, p_age1M, p_age2M, p_age3M, p_age4M, p_age5M $
      , p_age6M, p_age7M, p_age8M, p_age9M, p_age10M, p_age11M, p_age12M $
      , p_age13M, p_age14M, p_age15M, p_age16M, p_age17M, p_age18M, p_age19M $
      , p_age20M, p_age21M, p_age22M, p_age23M, p_age24M, p_age25M $
      , p_age26M, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthIndex2]] $
      , male[LengthIndex2], FishProb, FishAge[male[LengthIndex2]] $
      , LoopIndex1)
    length_meanM[10:36, LoopIndex2+LengthIndex1] = AgeAssignM[0, *]
    length_binM[10:36, LoopIndex2+LengthIndex1] = AgeAssignM[1, *]
    ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
    AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[male[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
    FishAge[male[LengthIndex2]] = AgeAssignIndM[0,*]
    FishLength[male[LengthIndex2]] = AgeAssignIndM[1,*]
  ENDIF
  IF Size700to720Mcount GT 0 THEN BEGIN
    LengthIndex1 = 31
    LengthIndex2 = Size700to720M
    FishProb = AgeLengthKey(p_age0M, p_age1M, p_age2M, p_age3M, p_age4M, p_age5M $
      , p_age6M, p_age7M, p_age8M, p_age9M, p_age10M, p_age11M, p_age12M $
      , p_age13M, p_age14M, p_age15M, p_age16M, p_age17M, p_age18M, p_age19M $
      , p_age20M, p_age21M, p_age22M, p_age23M, p_age24M, p_age25M $
      , p_age26M, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthIndex2]] $
      , male[LengthIndex2], FishProb, FishAge[male[LengthIndex2]] $
      , LoopIndex1)
    length_meanM[10:36, LoopIndex2+LengthIndex1] = AgeAssignM[0, *]
    length_binM[10:36, LoopIndex2+LengthIndex1] = AgeAssignM[1, *]
    ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
    AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[male[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
    FishAge[male[LengthIndex2]] = AgeAssignIndM[0,*]
    FishLength[male[LengthIndex2]] = AgeAssignIndM[1,*]
  ENDIF
  IF Size720to740Mcount GT 0 THEN BEGIN
    LengthIndex1 = 32
    LengthIndex2 = Size720to740M
    FishProb = AgeLengthKey(p_age0M, p_age1M, p_age2M, p_age3M, p_age4M, p_age5M $
      , p_age6M, p_age7M, p_age8M, p_age9M, p_age10M, p_age11M, p_age12M $
      , p_age13M, p_age14M, p_age15M, p_age16M, p_age17M, p_age18M, p_age19M $
      , p_age20M, p_age21M, p_age22M, p_age23M, p_age24M, p_age25M $
      , p_age26M, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthIndex2]] $
      , male[LengthIndex2], FishProb, FishAge[male[LengthIndex2]] $
      , LoopIndex1)
    length_meanM[10:36, LoopIndex2+LengthIndex1] = AgeAssignM[0, *]
    length_binM[10:36, LoopIndex2+LengthIndex1] = AgeAssignM[1, *]
    ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
    AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[male[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
    FishAge[male[LengthIndex2]] = AgeAssignIndM[0,*]
    FishLength[male[LengthIndex2]] = AgeAssignIndM[1,*]
  ENDIF
  IF Size740to760Mcount GT 0 THEN BEGIN
    LengthIndex1 = 33
    LengthIndex2 = Size740to760M
    FishProb = AgeLengthKey(p_age0M, p_age1M, p_age2M, p_age3M, p_age4M, p_age5M $
      , p_age6M, p_age7M, p_age8M, p_age9M, p_age10M, p_age11M, p_age12M $
      , p_age13M, p_age14M, p_age15M, p_age16M, p_age17M, p_age18M, p_age19M $
      , p_age20M, p_age21M, p_age22M, p_age23M, p_age24M, p_age25M $
      , p_age26M, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthIndex2]] $
      , male[LengthIndex2], FishProb, FishAge[male[LengthIndex2]] $
      , LoopIndex1)
    length_meanM[10:36, LoopIndex2+LengthIndex1] = AgeAssignM[0, *]
    length_binM[10:36, LoopIndex2+LengthIndex1] = AgeAssignM[1, *]
    ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
    AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[male[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
    FishAge[male[LengthIndex2]] = AgeAssignIndM[0,*]
    FishLength[male[LengthIndex2]] = AgeAssignIndM[1,*]
  ENDIF
  IF Size760to780Mcount GT 0 THEN BEGIN
    LengthIndex1 = 34
    LengthIndex2 = Size760to780M
    FishProb = AgeLengthKey(p_age0M, p_age1M, p_age2M, p_age3M, p_age4M, p_age5M $
      , p_age6M, p_age7M, p_age8M, p_age9M, p_age10M, p_age11M, p_age12M $
      , p_age13M, p_age14M, p_age15M, p_age16M, p_age17M, p_age18M, p_age19M $
      , p_age20M, p_age21M, p_age22M, p_age23M, p_age24M, p_age25M $
      , p_age26M, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthIndex2]] $
      , male[LengthIndex2], FishProb, FishAge[male[LengthIndex2]] $
      , LoopIndex1)
    length_meanM[10:36, LoopIndex2+LengthIndex1] = AgeAssignM[0, *]
    length_binM[10:36, LoopIndex2+LengthIndex1] = AgeAssignM[1, *]
    ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
    AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[male[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
    FishAge[male[LengthIndex2]] = AgeAssignIndM[0,*]
    FishLength[male[LengthIndex2]] = AgeAssignIndM[1,*]
  ENDIF
  IF Size780to800Mcount GT 0 THEN BEGIN
    LengthIndex1 = 35
    LengthIndex2 = Size780to800M
    FishProb = AgeLengthKey(p_age0M, p_age1M, p_age2M, p_age3M, p_age4M, p_age5M $
      , p_age6M, p_age7M, p_age8M, p_age9M, p_age10M, p_age11M, p_age12M $
      , p_age13M, p_age14M, p_age15M, p_age16M, p_age17M, p_age18M, p_age19M $
      , p_age20M, p_age21M, p_age22M, p_age23M, p_age24M, p_age25M $
      , p_age26M, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthIndex2]] $
      , male[LengthIndex2], FishProb, FishAge[male[LengthIndex2]] $
      , LoopIndex1)
    length_meanM[10:36, LoopIndex2+LengthIndex1] = AgeAssignM[0, *]
    length_binM[10:36, LoopIndex2+LengthIndex1] = AgeAssignM[1, *]
    ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
    AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[male[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
    FishAge[male[LengthIndex2]] = AgeAssignIndM[0,*]
    FishLength[male[LengthIndex2]] = AgeAssignIndM[1,*]
  ENDIF
  IF Sizege800Mcount GT 0 THEN BEGIN
    LengthIndex1 = 36
    LengthIndex2 = SizeGE800M
    FishProb = AgeLengthKey(p_age0M, p_age1M, p_age2M, p_age3M, p_age4M, p_age5M $
      , p_age6M, p_age7M, p_age8M, p_age9M, p_age10M, p_age11M, p_age12M $
      , p_age13M, p_age14M, p_age15M, p_age16M, p_age17M, p_age18M, p_age19M $
      , p_age20M, p_age21M, p_age22M, p_age23M, p_age24M, p_age25M $
      , p_age26M, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthIndex2]] $
      , male[LengthIndex2], FishProb, FishAge[male[LengthIndex2]] $
      , LoopIndex1)
    length_meanM[10:36, LoopIndex2+LengthIndex1] = AgeAssignM[0, *]
    length_binM[10:36, LoopIndex2+LengthIndex1] = AgeAssignM[1, *]
    ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
    AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[male[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
    FishAge[male[LengthIndex2]] = AgeAssignIndM[0,*]
    FishLength[male[LengthIndex2]] = AgeAssignIndM[1,*]
  ENDIF

  ; 1.Assign age semi-randomly to lengths - FEMALES
  IF SizeLT100Fcount GT 0 THEN BEGIN
    LengthIndex1 = 0
    LengthIndex2 = SizeLT100F
    FishProb = AgeLengthKey(p_age0F, p_age1F, p_age2F, p_age3F, p_age4F, p_age5F $
      , p_age6F, p_age7F, p_age8F, p_age9F, p_age10F, p_age11F, p_age12F $
      , p_age13F, p_age14F, p_age15F, p_age16F, p_age17F, p_age18F, p_age19F $
      , p_age20F, p_age21F, p_age22F, p_age23F, p_age24F, p_age25F $
      , p_age26F, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthIndex2]] $
      , female[LengthIndex2], FishProb, FishAge[female[LengthIndex2]] $
      , LoopIndex1)
    length_meanF[10:36, LoopIndex2+LengthIndex1] = AgeAssignF[0, *]
    length_binF[10:36, LoopIndex2+LengthIndex1] = AgeAssignF[1, *]
    ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
    AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[female[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
    FishAge[female[LengthIndex2]] = AgeAssignIndF[0,*]
    FishLength[female[LengthIndex2]] = AgeAssignIndF[1,*]
  ENDIF
  IF Size100to120Fcount GT 0 THEN BEGIN
    LengthIndex1 = 1
    LengthIndex2 = Size100to120F
    FishProb = AgeLengthKey(p_age0F, p_age1F, p_age2F, p_age3F, p_age4F, p_age5F $
      , p_age6F, p_age7F, p_age8F, p_age9F, p_age10F, p_age11F, p_age12F $
      , p_age13F, p_age14F, p_age15F, p_age16F, p_age17F, p_age18F, p_age19F $
      , p_age20F, p_age21F, p_age22F, p_age23F, p_age24F, p_age25F $
      , p_age26F, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthIndex2]] $
      , female[LengthIndex2], FishProb, FishAge[female[LengthIndex2]] $
      , LoopIndex1)
    length_meanF[10:36, LoopIndex2+LengthIndex1] = AgeAssignF[0, *]
    length_binF[10:36, LoopIndex2+LengthIndex1] = AgeAssignF[1, *]
    ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
    AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[female[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
    FishAge[female[LengthIndex2]] = AgeAssignIndF[0,*]
    FishLength[female[LengthIndex2]] = AgeAssignIndF[1,*]
  ENDIF
  IF Size120to140Fcount GT 0 THEN BEGIN
    LengthIndex1 = 2
    LengthIndex2 = Size120to140F
    FishProb = AgeLengthKey(p_age0F, p_age1F, p_age2F, p_age3F, p_age4F, p_age5F $
      , p_age6F, p_age7F, p_age8F, p_age9F, p_age10F, p_age11F, p_age12F $
      , p_age13F, p_age14F, p_age15F, p_age16F, p_age17F, p_age18F, p_age19F $
      , p_age20F, p_age21F, p_age22F, p_age23F, p_age24F, p_age25F $
      , p_age26F, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthIndex2]] $
      , female[LengthIndex2], FishProb, FishAge[female[LengthIndex2]] $
      , LoopIndex1)
    length_meanF[10:36, LoopIndex2+LengthIndex1] = AgeAssignF[0, *]
    length_binF[10:36, LoopIndex2+LengthIndex1] = AgeAssignF[1, *]
    ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
    AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[female[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
    FishAge[female[LengthIndex2]] = AgeAssignIndF[0,*]
    FishLength[female[LengthIndex2]] = AgeAssignIndF[1,*]
  ENDIF
  IF Size140to160Fcount GT 0 THEN BEGIN
    LengthIndex1 = 3
    LengthIndex2 = Size140to160F
    FishProb = AgeLengthKey(p_age0F, p_age1F, p_age2F, p_age3F, p_age4F, p_age5F $
      , p_age6F, p_age7F, p_age8F, p_age9F, p_age10F, p_age11F, p_age12F $
      , p_age13F, p_age14F, p_age15F, p_age16F, p_age17F, p_age18F, p_age19F $
      , p_age20F, p_age21F, p_age22F, p_age23F, p_age24F, p_age25F $
      , p_age26F, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthIndex2]] $
      , female[LengthIndex2], FishProb, FishAge[female[LengthIndex2]] $
      , LoopIndex1)
    length_meanF[10:36, LoopIndex2+LengthIndex1] = AgeAssignF[0, *]
    length_binF[10:36, LoopIndex2+LengthIndex1] = AgeAssignF[1, *]
    ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
    AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[female[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
    FishAge[female[LengthIndex2]] = AgeAssignIndF[0,*]
    FishLength[female[LengthIndex2]] = AgeAssignIndF[1,*]
  ENDIF
  IF Size160to180Fcount GT 0 THEN BEGIN
    LengthIndex1 = 4
    LengthIndex2 = Size160to180F
    FishProb = AgeLengthKey(p_age0F, p_age1F, p_age2F, p_age3F, p_age4F, p_age5F $
      , p_age6F, p_age7F, p_age8F, p_age9F, p_age10F, p_age11F, p_age12F $
      , p_age13F, p_age14F, p_age15F, p_age16F, p_age17F, p_age18F, p_age19F $
      , p_age20F, p_age21F, p_age22F, p_age23F, p_age24F, p_age25F $
      , p_age26F, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthIndex2]] $
      , female[LengthIndex2], FishProb, FishAge[female[LengthIndex2]] $
      , LoopIndex1)
    length_meanF[10:36, LoopIndex2+LengthIndex1] = AgeAssignF[0, *]
    length_binF[10:36, LoopIndex2+LengthIndex1] = AgeAssignF[1, *]
    ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
    AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[female[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
    FishAge[female[LengthIndex2]] = AgeAssignIndF[0,*]
    FishLength[female[LengthIndex2]] = AgeAssignIndF[1,*]
  ENDIF
  IF Size180to200Fcount GT 0 THEN BEGIN
    LengthIndex1 = 5
    LengthIndex2 = Size180to200F
    FishProb = AgeLengthKey(p_age0F, p_age1F, p_age2F, p_age3F, p_age4F, p_age5F $
      , p_age6F, p_age7F, p_age8F, p_age9F, p_age10F, p_age11F, p_age12F $
      , p_age13F, p_age14F, p_age15F, p_age16F, p_age17F, p_age18F, p_age19F $
      , p_age20F, p_age21F, p_age22F, p_age23F, p_age24F, p_age25F $
      , p_age26F, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthIndex2]] $
      , female[LengthIndex2], FishProb, FishAge[female[LengthIndex2]] $
      , LoopIndex1)
    length_meanF[10:36, LoopIndex2+LengthIndex1] = AgeAssignF[0, *]
    length_binF[10:36, LoopIndex2+LengthIndex1] = AgeAssignF[1, *]
    ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
    AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[female[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
    FishAge[female[LengthIndex2]] = AgeAssignIndF[0,*]
    FishLength[female[LengthIndex2]] = AgeAssignIndF[1,*]
  ENDIF
  IF Size200to220Fcount GT 0 THEN BEGIN
    LengthIndex1 = 6
    LengthIndex2 = Size200to220F
    FishProb = AgeLengthKey(p_age0F, p_age1F, p_age2F, p_age3F, p_age4F, p_age5F $
      , p_age6F, p_age7F, p_age8F, p_age9F, p_age10F, p_age11F, p_age12F $
      , p_age13F, p_age14F, p_age15F, p_age16F, p_age17F, p_age18F, p_age19F $
      , p_age20F, p_age21F, p_age22F, p_age23F, p_age24F, p_age25F $
      , p_age26F, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthIndex2]] $
      , female[LengthIndex2], FishProb, FishAge[female[LengthIndex2]] $
      , LoopIndex1)
    length_meanF[10:36, LoopIndex2+LengthIndex1] = AgeAssignF[0, *]
    length_binF[10:36, LoopIndex2+LengthIndex1] = AgeAssignF[1, *]
    ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
    AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[female[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
    FishAge[female[LengthIndex2]] = AgeAssignIndF[0,*]
    FishLength[female[LengthIndex2]] = AgeAssignIndF[1,*]
  ENDIF
  IF Size220to240Fcount GT 0 THEN BEGIN
    LengthIndex1 = 7
    LengthIndex2 = Size220to240F
    FishProb = AgeLengthKey(p_age0F, p_age1F, p_age2F, p_age3F, p_age4F, p_age5F $
      , p_age6F, p_age7F, p_age8F, p_age9F, p_age10F, p_age11F, p_age12F $
      , p_age13F, p_age14F, p_age15F, p_age16F, p_age17F, p_age18F, p_age19F $
      , p_age20F, p_age21F, p_age22F, p_age23F, p_age24F, p_age25F $
      , p_age26F, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthIndex2]] $
      , female[LengthIndex2], FishProb, FishAge[female[LengthIndex2]] $
      , LoopIndex1)
    length_meanF[10:36, LoopIndex2+LengthIndex1] = AgeAssignF[0, *]
    length_binF[10:36, LoopIndex2+LengthIndex1] = AgeAssignF[1, *]
    ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
    AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[female[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
    FishAge[female[LengthIndex2]] = AgeAssignIndF[0,*]
    FishLength[female[LengthIndex2]] = AgeAssignIndF[1,*]
  ENDIF
  IF Size240to260Fcount GT 0 THEN BEGIN
    LengthIndex1 = 8
    LengthIndex2 = Size240to260F
    FishProb = AgeLengthKey(p_age0F, p_age1F, p_age2F, p_age3F, p_age4F, p_age5F $
      , p_age6F, p_age7F, p_age8F, p_age9F, p_age10F, p_age11F, p_age12F $
      , p_age13F, p_age14F, p_age15F, p_age16F, p_age17F, p_age18F, p_age19F $
      , p_age20F, p_age21F, p_age22F, p_age23F, p_age24F, p_age25F $
      , p_age26F, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthIndex2]] $
      , female[LengthIndex2], FishProb, FishAge[female[LengthIndex2]] $
      , LoopIndex1)
    length_meanF[10:36, LoopIndex2+LengthIndex1] = AgeAssignF[0, *]
    length_binF[10:36, LoopIndex2+LengthIndex1] = AgeAssignF[1, *]
    ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
    AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[female[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
    FishAge[female[LengthIndex2]] = AgeAssignIndF[0,*]
    FishLength[female[LengthIndex2]] = AgeAssignIndF[1,*]
  ENDIF
  IF Size260to280Fcount GT 0 THEN BEGIN
    LengthIndex1 = 9
    LengthIndex2 = Size260to280F
    FishProb = AgeLengthKey(p_age0F, p_age1F, p_age2F, p_age3F, p_age4F, p_age5F $
      , p_age6F, p_age7F, p_age8F, p_age9F, p_age10F, p_age11F, p_age12F $
      , p_age13F, p_age14F, p_age15F, p_age16F, p_age17F, p_age18F, p_age19F $
      , p_age20F, p_age21F, p_age22F, p_age23F, p_age24F, p_age25F $
      , p_age26F, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthIndex2]] $
      , female[LengthIndex2], FishProb, FishAge[female[LengthIndex2]] $
      , LoopIndex1)
    length_meanF[10:36, LoopIndex2+LengthIndex1] = AgeAssignF[0, *]
    length_binF[10:36, LoopIndex2+LengthIndex1] = AgeAssignF[1, *]
    ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
    AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[female[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
    FishAge[female[LengthIndex2]] = AgeAssignIndF[0,*]
    FishLength[female[LengthIndex2]] = AgeAssignIndF[1,*]
  ENDIF
  IF Size280to300Fcount GT 0 THEN BEGIN
    LengthIndex1 = 10
    LengthIndex2 = Size280to300F
    FishProb = AgeLengthKey(p_age0F, p_age1F, p_age2F, p_age3F, p_age4F, p_age5F $
      , p_age6F, p_age7F, p_age8F, p_age9F, p_age10F, p_age11F, p_age12F $
      , p_age13F, p_age14F, p_age15F, p_age16F, p_age17F, p_age18F, p_age19F $
      , p_age20F, p_age21F, p_age22F, p_age23F, p_age24F, p_age25F $
      , p_age26F, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthIndex2]] $
      , female[LengthIndex2], FishProb, FishAge[female[LengthIndex2]] $
      , LoopIndex1)
    length_meanF[10:36, LoopIndex2+LengthIndex1] = AgeAssignF[0, *]
    length_binF[10:36, LoopIndex2+LengthIndex1] = AgeAssignF[1, *]
    ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
    AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[female[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
    FishAge[female[LengthIndex2]] = AgeAssignIndF[0,*]
    FishLength[female[LengthIndex2]] = AgeAssignIndF[1,*]
  ENDIF
  IF Size300to320Fcount GT 0 THEN BEGIN
    LengthIndex1 = 11
    LengthIndex2 = Size300to320F
    FishProb = AgeLengthKey(p_age0F, p_age1F, p_age2F, p_age3F, p_age4F, p_age5F $
      , p_age6F, p_age7F, p_age8F, p_age9F, p_age10F, p_age11F, p_age12F $
      , p_age13F, p_age14F, p_age15F, p_age16F, p_age17F, p_age18F, p_age19F $
      , p_age20F, p_age21F, p_age22F, p_age23F, p_age24F, p_age25F $
      , p_age26F, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthIndex2]] $
      , female[LengthIndex2], FishProb, FishAge[female[LengthIndex2]] $
      , LoopIndex1)
    length_meanF[10:36, LoopIndex2+LengthIndex1] = AgeAssignF[0, *]
    length_binF[10:36, LoopIndex2+LengthIndex1] = AgeAssignF[1, *]
    ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
    AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[female[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
    FishAge[female[LengthIndex2]] = AgeAssignIndF[0,*]
    FishLength[female[LengthIndex2]] = AgeAssignIndF[1,*]
  ENDIF
  IF Size320to340Fcount GT 0 THEN BEGIN
    LengthIndex1 = 12
    LengthIndex2 = Size320to340F
    FishProb = AgeLengthKey(p_age0F, p_age1F, p_age2F, p_age3F, p_age4F, p_age5F $
      , p_age6F, p_age7F, p_age8F, p_age9F, p_age10F, p_age11F, p_age12F $
      , p_age13F, p_age14F, p_age15F, p_age16F, p_age17F, p_age18F, p_age19F $
      , p_age20F, p_age21F, p_age22F, p_age23F, p_age24F, p_age25F $
      , p_age26F, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthIndex2]] $
      , female[LengthIndex2], FishProb, FishAge[female[LengthIndex2]] $
      , LoopIndex1)
    length_meanF[10:36, LoopIndex2+LengthIndex1] = AgeAssignF[0, *]
    length_binF[10:36, LoopIndex2+LengthIndex1] = AgeAssignF[1, *]
    ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
    AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[female[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
    FishAge[female[LengthIndex2]] = AgeAssignIndF[0,*]
    FishLength[female[LengthIndex2]] = AgeAssignIndF[1,*]
  ENDIF
  IF Size340to360Fcount GT 0 THEN BEGIN
    LengthIndex1 = 13
    LengthIndex2 = Size340to360F
    FishProb = AgeLengthKey(p_age0F, p_age1F, p_age2F, p_age3F, p_age4F, p_age5F $
      , p_age6F, p_age7F, p_age8F, p_age9F, p_age10F, p_age11F, p_age12F $
      , p_age13F, p_age14F, p_age15F, p_age16F, p_age17F, p_age18F, p_age19F $
      , p_age20F, p_age21F, p_age22F, p_age23F, p_age24F, p_age25F $
      , p_age26F, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthIndex2]] $
      , female[LengthIndex2], FishProb, FishAge[female[LengthIndex2]] $
      , LoopIndex1)
    length_meanF[10:36, LoopIndex2+LengthIndex1] = AgeAssignF[0, *]
    length_binF[10:36, LoopIndex2+LengthIndex1] = AgeAssignF[1, *]
    ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
    AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[female[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
    FishAge[female[LengthIndex2]] = AgeAssignIndF[0,*]
    FishLength[female[LengthIndex2]] = AgeAssignIndF[1,*]
  ENDIF
  IF Size360to380Fcount GT 0 THEN BEGIN
    LengthIndex1 = 14
    LengthIndex2 = Size360to380F
    FishProb = AgeLengthKey(p_age0F, p_age1F, p_age2F, p_age3F, p_age4F, p_age5F $
      , p_age6F, p_age7F, p_age8F, p_age9F, p_age10F, p_age11F, p_age12F $
      , p_age13F, p_age14F, p_age15F, p_age16F, p_age17F, p_age18F, p_age19F $
      , p_age20F, p_age21F, p_age22F, p_age23F, p_age24F, p_age25F $
      , p_age26F, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthIndex2]] $
      , female[LengthIndex2], FishProb, FishAge[female[LengthIndex2]] $
      , LoopIndex1)
    length_meanF[10:36, LoopIndex2+LengthIndex1] = AgeAssignF[0, *]
    length_binF[10:36, LoopIndex2+LengthIndex1] = AgeAssignF[1, *]
    ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
    AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[female[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
    FishAge[female[LengthIndex2]] = AgeAssignIndF[0,*]
    FishLength[female[LengthIndex2]] = AgeAssignIndF[1,*]
  ENDIF
  IF Size380to400Fcount GT 0 THEN BEGIN
    LengthIndex1 = 15
    LengthIndex2 = Size380to400F
    FishProb = AgeLengthKey(p_age0F, p_age1F, p_age2F, p_age3F, p_age4F, p_age5F $
      , p_age6F, p_age7F, p_age8F, p_age9F, p_age10F, p_age11F, p_age12F $
      , p_age13F, p_age14F, p_age15F, p_age16F, p_age17F, p_age18F, p_age19F $
      , p_age20F, p_age21F, p_age22F, p_age23F, p_age24F, p_age25F $
      , p_age26F, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthIndex2]] $
      , female[LengthIndex2], FishProb, FishAge[female[LengthIndex2]] $
      , LoopIndex1)
    length_meanF[10:36, LoopIndex2+LengthIndex1] = AgeAssignF[0, *]
    length_binF[10:36, LoopIndex2+LengthIndex1] = AgeAssignF[1, *]
    ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
    AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[female[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
    FishAge[female[LengthIndex2]] = AgeAssignIndF[0,*]
    FishLength[female[LengthIndex2]] = AgeAssignIndF[1,*]
  ENDIF
  IF Size400to420Fcount GT 0 THEN BEGIN
    LengthIndex1 = 16
    LengthIndex2 = Size400to420F
    FishProb = AgeLengthKey(p_age0F, p_age1F, p_age2F, p_age3F, p_age4F, p_age5F $
      , p_age6F, p_age7F, p_age8F, p_age9F, p_age10F, p_age11F, p_age12F $
      , p_age13F, p_age14F, p_age15F, p_age16F, p_age17F, p_age18F, p_age19F $
      , p_age20F, p_age21F, p_age22F, p_age23F, p_age24F, p_age25F $
      , p_age26F, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthIndex2]] $
      , female[LengthIndex2], FishProb, FishAge[female[LengthIndex2]] $
      , LoopIndex1)
    length_meanF[10:36, LoopIndex2+LengthIndex1] = AgeAssignF[0, *]
    length_binF[10:36, LoopIndex2+LengthIndex1] = AgeAssignF[1, *]
    ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
    AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[female[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
    FishAge[female[LengthIndex2]] = AgeAssignIndF[0,*]
    FishLength[female[LengthIndex2]] = AgeAssignIndF[1,*]
  ENDIF
  IF Size420to440Fcount GT 0 THEN BEGIN
    LengthIndex1 = 17
    LengthIndex2 = Size420to440F
    FishProb = AgeLengthKey(p_age0F, p_age1F, p_age2F, p_age3F, p_age4F, p_age5F $
      , p_age6F, p_age7F, p_age8F, p_age9F, p_age10F, p_age11F, p_age12F $
      , p_age13F, p_age14F, p_age15F, p_age16F, p_age17F, p_age18F, p_age19F $
      , p_age20F, p_age21F, p_age22F, p_age23F, p_age24F, p_age25F $
      , p_age26F, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthIndex2]] $
      , female[LengthIndex2], FishProb, FishAge[female[LengthIndex2]] $
      , LoopIndex1)
    length_meanF[10:36, LoopIndex2+LengthIndex1] = AgeAssignF[0, *]
    length_binF[10:36, LoopIndex2+LengthIndex1] = AgeAssignF[1, *]
    ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
    AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[female[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
    FishAge[female[LengthIndex2]] = AgeAssignIndF[0,*]
    FishLength[female[LengthIndex2]] = AgeAssignIndF[1,*]
  ENDIF
  IF Size440to460Fcount GT 0 THEN BEGIN
    LengthIndex1 = 18
    LengthIndex2 = Size440to460F
    FishProb = AgeLengthKey(p_age0F, p_age1F, p_age2F, p_age3F, p_age4F, p_age5F $
      , p_age6F, p_age7F, p_age8F, p_age9F, p_age10F, p_age11F, p_age12F $
      , p_age13F, p_age14F, p_age15F, p_age16F, p_age17F, p_age18F, p_age19F $
      , p_age20F, p_age21F, p_age22F, p_age23F, p_age24F, p_age25F $
      , p_age26F, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthIndex2]] $
      , female[LengthIndex2], FishProb, FishAge[female[LengthIndex2]] $
      , LoopIndex1)
    length_meanF[10:36, LoopIndex2+LengthIndex1] = AgeAssignF[0, *]
    length_binF[10:36, LoopIndex2+LengthIndex1] = AgeAssignF[1, *]
    ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
    AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[female[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
    FishAge[female[LengthIndex2]] = AgeAssignIndF[0,*]
    FishLength[female[LengthIndex2]] = AgeAssignIndF[1,*]
  ENDIF
  IF Size460to480Fcount GT 0 THEN BEGIN
    LengthIndex1 = 19
    LengthIndex2 = Size460to480F
    FishProb = AgeLengthKey(p_age0F, p_age1F, p_age2F, p_age3F, p_age4F, p_age5F $
      , p_age6F, p_age7F, p_age8F, p_age9F, p_age10F, p_age11F, p_age12F $
      , p_age13F, p_age14F, p_age15F, p_age16F, p_age17F, p_age18F, p_age19F $
      , p_age20F, p_age21F, p_age22F, p_age23F, p_age24F, p_age25F $
      , p_age26F, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthIndex2]] $
      , female[LengthIndex2], FishProb, FishAge[female[LengthIndex2]] $
      , LoopIndex1)
    length_meanF[10:36, LoopIndex2+LengthIndex1] = AgeAssignF[0, *]
    length_binF[10:36, LoopIndex2+LengthIndex1] = AgeAssignF[1, *]
    ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
    AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[female[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
    FishAge[female[LengthIndex2]] = AgeAssignIndF[0,*]
    FishLength[female[LengthIndex2]] = AgeAssignIndF[1,*]
  ENDIF
  IF Size480to500Fcount GT 0 THEN BEGIN
    LengthIndex1 = 20
    LengthIndex2 = Size480to500F
    FishProb = AgeLengthKey(p_age0F, p_age1F, p_age2F, p_age3F, p_age4F, p_age5F $
      , p_age6F, p_age7F, p_age8F, p_age9F, p_age10F, p_age11F, p_age12F $
      , p_age13F, p_age14F, p_age15F, p_age16F, p_age17F, p_age18F, p_age19F $
      , p_age20F, p_age21F, p_age22F, p_age23F, p_age24F, p_age25F $
      , p_age26F, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb

    AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthIndex2]] $
      , female[LengthIndex2], FishProb, FishAge[female[LengthIndex2]] $
      , LoopIndex1)
    length_meanF[10:36, LoopIndex2+LengthIndex1] = AgeAssignF[0, *]
    length_binF[10:36, LoopIndex2+LengthIndex1] = AgeAssignF[1, *]
    ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
    AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[female[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
    FishAge[female[LengthIndex2]] = AgeAssignIndF[0,*]
    FishLength[female[LengthIndex2]] = AgeAssignIndF[1,*]
  ENDIF
  IF Size500to520Fcount GT 0 THEN BEGIN
    LengthIndex1 = 21
    LengthIndex2 = Size500to520F
    FishProb = AgeLengthKey(p_age0F, p_age1F, p_age2F, p_age3F, p_age4F, p_age5F $
      , p_age6F, p_age7F, p_age8F, p_age9F, p_age10F, p_age11F, p_age12F $
      , p_age13F, p_age14F, p_age15F, p_age16F, p_age17F, p_age18F, p_age19F $
      , p_age20F, p_age21F, p_age22F, p_age23F, p_age24F, p_age25F $
      , p_age26F, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb

    AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthIndex2]] $
      , female[LengthIndex2], FishProb, FishAge[female[LengthIndex2]] $
      , LoopIndex1)
    length_meanF[10:36, LoopIndex2+LengthIndex1] = AgeAssignF[0, *]
    length_binF[10:36, LoopIndex2+LengthIndex1] = AgeAssignF[1, *]
    ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
    AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[female[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
    FishAge[female[LengthIndex2]] = AgeAssignIndF[0,*]
    FishLength[female[LengthIndex2]] = AgeAssignIndF[1,*]
  ENDIF
  IF Size520to540Fcount GT 0 THEN BEGIN
    LengthIndex1 = 22
    LengthIndex2 = Size520to540F
    FishProb = AgeLengthKey(p_age0F, p_age1F, p_age2F, p_age3F, p_age4F, p_age5F $
      , p_age6F, p_age7F, p_age8F, p_age9F, p_age10F, p_age11F, p_age12F $
      , p_age13F, p_age14F, p_age15F, p_age16F, p_age17F, p_age18F, p_age19F $
      , p_age20F, p_age21F, p_age22F, p_age23F, p_age24F, p_age25F $
      , p_age26F, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthIndex2]] $
      , female[LengthIndex2], FishProb, FishAge[female[LengthIndex2]] $
      , LoopIndex1)
    length_meanF[10:36, LoopIndex2+LengthIndex1] = AgeAssignF[0, *]
    length_binF[10:36, LoopIndex2+LengthIndex1] = AgeAssignF[1, *]
    ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
    AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[female[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
    FishAge[female[LengthIndex2]] = AgeAssignIndF[0,*]
    FishLength[female[LengthIndex2]] = AgeAssignIndF[1,*]
  ENDIF
  IF Size540to560Fcount GT 0 THEN BEGIN
    LengthIndex1 = 23
    LengthIndex2 = Size540to560F
    FishProb = AgeLengthKey(p_age0F, p_age1F, p_age2F, p_age3F, p_age4F, p_age5F $
      , p_age6F, p_age7F, p_age8F, p_age9F, p_age10F, p_age11F, p_age12F $
      , p_age13F, p_age14F, p_age15F, p_age16F, p_age17F, p_age18F, p_age19F $
      , p_age20F, p_age21F, p_age22F, p_age23F, p_age24F, p_age25F $
      , p_age26F, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb

    AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthIndex2]] $
      , female[LengthIndex2], FishProb, FishAge[female[LengthIndex2]] $
      , LoopIndex1)
    length_meanF[10:36, LoopIndex2+LengthIndex1] = AgeAssignF[0, *]
    length_binF[10:36, LoopIndex2+LengthIndex1] = AgeAssignF[1, *]
    ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
    AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[female[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
    FishAge[female[LengthIndex2]] = AgeAssignIndF[0,*]
    FishLength[female[LengthIndex2]] = AgeAssignIndF[1,*]
  ENDIF
  IF Size560to580Fcount GT 0 THEN BEGIN
    LengthIndex1 = 24
    LengthIndex2 = Size560to580F
    FishProb = AgeLengthKey(p_age0F, p_age1F, p_age2F, p_age3F, p_age4F, p_age5F $
      , p_age6F, p_age7F, p_age8F, p_age9F, p_age10F, p_age11F, p_age12F $
      , p_age13F, p_age14F, p_age15F, p_age16F, p_age17F, p_age18F, p_age19F $
      , p_age20F, p_age21F, p_age22F, p_age23F, p_age24F, p_age25F $
      , p_age26F, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb

    AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthIndex2]] $
      , female[LengthIndex2], FishProb, FishAge[female[LengthIndex2]] $
      , LoopIndex1)
    length_meanF[10:36, LoopIndex2+LengthIndex1] = AgeAssignF[0, *]
    length_binF[10:36, LoopIndex2+LengthIndex1] = AgeAssignF[1, *]
    ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
    AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[female[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
    FishAge[female[LengthIndex2]] = AgeAssignIndF[0,*]
    FishLength[female[LengthIndex2]] = AgeAssignIndF[1,*]
  ENDIF
  IF Size580to600Fcount GT 0 THEN BEGIN
    LengthIndex1 = 25
    LengthIndex2 = Size580to600F
    FishProb = AgeLengthKey(p_age0F, p_age1F, p_age2F, p_age3F, p_age4F, p_age5F $
      , p_age6F, p_age7F, p_age8F, p_age9F, p_age10F, p_age11F, p_age12F $
      , p_age13F, p_age14F, p_age15F, p_age16F, p_age17F, p_age18F, p_age19F $
      , p_age20F, p_age21F, p_age22F, p_age23F, p_age24F, p_age25F $
      , p_age26F, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthIndex2]] $
      , female[LengthIndex2], FishProb, FishAge[female[LengthIndex2]] $
      , LoopIndex1)
    length_meanF[10:36, LoopIndex2+LengthIndex1] = AgeAssignF[0, *]
    length_binF[10:36, LoopIndex2+LengthIndex1] = AgeAssignF[1, *]
    ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
    AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[female[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
    FishAge[female[LengthIndex2]] = AgeAssignIndF[0,*]
    FishLength[female[LengthIndex2]] = AgeAssignIndF[1,*]
  ENDIF
  IF Size600to620Fcount GT 0 THEN BEGIN
    LengthIndex1 = 26
    LengthIndex2 = Size600to620F
    FishProb = AgeLengthKey(p_age0F, p_age1F, p_age2F, p_age3F, p_age4F, p_age5F $
      , p_age6F, p_age7F, p_age8F, p_age9F, p_age10F, p_age11F, p_age12F $
      , p_age13F, p_age14F, p_age15F, p_age16F, p_age17F, p_age18F, p_age19F $
      , p_age20F, p_age21F, p_age22F, p_age23F, p_age24F, p_age25F $
      , p_age26F, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthIndex2]] $
      , female[LengthIndex2], FishProb, FishAge[female[LengthIndex2]] $
      , LoopIndex1)
    length_meanF[10:36, LoopIndex2+LengthIndex1] = AgeAssignF[0, *]
    length_binF[10:36, LoopIndex2+LengthIndex1] = AgeAssignF[1, *]
    ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
    AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[female[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
    FishAge[female[LengthIndex2]] = AgeAssignIndF[0,*]
    FishLength[female[LengthIndex2]] = AgeAssignIndF[1,*]
  ENDIF
  IF Size620to640Fcount GT 0 THEN BEGIN
    LengthIndex1 = 27
    LengthIndex2 = Size620to640F
    FishProb = AgeLengthKey(p_age0F, p_age1F, p_age2F, p_age3F, p_age4F, p_age5F $
      , p_age6F, p_age7F, p_age8F, p_age9F, p_age10F, p_age11F, p_age12F $
      , p_age13F, p_age14F, p_age15F, p_age16F, p_age17F, p_age18F, p_age19F $
      , p_age20F, p_age21F, p_age22F, p_age23F, p_age24F, p_age25F $
      , p_age26F, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthIndex2]] $
      , female[LengthIndex2], FishProb, FishAge[female[LengthIndex2]] $
      , LoopIndex1)
    length_meanF[10:36, LoopIndex2+LengthIndex1] = AgeAssignF[0, *]
    length_binF[10:36, LoopIndex2+LengthIndex1] = AgeAssignF[1, *]
    ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
    AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[female[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
    FishAge[female[LengthIndex2]] = AgeAssignIndF[0,*]
    FishLength[female[LengthIndex2]] = AgeAssignIndF[1,*]
  ENDIF
  IF Size640to660Fcount GT 0 THEN BEGIN
    LengthIndex1 = 28
    LengthIndex2 = Size640to660F
    FishProb = AgeLengthKey(p_age0F, p_age1F, p_age2F, p_age3F, p_age4F, p_age5F $
      , p_age6F, p_age7F, p_age8F, p_age9F, p_age10F, p_age11F, p_age12F $
      , p_age13F, p_age14F, p_age15F, p_age16F, p_age17F, p_age18F, p_age19F $
      , p_age20F, p_age21F, p_age22F, p_age23F, p_age24F, p_age25F $
      , p_age26F, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthIndex2]] $
      , female[LengthIndex2], FishProb, FishAge[female[LengthIndex2]] $
      , LoopIndex1)
    length_meanF[10:36, LoopIndex2+LengthIndex1] = AgeAssignF[0, *]
    length_binF[10:36, LoopIndex2+LengthIndex1] = AgeAssignF[1, *]
    ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
    AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[female[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
    FishAge[female[LengthIndex2]] = AgeAssignIndF[0,*]
    FishLength[female[LengthIndex2]] = AgeAssignIndF[1,*]
  ENDIF
  IF Size660to680Fcount GT 0 THEN BEGIN
    LengthIndex1 = 29
    LengthIndex2 = Size660to680F
    FishProb = AgeLengthKey(p_age0F, p_age1F, p_age2F, p_age3F, p_age4F, p_age5F $
      , p_age6F, p_age7F, p_age8F, p_age9F, p_age10F, p_age11F, p_age12F $
      , p_age13F, p_age14F, p_age15F, p_age16F, p_age17F, p_age18F, p_age19F $
      , p_age20F, p_age21F, p_age22F, p_age23F, p_age24F, p_age25F $
      , p_age26F, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthIndex2]] $
      , female[LengthIndex2], FishProb, FishAge[female[LengthIndex2]] $
      , LoopIndex1)
    length_meanF[10:36, LoopIndex2+LengthIndex1] = AgeAssignF[0, *]
    length_binF[10:36, LoopIndex2+LengthIndex1] = AgeAssignF[1, *]
    ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
    AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[female[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
    FishAge[female[LengthIndex2]] = AgeAssignIndF[0,*]
    FishLength[female[LengthIndex2]] = AgeAssignIndF[1,*]
  ENDIF
  IF Size680to700Fcount GT 0 THEN BEGIN
    LengthIndex1 = 30
    LengthIndex2 = Size680to700F
    FishProb = AgeLengthKey(p_age0F, p_age1F, p_age2F, p_age3F, p_age4F, p_age5F $
      , p_age6F, p_age7F, p_age8F, p_age9F, p_age10F, p_age11F, p_age12F $
      , p_age13F, p_age14F, p_age15F, p_age16F, p_age17F, p_age18F, p_age19F $
      , p_age20F, p_age21F, p_age22F, p_age23F, p_age24F, p_age25F $
      , p_age26F, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthIndex2]] $
      , female[LengthIndex2], FishProb, FishAge[female[LengthIndex2]] $
      , LoopIndex1)
    length_meanF[10:36, LoopIndex2+LengthIndex1] = AgeAssignF[0, *]
    length_binF[10:36, LoopIndex2+LengthIndex1] = AgeAssignF[1, *]
    ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
    AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[female[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
    FishAge[female[LengthIndex2]] = AgeAssignIndF[0,*]
    FishLength[female[LengthIndex2]] = AgeAssignIndF[1,*]
  ENDIF
  IF Size700to720Fcount GT 0 THEN BEGIN
    LengthIndex1 = 31
    LengthIndex2 = Size700to720F
    FishProb = AgeLengthKey(p_age0F, p_age1F, p_age2F, p_age3F, p_age4F, p_age5F $
      , p_age6F, p_age7F, p_age8F, p_age9F, p_age10F, p_age11F, p_age12F $
      , p_age13F, p_age14F, p_age15F, p_age16F, p_age17F, p_age18F, p_age19F $
      , p_age20F, p_age21F, p_age22F, p_age23F, p_age24F, p_age25F $
      , p_age26F, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthIndex2]] $
      , female[LengthIndex2], FishProb, FishAge[female[LengthIndex2]] $
      , LoopIndex1)
    length_meanF[10:36, LoopIndex2+LengthIndex1] = AgeAssignF[0, *]
    length_binF[10:36, LoopIndex2+LengthIndex1] = AgeAssignF[1, *]
    ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
    AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[female[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
    FishAge[female[LengthIndex2]] = AgeAssignIndF[0,*]
    FishLength[female[LengthIndex2]] = AgeAssignIndF[1,*]
  ENDIF
  IF Size720to740Fcount GT 0 THEN BEGIN
    LengthIndex1 = 32
    LengthIndex2 = Size720to740F
    FishProb = AgeLengthKey(p_age0F, p_age1F, p_age2F, p_age3F, p_age4F, p_age5F $
      , p_age6F, p_age7F, p_age8F, p_age9F, p_age10F, p_age11F, p_age12F $
      , p_age13F, p_age14F, p_age15F, p_age16F, p_age17F, p_age18F, p_age19F $
      , p_age20F, p_age21F, p_age22F, p_age23F, p_age24F, p_age25F $
      , p_age26F, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthIndex2]] $
      , female[LengthIndex2], FishProb, FishAge[female[LengthIndex2]] $
      , LoopIndex1)
    length_meanF[10:36, LoopIndex2+LengthIndex1] = AgeAssignF[0, *]
    length_binF[10:36, LoopIndex2+LengthIndex1] = AgeAssignF[1, *]
    ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
    AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[female[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
    FishAge[female[LengthIndex2]] = AgeAssignIndF[0,*]
    FishLength[female[LengthIndex2]] = AgeAssignIndF[1,*]
  ENDIF
  IF Size740to760Fcount GT 0 THEN BEGIN
    LengthIndex1 = 33
    LengthIndex2 = Size740to760F
    FishProb = AgeLengthKey(p_age0F, p_age1F, p_age2F, p_age3F, p_age4F, p_age5F $
      , p_age6F, p_age7F, p_age8F, p_age9F, p_age10F, p_age11F, p_age12F $
      , p_age13F, p_age14F, p_age15F, p_age16F, p_age17F, p_age18F, p_age19F $
      , p_age20F, p_age21F, p_age22F, p_age23F, p_age24F, p_age25F $
      , p_age26F, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb

    AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthIndex2]] $
      , female[LengthIndex2], FishProb, FishAge[female[LengthIndex2]] $
      , LoopIndex1)
    length_meanF[10:36, LoopIndex2+LengthIndex1] = AgeAssignF[0, *]
    length_binF[10:36, LoopIndex2+LengthIndex1] = AgeAssignF[1, *]
    ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
    AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[female[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
    FishAge[female[LengthIndex2]] = AgeAssignIndF[0,*]
    FishLength[female[LengthIndex2]] = AgeAssignIndF[1,*]
  ENDIF
  IF Size760to780Fcount GT 0 THEN BEGIN
    LengthIndex1 = 34
    LengthIndex2 = Size760to780F
    FishProb = AgeLengthKey(p_age0F, p_age1F, p_age2F, p_age3F, p_age4F, p_age5F $
      , p_age6F, p_age7F, p_age8F, p_age9F, p_age10F, p_age11F, p_age12F $
      , p_age13F, p_age14F, p_age15F, p_age16F, p_age17F, p_age18F, p_age19F $
      , p_age20F, p_age21F, p_age22F, p_age23F, p_age24F, p_age25F $
      , p_age26F, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthIndex2]] $
      , female[LengthIndex2], FishProb, FishAge[female[LengthIndex2]] $
      , LoopIndex1)
    length_meanF[10:36, LoopIndex2+LengthIndex1] = AgeAssignF[0, *]
    length_binF[10:36, LoopIndex2+LengthIndex1] = AgeAssignF[1, *]
    ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
    AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[female[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
    FishAge[female[LengthIndex2]] = AgeAssignIndF[0,*]
    FishLength[female[LengthIndex2]] = AgeAssignIndF[1,*]
  ENDIF
  IF Size780to800Fcount GT 0 THEN BEGIN
    LengthIndex1 = 35
    LengthIndex2 = Size780to800F
    FishProb = AgeLengthKey(p_age0F, p_age1F, p_age2F, p_age3F, p_age4F, p_age5F $
      , p_age6F, p_age7F, p_age8F, p_age9F, p_age10F, p_age11F, p_age12F $
      , p_age13F, p_age14F, p_age15F, p_age16F, p_age17F, p_age18F, p_age19F $
      , p_age20F, p_age21F, p_age22F, p_age23F, p_age24F, p_age25F $
      , p_age26F, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthIndex2]] $
      , female[LengthIndex2], FishProb, FishAge[female[LengthIndex2]] $
      , LoopIndex1)
    length_meanF[10:36, LoopIndex2+LengthIndex1] = AgeAssignF[0, *]
    length_binF[10:36, LoopIndex2+LengthIndex1] = AgeAssignF[1, *]
    ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
    AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[female[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
    FishAge[female[LengthIndex2]] = AgeAssignIndF[0,*]
    FishLength[female[LengthIndex2]] = AgeAssignIndF[1,*]
  ENDIF
  IF Sizege800Fcount GT 0 THEN BEGIN
    LengthIndex1 = 36
    LengthIndex2 = SizeGE800F
    FishProb = AgeLengthKey(p_age0F, p_age1F, p_age2F, p_age3F, p_age4F, p_age5F $
      , p_age6F, p_age7F, p_age8F, p_age9F, p_age10F, p_age11F, p_age12F $
      , p_age13F, p_age14F, p_age15F, p_age16F, p_age17F, p_age18F, p_age19F $
      , p_age20F, p_age21F, p_age22F, p_age23F, p_age24F, p_age25F $
      , p_age26F, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthIndex2]] $
      , female[LengthIndex2], FishProb, FishAge[female[LengthIndex2]] $
      , LoopIndex1)
    length_meanF[10:36, LoopIndex2+LengthIndex1] = AgeAssignF[0, *]
    length_binF[10:36, LoopIndex2+LengthIndex1] = AgeAssignF[1, *]
    ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
    AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[female[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
    FishAge[female[LengthIndex2]] = AgeAssignIndF[0,*]
    FishLength[female[LengthIndex2]] = AgeAssignIndF[1,*]
  ENDIF

  ; 1.Assign age semi-randomly to lengths - UNKNOWNS
  IF SizeLT100Ucount GT 0 THEN BEGIN
    LengthIndex1 = 0
    LengthIndex2 = SizeLT100U
    FishProb = AgeLengthKey(p_age0, p_age1, p_age2, p_age3, p_age4, p_age5 $
      , p_age6, p_age7, p_age8, p_age9, p_age10, p_age11, p_age12 $
      , p_age13, p_age14, p_age15, p_age16, p_age17, p_age18, p_age19 $
      , p_age20, p_age21, p_age22, p_age23, p_age24, p_age25 $
      , p_age26, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb

    AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthIndex2]] $
      , unknown[LengthIndex2], FishProb, FishAge[unknown[LengthIndex2]] $
      , LoopIndex1)
    length_meanU[10:36, LoopIndex2+LengthIndex1] = AgeAssignU[0, *]
    length_binU[10:36, LoopIndex2+LengthIndex1] = AgeAssignU[1, *]
    ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
    AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[unknown[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
    FishAge[unknown[LengthIndex2]] = AgeAssignIndU[0,*]
    FishLength[unknown[LengthIndex2]] = AgeAssignIndU[1,*]
  ENDIF
  IF Size100to120Ucount GT 0 THEN BEGIN
    LengthIndex1 = 1
    LengthIndex2 = Size100to120U
    FishProb = AgeLengthKey(p_age0, p_age1, p_age2, p_age3, p_age4, p_age5 $
      , p_age6, p_age7, p_age8, p_age9, p_age10, p_age11, p_age12 $
      , p_age13, p_age14, p_age15, p_age16, p_age17, p_age18, p_age19 $
      , p_age20, p_age21, p_age22, p_age23, p_age24, p_age25 $
      , p_age26, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb

    AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthIndex2]] $
      , unknown[LengthIndex2], FishProb, FishAge[unknown[LengthIndex2]] $
      , LoopIndex1)
    length_meanU[10:36, LoopIndex2+LengthIndex1] = AgeAssignU[0, *]
    length_binU[10:36, LoopIndex2+LengthIndex1] = AgeAssignU[1, *]
    ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
    AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[unknown[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
    FishAge[unknown[LengthIndex2]] = AgeAssignIndU[0,*]
    FishLength[unknown[LengthIndex2]] = AgeAssignIndU[1,*]
  ENDIF
  IF Size120to140Ucount GT 0 THEN BEGIN
    LengthIndex1 = 2
    LengthIndex2 = Size120to140U
    FishProb = AgeLengthKey(p_age0, p_age1, p_age2, p_age3, p_age4, p_age5 $
      , p_age6, p_age7, p_age8, p_age9, p_age10, p_age11, p_age12 $
      , p_age13, p_age14, p_age15, p_age16, p_age17, p_age18, p_age19 $
      , p_age20, p_age21, p_age22, p_age23, p_age24, p_age25 $
      , p_age26, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthIndex2]] $
      , unknown[LengthIndex2], FishProb, FishAge[unknown[LengthIndex2]] $
      , LoopIndex1)
    length_meanU[10:36, LoopIndex2+LengthIndex1] = AgeAssignU[0, *]
    length_binU[10:36, LoopIndex2+LengthIndex1] = AgeAssignU[1, *]
    ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
    AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[unknown[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
    FishAge[unknown[LengthIndex2]] = AgeAssignIndU[0,*]
    FishLength[unknown[LengthIndex2]] = AgeAssignIndU[1,*]
  ENDIF
  IF Size140to160Ucount GT 0 THEN BEGIN
    LengthIndex1 = 3
    LengthIndex2 = Size140to160U
    FishProb = AgeLengthKey(p_age0, p_age1, p_age2, p_age3, p_age4, p_age5 $
      , p_age6, p_age7, p_age8, p_age9, p_age10, p_age11, p_age12 $
      , p_age13, p_age14, p_age15, p_age16, p_age17, p_age18, p_age19 $
      , p_age20, p_age21, p_age22, p_age23, p_age24, p_age25 $
      , p_age26, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthIndex2]] $
      , unknown[LengthIndex2], FishProb, FishAge[unknown[LengthIndex2]] $
      , LoopIndex1)
    length_meanU[10:36, LoopIndex2+LengthIndex1] = AgeAssignU[0, *]
    length_binU[10:36, LoopIndex2+LengthIndex1] = AgeAssignU[1, *]
    ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
    AgeAssignIndu = WalleyeAgeAssignInd(Length_prod[unknown[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[unknown[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
    FishAge[unknown[LengthIndex2]] = AgeAssignIndU[0,*]
    FishLength[unknown[LengthIndex2]] = AgeAssignIndU[1,*]
  ENDIF
  IF Size160to180Ucount GT 0 THEN BEGIN
    LengthIndex1 = 4
    LengthIndex2 = Size160to180U
    FishProb = AgeLengthKey(p_age0, p_age1, p_age2, p_age3, p_age4, p_age5 $
      , p_age6, p_age7, p_age8, p_age9, p_age10, p_age11, p_age12 $
      , p_age13, p_age14, p_age15, p_age16, p_age17, p_age18, p_age19 $
      , p_age20, p_age21, p_age22, p_age23, p_age24, p_age25 $
      , p_age26, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthIndex2]] $
      , unknown[LengthIndex2], FishProb, FishAge[unknown[LengthIndex2]] $
      , LoopIndex1)
    length_meanU[10:36, LoopIndex2+LengthIndex1] = AgeAssignU[0, *]
    length_binU[10:36, LoopIndex2+LengthIndex1] = AgeAssignU[1, *]
    ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
    AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[unknown[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
    FishAge[unknown[LengthIndex2]] = AgeAssignIndU[0,*]
    FishLength[unknown[LengthIndex2]] = AgeAssignIndU[1,*]
  ENDIF
  IF Size180to200Ucount GT 0 THEN BEGIN
    LengthIndex1 = 5
    LengthIndex2 = Size180to200U
    FishProb = AgeLengthKey(p_age0, p_age1, p_age2, p_age3, p_age4, p_age5 $
      , p_age6, p_age7, p_age8, p_age9, p_age10, p_age11, p_age12 $
      , p_age13, p_age14, p_age15, p_age16, p_age17, p_age18, p_age19 $
      , p_age20, p_age21, p_age22, p_age23, p_age24, p_age25 $
      , p_age26, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb

    AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthIndex2]] $
      , unknown[LengthIndex2], FishProb, FishAge[unknown[LengthIndex2]] $
      , LoopIndex1)
    length_meanU[10:36, LoopIndex2+LengthIndex1] = AgeAssignU[0, *]
    length_binU[10:36, LoopIndex2+LengthIndex1] = AgeAssignU[1, *]
    ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
    AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[unknown[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
    FishAge[unknown[LengthIndex2]] = AgeAssignIndU[0,*]
    FishLength[unknown[LengthIndex2]] = AgeAssignIndU[1,*]
  ENDIF

  IF Size200to220Ucount GT 0 THEN BEGIN
    LengthIndex1 = 6
    LengthIndex2 = Size200to220U
    FishProb = AgeLengthKey(p_age0, p_age1, p_age2, p_age3, p_age4, p_age5 $
      , p_age6, p_age7, p_age8, p_age9, p_age10, p_age11, p_age12 $
      , p_age13, p_age14, p_age15, p_age16, p_age17, p_age18, p_age19 $
      , p_age20, p_age21, p_age22, p_age23, p_age24, p_age25 $
      , p_age26, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthIndex2]] $
      , unknown[LengthIndex2], FishProb, FishAge[unknown[LengthIndex2]] $
      , LoopIndex1)
    length_meanU[10:36, LoopIndex2+LengthIndex1] = AgeAssignU[0, *]
    length_binU[10:36, LoopIndex2+LengthIndex1] = AgeAssignU[1, *]
    ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
    AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[unknown[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
    FishAge[unknown[LengthIndex2]] = AgeAssignIndU[0,*]
    FishLength[unknown[LengthIndex2]] = AgeAssignIndU[1,*]
  ENDIF
  IF Size220to240Ucount GT 0 THEN BEGIN
    LengthIndex1 = 7
    LengthIndex2 = Size220to240U
    FishProb = AgeLengthKey(p_age0, p_age1, p_age2, p_age3, p_age4, p_age5 $
      , p_age6, p_age7, p_age8, p_age9, p_age10, p_age11, p_age12 $
      , p_age13, p_age14, p_age15, p_age16, p_age17, p_age18, p_age19 $
      , p_age20, p_age21, p_age22, p_age23, p_age24, p_age25 $
      , p_age26, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb

    AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthIndex2]] $
      , unknown[LengthIndex2], FishProb, FishAge[unknown[LengthIndex2]] $
      , LoopIndex1)
    length_meanU[10:36, LoopIndex2+LengthIndex1] = AgeAssignU[0, *]
    length_binU[10:36, LoopIndex2+LengthIndex1] = AgeAssignU[1, *]
    ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
    AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[unknown[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
    FishAge[unknown[LengthIndex2]] = AgeAssignIndU[0,*]
    FishLength[unknown[LengthIndex2]] = AgeAssignIndU[1,*]
  ENDIF
  IF Size240to260Ucount GT 0 THEN BEGIN
    LengthIndex1 = 8
    LengthIndex2 = Size240to260U
    FishProb = AgeLengthKey(p_age0, p_age1, p_age2, p_age3, p_age4, p_age5 $
      , p_age6, p_age7, p_age8, p_age9, p_age10, p_age11, p_age12 $
      , p_age13, p_age14, p_age15, p_age16, p_age17, p_age18, p_age19 $
      , p_age20, p_age21, p_age22, p_age23, p_age24, p_age25 $
      , p_age26, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb

    AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthIndex2]] $
      , unknown[LengthIndex2], FishProb, FishAge[unknown[LengthIndex2]] $
      , LoopIndex1)
    length_meanU[10:36, LoopIndex2+LengthIndex1] = AgeAssignU[0, *]
    length_binU[10:36, LoopIndex2+LengthIndex1] = AgeAssignU[1, *]
    ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
    AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[unknown[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
    FishAge[unknown[LengthIndex2]] = AgeAssignIndU[0,*]
    FishLength[unknown[LengthIndex2]] = AgeAssignIndU[1,*]
  ENDIF
  IF Size260to280Ucount GT 0 THEN BEGIN
    LengthIndex1 = 9
    LengthIndex2 = Size260to280U
    FishProb = AgeLengthKey(p_age0, p_age1, p_age2, p_age3, p_age4, p_age5 $
      , p_age6, p_age7, p_age8, p_age9, p_age10, p_age11, p_age12 $
      , p_age13, p_age14, p_age15, p_age16, p_age17, p_age18, p_age19 $
      , p_age20, p_age21, p_age22, p_age23, p_age24, p_age25 $
      , p_age26, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthIndex2]] $
      , unknown[LengthIndex2], FishProb, FishAge[unknown[LengthIndex2]] $
      , LoopIndex1)
    length_meanU[10:36, LoopIndex2+LengthIndex1] = AgeAssignU[0, *]
    length_binU[10:36, LoopIndex2+LengthIndex1] = AgeAssignU[1, *]
    ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
    AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[unknown[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
    FishAge[unknown[LengthIndex2]] = AgeAssignIndU[0,*]
    FishLength[unknown[LengthIndex2]] = AgeAssignIndU[1,*]
  ENDIF
  IF Size280to300Ucount GT 0 THEN BEGIN
    LengthIndex1 = 10
    LengthIndex2 = Size280to300U
    FishProb = AgeLengthKey(p_age0, p_age1, p_age2, p_age3, p_age4, p_age5 $
      , p_age6, p_age7, p_age8, p_age9, p_age10, p_age11, p_age12 $
      , p_age13, p_age14, p_age15, p_age16, p_age17, p_age18, p_age19 $
      , p_age20, p_age21, p_age22, p_age23, p_age24, p_age25 $
      , p_age26, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb

    AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthIndex2]] $
      , unknown[LengthIndex2], FishProb, FishAge[unknown[LengthIndex2]] $
      , LoopIndex1)
    length_meanU[10:36, LoopIndex2+LengthIndex1] = AgeAssignU[0, *]
    length_binU[10:36, LoopIndex2+LengthIndex1] = AgeAssignU[1, *]
    ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
    AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[unknown[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
    FishAge[unknown[LengthIndex2]] = AgeAssignIndU[0,*]
    FishLength[unknown[LengthIndex2]] = AgeAssignIndU[1,*]
  ENDIF
  IF Size300to320Ucount GT 0 THEN BEGIN
    LengthIndex1 = 11
    LengthIndex2 = Size300to320U
    FishProb = AgeLengthKey(p_age0, p_age1, p_age2, p_age3, p_age4, p_age5 $
      , p_age6, p_age7, p_age8, p_age9, p_age10, p_age11, p_age12 $
      , p_age13, p_age14, p_age15, p_age16, p_age17, p_age18, p_age19 $
      , p_age20, p_age21, p_age22, p_age23, p_age24, p_age25 $
      , p_age26, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb

    AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthIndex2]] $
      , unknown[LengthIndex2], FishProb, FishAge[unknown[LengthIndex2]] $
      , LoopIndex1)
    length_meanU[10:36, LoopIndex2+LengthIndex1] = AgeAssignU[0, *]
    length_binU[10:36, LoopIndex2+LengthIndex1] = AgeAssignU[1, *]
    ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
    AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[unknown[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
    FishAge[unknown[LengthIndex2]] = AgeAssignIndU[0,*]
    FishLength[unknown[LengthIndex2]] = AgeAssignIndU[1,*]
  ENDIF
  IF Size320to340Ucount GT 0 THEN BEGIN
    LengthIndex1 = 12
    LengthIndex2 = Size320to340U
    FishProb = AgeLengthKey(p_age0, p_age1, p_age2, p_age3, p_age4, p_age5 $
      , p_age6, p_age7, p_age8, p_age9, p_age10, p_age11, p_age12 $
      , p_age13, p_age14, p_age15, p_age16, p_age17, p_age18, p_age19 $
      , p_age20, p_age21, p_age22, p_age23, p_age24, p_age25 $
      , p_age26, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb

    AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthIndex2]] $
      , unknown[LengthIndex2], FishProb, FishAge[unknown[LengthIndex2]] $
      , LoopIndex1)
    length_meanU[10:36, LoopIndex2+LengthIndex1] = AgeAssignU[0, *]
    length_binU[10:36, LoopIndex2+LengthIndex1] = AgeAssignU[1, *]
    ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
    AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[unknown[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
    FishAge[unknown[LengthIndex2]] = AgeAssignIndU[0,*]
    FishLength[unknown[LengthIndex2]] = AgeAssignIndU[1,*]
  ENDIF
  IF Size340to360Ucount GT 0 THEN BEGIN
    LengthIndex1 = 13
    LengthIndex2 = Size340to360U
    FishProb = AgeLengthKey(p_age0, p_age1, p_age2, p_age3, p_age4, p_age5 $
      , p_age6, p_age7, p_age8, p_age9, p_age10, p_age11, p_age12 $
      , p_age13, p_age14, p_age15, p_age16, p_age17, p_age18, p_age19 $
      , p_age20, p_age21, p_age22, p_age23, p_age24, p_age25 $
      , p_age26, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthIndex2]] $
      , unknown[LengthIndex2], FishProb, FishAge[unknown[LengthIndex2]] $
      , LoopIndex1)
    length_meanU[10:36, LoopIndex2+LengthIndex1] = AgeAssignU[0, *]
    length_binU[10:36, LoopIndex2+LengthIndex1] = AgeAssignU[1, *]
    ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
    AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[unknown[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
    FishAge[unknown[LengthIndex2]] = AgeAssignIndU[0,*]
    FishLength[unknown[LengthIndex2]] = AgeAssignIndU[1,*]
  ENDIF
  IF Size360to380Ucount GT 0 THEN BEGIN
    LengthIndex1 = 14
    LengthIndex2 = Size360to380U
    FishProb = AgeLengthKey(p_age0, p_age1, p_age2, p_age3, p_age4, p_age5 $
      , p_age6, p_age7, p_age8, p_age9, p_age10, p_age11, p_age12 $
      , p_age13, p_age14, p_age15, p_age16, p_age17, p_age18, p_age19 $
      , p_age20, p_age21, p_age22, p_age23, p_age24, p_age25 $
      , p_age26, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthIndex2]] $
      , unknown[LengthIndex2], FishProb, FishAge[unknown[LengthIndex2]] $
      , LoopIndex1)
    length_meanU[10:36, LoopIndex2+LengthIndex1] = AgeAssignU[0, *]
    length_binU[10:36, LoopIndex2+LengthIndex1] = AgeAssignU[1, *]
    ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
    AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[unknown[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
    FishAge[unknown[LengthIndex2]] = AgeAssignIndU[0,*]
    FishLength[unknown[LengthIndex2]] = AgeAssignIndU[1,*]
  ENDIF
  IF Size380to400Ucount GT 0 THEN BEGIN
    LengthIndex1 = 15
    LengthIndex2 = Size380to400U
    FishProb = AgeLengthKey(p_age0, p_age1, p_age2, p_age3, p_age4, p_age5 $
      , p_age6, p_age7, p_age8, p_age9, p_age10, p_age11, p_age12 $
      , p_age13, p_age14, p_age15, p_age16, p_age17, p_age18, p_age19 $
      , p_age20, p_age21, p_age22, p_age23, p_age24, p_age25 $
      , p_age26, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthIndex2]] $
      , unknown[LengthIndex2], FishProb, FishAge[unknown[LengthIndex2]] $
      , LoopIndex1)
    length_meanU[10:36, LoopIndex2+LengthIndex1] = AgeAssignU[0, *]
    length_binU[10:36, LoopIndex2+LengthIndex1] = AgeAssignU[1, *]
    ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
    AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[unknown[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
    FishAge[unknown[LengthIndex2]] = AgeAssignIndU[0,*]
    FishLength[unknown[LengthIndex2]] = AgeAssignIndU[1,*]
  ENDIF
  IF Size400to420Ucount GT 0 THEN BEGIN
    LengthIndex1 = 16
    LengthIndex2 = Size400to420U
    FishProb = AgeLengthKey(p_age0, p_age1, p_age2, p_age3, p_age4, p_age5 $
      , p_age6, p_age7, p_age8, p_age9, p_age10, p_age11, p_age12 $
      , p_age13, p_age14, p_age15, p_age16, p_age17, p_age18, p_age19 $
      , p_age20, p_age21, p_age22, p_age23, p_age24, p_age25 $
      , p_age26, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthIndex2]] $
      , unknown[LengthIndex2], FishProb, FishAge[unknown[LengthIndex2]] $
      , LoopIndex1)
    length_meanU[10:36, LoopIndex2+LengthIndex1] = AgeAssignU[0, *]
    length_binU[10:36, LoopIndex2+LengthIndex1] = AgeAssignU[1, *]
    ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
    AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[unknown[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
    FishAge[unknown[LengthIndex2]] = AgeAssignIndU[0,*]
    FishLength[unknown[LengthIndex2]] = AgeAssignIndU[1,*]
  ENDIF
  IF Size420to440Ucount GT 0 THEN BEGIN
    LengthIndex1 = 17
    LengthIndex2 = Size420to440U
    FishProb = AgeLengthKey(p_age0, p_age1, p_age2, p_age3, p_age4, p_age5 $
      , p_age6, p_age7, p_age8, p_age9, p_age10, p_age11, p_age12 $
      , p_age13, p_age14, p_age15, p_age16, p_age17, p_age18, p_age19 $
      , p_age20, p_age21, p_age22, p_age23, p_age24, p_age25 $
      , p_age26, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthIndex2]] $
      , unknown[LengthIndex2], FishProb, FishAge[unknown[LengthIndex2]] $
      , LoopIndex1)
    length_meanU[10:36, LoopIndex2+LengthIndex1] = AgeAssignU[0, *]
    length_binU[10:36, LoopIndex2+LengthIndex1] = AgeAssignU[1, *]
    ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
    AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[unknown[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
    FishAge[unknown[LengthIndex2]] = AgeAssignIndU[0,*]
    FishLength[unknown[LengthIndex2]] = AgeAssignIndU[1,*]
  ENDIF
  IF Size440to460Ucount GT 0 THEN BEGIN
    LengthIndex1 = 18
    LengthIndex2 = Size440to460U
    FishProb = AgeLengthKey(p_age0, p_age1, p_age2, p_age3, p_age4, p_age5 $
      , p_age6, p_age7, p_age8, p_age9, p_age10, p_age11, p_age12 $
      , p_age13, p_age14, p_age15, p_age16, p_age17, p_age18, p_age19 $
      , p_age20, p_age21, p_age22, p_age23, p_age24, p_age25 $
      , p_age26, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthIndex2]] $
      , unknown[LengthIndex2], FishProb, FishAge[unknown[LengthIndex2]] $
      , LoopIndex1)
    length_meanU[10:36, LoopIndex2+LengthIndex1] = AgeAssignU[0, *]
    length_binU[10:36, LoopIndex2+LengthIndex1] = AgeAssignU[1, *]
    ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
    AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[unknown[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
    FishAge[unknown[LengthIndex2]] = AgeAssignIndU[0,*]
    FishLength[unknown[LengthIndex2]] = AgeAssignIndU[1,*]
  ENDIF
  IF Size460to480Ucount GT 0 THEN BEGIN
    LengthIndex1 = 19
    LengthIndex2 = Size460to480U
    FishProb = AgeLengthKey(p_age0, p_age1, p_age2, p_age3, p_age4, p_age5 $
      , p_age6, p_age7, p_age8, p_age9, p_age10, p_age11, p_age12 $
      , p_age13, p_age14, p_age15, p_age16, p_age17, p_age18, p_age19 $
      , p_age20, p_age21, p_age22, p_age23, p_age24, p_age25 $
      , p_age26, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthIndex2]] $
      , unknown[LengthIndex2], FishProb, FishAge[unknown[LengthIndex2]] $
      , LoopIndex1)
    length_meanU[10:36, LoopIndex2+LengthIndex1] = AgeAssignU[0, *]
    length_binU[10:36, LoopIndex2+LengthIndex1] = AgeAssignU[1, *]
    ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
    AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[unknown[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
    FishAge[unknown[LengthIndex2]] = AgeAssignIndU[0,*]
    FishLength[unknown[LengthIndex2]] = AgeAssignIndU[1,*]
  ENDIF
  IF Size480to500Ucount GT 0 THEN BEGIN
    LengthIndex1 = 20
    LengthIndex2 = Size480to500U
    FishProb = AgeLengthKey(p_age0, p_age1, p_age2, p_age3, p_age4, p_age5 $
      , p_age6, p_age7, p_age8, p_age9, p_age10, p_age11, p_age12 $
      , p_age13, p_age14, p_age15, p_age16, p_age17, p_age18, p_age19 $
      , p_age20, p_age21, p_age22, p_age23, p_age24, p_age25 $
      , p_age26, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthIndex2]] $
      , unknown[LengthIndex2], FishProb, FishAge[unknown[LengthIndex2]] $
      , LoopIndex1)
    length_meanU[10:36, LoopIndex2+LengthIndex1] = AgeAssignU[0, *]
    length_binU[10:36, LoopIndex2+LengthIndex1] = AgeAssignU[1, *]
    ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
    AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[unknown[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
    FishAge[unknown[LengthIndex2]] = AgeAssignIndU[0,*]
    FishLength[unknown[LengthIndex2]] = AgeAssignIndU[1,*]
  ENDIF
  IF Size500to520Ucount GT 0 THEN BEGIN
    LengthIndex1 = 21
    LengthIndex2 = Size500to520U
    FishProb = AgeLengthKey(p_age0, p_age1, p_age2, p_age3, p_age4, p_age5 $
      , p_age6, p_age7, p_age8, p_age9, p_age10, p_age11, p_age12 $
      , p_age13, p_age14, p_age15, p_age16, p_age17, p_age18, p_age19 $
      , p_age20, p_age21, p_age22, p_age23, p_age24, p_age25 $
      , p_age26, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthIndex2]] $
      , unknown[LengthIndex2], FishProb, FishAge[unknown[LengthIndex2]] $
      , LoopIndex1)
    length_meanU[10:36, LoopIndex2+LengthIndex1] = AgeAssignU[0, *]
    length_binU[10:36, LoopIndex2+LengthIndex1] = AgeAssignU[1, *]
    ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
    AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[unknown[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
    FishAge[unknown[LengthIndex2]] = AgeAssignIndU[0,*]
    FishLength[unknown[LengthIndex2]] = AgeAssignIndU[1,*]
  ENDIF
  IF Size520to540Ucount GT 0 THEN BEGIN
    LengthIndex1 = 22
    LengthIndex2 = Size520to540U
    FishProb = AgeLengthKey(p_age0, p_age1, p_age2, p_age3, p_age4, p_age5 $
      , p_age6, p_age7, p_age8, p_age9, p_age10, p_age11, p_age12 $
      , p_age13, p_age14, p_age15, p_age16, p_age17, p_age18, p_age19 $
      , p_age20, p_age21, p_age22, p_age23, p_age24, p_age25 $
      , p_age26, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb

    AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthIndex2]] $
      , unknown[LengthIndex2], FishProb, FishAge[unknown[LengthIndex2]] $
      , LoopIndex1)
    length_meanU[10:36, LoopIndex2+LengthIndex1] = AgeAssignU[0, *]
    length_binU[10:36, LoopIndex2+LengthIndex1] = AgeAssignU[1, *]
    ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
    AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[unknown[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
    FishAge[unknown[LengthIndex2]] = AgeAssignIndU[0,*]
    FishLength[unknown[LengthIndex2]] = AgeAssignIndU[1,*]
  ENDIF
  IF Size540to560Ucount GT 0 THEN BEGIN
    LengthIndex1 = 23
    LengthIndex2 = Size540to560U
    FishProb = AgeLengthKey(p_age0, p_age1, p_age2, p_age3, p_age4, p_age5 $
      , p_age6, p_age7, p_age8, p_age9, p_age10, p_age11, p_age12 $
      , p_age13, p_age14, p_age15, p_age16, p_age17, p_age18, p_age19 $
      , p_age20, p_age21, p_age22, p_age23, p_age24, p_age25 $
      , p_age26, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb

    AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthIndex2]] $
      , unknown[LengthIndex2], FishProb, FishAge[unknown[LengthIndex2]] $
      , LoopIndex1)
    length_meanU[10:36, LoopIndex2+LengthIndex1] = AgeAssignU[0, *]
    length_binU[10:36, LoopIndex2+LengthIndex1] = AgeAssignU[1, *]
    ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
    AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[unknown[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
    FishAge[unknown[LengthIndex2]] = AgeAssignIndU[0,*]
    FishLength[unknown[LengthIndex2]] = AgeAssignIndU[1,*]
  ENDIF
  IF Size560to580Ucount GT 0 THEN BEGIN
    LengthIndex1 = 24
    LengthIndex2 = Size560to580U
    FishProb = AgeLengthKey(p_age0, p_age1, p_age2, p_age3, p_age4, p_age5 $
      , p_age6, p_age7, p_age8, p_age9, p_age10, p_age11, p_age12 $
      , p_age13, p_age14, p_age15, p_age16, p_age17, p_age18, p_age19 $
      , p_age20, p_age21, p_age22, p_age23, p_age24, p_age25 $
      , p_age26, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthIndex2]] $
      , unknown[LengthIndex2], FishProb, FishAge[unknown[LengthIndex2]] $
      , LoopIndex1)
    length_meanU[10:36, LoopIndex2+LengthIndex1] = AgeAssignU[0, *]
    length_binU[10:36, LoopIndex2+LengthIndex1] = AgeAssignU[1, *]
    ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
    AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[unknown[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
    FishAge[unknown[LengthIndex2]] = AgeAssignIndU[0,*]
    FishLength[unknown[LengthIndex2]] = AgeAssignIndU[1,*]
  ENDIF
  IF Size580to600Ucount GT 0 THEN BEGIN
    LengthIndex1 = 25
    LengthIndex2 = Size580to600U
    FishProb = AgeLengthKey(p_age0, p_age1, p_age2, p_age3, p_age4, p_age5 $
      , p_age6, p_age7, p_age8, p_age9, p_age10, p_age11, p_age12 $
      , p_age13, p_age14, p_age15, p_age16, p_age17, p_age18, p_age19 $
      , p_age20, p_age21, p_age22, p_age23, p_age24, p_age25 $
      , p_age26, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb

    AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthIndex2]] $
      , unknown[LengthIndex2], FishProb, FishAge[unknown[LengthIndex2]] $
      , LoopIndex1)
    length_meanU[10:36, LoopIndex2+LengthIndex1] = AgeAssignU[0, *]
    length_binU[10:36, LoopIndex2+LengthIndex1] = AgeAssignU[1, *]
    ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
    AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[unknown[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
    FishAge[unknown[LengthIndex2]] = AgeAssignIndU[0,*]
    FishLength[unknown[LengthIndex2]] = AgeAssignIndU[1,*]
  ENDIF
  IF Size600to620Ucount GT 0 THEN BEGIN
    LengthIndex1 = 26
    LengthIndex2 = Size600to620U
    FishProb = AgeLengthKey(p_age0, p_age1, p_age2, p_age3, p_age4, p_age5 $
      , p_age6, p_age7, p_age8, p_age9, p_age10, p_age11, p_age12 $
      , p_age13, p_age14, p_age15, p_age16, p_age17, p_age18, p_age19 $
      , p_age20, p_age21, p_age22, p_age23, p_age24, p_age25 $
      , p_age26, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthIndex2]] $
      , unknown[LengthIndex2], FishProb, FishAge[unknown[LengthIndex2]] $
      , LoopIndex1)
    length_meanU[10:36, LoopIndex2+LengthIndex1] = AgeAssignU[0, *]
    length_binU[10:36, LoopIndex2+LengthIndex1] = AgeAssignU[1, *]
    ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
    AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[unknown[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
    FishAge[unknown[LengthIndex2]] = AgeAssignIndU[0,*]
    FishLength[unknown[LengthIndex2]] = AgeAssignIndU[1,*]
  ENDIF
  IF Size620to640Ucount GT 0 THEN BEGIN
    LengthIndex1 = 27
    LengthIndex2 = Size620to640U
    FishProb = AgeLengthKey(p_age0, p_age1, p_age2, p_age3, p_age4, p_age5 $
      , p_age6, p_age7, p_age8, p_age9, p_age10, p_age11, p_age12 $
      , p_age13, p_age14, p_age15, p_age16, p_age17, p_age18, p_age19 $
      , p_age20, p_age21, p_age22, p_age23, p_age24, p_age25 $
      , p_age26, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb

    AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthIndex2]] $
      , unknown[LengthIndex2], FishProb, FishAge[unknown[LengthIndex2]] $
      , LoopIndex1)
    length_meanU[10:36, LoopIndex2+LengthIndex1] = AgeAssignU[0, *]
    length_binU[10:36, LoopIndex2+LengthIndex1] = AgeAssignU[1, *]
    ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
    AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[unknown[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
    FishAge[unknown[LengthIndex2]] = AgeAssignIndU[0,*]
    FishLength[unknown[LengthIndex2]] = AgeAssignIndU[1,*]
  ENDIF
  IF Size640to660Ucount GT 0 THEN BEGIN
    LengthIndex1 = 28
    LengthIndex2 = Size640to660U
    FishProb = AgeLengthKey(p_age0, p_age1, p_age2, p_age3, p_age4, p_age5 $
      , p_age6, p_age7, p_age8, p_age9, p_age10, p_age11, p_age12 $
      , p_age13, p_age14, p_age15, p_age16, p_age17, p_age18, p_age19 $
      , p_age20, p_age21, p_age22, p_age23, p_age24, p_age25 $
      , p_age26, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb

    AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthIndex2]] $
      , unknown[LengthIndex2], FishProb, FishAge[unknown[LengthIndex2]] $
      , LoopIndex1)
    length_meanU[10:36, LoopIndex2+LengthIndex1] = AgeAssignU[0, *]
    length_binU[10:36, LoopIndex2+LengthIndex1] = AgeAssignU[1, *]
    ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
    AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[unknown[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
    FishAge[unknown[LengthIndex2]] = AgeAssignIndU[0,*]
    FishLength[unknown[LengthIndex2]] = AgeAssignIndU[1,*]
  ENDIF
  IF Size660to680Ucount GT 0 THEN BEGIN
    LengthIndex1 = 29
    LengthIndex2 = Size660to680U
    FishProb = AgeLengthKey(p_age0, p_age1, p_age2, p_age3, p_age4, p_age5 $
      , p_age6, p_age7, p_age8, p_age9, p_age10, p_age11, p_age12 $
      , p_age13, p_age14, p_age15, p_age16, p_age17, p_age18, p_age19 $
      , p_age20, p_age21, p_age22, p_age23, p_age24, p_age25 $
      , p_age26, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthIndex2]] $
      , unknown[LengthIndex2], FishProb, FishAge[unknown[LengthIndex2]] $
      , LoopIndex1)
    length_meanU[10:36, LoopIndex2+LengthIndex1] = AgeAssignU[0, *]
    length_binU[10:36, LoopIndex2+LengthIndex1] = AgeAssignU[1, *]
    ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
    AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[unknown[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
    FishAge[unknown[LengthIndex2]] = AgeAssignIndU[0,*]
    FishLength[unknown[LengthIndex2]] = AgeAssignIndU[1,*]
  ENDIF
  IF Size680to700Ucount GT 0 THEN BEGIN
    LengthIndex1 = 30
    LengthIndex2 = Size680to700U
    FishProb = AgeLengthKey(p_age0, p_age1, p_age2, p_age3, p_age4, p_age5 $
      , p_age6, p_age7, p_age8, p_age9, p_age10, p_age11, p_age12 $
      , p_age13, p_age14, p_age15, p_age16, p_age17, p_age18, p_age19 $
      , p_age20, p_age21, p_age22, p_age23, p_age24, p_age25 $
      , p_age26, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthIndex2]] $
      , unknown[LengthIndex2], FishProb, FishAge[unknown[LengthIndex2]] $
      , LoopIndex1)
    length_meanU[10:36, LoopIndex2+LengthIndex1] = AgeAssignU[0, *]
    length_binU[10:36, LoopIndex2+LengthIndex1] = AgeAssignU[1, *]
    ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
    AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[unknown[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
    FishAge[unknown[LengthIndex2]] = AgeAssignIndU[0,*]
    FishLength[unknown[LengthIndex2]] = AgeAssignIndU[1,*]
  ENDIF
  IF Size700to720Ucount GT 0 THEN BEGIN
    LengthIndex1 = 31
    LengthIndex2 = Size700to720U
    FishProb = AgeLengthKey(p_age0, p_age1, p_age2, p_age3, p_age4, p_age5 $
      , p_age6, p_age7, p_age8, p_age9, p_age10, p_age11, p_age12 $
      , p_age13, p_age14, p_age15, p_age16, p_age17, p_age18, p_age19 $
      , p_age20, p_age21, p_age22, p_age23, p_age24, p_age25 $
      , p_age26, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthIndex2]] $
      , unknown[LengthIndex2], FishProb, FishAge[unknown[LengthIndex2]] $
      , LoopIndex1)
    length_meanU[10:36, LoopIndex2+LengthIndex1] = AgeAssignU[0, *]
    length_binU[10:36, LoopIndex2+LengthIndex1] = AgeAssignU[1, *]
    ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
    AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[unknown[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
    FishAge[unknown[LengthIndex2]] = AgeAssignIndU[0,*]
    FishLength[unknown[LengthIndex2]] = AgeAssignIndU[1,*]
  ENDIF
  IF Size720to740Ucount GT 0 THEN BEGIN
    LengthIndex1 = 32
    LengthIndex2 = Size720to740U
    FishProb = AgeLengthKey(p_age0, p_age1, p_age2, p_age3, p_age4, p_age5 $
      , p_age6, p_age7, p_age8, p_age9, p_age10, p_age11, p_age12 $
      , p_age13, p_age14, p_age15, p_age16, p_age17, p_age18, p_age19 $
      , p_age20, p_age21, p_age22, p_age23, p_age24, p_age25 $
      , p_age26, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb

    AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthIndex2]] $
      , unknown[LengthIndex2], FishProb, FishAge[unknown[LengthIndex2]] $
      , LoopIndex1)
    length_meanU[10:36, LoopIndex2+LengthIndex1] = AgeAssignU[0, *]
    length_binU[10:36, LoopIndex2+LengthIndex1] = AgeAssignU[1, *]
    ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
    AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[unknown[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
    FishAge[unknown[LengthIndex2]] = AgeAssignIndU[0,*]
    FishLength[unknown[LengthIndex2]] = AgeAssignIndU[1,*]
  ENDIF
  IF Size740to760Ucount GT 0 THEN BEGIN
    LengthIndex1 = 33
    LengthIndex2 = Size740to760U
    FishProb = AgeLengthKey(p_age0, p_age1, p_age2, p_age3, p_age4, p_age5 $
      , p_age6, p_age7, p_age8, p_age9, p_age10, p_age11, p_age12 $
      , p_age13, p_age14, p_age15, p_age16, p_age17, p_age18, p_age19 $
      , p_age20, p_age21, p_age22, p_age23, p_age24, p_age25 $
      , p_age26, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthIndex2]] $
      , unknown[LengthIndex2], FishProb, FishAge[unknown[LengthIndex2]] $
      , LoopIndex1)
    length_meanU[10:36, LoopIndex2+LengthIndex1] = AgeAssignU[0, *]
    length_binU[10:36, LoopIndex2+LengthIndex1] = AgeAssignU[1, *]
    ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
    AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[unknown[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
    FishAge[unknown[LengthIndex2]] = AgeAssignIndU[0,*]
    FishLength[unknown[LengthIndex2]] = AgeAssignIndU[1,*]
  ENDIF
  IF Size760to780Ucount GT 0 THEN BEGIN
    LengthIndex1 = 34
    LengthIndex2 = Size760to780U
    FishProb = AgeLengthKey(p_age0, p_age1, p_age2, p_age3, p_age4, p_age5 $
      , p_age6, p_age7, p_age8, p_age9, p_age10, p_age11, p_age12 $
      , p_age13, p_age14, p_age15, p_age16, p_age17, p_age18, p_age19 $
      , p_age20, p_age21, p_age22, p_age23, p_age24, p_age25 $
      , p_age26, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthIndex2]] $
      , unknown[LengthIndex2], FishProb, FishAge[unknown[LengthIndex2]] $
      , LoopIndex1)
    length_meanU[10:36, LoopIndex2+LengthIndex1] = AgeAssignU[0, *]
    length_binU[10:36, LoopIndex2+LengthIndex1] = AgeAssignU[1, *]
    ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
    AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[unknown[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
    FishAge[unknown[LengthIndex2]] = AgeAssignIndU[0,*]
    FishLength[unknown[LengthIndex2]] = AgeAssignIndU[1,*]
  ENDIF
  IF Size780to800Ucount GT 0 THEN BEGIN
    LengthIndex1 = 35
    LengthIndex2 = Size780to800U
    FishProb = AgeLengthKey(p_age0, p_age1, p_age2, p_age3, p_age4, p_age5 $
      , p_age6, p_age7, p_age8, p_age9, p_age10, p_age11, p_age12 $
      , p_age13, p_age14, p_age15, p_age16, p_age17, p_age18, p_age19 $
      , p_age20, p_age21, p_age22, p_age23, p_age24, p_age25 $
      , p_age26, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthIndex2]] $
      , unknown[LengthIndex2], FishProb, FishAge[unknown[LengthIndex2]] $
      , LoopIndex1)
    length_meanU[10:36, LoopIndex2+LengthIndex1] = AgeAssignU[0, *]
    length_binU[10:36, LoopIndex2+LengthIndex1] = AgeAssignU[1, *]
    ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
    AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[unknown[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
    FishAge[unknown[LengthIndex2]] = AgeAssignIndU[0,*]
    FishLength[unknown[LengthIndex2]] = AgeAssignIndU[1,*]
  ENDIF
  IF Sizege800Ucount GT 0 THEN BEGIN
    LengthIndex1 = 36
    LengthIndex2 = SizeGE800U
    FishProb = AgeLengthKey(p_age0, p_age1, p_age2, p_age3, p_age4, p_age5 $
      , p_age6, p_age7, p_age8, p_age9, p_age10, p_age11, p_age12 $
      , p_age13, p_age14, p_age15, p_age16, p_age17, p_age18, p_age19 $
      , p_age20, p_age21, p_age22, p_age23, p_age24, p_age25 $
      , p_age26, INDEX_lengthdata2, LengthIndex1)
    ;PRINT, 'FishProb', FishProb
    AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthIndex2]] $
      , unknown[LengthIndex2], FishProb, FishAge[unknown[LengthIndex2]] $
      , LoopIndex1)
    length_meanU[10:36, LoopIndex2+LengthIndex1] = AgeAssignU[0, *]
    length_binU[10:36, LoopIndex2+LengthIndex1] = AgeAssignU[1, *]
    ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
    AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthIndex2]] $
      , LengthIndex2, FishProb, FishAge[unknown[LengthIndex2]] $
      , LoopIndex1)
    ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
    FishAge[unknown[LengthIndex2]] = AgeAssignIndU[0,*]
    FishLength[unknown[LengthIndex2]] = AgeAssignIndU[1,*]
  ENDIF
  
  ; mean age of stock (age>3)
  Age3plus = WHERE(FishAge GE 3, Age3plusCOUNT)
  IF Age3plusCOUNT GT 0 THEN BEGIN
    paramset[225, i] = MEAN(FishAge[Age3plus]); mean age for all fish
    paramset[226, i] = STDDEV(FishAge[Age3plus]); SD age for all fish
  ENDIF
  Age3Mplus = WHERE(FishAge[male] GE 3, Age3MplusCOUNT)
  IF Age3MplusCOUNT GT 0 THEN BEGIN
    paramset[227, i] = MEAN(FishAge[male[Age3Mplus]]); mean age for males
    paramset[228, i] = STDDEV(FishAge[male[Age3Mplus]]); SD age for males
  ENDIF
  Age3Fplus = WHERE(FishAge[female] GE 3, Age3FplusCOUNT)
  IF Age3FplusCOUNT GT 0 THEN BEGIN
    paramset[229, i] = MEAN(FishAge[female[Age3Fplus]]); mean age for females
    paramset[230, i] = STDDEV(FishAge[female[Age3Fplus]]); SD age for females
  ENDIF

  ; Summary estimated age distribution data - SPRING SURVEY
  ; Allocate estimated age data to an array - ALL FISH
  Total_N_ageclass = fltarr(27L, 2L); all
  Total_N_ageclass[0, 0] = TOTAL(length_bin[10, LoopIndex2:LoopIndex2+36L]); age 0
  Total_N_ageclass[1, 0] = TOTAL(length_bin[11, LoopIndex2:LoopIndex2+36L]); age 1
  Total_N_ageclass[2, 0] = TOTAL(length_bin[12, LoopIndex2:LoopIndex2+36L]); age 2
  Total_N_ageclass[3, 0] = TOTAL(length_bin[13, LoopIndex2:LoopIndex2+36L]); age 3
  Total_N_ageclass[4, 0] = TOTAL(length_bin[14, LoopIndex2:LoopIndex2+36L]); age 4
  Total_N_ageclass[5, 0] = TOTAL(length_bin[15, LoopIndex2:LoopIndex2+36L]); age 5
  Total_N_ageclass[6, 0] = TOTAL(length_bin[16, LoopIndex2:LoopIndex2+36L]); age 6
  Total_N_ageclass[7, 0] = TOTAL(length_bin[17, LoopIndex2:LoopIndex2+36L]); age 7
  Total_N_ageclass[8, 0] = TOTAL(length_bin[18, LoopIndex2:LoopIndex2+36L]); age 8
  Total_N_ageclass[9, 0] = TOTAL(length_bin[19, LoopIndex2:LoopIndex2+36L]); age 9
  Total_N_ageclass[10, 0] = TOTAL(length_bin[20, LoopIndex2:LoopIndex2+36L]); age 10
  Total_N_ageclass[11, 0] = TOTAL(length_bin[21, LoopIndex2:LoopIndex2+36L]); age 11
  Total_N_ageclass[12, 0] = TOTAL(length_bin[22, LoopIndex2:LoopIndex2+36L]); age 12
  Total_N_ageclass[13, 0] = TOTAL(length_bin[23, LoopIndex2:LoopIndex2+36L]); age 13
  Total_N_ageclass[14, 0] = TOTAL(length_bin[24, LoopIndex2:LoopIndex2+36L]); age 14
  Total_N_ageclass[15, 0] = TOTAL(length_bin[25, LoopIndex2:LoopIndex2+36L]); age 15
  Total_N_ageclass[16, 0] = TOTAL(length_bin[26, LoopIndex2:LoopIndex2+36L]); age 16
  Total_N_ageclass[17, 0] = TOTAL(length_bin[27, LoopIndex2:LoopIndex2+36L]); age 17
  Total_N_ageclass[18, 0] = TOTAL(length_bin[28, LoopIndex2:LoopIndex2+36L]); age 18
  Total_N_ageclass[19, 0] = TOTAL(length_bin[29, LoopIndex2:LoopIndex2+36L]); age 19
  Total_N_ageclass[20, 0] = TOTAL(length_bin[30, LoopIndex2:LoopIndex2+36L]); age 20
  Total_N_ageclass[21, 0] = TOTAL(length_bin[31, LoopIndex2:LoopIndex2+36L]); age 21
  Total_N_ageclass[22, 0] = TOTAL(length_bin[32, LoopIndex2:LoopIndex2+36L]); age 22
  Total_N_ageclass[23, 0] = TOTAL(length_bin[33, LoopIndex2:LoopIndex2+36L]); age 23
  Total_N_ageclass[24, 0] = TOTAL(length_bin[34, LoopIndex2:LoopIndex2+36L]); age 24
  Total_N_ageclass[25, 0] = TOTAL(length_bin[35, LoopIndex2:LoopIndex2+36L]); age 25
  Total_N_ageclass[26, 0] = TOTAL(length_bin[36, LoopIndex2:LoopIndex2+36L]); age 26
  PRINT, 'Derived age distribution for all fish'
  PRINT, Total_N_ageclass[*, 0]
  PRINT, 'Total number of all fish', TOTAL(Total_N_ageclass[*, 0])

  ; Identify the number of age classes in the data set
  NumAgeClass = WHERE(Total_N_ageclass[*, 0] GT 0, NumAgeClasscount)
  paramset[213, i] = NumAgeClasscount
  PRINT, 'Number of age classes', NumAgeClasscount
  paramset[216, i] = MAX(NumAgeClass)
  PRINT, 'Maximum age classes', MAX(NumAgeClass)

  ; Identify the peak age class (age >3) used for estimating mortality rates with catch curves
  PeakAgeClass = WHERE(Total_N_ageclass[*, 0] EQ MAX(Total_N_ageclass[3:26, 0]), PeakAgeClasscount)
  PRINT, 'Peak age of fully recruited to fishery', PeakAgeClass
  PeakAgeClassLimit = where(PeakAgeClass GE 3, PeakAgeClassLimitcount)
  IF PeakAgeClassLimitcount GT 0 THEN paramset[214, i] = MIN(PeakAgeClass[PeakAgeClassLimit]) $
  ELSE paramset[214, i] = -1
  PRINT, 'Initial age of fully recruited to fishery', PeakAgeClass

  Total_N_ageclass2 = fltarr(27L, 4L); all
  print, 'FishAge[*]', n_elements(FishAge[INDEX_lengthdata2])
  print, 'FishAge[*]', (FishAge[INDEX_lengthdata2])

  age0Num = where(FishAge[*] EQ 0, age0Numcount)
  age1Num = where(FishAge[*] EQ 1, age1Numcount)
  age2Num = where(FishAge[*] EQ 2, age2Numcount)
  age3Num = where(FishAge[*] EQ 3, age3Numcount)
  age4Num = where(FishAge[*] EQ 4, age4Numcount)
  age5Num = where(FishAge[*] EQ 5, age5Numcount)
  age6Num = where(FishAge[*] EQ 6, age6Numcount)
  age7Num = where(FishAge[*] EQ 7, age7Numcount)
  age8Num = where(FishAge[*] EQ 8, age8Numcount)
  age9Num = where(FishAge[*] EQ 9, age9Numcount)
  age10Num = where(FishAge[*] EQ 10, age10Numcount)
  age11Num = where(FishAge[*] EQ 11, age11Numcount)
  age12Num = where(FishAge[*] EQ 12, age12Numcount)
  age13Num = where(FishAge[*] EQ 13, age13Numcount)
  age14Num = where(FishAge[*] EQ 14, age14Numcount)
  age15Num = where(FishAge[*] EQ 15, age15Numcount)
  age16Num = where(FishAge[*] EQ 16, age16Numcount)
  age17Num = where(FishAge[*] EQ 17, age17Numcount)
  age18Num = where(FishAge[*] EQ 18, age18Numcount)
  age19Num = where(FishAge[*] EQ 19, age19Numcount)
  age20Num = where(FishAge[*] EQ 20, age20Numcount)
  age21Num = where(FishAge[*] EQ 21, age21Numcount)
  age22Num = where(FishAge[*] EQ 22, age22Numcount)
  age23Num = where(FishAge[*] EQ 23, age23Numcount)
  age24Num = where(FishAge[*] EQ 24, age24Numcount)
  age25Num = where(FishAge[*] EQ 25, age25Numcount)
  age26Num = where(FishAge[*] EQ 26, age26Numcount)
  IF age0Numcount GT 0 THEN Total_N_ageclass2[0, 0] = age0Numcount
  IF age1Numcount GT 0 THEN Total_N_ageclass2[1, 0] = age1Numcount
  IF age2Numcount GT 0 THEN Total_N_ageclass2[2, 0] = age2Numcount
  IF age3Numcount GT 0 THEN Total_N_ageclass2[3, 0] = age3Numcount
  IF age4Numcount GT 0 THEN Total_N_ageclass2[4, 0] = age4Numcount
  IF age5Numcount GT 0 THEN Total_N_ageclass2[5, 0] = age5Numcount
  IF age6Numcount GT 0 THEN Total_N_ageclass2[6, 0] = age6Numcount
  IF age7Numcount GT 0 THEN Total_N_ageclass2[7, 0] = age7Numcount
  IF age8Numcount GT 0 THEN Total_N_ageclass2[8, 0] = age8Numcount
  IF age9Numcount GT 0 THEN Total_N_ageclass2[9, 0] = age9Numcount
  IF age10Numcount GT 0 THEN Total_N_ageclass2[10, 0] = age10Numcount
  IF age11Numcount GT 0 THEN Total_N_ageclass2[11, 0] = age11Numcount
  IF age12Numcount GT 0 THEN Total_N_ageclass2[12, 0] = age12Numcount
  IF age13Numcount GT 0 THEN Total_N_ageclass2[13, 0] = age13Numcount
  IF age14Numcount GT 0 THEN Total_N_ageclass2[14, 0] = age14Numcount
  IF age15Numcount GT 0 THEN Total_N_ageclass2[15, 0] = age15Numcount
  IF age16Numcount GT 0 THEN Total_N_ageclass2[16, 0] = age16Numcount
  IF age17Numcount GT 0 THEN Total_N_ageclass2[17, 0] = age17Numcount
  IF age18Numcount GT 0 THEN Total_N_ageclass2[18, 0] = age18Numcount
  IF age19Numcount GT 0 THEN Total_N_ageclass2[19, 0] = age19Numcount
  IF age20Numcount GT 0 THEN Total_N_ageclass2[20, 0] = age20Numcount
  IF age21Numcount GT 0 THEN Total_N_ageclass2[21, 0] = age21Numcount
  IF age22Numcount GT 0 THEN Total_N_ageclass2[22, 0] = age22Numcount
  IF age23Numcount GT 0 THEN Total_N_ageclass2[23, 0] = age23Numcount
  IF age24Numcount GT 0 THEN Total_N_ageclass2[24, 0] = age24Numcount
  IF age25Numcount GT 0 THEN Total_N_ageclass2[25, 0] = age25Numcount
  IF age26Numcount GT 0 THEN Total_N_ageclass2[26, 0] = age26Numcount
  PRINT, 'Derived age distribution for all fish (individual-based)'
  PRINT, Total_N_ageclass2[*, 0]
  PRINT, 'Total number of all fish (INDIVIDUAL-BASED)', total(Total_N_ageclass2[*, 0])

  ; allocate estimated age data to an array - MALES
  Male_N_ageclass = fltarr(27L, 2L); all
  Male_N_ageclass[0, 0] = TOTAL(length_binM[10, LoopIndex2:LoopIndex2+36L]); age 0
  Male_N_ageclass[1, 0] = TOTAL(length_binM[11, LoopIndex2:LoopIndex2+36L]); age 1
  Male_N_ageclass[2, 0] = TOTAL(length_binM[12, LoopIndex2:LoopIndex2+36L]); age 2
  Male_N_ageclass[3, 0] = TOTAL(length_binM[13, LoopIndex2:LoopIndex2+36L]); age 3
  Male_N_ageclass[4, 0] = TOTAL(length_binM[14, LoopIndex2:LoopIndex2+36L]); age 4
  Male_N_ageclass[5, 0] = TOTAL(length_binM[15, LoopIndex2:LoopIndex2+36L]); age 5
  Male_N_ageclass[6, 0] = TOTAL(length_binM[16, LoopIndex2:LoopIndex2+36L]); age 6
  Male_N_ageclass[7, 0] = TOTAL(length_binM[17, LoopIndex2:LoopIndex2+36L]); age 7
  Male_N_ageclass[8, 0] = TOTAL(length_binM[18, LoopIndex2:LoopIndex2+36L]); age 8
  Male_N_ageclass[9, 0] = TOTAL(length_binM[19, LoopIndex2:LoopIndex2+36L]); age 9
  Male_N_ageclass[10, 0] = TOTAL(length_binM[20, LoopIndex2:LoopIndex2+36L]); age 10
  Male_N_ageclass[11, 0] = TOTAL(length_binM[21, LoopIndex2:LoopIndex2+36L]); age 11
  Male_N_ageclass[12, 0] = TOTAL(length_binM[22, LoopIndex2:LoopIndex2+36L]); age 12
  Male_N_ageclass[13, 0] = TOTAL(length_binM[23, LoopIndex2:LoopIndex2+36L]); age 13
  Male_N_ageclass[14, 0] = TOTAL(length_binM[24, LoopIndex2:LoopIndex2+36L]); age 14
  Male_N_ageclass[15, 0] = TOTAL(length_binM[25, LoopIndex2:LoopIndex2+36L]); age 15
  Male_N_ageclass[16, 0] = TOTAL(length_binM[26, LoopIndex2:LoopIndex2+36L]); age 16
  Male_N_ageclass[17, 0] = TOTAL(length_binM[27, LoopIndex2:LoopIndex2+36L]); age 17
  Male_N_ageclass[18, 0] = TOTAL(length_binM[28, LoopIndex2:LoopIndex2+36L]); age 18
  Male_N_ageclass[19, 0] = TOTAL(length_binM[29, LoopIndex2:LoopIndex2+36L]); age 19
  Male_N_ageclass[20, 0] = TOTAL(length_binM[30, LoopIndex2:LoopIndex2+36L]); age 20
  Male_N_ageclass[21, 0] = TOTAL(length_binM[31, LoopIndex2:LoopIndex2+36L]); age 21
  Male_N_ageclass[22, 0] = TOTAL(length_binM[32, LoopIndex2:LoopIndex2+36L]); age 22
  Male_N_ageclass[23, 0] = TOTAL(length_binM[33, LoopIndex2:LoopIndex2+36L]); age 23
  Male_N_ageclass[24, 0] = TOTAL(length_binM[34, LoopIndex2:LoopIndex2+36L]); age 24
  Male_N_ageclass[25, 0] = TOTAL(length_binM[35, LoopIndex2:LoopIndex2+36L]); age 25
  Male_N_ageclass[26, 0] = TOTAL(length_binM[36, LoopIndex2:LoopIndex2+36L]); age 26
  PRINT, 'Derived age distribution for males'
  PRINT, Male_N_ageclass[*, 0]
  PRINT, 'Total number of males', TOTAL(Male_N_ageclass[*, 0])

  age0MNum = where(FishAge[*] EQ 0 AND Sex_prod[*] EQ 0, age0MNumcount)
  age1MNum = where(FishAge[*] EQ 1 AND Sex_prod[*] EQ 0, age1MNumcount)
  age2MNum = where(FishAge[*] EQ 2 AND Sex_prod[*] EQ 0, age2MNumcount)
  age3MNum = where(FishAge[*] EQ 3 AND Sex_prod[*] EQ 0, age3MNumcount)
  age4MNum = where(FishAge[*] EQ 4 AND Sex_prod[*] EQ 0, age4MNumcount)
  age5MNum = where(FishAge[*] EQ 5 AND Sex_prod[*] EQ 0, age5MNumcount)
  age6MNum = where(FishAge[*] EQ 6 AND Sex_prod[*] EQ 0, age6MNumcount)
  age7MNum = where(FishAge[*] EQ 7 AND Sex_prod[*] EQ 0, age7MNumcount)
  age8MNum = where(FishAge[*] EQ 8 AND Sex_prod[*] EQ 0, age8MNumcount)
  age9MNum = where(FishAge[*] EQ 9 AND Sex_prod[*] EQ 0, age9MNumcount)
  age10MNum = where(FishAge[*] EQ 10 AND Sex_prod[*] EQ 0, age10MNumcount)
  age11MNum = where(FishAge[*] EQ 11 AND Sex_prod[*] EQ 0, age11MNumcount)
  age12MNum = where(FishAge[*] EQ 12 AND Sex_prod[*] EQ 0, age12MNumcount)
  age13MNum = where(FishAge[*] EQ 13 AND Sex_prod[*] EQ 0, age13MNumcount)
  age14MNum = where(FishAge[*] EQ 14 AND Sex_prod[*] EQ 0, age14MNumcount)
  age15MNum = where(FishAge[*] EQ 15 AND Sex_prod[*] EQ 0, age15MNumcount)
  age16MNum = where(FishAge[*] EQ 16 AND Sex_prod[*] EQ 0, age16MNumcount)
  age17MNum = where(FishAge[*] EQ 17 AND Sex_prod[*] EQ 0, age17MNumcount)
  age18MNum = where(FishAge[*] EQ 18 AND Sex_prod[*] EQ 0, age18MNumcount)
  age19MNum = where(FishAge[*] EQ 19 AND Sex_prod[*] EQ 0, age19MNumcount)
  age20MNum = where(FishAge[*] EQ 20 AND Sex_prod[*] EQ 0, age20MNumcount)
  age21MNum = where(FishAge[*] EQ 21 AND Sex_prod[*] EQ 0, age21MNumcount)
  age22MNum = where(FishAge[*] EQ 22 AND Sex_prod[*] EQ 0, age22MNumcount)
  age23MNum = where(FishAge[*] EQ 23 AND Sex_prod[*] EQ 0, age23MNumcount)
  age24MNum = where(FishAge[*] EQ 24 AND Sex_prod[*] EQ 0, age24MNumcount)
  age25MNum = where(FishAge[*] EQ 25 AND Sex_prod[*] EQ 0, age25MNumcount)
  age26MNum = where(FishAge[*] EQ 26 AND Sex_prod[*] EQ 0, age26MNumcount)
  IF age0MNumcount GT 0 THEN Total_N_ageclass2[0, 1] = age0MNumcount
  IF age1MNumcount GT 0 THEN Total_N_ageclass2[1, 1] = age1MNumcount
  IF age2MNumcount GT 0 THEN Total_N_ageclass2[2, 1] = age2MNumcount
  IF age3MNumcount GT 0 THEN Total_N_ageclass2[3, 1] = age3MNumcount
  IF age4MNumcount GT 0 THEN Total_N_ageclass2[4, 1] = age4MNumcount
  IF age5MNumcount GT 0 THEN Total_N_ageclass2[5, 1] = age5MNumcount
  IF age6MNumcount GT 0 THEN Total_N_ageclass2[6, 1] = age6MNumcount
  IF age7MNumcount GT 0 THEN Total_N_ageclass2[7, 1] = age7MNumcount
  IF age8MNumcount GT 0 THEN Total_N_ageclass2[8, 1] = age8MNumcount
  IF age9MNumcount GT 0 THEN Total_N_ageclass2[9, 1] = age9MNumcount
  IF age10MNumcount GT 0 THEN Total_N_ageclass2[10, 1] = age10MNumcount
  IF age11MNumcount GT 0 THEN Total_N_ageclass2[11, 1] = age11MNumcount
  IF age12MNumcount GT 0 THEN Total_N_ageclass2[12, 1] = age12MNumcount
  IF age13MNumcount GT 0 THEN Total_N_ageclass2[13, 1] = age13MNumcount
  IF age14MNumcount GT 0 THEN Total_N_ageclass2[14, 1] = age14MNumcount
  IF age15MNumcount GT 0 THEN Total_N_ageclass2[15, 1] = age15MNumcount
  IF age16MNumcount GT 0 THEN Total_N_ageclass2[16, 1] = age16MNumcount
  IF age17MNumcount GT 0 THEN Total_N_ageclass2[17, 1] = age17MNumcount
  IF age18MNumcount GT 0 THEN Total_N_ageclass2[18, 1] = age18MNumcount
  IF age19MNumcount GT 0 THEN Total_N_ageclass2[19, 1] = age19MNumcount
  IF age20MNumcount GT 0 THEN Total_N_ageclass2[20, 1] = age20MNumcount
  IF age21MNumcount GT 0 THEN Total_N_ageclass2[21, 1] = age21MNumcount
  IF age22MNumcount GT 0 THEN Total_N_ageclass2[22, 1] = age22MNumcount
  IF age23MNumcount GT 0 THEN Total_N_ageclass2[23, 1] = age23MNumcount
  IF age24MNumcount GT 0 THEN Total_N_ageclass2[24, 1] = age24MNumcount
  IF age25MNumcount GT 0 THEN Total_N_ageclass2[25, 1] = age25MNumcount
  IF age26MNumcount GT 0 THEN Total_N_ageclass2[26, 1] = age26MNumcount
  PRINT, 'Derived age distribution for MALES (individual-based)'
  PRINT, Total_N_ageclass2[*, 1]
  PRINT, 'Total number of MALES (INDIVIDUAL-BASED)'
  PRINT, total(Total_N_ageclass2[*, 1])

  ; allocate estimated age data to an array - FEMALES
  Female_N_ageclass = fltarr(27L, 2L); all
  Female_N_ageclass[0, 0] = TOTAL(length_binF[10, LoopIndex2:LoopIndex2+36L]); age 0
  Female_N_ageclass[1, 0] = TOTAL(length_binF[11, LoopIndex2:LoopIndex2+36L]); age 1
  Female_N_ageclass[2, 0] = TOTAL(length_binF[12, LoopIndex2:LoopIndex2+36L]); age 2
  Female_N_ageclass[3, 0] = TOTAL(length_binF[13, LoopIndex2:LoopIndex2+36L]); age 3
  Female_N_ageclass[4, 0] = TOTAL(length_binF[14, LoopIndex2:LoopIndex2+36L]); age 4
  Female_N_ageclass[5, 0] = TOTAL(length_binF[15, LoopIndex2:LoopIndex2+36L]); age 5
  Female_N_ageclass[6, 0] = TOTAL(length_binF[16, LoopIndex2:LoopIndex2+36L]); age 6
  Female_N_ageclass[7, 0] = TOTAL(length_binF[17, LoopIndex2:LoopIndex2+36L]); age 7
  Female_N_ageclass[8, 0] = TOTAL(length_binF[18, LoopIndex2:LoopIndex2+36L]); age 8
  Female_N_ageclass[9, 0] = TOTAL(length_binF[19, LoopIndex2:LoopIndex2+36L]); age 9
  Female_N_ageclass[10, 0] = TOTAL(length_binF[20, LoopIndex2:LoopIndex2+36L]); age 10
  Female_N_ageclass[11, 0] = TOTAL(length_binF[21, LoopIndex2:LoopIndex2+36L]); age 11
  Female_N_ageclass[12, 0] = TOTAL(length_binF[22, LoopIndex2:LoopIndex2+36L]); age 12
  Female_N_ageclass[13, 0] = TOTAL(length_binF[23, LoopIndex2:LoopIndex2+36L]); age 13
  Female_N_ageclass[14, 0] = TOTAL(length_binF[24, LoopIndex2:LoopIndex2+36L]); age 14
  Female_N_ageclass[15, 0] = TOTAL(length_binF[25, LoopIndex2:LoopIndex2+36L]); age 15
  Female_N_ageclass[16, 0] = TOTAL(length_binF[26, LoopIndex2:LoopIndex2+36L]); age 16
  Female_N_ageclass[17, 0] = TOTAL(length_binF[27, LoopIndex2:LoopIndex2+36L]); age 17
  Female_N_ageclass[18, 0] = TOTAL(length_binF[28, LoopIndex2:LoopIndex2+36L]); age 18
  Female_N_ageclass[19, 0] = TOTAL(length_binF[29, LoopIndex2:LoopIndex2+36L]); age 19
  Female_N_ageclass[20, 0] = TOTAL(length_binF[30, LoopIndex2:LoopIndex2+36L]); age 20
  Female_N_ageclass[21, 0] = TOTAL(length_binF[31, LoopIndex2:LoopIndex2+36L]); age 21
  Female_N_ageclass[22, 0] = TOTAL(length_binF[32, LoopIndex2:LoopIndex2+36L]); age 22
  Female_N_ageclass[23, 0] = TOTAL(length_binF[33, LoopIndex2:LoopIndex2+36L]); age 23
  Female_N_ageclass[24, 0] = TOTAL(length_binF[34, LoopIndex2:LoopIndex2+36L]); age 24
  Female_N_ageclass[25, 0] = TOTAL(length_binF[35, LoopIndex2:LoopIndex2+36L]); age 25
  Female_N_ageclass[26, 0] = TOTAL(length_binF[36, LoopIndex2:LoopIndex2+36L]); age 26
  PRINT, 'Derived age distribution for females'
  PRINT, Female_N_ageclass[*, 0]
  PRINT, 'Total number of females', total(Female_N_ageclass[*, 0])

  age0FNum = where(FishAge[*] EQ 0 AND Sex_prod[*] EQ 1, age0FNumcount)
  age1FNum = where(FishAge[*] EQ 1 AND Sex_prod[*] EQ 1, age1FNumcount)
  age2FNum = where(FishAge[*] EQ 2 AND Sex_prod[*] EQ 1, age2FNumcount)
  age3FNum = where(FishAge[*] EQ 3 AND Sex_prod[*] EQ 1, age3FNumcount)
  age4FNum = where(FishAge[*] EQ 4 AND Sex_prod[*] EQ 1, age4FNumcount)
  age5FNum = where(FishAge[*] EQ 5 AND Sex_prod[*] EQ 1, age5FNumcount)
  age6FNum = where(FishAge[*] EQ 6 AND Sex_prod[*] EQ 1, age6FNumcount)
  age7FNum = where(FishAge[*] EQ 7 AND Sex_prod[*] EQ 1, age7FNumcount)
  age8FNum = where(FishAge[*] EQ 8 AND Sex_prod[*] EQ 1, age8FNumcount)
  age9FNum = where(FishAge[*] EQ 9 AND Sex_prod[*] EQ 1, age9FNumcount)
  age10FNum = where(FishAge[*] EQ 10 AND Sex_prod[*] EQ 1, age10FNumcount)
  age11FNum = where(FishAge[*] EQ 11 AND Sex_prod[*] EQ 1, age11FNumcount)
  age12FNum = where(FishAge[*] EQ 12 AND Sex_prod[*] EQ 1, age12FNumcount)
  age13FNum = where(FishAge[*] EQ 13 AND Sex_prod[*] EQ 1, age13FNumcount)
  age14FNum = where(FishAge[*] EQ 14 AND Sex_prod[*] EQ 1, age14FNumcount)
  age15FNum = where(FishAge[*] EQ 15 AND Sex_prod[*] EQ 1, age15FNumcount)
  age16FNum = where(FishAge[*] EQ 16 AND Sex_prod[*] EQ 1, age16FNumcount)
  age17FNum = where(FishAge[*] EQ 17 AND Sex_prod[*] EQ 1, age17FNumcount)
  age18FNum = where(FishAge[*] EQ 18 AND Sex_prod[*] EQ 1, age18FNumcount)
  age19FNum = where(FishAge[*] EQ 19 AND Sex_prod[*] EQ 1, age19FNumcount)
  age20FNum = where(FishAge[*] EQ 20 AND Sex_prod[*] EQ 1, age20FNumcount)
  age21FNum = where(FishAge[*] EQ 21 AND Sex_prod[*] EQ 1, age21FNumcount)
  age22FNum = where(FishAge[*] EQ 22 AND Sex_prod[*] EQ 1, age22FNumcount)
  age23FNum = where(FishAge[*] EQ 23 AND Sex_prod[*] EQ 1, age23FNumcount)
  age24FNum = where(FishAge[*] EQ 24 AND Sex_prod[*] EQ 1, age24FNumcount)
  age25FNum = where(FishAge[*] EQ 25 AND Sex_prod[*] EQ 1, age25FNumcount)
  age26FNum = where(FishAge[*] EQ 26 AND Sex_prod[*] EQ 1, age26FNumcount)
  IF age0FNumcount GT 0 THEN Total_N_ageclass2[0, 2] = age0FNumcount
  IF age1FNumcount GT 0 THEN Total_N_ageclass2[1, 2] = age1FNumcount
  IF age2FNumcount GT 0 THEN Total_N_ageclass2[2, 2] = age2FNumcount
  IF age3FNumcount GT 0 THEN Total_N_ageclass2[3, 2] = age3FNumcount
  IF age4FNumcount GT 0 THEN Total_N_ageclass2[4, 2] = age4FNumcount
  IF age5FNumcount GT 0 THEN Total_N_ageclass2[5, 2] = age5FNumcount
  IF age6FNumcount GT 0 THEN Total_N_ageclass2[6, 2] = age6FNumcount
  IF age7FNumcount GT 0 THEN Total_N_ageclass2[7, 2] = age7FNumcount
  IF age8FNumcount GT 0 THEN Total_N_ageclass2[8, 2] = age8FNumcount
  IF age9FNumcount GT 0 THEN Total_N_ageclass2[9, 2] = age9FNumcount
  IF age10FNumcount GT 0 THEN Total_N_ageclass2[10, 2] = age10FNumcount
  IF age11FNumcount GT 0 THEN Total_N_ageclass2[11, 2] = age11FNumcount
  IF age12FNumcount GT 0 THEN Total_N_ageclass2[12, 2] = age12FNumcount
  IF age13FNumcount GT 0 THEN Total_N_ageclass2[13, 2] = age13FNumcount
  IF age14FNumcount GT 0 THEN Total_N_ageclass2[14, 2] = age14FNumcount
  IF age15FNumcount GT 0 THEN Total_N_ageclass2[15, 2] = age15FNumcount
  IF age16FNumcount GT 0 THEN Total_N_ageclass2[16, 2] = age16FNumcount
  IF age17FNumcount GT 0 THEN Total_N_ageclass2[17, 2] = age17FNumcount
  IF age18FNumcount GT 0 THEN Total_N_ageclass2[18, 2] = age18FNumcount
  IF age19FNumcount GT 0 THEN Total_N_ageclass2[19, 2] = age19FNumcount
  IF age20FNumcount GT 0 THEN Total_N_ageclass2[20, 2] = age20FNumcount
  IF age21FNumcount GT 0 THEN Total_N_ageclass2[21, 2] = age21FNumcount
  IF age22FNumcount GT 0 THEN Total_N_ageclass2[22, 2] = age22FNumcount
  IF age23FNumcount GT 0 THEN Total_N_ageclass2[23, 2] = age23FNumcount
  IF age24FNumcount GT 0 THEN Total_N_ageclass2[24, 2] = age24FNumcount
  IF age25FNumcount GT 0 THEN Total_N_ageclass2[25, 2] = age25FNumcount
  IF age26FNumcount GT 0 THEN Total_N_ageclass2[26, 2] = age26FNumcount
  PRINT, 'Derived age distribution for FEMALES (individual-based)'
  PRINT, Total_N_ageclass2[*, 2]
  PRINT, 'Total number of FEMALES (INDIVIDUAL-BASED)'
  PRINT, total(Total_N_ageclass2[*, 2])

  ; allocate estimated age data to an array - unknowns
  Unknown_N_ageclass = fltarr(27L, 2L)
  Unknown_N_ageclass[0, 0] = TOTAL(length_binU[10, LoopIndex2:LoopIndex2+36L]); age 0
  Unknown_N_ageclass[1, 0] = TOTAL(length_binU[11, LoopIndex2:LoopIndex2+36L]); age 1
  Unknown_N_ageclass[2, 0] = TOTAL(length_binU[12, LoopIndex2:LoopIndex2+36L]); age 2
  Unknown_N_ageclass[3, 0] = TOTAL(length_binU[13, LoopIndex2:LoopIndex2+36L]); age 3
  Unknown_N_ageclass[4, 0] = TOTAL(length_binU[14, LoopIndex2:LoopIndex2+36L]); age 4
  Unknown_N_ageclass[5, 0] = TOTAL(length_binU[15, LoopIndex2:LoopIndex2+36L]); age 5
  Unknown_N_ageclass[6, 0] = TOTAL(length_binU[16, LoopIndex2:LoopIndex2+36L]); age 6
  Unknown_N_ageclass[7, 0] = TOTAL(length_binU[17, LoopIndex2:LoopIndex2+36L]); age 7
  Unknown_N_ageclass[8, 0] = TOTAL(length_binU[18, LoopIndex2:LoopIndex2+36L]); age 8
  Unknown_N_ageclass[9, 0] = TOTAL(length_binU[19, LoopIndex2:LoopIndex2+36L]); age 9
  Unknown_N_ageclass[10, 0] = TOTAL(length_binU[20, LoopIndex2:LoopIndex2+36L]); age 10
  Unknown_N_ageclass[11, 0] = TOTAL(length_binU[21, LoopIndex2:LoopIndex2+36L]); age 11
  Unknown_N_ageclass[12, 0] = TOTAL(length_binU[22, LoopIndex2:LoopIndex2+36L]); age 12
  Unknown_N_ageclass[13, 0] = TOTAL(length_binU[23, LoopIndex2:LoopIndex2+36L]); age 13
  Unknown_N_ageclass[14, 0] = TOTAL(length_binU[24, LoopIndex2:LoopIndex2+36L]); age 14
  Unknown_N_ageclass[15, 0] = TOTAL(length_binU[25, LoopIndex2:LoopIndex2+36L]); age 15
  Unknown_N_ageclass[16, 0] = TOTAL(length_binU[26, LoopIndex2:LoopIndex2+36L]); age 16
  Unknown_N_ageclass[17, 0] = TOTAL(length_binU[27, LoopIndex2:LoopIndex2+36L]); age 17
  Unknown_N_ageclass[18, 0] = TOTAL(length_binU[28, LoopIndex2:LoopIndex2+36L]); age 18
  Unknown_N_ageclass[19, 0] = TOTAL(length_binU[29, LoopIndex2:LoopIndex2+36L]); age 19
  Unknown_N_ageclass[20, 0] = TOTAL(length_binU[30, LoopIndex2:LoopIndex2+36L]); age 20
  Unknown_N_ageclass[21, 0] = TOTAL(length_binU[31, LoopIndex2:LoopIndex2+36L]); age 21
  Unknown_N_ageclass[22, 0] = TOTAL(length_binU[32, LoopIndex2:LoopIndex2+36L]); age 22
  Unknown_N_ageclass[23, 0] = TOTAL(length_binU[33, LoopIndex2:LoopIndex2+36L]); age 23
  Unknown_N_ageclass[24, 0] = TOTAL(length_binU[34, LoopIndex2:LoopIndex2+36L]); age 24
  Unknown_N_ageclass[25, 0] = TOTAL(length_binU[35, LoopIndex2:LoopIndex2+36L]); age 25
  Unknown_N_ageclass[26, 0] = TOTAL(length_binU[36, LoopIndex2:LoopIndex2+36L]); age 26
  PRINT, 'Derived age distribution for unknowns'
  PRINT, Unknown_N_ageclass[*, 0]
  PRINT, 'Total number of unknowns', total(Unknown_N_ageclass[*, 0])
  age0UNum = where(FishAge[*] EQ 0 AND Sex_prod[*] EQ 2, age0UNumcount)
  age1UNum = where(FishAge[*] EQ 1 AND Sex_prod[*] EQ 2, age1UNumcount)
  age2UNum = where(FishAge[*] EQ 2 AND Sex_prod[*] EQ 2, age2UNumcount)
  age3UNum = where(FishAge[*] EQ 3 AND Sex_prod[*] EQ 2, age3UNumcount)
  age4UNum = where(FishAge[*] EQ 4 AND Sex_prod[*] EQ 2, age4UNumcount)
  age5UNum = where(FishAge[*] EQ 5 AND Sex_prod[*] EQ 2, age5UNumcount)
  age6UNum = where(FishAge[*] EQ 6 AND Sex_prod[*] EQ 2, age6UNumcount)
  age7UNum = where(FishAge[*] EQ 7 AND Sex_prod[*] EQ 2, age7UNumcount)
  age8UNum = where(FishAge[*] EQ 8 AND Sex_prod[*] EQ 2, age8UNumcount)
  age9UNum = where(FishAge[*] EQ 9 AND Sex_prod[*] EQ 2, age9UNumcount)
  age10UNum = where(FishAge[*] EQ 10 AND Sex_prod[*] EQ 2, age10UNumcount)
  age11UNum = where(FishAge[*] EQ 11 AND Sex_prod[*] EQ 2, age11UNumcount)
  age12UNum = where(FishAge[*] EQ 12 AND Sex_prod[*] EQ 2, age12UNumcount)
  age13UNum = where(FishAge[*] EQ 13 AND Sex_prod[*] EQ 2, age13UNumcount)
  age14UNum = where(FishAge[*] EQ 14 AND Sex_prod[*] EQ 2, age14UNumcount)
  age15UNum = where(FishAge[*] EQ 15 AND Sex_prod[*] EQ 2, age15UNumcount)
  age16UNum = where(FishAge[*] EQ 16 AND Sex_prod[*] EQ 2, age16UNumcount)
  age17UNum = where(FishAge[*] EQ 17 AND Sex_prod[*] EQ 2, age17UNumcount)
  age18UNum = where(FishAge[*] EQ 18 AND Sex_prod[*] EQ 2, age18UNumcount)
  age19UNum = where(FishAge[*] EQ 19 AND Sex_prod[*] EQ 2, age19UNumcount)
  age20UNum = where(FishAge[*] EQ 20 AND Sex_prod[*] EQ 2, age20UNumcount)
  age21UNum = where(FishAge[*] EQ 21 AND Sex_prod[*] EQ 2, age21UNumcount)
  age22UNum = where(FishAge[*] EQ 22 AND Sex_prod[*] EQ 2, age22UNumcount)
  age23UNum = where(FishAge[*] EQ 23 AND Sex_prod[*] EQ 2, age23UNumcount)
  age24UNum = where(FishAge[*] EQ 24 AND Sex_prod[*] EQ 2, age24UNumcount)
  age25UNum = where(FishAge[*] EQ 25 AND Sex_prod[*] EQ 2, age25UNumcount)
  age26UNum = where(FishAge[*] EQ 26 AND Sex_prod[*] EQ 2, age26UNumcount)
  IF age0UNumcount GT 0 THEN Total_N_ageclass2[0, 3] = age0UNumcount
  IF age1UNumcount GT 0 THEN Total_N_ageclass2[1, 3] = age1UNumcount
  IF age2UNumcount GT 0 THEN Total_N_ageclass2[2, 3] = age2UNumcount
  IF age3UNumcount GT 0 THEN Total_N_ageclass2[3, 3] = age3UNumcount
  IF age4UNumcount GT 0 THEN Total_N_ageclass2[4, 3] = age4UNumcount
  IF age5UNumcount GT 0 THEN Total_N_ageclass2[5, 3] = age5UNumcount
  IF age6UNumcount GT 0 THEN Total_N_ageclass2[6, 3] = age6UNumcount
  IF age7UNumcount GT 0 THEN Total_N_ageclass2[7, 3] = age7UNumcount
  IF age8UNumcount GT 0 THEN Total_N_ageclass2[8, 3] = age8UNumcount
  IF age9UNumcount GT 0 THEN Total_N_ageclass2[9, 3] = age9UNumcount
  IF age10UNumcount GT 0 THEN Total_N_ageclass2[10, 3] = age10UNumcount
  IF age11UNumcount GT 0 THEN Total_N_ageclass2[11, 3] = age11UNumcount
  IF age12UNumcount GT 0 THEN Total_N_ageclass2[12, 3] = age12UNumcount
  IF age13UNumcount GT 0 THEN Total_N_ageclass2[13, 3] = age13UNumcount
  IF age14UNumcount GT 0 THEN Total_N_ageclass2[14, 3] = age14UNumcount
  IF age15UNumcount GT 0 THEN Total_N_ageclass2[15, 3] = age15UNumcount
  IF age16UNumcount GT 0 THEN Total_N_ageclass2[16, 3] = age16UNumcount
  IF age17UNumcount GT 0 THEN Total_N_ageclass2[17, 3] = age17UNumcount
  IF age18UNumcount GT 0 THEN Total_N_ageclass2[18, 3] = age18UNumcount
  IF age19UNumcount GT 0 THEN Total_N_ageclass2[19, 3] = age19UNumcount
  IF age20UNumcount GT 0 THEN Total_N_ageclass2[20, 3] = age20UNumcount
  IF age21UNumcount GT 0 THEN Total_N_ageclass2[21, 3] = age21UNumcount
  IF age22UNumcount GT 0 THEN Total_N_ageclass2[22, 3] = age22UNumcount
  IF age23UNumcount GT 0 THEN Total_N_ageclass2[23, 3] = age23UNumcount
  IF age24UNumcount GT 0 THEN Total_N_ageclass2[24, 3] = age24UNumcount
  IF age25UNumcount GT 0 THEN Total_N_ageclass2[25, 3] = age25UNumcount
  IF age26UNumcount GT 0 THEN Total_N_ageclass2[26, 3] = age26UNumcount
  PRINT, 'Derived age distribution for UNKNOWN (individual-based)'
  PRINT, Total_N_ageclass2[*, 3]
  PRINT, 'Total number of UNKNOWN (INDIVIDUAL-BASED)'
  PRINT, TOTAL(Total_N_ageclass2[*, 3])

  ; Estimate age structure using PE- ALL FISH
  p_ageclass = fltarr(27L, 4L)
  IF TOTAL(Total_N_ageclass[*, 0]) GT 0. THEN p_ageclass[*, 0] = Total_N_ageclass[*, 0]/TOTAL(Total_N_ageclass[*, 0])
  PRINT, 'Relative age distribution - ALL FISH'
  PRINT, p_ageclass[*, 0]
  ; Estimate age structure - MALES
  IF TOTAL(Total_N_ageclass[*, 0]) GT 0. THEN p_ageclass[*, 1] = Male_N_ageclass[*, 0]/TOTAL(Total_N_ageclass[*, 0])
  PRINT, 'Relative age distribution - MALES'
  PRINT, p_ageclass[*, 1]
  ; Estimate age structure - FEMALES
  IF TOTAL(Total_N_ageclass[*, 0]) GT 0. THEN p_ageclass[*, 2] = Female_N_ageclass[*, 0]/TOTAL(Total_N_ageclass[*, 0])
  PRINT, 'Relative age distribution - FEMALES'
  PRINT, p_ageclass[*, 2]
  ; Estimate age structure - UNKNOWNS
  IF TOTAL(Total_N_ageclass[*, 0]) GT 0. THEN p_ageclass[*, 3] = Unknown_N_ageclass[*, 0]/TOTAL(Total_N_ageclass[*, 0])
  PRINT, 'Relative age distribution - UNKNOWN'
  PRINT, p_ageclass[*, 3]

  ; Estimate age structure 2 - ALL FISH
  p_ageclass2 = fltarr(27L, 4L)
  IF TOTAL(Total_N_ageclass2[*, 0]) GT 0. THEN p_ageclass2[*, 0] = Total_N_ageclass2[*, 0]/TOTAL(Total_N_ageclass[*, 0])
  PRINT, 'Relative age distribution2 - ALL FISH'
  PRINT, p_ageclass2[*, 0]
  ; Estimate age structure - MALES
  IF TOTAL(Total_N_ageclass2[*, 0]) GT 0. THEN p_ageclass2[*, 1] = Total_N_ageclass2[*, 1]/TOTAL(Total_N_ageclass[*, 0])
  PRINT, 'Relative age distribution2 - MALES'
  PRINT, p_ageclass2[*, 1]
  ; Estimate age structure - FEMALES
  IF TOTAL(Total_N_ageclass2[*, 0]) GT 0. THEN p_ageclass2[*, 2] = Total_N_ageclass2[*, 2]/TOTAL(Total_N_ageclass[*, 0])
  PRINT, 'Relative age distribution2 - FEMALES'
  PRINT, p_ageclass2[*, 2]
  ; Estimate age structure - UNKNOWNS
  IF TOTAL(Total_N_ageclass2[*, 0]) GT 0. THEN p_ageclass2[*, 3] = Total_N_ageclass2[*, 3]/TOTAL(Total_N_ageclass[*, 0])
  PRINT, 'Relative age distribution2 - UNKNOWN'
  PRINT, p_ageclass2[*, 3]

  PRINT, 'Population estimate (PE)', PE[INDEX_lengthdata[0]]
  paramset[13:39, i] = ROUND(p_ageclass[*, 0]*PE[INDEX_lengthdata[0]])
  paramset[13, i] = YOY_PE[i]
  PRINT, 'Estimated age distribution - ALL FISH'
  PRINT, paramset[13:39, i]
  paramsetM[13:39, i] = ROUND(p_ageclass[*, 1]*PE[INDEX_lengthdata[0]])
  PRINT, 'Estimated age distribution - MALES'
  PRINT, ROUND(p_ageclass[*, 1]*PE[INDEX_lengthdata[0]])
  paramsetF[13:39, i] = ROUND(p_ageclass[*, 2]*PE[INDEX_lengthdata[0]])
  PRINT, 'Estimated age distribution - FEMALES'
  PRINT, ROUND(p_ageclass[*, 2]*PE[INDEX_lengthdata[0]])
  paramsetU[13:39, i] = ROUND(p_ageclass[*, 3]*PE[INDEX_lengthdata[0]])
  PRINT, 'Estimated age distribution - UNKNOWNS'
  PRINT, ROUND(p_ageclass[*, 3]*PE[INDEX_lengthdata[0]])

  ; Plot estimated age structure
  maleage=ROUND(p_ageclass[*, 1]*PE[INDEX_lengthdata[0]])
  femaleage=ROUND(p_ageclass[*, 2]*PE[INDEX_lengthdata[0]])
  unknownage=ROUND(p_ageclass[*, 3]*PE[INDEX_lengthdata[0]])
  unknownage[0]=YOY_PE[i]
  maleage2=ROUND(p_ageclass2[*, 1]*PE[INDEX_lengthdata[0]])
  femaleage2=ROUND(p_ageclass2[*, 2]*PE[INDEX_lengthdata[0]])
  unknownage2=ROUND(p_ageclass2[*, 3]*PE[INDEX_lengthdata[0]])
  unknownage2[0]=YOY_PE[i]

  !p.font=0
  ;Device, Set_Character_Size=[8,12]
  DEVICE, Get_Decomposed=currentState
  DEVICE, SET_FONT='Courier', /TT_FONT
  DEVICE, DECOMPOSED=0
  cgDisplay, 750, 400, WID=1
  ;!P.Multi = [0,2,1]
  labels = INDGEN(27);
  cgLoadct, 33, Clip=[10,245]
  cgBarPlot, maleage,  YRange=[0,ROUND(MAX(maleage+femaleage+unknownage))*1.3], Colors='BLUE', BarNames=labels $
    , xtitle='Age (years)' $
    , ytitle='Number of fish' $;, xrange=[0, 25]
    , title='Age structure of WI walleye - '+'WBIC: '+STRING(paramset[1, i], FORMAT = '(I7)') $
    +'_Year: '+STRING(fix(paramset[2, i]), FORMAT = '(I4)')+' PE='+STRING(PE[INDEX_lengthdata[0]], FORMAT = '(I5)')+stock
  cgBarPlot, femaleage, Colors='RED', /Overplot, BaseLines=maleage
  cgBarPlot, unknownage, Colors='dark green', /Overplot, BaseLines=maleage+femaleage
  items = ['Male', 'Female', 'Unknown']
  colors = ['BLUE', 'RED', 'dark green']
  AL_Legend, items, Colors=colors, PSym=Replicate(15,3), SymSize=Replicate(1.75,3), $
    Charsize=cgDefCharsize(), Position=[0.75, 0.85], /Normal
  filename='Walleye age structure' + STRING(paramset[1, i], FORMAT = '(I7)') $
    + '_'+STRING(fix(paramset[2, i]), FORMAT = '(I4)') + '.png'
  WRITE_PNG, filename, TVRD(/TRUE)
  DEVICE, DECOMPOSED=old_decomposed
  !p.font=1

  !p.font=0
  ;Device, Set_Character_Size=[8,12]
  DEVICE, Get_Decomposed=currentState
  DEVICE, SET_FONT='Courier', /TT_FONT
  DEVICE, DECOMPOSED=0
  cgDisplay, 750, 400, WID=1
  ;!P.Multi = [0,2,1]
  labels = INDGEN(27);
  cgLoadct, 33, Clip=[10,245]
  cgBarPlot, maleage,  YRange=[0,ROUND(MAX(maleage2+femaleage2+unknownage2))*1.3], Colors='BLUE', BarNames=labels $
    , xtitle='Age (years)' $
    , ytitle='Number of fish' $;, xrange=[0, 25]
    , title='Age structure of WI walleye2 - '+'WBIC: '+STRING(paramset[1, i], FORMAT = '(I7)') $
    +'_Year: '+STRING(fix(paramset[2, i]), FORMAT = '(I4)')+' PE='+STRING(PE[INDEX_lengthdata[0]], FORMAT = '(I5)')+stock
  cgBarPlot, femaleage, Colors='RED', /Overplot, BaseLines=maleage
  cgBarPlot, unknownage, Colors='dark green', /Overplot, BaseLines=maleage+femaleage
  items = ['Male', 'Female', 'Unknown']
  colors = ['BLUE', 'RED', 'dark green']
  AL_Legend, items, Colors=colors, PSym=Replicate(15,3), SymSize=Replicate(1.75,3), $
    Charsize=cgDefCharsize(), Position=[0.75, 0.85], /Normal
  filename='Walleye age structure2' + STRING(paramset[1, i], FORMAT = '(I7)') $
    + '_'+STRING(fix(paramset[2, i]), FORMAT = '(I4)') + '.png'
  WRITE_PNG, filename, TVRD(/TRUE)
  DEVICE, DECOMPOSED=old_decomposed
  !p.font=1

  ; Mean length-at-age from estiamted age structure (meas of mean length-at-age from each length bins) - ALL FISH
  mean_length_at_age = FLTARR(27L, 37L)
  mean_length_at_age[0, *] = (length_mean[10, LoopIndex2:LoopIndex2+36L])
  mean_length_at_age[1, *] = (length_mean[11, LoopIndex2:LoopIndex2+36L])
  mean_length_at_age[2, *] = (length_mean[12, LoopIndex2:LoopIndex2+36L])
  mean_length_at_age[3, *] = (length_mean[13, LoopIndex2:LoopIndex2+36L])
  mean_length_at_age[4, *] = (length_mean[14, LoopIndex2:LoopIndex2+36L])
  mean_length_at_age[5, *] = (length_mean[15, LoopIndex2:LoopIndex2+36L])
  mean_length_at_age[6, *] = (length_mean[16, LoopIndex2:LoopIndex2+36L])
  mean_length_at_age[7, *] = (length_mean[17, LoopIndex2:LoopIndex2+36L])
  mean_length_at_age[8, *] = (length_mean[18, LoopIndex2:LoopIndex2+36L])
  mean_length_at_age[9, *] = (length_mean[19, LoopIndex2:LoopIndex2+36L])
  mean_length_at_age[10, *] = (length_mean[20, LoopIndex2:LoopIndex2+36L])
  mean_length_at_age[11, *] = (length_mean[21, LoopIndex2:LoopIndex2+36L])
  mean_length_at_age[12, *] = (length_mean[22, LoopIndex2:LoopIndex2+36L])
  mean_length_at_age[13, *] = (length_mean[23, LoopIndex2:LoopIndex2+36L])
  mean_length_at_age[14, *] = (length_mean[24, LoopIndex2:LoopIndex2+36L])
  mean_length_at_age[15, *] = (length_mean[25, LoopIndex2:LoopIndex2+36L])
  mean_length_at_age[16, *] = (length_mean[26, LoopIndex2:LoopIndex2+36L])
  mean_length_at_age[17, *] = (length_mean[27, LoopIndex2:LoopIndex2+36L])
  mean_length_at_age[18, *] = (length_mean[28, LoopIndex2:LoopIndex2+36L])
  mean_length_at_age[19, *] = (length_mean[29, LoopIndex2:LoopIndex2+36L])
  mean_length_at_age[20, *] = (length_mean[30, LoopIndex2:LoopIndex2+36L])
  mean_length_at_age[21, *] = (length_mean[31, LoopIndex2:LoopIndex2+36L])
  mean_length_at_age[22, *] = (length_mean[32, LoopIndex2:LoopIndex2+36L])
  mean_length_at_age[23, *] = (length_mean[33, LoopIndex2:LoopIndex2+36L])
  mean_length_at_age[24, *] = (length_mean[34, LoopIndex2:LoopIndex2+36L])
  mean_length_at_age[25, *] = (length_mean[35, LoopIndex2:LoopIndex2+36L])
  mean_length_at_age[26, *] = (length_mean[36, LoopIndex2:LoopIndex2+36L])
  age0mean = where(mean_length_at_age[0, *] GT 0, age0meancount)
  age1mean = where(mean_length_at_age[1, *] GT 0, age1meancount)
  age2mean = where(mean_length_at_age[2, *] GT 0, age2meancount)
  age3mean = where(mean_length_at_age[3, *] GT 0, age3meancount)
  age4mean = where(mean_length_at_age[4, *] GT 0, age4meancount)
  age5mean = where(mean_length_at_age[5, *] GT 0, age5meancount)
  age6mean = where(mean_length_at_age[6, *] GT 0, age6meancount)
  age7mean = where(mean_length_at_age[7, *] GT 0, age7meancount)
  age8mean = where(mean_length_at_age[8, *] GT 0, age8meancount)
  age9mean = where(mean_length_at_age[9, *] GT 0, age9meancount)
  age10mean = where(mean_length_at_age[10, *] GT 0, age10meancount)
  age11mean = where(mean_length_at_age[11, *] GT 0, age11meancount)
  age12mean = where(mean_length_at_age[12, *] GT 0, age12meancount)
  age13mean = where(mean_length_at_age[13, *] GT 0, age13meancount)
  age14mean = where(mean_length_at_age[14, *] GT 0, age14meancount)
  age15mean = where(mean_length_at_age[15, *] GT 0, age15meancount)
  age16mean = where(mean_length_at_age[16, *] GT 0, age16meancount)
  age17mean = where(mean_length_at_age[17, *] GT 0, age17meancount)
  age18mean = where(mean_length_at_age[18, *] GT 0, age18meancount)
  age19mean = where(mean_length_at_age[19, *] GT 0, age19meancount)
  age20mean = where(mean_length_at_age[20, *] GT 0, age20meancount)
  age21mean = where(mean_length_at_age[21, *] GT 0, age21meancount)
  age22mean = where(mean_length_at_age[22, *] GT 0, age22meancount)
  age23mean = where(mean_length_at_age[23, *] GT 0, age23meancount)
  age24mean = where(mean_length_at_age[24, *] GT 0, age24meancount)
  age25mean = where(mean_length_at_age[25, *] GT 0, age25meancount)
  age26mean = where(mean_length_at_age[26, *] GT 0, age26meancount)
  IF age0meancount GT 0 THEN Total_N_ageclass[0, 1] = TOTAL(length_mean[10, LoopIndex2:LoopIndex2+36L])/age0meancount
  IF age1meancount GT 0 THEN Total_N_ageclass[1, 1] = TOTAL(length_mean[11, LoopIndex2:LoopIndex2+36L])/age1meancount
  IF age2meancount GT 0 THEN Total_N_ageclass[2, 1] = TOTAL(length_mean[12, LoopIndex2:LoopIndex2+36L])/age2meancount
  IF age3meancount GT 0 THEN Total_N_ageclass[3, 1] = TOTAL(length_mean[13, LoopIndex2:LoopIndex2+36L])/age3meancount
  IF age4meancount GT 0 THEN Total_N_ageclass[4, 1] = TOTAL(length_mean[14, LoopIndex2:LoopIndex2+36L])/age4meancount
  IF age5meancount GT 0 THEN Total_N_ageclass[5, 1] = TOTAL(length_mean[15, LoopIndex2:LoopIndex2+36L])/age5meancount
  IF age6meancount GT 0 THEN Total_N_ageclass[6, 1] = TOTAL(length_mean[16, LoopIndex2:LoopIndex2+36L])/age6meancount
  IF age7meancount GT 0 THEN Total_N_ageclass[7, 1] = TOTAL(length_mean[17, LoopIndex2:LoopIndex2+36L])/age7meancount
  IF age8meancount GT 0 THEN Total_N_ageclass[8, 1] = TOTAL(length_mean[18, LoopIndex2:LoopIndex2+36L])/age8meancount
  IF age9meancount GT 0 THEN Total_N_ageclass[9, 1] = TOTAL(length_mean[19, LoopIndex2:LoopIndex2+36L])/age9meancount
  IF age10meancount GT 0 THEN Total_N_ageclass[10, 1] = TOTAL(length_mean[20, LoopIndex2:LoopIndex2+36L])/age10meancount
  IF age11meancount GT 0 THEN Total_N_ageclass[11, 1] = TOTAL(length_mean[21, LoopIndex2:LoopIndex2+36L])/age11meancount
  IF age12meancount GT 0 THEN Total_N_ageclass[12, 1] = TOTAL(length_mean[22, LoopIndex2:LoopIndex2+36L])/age12meancount
  IF age13meancount GT 0 THEN Total_N_ageclass[13, 1] = TOTAL(length_mean[23, LoopIndex2:LoopIndex2+36L])/age13meancount
  IF age14meancount GT 0 THEN Total_N_ageclass[14, 1] = TOTAL(length_mean[24, LoopIndex2:LoopIndex2+36L])/age14meancount
  IF age15meancount GT 0 THEN Total_N_ageclass[15, 1] = TOTAL(length_mean[25, LoopIndex2:LoopIndex2+36L])/age15meancount
  IF age16meancount GT 0 THEN Total_N_ageclass[16, 1] = TOTAL(length_mean[26, LoopIndex2:LoopIndex2+36L])/age16meancount
  IF age17meancount GT 0 THEN Total_N_ageclass[17, 1] = TOTAL(length_mean[27, LoopIndex2:LoopIndex2+36L])/age17meancount
  IF age18meancount GT 0 THEN Total_N_ageclass[18, 1] = TOTAL(length_mean[28, LoopIndex2:LoopIndex2+36L])/age18meancount
  IF age19meancount GT 0 THEN Total_N_ageclass[19, 1] = TOTAL(length_mean[29, LoopIndex2:LoopIndex2+36L])/age19meancount
  IF age20meancount GT 0 THEN Total_N_ageclass[20, 1] = TOTAL(length_mean[30, LoopIndex2:LoopIndex2+36L])/age20meancount
  IF age21meancount GT 0 THEN Total_N_ageclass[21, 1] = TOTAL(length_mean[31, LoopIndex2:LoopIndex2+36L])/age21meancount
  IF age22meancount GT 0 THEN Total_N_ageclass[22, 1] = TOTAL(length_mean[32, LoopIndex2:LoopIndex2+36L])/age22meancount
  IF age23meancount GT 0 THEN Total_N_ageclass[23, 1] = TOTAL(length_mean[33, LoopIndex2:LoopIndex2+36L])/age23meancount
  IF age24meancount GT 0 THEN Total_N_ageclass[24, 1] = TOTAL(length_mean[34, LoopIndex2:LoopIndex2+36L])/age24meancount
  IF age25meancount GT 0 THEN Total_N_ageclass[25, 1] = TOTAL(length_mean[35, LoopIndex2:LoopIndex2+36L])/age25meancount
  IF age26meancount GT 0 THEN Total_N_ageclass[26, 1] = TOTAL(length_mean[36, LoopIndex2:LoopIndex2+36L])/age26meancount

  ; Body length (mm) of YOY - *******NEED TO CHANGE IT TO LAKE-YEAR-SPECIFIC
  YOYNOlength = where((Total_N_ageclass[0, 0] GT 0.) AND (Total_N_ageclass[0, 1] LE 0.), YOYNOlengthcount)
  IF paramset[40, i] LE 0 THEN paramset[40, i] = 104.5
  IF YOYNOlengthcount GT 0 THEN Total_N_ageclass[YOYNOlength, 1] = paramset[40, i]
  PRINT, 'Mean length-at-age'
  PRINT, Total_N_ageclass[*, 1]

  ; Mean length-at-age from estiamted age structure - males
  mean_length_at_ageM = FLTARR(27L, 37L)
  mean_length_at_ageM[0, *] = (length_meanM[10, LoopIndex2:LoopIndex2+36L])
  mean_length_at_ageM[1, *] = (length_meanM[11, LoopIndex2:LoopIndex2+36L])
  mean_length_at_ageM[2, *] = (length_meanM[12, LoopIndex2:LoopIndex2+36L])
  mean_length_at_ageM[3, *] = (length_meanM[13, LoopIndex2:LoopIndex2+36L])
  mean_length_at_ageM[4, *] = (length_meanM[14, LoopIndex2:LoopIndex2+36L])
  mean_length_at_ageM[5, *] = (length_meanM[15, LoopIndex2:LoopIndex2+36L])
  mean_length_at_ageM[6, *] = (length_meanM[16, LoopIndex2:LoopIndex2+36L])
  mean_length_at_ageM[7, *] = (length_meanM[17, LoopIndex2:LoopIndex2+36L])
  mean_length_at_ageM[8, *] = (length_meanM[18, LoopIndex2:LoopIndex2+36L])
  mean_length_at_ageM[9, *] = (length_meanM[19, LoopIndex2:LoopIndex2+36L])
  mean_length_at_ageM[10, *] = (length_meanM[20, LoopIndex2:LoopIndex2+36L])
  mean_length_at_ageM[11, *] = (length_meanM[21, LoopIndex2:LoopIndex2+36L])
  mean_length_at_ageM[12, *] = (length_meanM[22, LoopIndex2:LoopIndex2+36L])
  mean_length_at_ageM[13, *] = (length_meanM[23, LoopIndex2:LoopIndex2+36L])
  mean_length_at_ageM[14, *] = (length_meanM[24, LoopIndex2:LoopIndex2+36L])
  mean_length_at_ageM[15, *] = (length_meanM[25, LoopIndex2:LoopIndex2+36L])
  mean_length_at_ageM[16, *] = (length_meanM[26, LoopIndex2:LoopIndex2+36L])
  mean_length_at_ageM[17, *] = (length_meanM[27, LoopIndex2:LoopIndex2+36L])
  mean_length_at_ageM[18, *] = (length_meanM[28, LoopIndex2:LoopIndex2+36L])
  mean_length_at_ageM[19, *] = (length_meanM[29, LoopIndex2:LoopIndex2+36L])
  mean_length_at_ageM[20, *] = (length_meanM[30, LoopIndex2:LoopIndex2+36L])
  mean_length_at_ageM[21, *] = (length_meanM[31, LoopIndex2:LoopIndex2+36L])
  mean_length_at_ageM[22, *] = (length_meanM[32, LoopIndex2:LoopIndex2+36L])
  mean_length_at_ageM[23, *] = (length_meanM[33, LoopIndex2:LoopIndex2+36L])
  mean_length_at_ageM[24, *] = (length_meanM[34, LoopIndex2:LoopIndex2+36L])
  mean_length_at_ageM[25, *] = (length_meanM[35, LoopIndex2:LoopIndex2+36L])
  mean_length_at_ageM[26, *] = (length_meanM[36, LoopIndex2:LoopIndex2+36L])
  age0Mmean = where(mean_length_at_ageM[0, *] GT 0, age0meanMcount)
  age1Mmean = where(mean_length_at_ageM[1, *] GT 0, age1meanMcount)
  age2Mmean = where(mean_length_at_ageM[2, *] GT 0, age2meanMcount)
  age3Mmean = where(mean_length_at_ageM[3, *] GT 0, age3meanMcount)
  age4Mmean = where(mean_length_at_ageM[4, *] GT 0, age4meanMcount)
  age5Mmean = where(mean_length_at_ageM[5, *] GT 0, age5meanMcount)
  age6Mmean = where(mean_length_at_ageM[6, *] GT 0, age6meanMcount)
  age7Mmean = where(mean_length_at_ageM[7, *] GT 0, age7meanMcount)
  age8Mmean = where(mean_length_at_ageM[8, *] GT 0, age8meanMcount)
  age9Mmean = where(mean_length_at_ageM[9, *] GT 0, age9meanMcount)
  age10Mmean = where(mean_length_at_ageM[10, *] GT 0, age10meanMcount)
  age11Mmean = where(mean_length_at_ageM[11, *] GT 0, age11meanMcount)
  age12Mmean = where(mean_length_at_ageM[12, *] GT 0, age12meanMcount)
  age13Mmean = where(mean_length_at_ageM[13, *] GT 0, age13meanMcount)
  age14Mmean = where(mean_length_at_ageM[14, *] GT 0, age14meanMcount)
  age15Mmean = where(mean_length_at_ageM[15, *] GT 0, age15meanMcount)
  age16Mmean = where(mean_length_at_ageM[16, *] GT 0, age16meanMcount)
  age17Mmean = where(mean_length_at_ageM[17, *] GT 0, age17meanMcount)
  age18Mmean = where(mean_length_at_ageM[18, *] GT 0, age18meanMcount)
  age19Mmean = where(mean_length_at_ageM[19, *] GT 0, age19meanMcount)
  age20Mmean = where(mean_length_at_ageM[20, *] GT 0, age20meanMcount)
  age21Mmean = where(mean_length_at_ageM[21, *] GT 0, age21meanMcount)
  age22Mmean = where(mean_length_at_ageM[22, *] GT 0, age22meanMcount)
  age23Mmean = where(mean_length_at_ageM[23, *] GT 0, age23meanMcount)
  age24Mmean = where(mean_length_at_ageM[24, *] GT 0, age24meanMcount)
  age25Mmean = where(mean_length_at_ageM[25, *] GT 0, age25meanMcount)
  age26Mmean = where(mean_length_at_ageM[26, *] GT 0, age26meanMcount)
  IF age0meanMcount GT 0 THEN Male_N_ageclass[0, 1] = TOTAL(length_meanM[10, LoopIndex2:LoopIndex2+36L])/age0meanMcount
  IF age1meanMcount GT 0 THEN Male_N_ageclass[1, 1] = TOTAL(length_meanM[11, LoopIndex2:LoopIndex2+36L])/age1meanMcount
  IF age2meanMcount GT 0 THEN Male_N_ageclass[2, 1] = TOTAL(length_meanM[12, LoopIndex2:LoopIndex2+36L])/age2meanMcount
  IF age3meanMcount GT 0 THEN Male_N_ageclass[3, 1] = TOTAL(length_meanM[13, LoopIndex2:LoopIndex2+36L])/age3meanMcount
  IF age4meanMcount GT 0 THEN Male_N_ageclass[4, 1] = TOTAL(length_meanM[14, LoopIndex2:LoopIndex2+36L])/age4meanMcount
  IF age5meanMcount GT 0 THEN Male_N_ageclass[5, 1] = TOTAL(length_meanM[15, LoopIndex2:LoopIndex2+36L])/age5meanMcount
  IF age6meanMcount GT 0 THEN Male_N_ageclass[6, 1] = TOTAL(length_meanM[16, LoopIndex2:LoopIndex2+36L])/age6meanMcount
  IF age7meanMcount GT 0 THEN Male_N_ageclass[7, 1] = TOTAL(length_meanM[17, LoopIndex2:LoopIndex2+36L])/age7meanMcount
  IF age8meanMcount GT 0 THEN Male_N_ageclass[8, 1] = TOTAL(length_meanM[18, LoopIndex2:LoopIndex2+36L])/age8meanMcount
  IF age9meanMcount GT 0 THEN Male_N_ageclass[9, 1] = TOTAL(length_meanM[19, LoopIndex2:LoopIndex2+36L])/age9meanMcount
  IF age10meanMcount GT 0 THEN Male_N_ageclass[10, 1] = TOTAL(length_meanM[20, LoopIndex2:LoopIndex2+36L])/age10meanMcount
  IF age11meanMcount GT 0 THEN Male_N_ageclass[11, 1] = TOTAL(length_meanM[21, LoopIndex2:LoopIndex2+36L])/age11meanMcount
  IF age12meanMcount GT 0 THEN Male_N_ageclass[12, 1] = TOTAL(length_meanM[22, LoopIndex2:LoopIndex2+36L])/age12meanMcount
  IF age13meanMcount GT 0 THEN Male_N_ageclass[13, 1] = TOTAL(length_meanM[23, LoopIndex2:LoopIndex2+36L])/age13meanMcount
  IF age14meanMcount GT 0 THEN Male_N_ageclass[14, 1] = TOTAL(length_meanM[24, LoopIndex2:LoopIndex2+36L])/age14meanMcount
  IF age15meanMcount GT 0 THEN Male_N_ageclass[15, 1] = TOTAL(length_meanM[25, LoopIndex2:LoopIndex2+36L])/age15meanMcount
  IF age16meanMcount GT 0 THEN Male_N_ageclass[16, 1] = TOTAL(length_meanM[26, LoopIndex2:LoopIndex2+36L])/age16meanMcount
  IF age17meanMcount GT 0 THEN Male_N_ageclass[17, 1] = TOTAL(length_meanM[27, LoopIndex2:LoopIndex2+36L])/age17meanMcount
  IF age18meanMcount GT 0 THEN Male_N_ageclass[18, 1] = TOTAL(length_meanM[28, LoopIndex2:LoopIndex2+36L])/age18meanMcount
  IF age19meanMcount GT 0 THEN Male_N_ageclass[19, 1] = TOTAL(length_meanM[29, LoopIndex2:LoopIndex2+36L])/age19meanMcount
  IF age20meanMcount GT 0 THEN Male_N_ageclass[20, 1] = TOTAL(length_meanM[30, LoopIndex2:LoopIndex2+36L])/age20meanMcount
  IF age21meanMcount GT 0 THEN Male_N_ageclass[21, 1] = TOTAL(length_meanM[31, LoopIndex2:LoopIndex2+36L])/age21meanMcount
  IF age22meanMcount GT 0 THEN Male_N_ageclass[22, 1] = TOTAL(length_meanM[32, LoopIndex2:LoopIndex2+36L])/age22meanMcount
  IF age23meanMcount GT 0 THEN Male_N_ageclass[23, 1] = TOTAL(length_meanM[33, LoopIndex2:LoopIndex2+36L])/age23meanMcount
  IF age24meanMcount GT 0 THEN Male_N_ageclass[24, 1] = TOTAL(length_meanM[34, LoopIndex2:LoopIndex2+36L])/age24meanMcount
  IF age25meanMcount GT 0 THEN Male_N_ageclass[25, 1] = TOTAL(length_meanM[35, LoopIndex2:LoopIndex2+36L])/age25meanMcount
  IF age26meanMcount GT 0 THEN Male_N_ageclass[26, 1] = TOTAL(length_meanM[36, LoopIndex2:LoopIndex2+36L])/age26meanMcount
  PRINT, 'Mean length-at-age for males'
  PRINT, Male_N_ageclass[*, 1]

  ; Mean length-at-age from estiamted age structure - females
  mean_length_at_ageF = FLTARR(27L, 37L)
  mean_length_at_ageF[0, *] = (length_meanF[10, LoopIndex2:LoopIndex2+36L])
  mean_length_at_ageF[1, *] = (length_meanF[11, LoopIndex2:LoopIndex2+36L])
  mean_length_at_ageF[2, *] = (length_meanF[12, LoopIndex2:LoopIndex2+36L])
  mean_length_at_ageF[3, *] = (length_meanF[13, LoopIndex2:LoopIndex2+36L])
  mean_length_at_ageF[4, *] = (length_meanF[14, LoopIndex2:LoopIndex2+36L])
  mean_length_at_ageF[5, *] = (length_meanF[15, LoopIndex2:LoopIndex2+36L])
  mean_length_at_ageF[6, *] = (length_meanF[16, LoopIndex2:LoopIndex2+36L])
  mean_length_at_ageF[7, *] = (length_meanF[17, LoopIndex2:LoopIndex2+36L])
  mean_length_at_ageF[8, *] = (length_meanF[18, LoopIndex2:LoopIndex2+36L])
  mean_length_at_ageF[9, *] = (length_meanF[19, LoopIndex2:LoopIndex2+36L])
  mean_length_at_ageF[10, *] = (length_meanF[20, LoopIndex2:LoopIndex2+36L])
  mean_length_at_ageF[11, *] = (length_meanF[21, LoopIndex2:LoopIndex2+36L])
  mean_length_at_ageF[12, *] = (length_meanF[22, LoopIndex2:LoopIndex2+36L])
  mean_length_at_ageF[13, *] = (length_meanF[23, LoopIndex2:LoopIndex2+36L])
  mean_length_at_ageF[14, *] = (length_meanF[24, LoopIndex2:LoopIndex2+36L])
  mean_length_at_ageF[15, *] = (length_meanF[25, LoopIndex2:LoopIndex2+36L])
  mean_length_at_ageF[16, *] = (length_meanF[26, LoopIndex2:LoopIndex2+36L])
  mean_length_at_ageF[17, *] = (length_meanF[27, LoopIndex2:LoopIndex2+36L])
  mean_length_at_ageF[18, *] = (length_meanF[28, LoopIndex2:LoopIndex2+36L])
  mean_length_at_ageF[19, *] = (length_meanF[29, LoopIndex2:LoopIndex2+36L])
  mean_length_at_ageF[20, *] = (length_meanF[30, LoopIndex2:LoopIndex2+36L])
  mean_length_at_ageF[21, *] = (length_meanF[31, LoopIndex2:LoopIndex2+36L])
  mean_length_at_ageF[22, *] = (length_meanF[32, LoopIndex2:LoopIndex2+36L])
  mean_length_at_ageF[23, *] = (length_meanF[33, LoopIndex2:LoopIndex2+36L])
  mean_length_at_ageF[24, *] = (length_meanF[34, LoopIndex2:LoopIndex2+36L])
  mean_length_at_ageF[25, *] = (length_meanF[35, LoopIndex2:LoopIndex2+36L])
  mean_length_at_ageF[26, *] = (length_meanF[36, LoopIndex2:LoopIndex2+36L])
  age0Mmean = where(mean_length_at_ageF[0, *] GT 0, age0meanFcount)
  age1Mmean = where(mean_length_at_ageF[1, *] GT 0, age1meanFcount)
  age2Mmean = where(mean_length_at_ageF[2, *] GT 0, age2meanFcount)
  age3Mmean = where(mean_length_at_ageF[3, *] GT 0, age3meanFcount)
  age4Mmean = where(mean_length_at_ageF[4, *] GT 0, age4meanFcount)
  age5Mmean = where(mean_length_at_ageF[5, *] GT 0, age5meanFcount)
  age6Mmean = where(mean_length_at_ageF[6, *] GT 0, age6meanFcount)
  age7Mmean = where(mean_length_at_ageF[7, *] GT 0, age7meanFcount)
  age8Mmean = where(mean_length_at_ageF[8, *] GT 0, age8meanFcount)
  age9Mmean = where(mean_length_at_ageF[9, *] GT 0, age9meanFcount)
  age10Mmean = where(mean_length_at_ageF[10, *] GT 0, age10meanFcount)
  age11Mmean = where(mean_length_at_ageF[11, *] GT 0, age11meanFcount)
  age12Mmean = where(mean_length_at_ageF[12, *] GT 0, age12meanFcount)
  age13Mmean = where(mean_length_at_ageF[13, *] GT 0, age13meanFcount)
  age14Mmean = where(mean_length_at_ageF[14, *] GT 0, age14meanFcount)
  age15Mmean = where(mean_length_at_ageF[15, *] GT 0, age15meanFcount)
  age16Mmean = where(mean_length_at_ageF[16, *] GT 0, age16meanFcount)
  age17Mmean = where(mean_length_at_ageF[17, *] GT 0, age17meanFcount)
  age18Mmean = where(mean_length_at_ageF[18, *] GT 0, age18meanFcount)
  age19Mmean = where(mean_length_at_ageF[19, *] GT 0, age19meanFcount)
  age20Mmean = where(mean_length_at_ageF[20, *] GT 0, age20meanFcount)
  age21Mmean = where(mean_length_at_ageF[21, *] GT 0, age21meanFcount)
  age22Mmean = where(mean_length_at_ageF[22, *] GT 0, age22meanFcount)
  age23Mmean = where(mean_length_at_ageF[23, *] GT 0, age23meanFcount)
  age24Mmean = where(mean_length_at_ageF[24, *] GT 0, age24meanFcount)
  age25Mmean = where(mean_length_at_ageF[25, *] GT 0, age25meanFcount)
  age26Mmean = where(mean_length_at_ageF[26, *] GT 0, age26meanFcount)
  IF age0meanFcount GT 0 THEN Female_N_ageclass[0, 1] = TOTAL(length_meanF[10, LoopIndex2:LoopIndex2+36L])/age0meanFcount
  IF age1meanFcount GT 0 THEN Female_N_ageclass[1, 1] = TOTAL(length_meanF[11, LoopIndex2:LoopIndex2+36L])/age1meanFcount
  IF age2meanFcount GT 0 THEN Female_N_ageclass[2, 1] = TOTAL(length_meanF[12, LoopIndex2:LoopIndex2+36L])/age2meanFcount
  IF age3meanFcount GT 0 THEN Female_N_ageclass[3, 1] = TOTAL(length_meanF[13, LoopIndex2:LoopIndex2+36L])/age3meanFcount
  IF age4meanFcount GT 0 THEN Female_N_ageclass[4, 1] = TOTAL(length_meanF[14, LoopIndex2:LoopIndex2+36L])/age4meanFcount
  IF age5meanFcount GT 0 THEN Female_N_ageclass[5, 1] = TOTAL(length_meanF[15, LoopIndex2:LoopIndex2+36L])/age5meanFcount
  IF age6meanFcount GT 0 THEN Female_N_ageclass[6, 1] = TOTAL(length_meanF[16, LoopIndex2:LoopIndex2+36L])/age6meanFcount
  IF age7meanFcount GT 0 THEN Female_N_ageclass[7, 1] = TOTAL(length_meanF[17, LoopIndex2:LoopIndex2+36L])/age7meanFcount
  IF age8meanFcount GT 0 THEN Female_N_ageclass[8, 1] = TOTAL(length_meanF[18, LoopIndex2:LoopIndex2+36L])/age8meanFcount
  IF age9meanFcount GT 0 THEN Female_N_ageclass[9, 1] = TOTAL(length_meanF[19, LoopIndex2:LoopIndex2+36L])/age9meanFcount
  IF age10meanFcount GT 0 THEN Female_N_ageclass[10, 1] = TOTAL(length_meanF[20, LoopIndex2:LoopIndex2+36L])/age10meanFcount
  IF age11meanFcount GT 0 THEN Female_N_ageclass[11, 1] = TOTAL(length_meanF[21, LoopIndex2:LoopIndex2+36L])/age11meanFcount
  IF age12meanFcount GT 0 THEN Female_N_ageclass[12, 1] = TOTAL(length_meanF[22, LoopIndex2:LoopIndex2+36L])/age12meanFcount
  IF age13meanFcount GT 0 THEN Female_N_ageclass[13, 1] = TOTAL(length_meanF[23, LoopIndex2:LoopIndex2+36L])/age13meanFcount
  IF age14meanFcount GT 0 THEN Female_N_ageclass[14, 1] = TOTAL(length_meanF[24, LoopIndex2:LoopIndex2+36L])/age14meanFcount
  IF age15meanFcount GT 0 THEN Female_N_ageclass[15, 1] = TOTAL(length_meanF[25, LoopIndex2:LoopIndex2+36L])/age15meanFcount
  IF age16meanFcount GT 0 THEN Female_N_ageclass[16, 1] = TOTAL(length_meanF[26, LoopIndex2:LoopIndex2+36L])/age16meanFcount
  IF age17meanFcount GT 0 THEN Female_N_ageclass[17, 1] = TOTAL(length_meanF[27, LoopIndex2:LoopIndex2+36L])/age17meanFcount
  IF age18meanFcount GT 0 THEN Female_N_ageclass[18, 1] = TOTAL(length_meanF[28, LoopIndex2:LoopIndex2+36L])/age18meanFcount
  IF age19meanFcount GT 0 THEN Female_N_ageclass[19, 1] = TOTAL(length_meanF[29, LoopIndex2:LoopIndex2+36L])/age19meanFcount
  IF age20meanFcount GT 0 THEN Female_N_ageclass[20, 1] = TOTAL(length_meanF[30, LoopIndex2:LoopIndex2+36L])/age20meanFcount
  IF age21meanFcount GT 0 THEN Female_N_ageclass[21, 1] = TOTAL(length_meanF[31, LoopIndex2:LoopIndex2+36L])/age21meanFcount
  IF age22meanFcount GT 0 THEN Female_N_ageclass[22, 1] = TOTAL(length_meanF[32, LoopIndex2:LoopIndex2+36L])/age22meanFcount
  IF age23meanFcount GT 0 THEN Female_N_ageclass[23, 1] = TOTAL(length_meanF[33, LoopIndex2:LoopIndex2+36L])/age23meanFcount
  IF age24meanFcount GT 0 THEN Female_N_ageclass[24, 1] = TOTAL(length_meanF[34, LoopIndex2:LoopIndex2+36L])/age24meanFcount
  IF age25meanFcount GT 0 THEN Female_N_ageclass[25, 1] = TOTAL(length_meanF[35, LoopIndex2:LoopIndex2+36L])/age25meanFcount
  IF age26meanFcount GT 0 THEN Female_N_ageclass[26, 1] = TOTAL(length_meanF[36, LoopIndex2:LoopIndex2+36L])/age26meanFcount
  PRINT, 'Mean length-at-age for females'
  PRINT, Female_N_ageclass[*, 1]
  ; Store mean length-at-age in output arrays
  paramset[40L:66, i] = Total_N_ageclass[*, 1]
  paramsetM[40L:66, i] = Male_N_ageclass[*, 1]
  paramsetF[40L:66, i] = Female_N_ageclass[*, 1]
  paramsetU[40L:66, i] = Total_N_ageclass[*, 1]
  
  
  
  RETURN, FishAgeStruc

END