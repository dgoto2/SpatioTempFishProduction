;########################################################################################################
PRO WalleyeAgeStrucIndAngl
; converting length to age for WI walleye data
; calcualted total production of WI walleye from spring surveys and angling harvest from creel surveys
PRINT, 'a program to compute productivity and harvest efficiency of walleye stocks in Wisconsin, USA'
PRINT, 'Created: Apr 26, 2014'
PRINT, 'Updated: May 25, 2015'
;########################################################################################################

tstart = SYSTIME(/seconds);

; Read input files
; Identify a direcotry for exporting daily output of state variables as .csv file
CD, 'C:\Users\Daisuke\Desktop\Walleye_production_project\Walleye outputs'; Directory; F:\SNS_SEIBM
; Input file locations
; 1.walleye body length data from the spring survey data
file = FILEPATH('walleye_length_PE_data3_IDL.csv', Root_dir = 'C:', SUBDIR = 'Users\Daisuke\Desktop\Walleye_production_project\Data')
; 2.walleye body length-age keys - LAKE-YEAR-specific
file2 = FILEPATH('walleye_age_length_key_IDL.csv', Root_dir = 'C:', SUBDIR = 'Users\Daisuke\Desktop\Walleye_production_project\Data')
; 3.walleye body length-age keys - LAKE-specific
file3 = FILEPATH('walleye_age_length_key_lake_IDL.csv', Root_dir = 'C:', SUBDIR = 'Users\Daisuke\Desktop\Walleye_production_project\Data')
; 4.walleye body length-age keys - STATEWIDE
file4 = FILEPATH('walleye_age_length_key_region_IDL.csv', Root_dir = 'C:', SUBDIR = 'Users\Daisuke\Desktop\Walleye_production_project\Data')
; 5. yonung-of-the-year data
file5 = FILEPATH('walleye_YOY_data_IDL.csv', Root_dir = 'C:', SUBDIR = 'Users\Daisuke\Desktop\Walleye_production_project\Data')
; 6.walleye body length data from the creel surveys (angling)
file6 = FILEPATH('walleye_length_N_angl2_IDL.csv', Root_dir = 'C:', SUBDIR = 'Users\Daisuke\Desktop\Walleye_production_project\Data')
; Check if the file is not blank
IF (N_ELEMENTS(file) EQ 0L) THEN MESSAGE, 'FILE is undefined'
;IF (N_ELEMENTS(maxcols) EQ 0L) THEN maxcols = 8L

; Define the data structure
;N = 272935L; survey data - data set1
N = 289450L; survey data - data set3
Nkey = 24864L; lake-year-specific age-length key
Nkey2 = 13542L; lake-specific age-length key
Nkey3 = 37L; region-wide age-length key
Nyoy = 2340L
;Nangl = 57326L; harvested fish - data set1
Nangl = 64442L; harvested fish - data set2

; create arrays for input data
Length_Data = DOUBLE(FLTARR(14L, N))
Length_key = DOUBLE(FLTARR(93L, Nkey))
Length_key2 = DOUBLE(FLTARR(93L, Nkey2))
Length_key3 = DOUBLE(FLTARR(93L, Nkey3))
YOY_data = DOUBLE(FLTARR(6L, Nyoy))
Length_angl_data = DOUBLE(FLTARR(12L, Nangl))
AgeArray = -1 + FLTARR(N)
LengthArray = FLTARR(N)
AgeArrayAngl = -1 + FLTARR(Nangl)
LengthArrayAngl = FLTARR(Nangl)

; read input length & PE data
OPENR, lun, file, /GET_LUN
READF, lun, Length_Data;, FORMAT='(A17, x, I0)';
WBIC_Year = Length_Data[0, *]
WBIC = Length_Data[1, *]
SurveyYear = Length_Data[2, *]
Length = Length_Data[3, *]
Sex = Length_Data[4, *]
PE = Length_Data[5, *]
PEmodel = Length_Data[6, *]
LakeArea = Length_Data[7, *]
LakeSizeCode = Length_Data[8, *]
RegionCode = Length_Data[9, *]
LakeCode = Length_Data[10, *]
Longitude = Length_Data[11, *]
Latitude = Length_Data[12, *]
StockType = Length_Data[13, *]
FREE_LUN, lun

; read lake-year-specific age-length key data
OPENR, lun, file2, /GET_LUN
READF, lun, Length_key;, FORMAT='(A17, x, I0)';
FREE_LUN, lun

; read lake-specific age-length key data
OPENR, lun, file3, /GET_LUN
READF, lun, Length_key2;, FORMAT='(A17, x, I0)';
FREE_LUN, lun

; read region key
OPENR, lun, file4, /GET_LUN
READF, lun, Length_key3;, FORMAT='(A17, x, I0)';
FREE_LUN, lun

; read yoy data
OPENR, lun, file5, /GET_LUN
READF, lun, YOY_data;, FORMAT='(A17, x, I0)';
WBIC_Year_YOY = YOY_data[0, *]
WBIC_YOY = YOY_data[1, *]
SurveyYear_YOY = YOY_data[2, *]
Density_YOY = YOY_data[3, *]
Length_YOY = YOY_data[4, *]
Stock_YOY = YOY_data[5, *]
FREE_LUN, lun

; angling data
OPENR, lun, file6, /GET_LUN
READF, lun, Length_angl_Data;, FORMAT='(A17, x, I0)';
WBIC_Year_angl = Length_angl_Data[0, *]
WBIC_angl = Length_angl_Data[1, *]
SurveyYear_angl = Length_angl_Data[2, *]
Length_angl = Length_angl_Data[3, *]
Mass_angl = Length_angl_Data[4, *]
adultPE_angl = Length_angl_Data[5, *]
HarvRate_angl = Length_angl_Data[6, *]
N_harv_angl = Length_angl_Data[7, *]
TotAlowCat = Length_angl_Data[8, *]
LakeArea_angl = Length_angl_Data[9, *]
Stock_type = Length_angl_Data[10, *]
legal_size = Length_angl_Data[11, *]
FREE_LUN, lun

; Create arrays for a cumulative number of lake-years/lakes with the length-age data
N_Lake_year_Wkeys = FLTARR(1)       ; number of lake years with lake-year-specific keys
N_Lake_Wkeys = FLTARR(1)            ; number of lake years iwth lake-specific keys
N_Lake_WOkeys = FLTARR(1)           ; number of lake years w/o keys
N_Lake_year_angl = FLTARR(1)
N_Lake_angl = FLTARR(1)
N_Lake_WOkeys_angl = FLTARR(1)      ; number of lake years w/o keys
N_Lake_year_yoy = FLTARR(1)
AgeLengthKeyLevel = 0.15            ; age-length key conversion threshold
AgeLengthKeyCheck_angl1 = FLTARR(1)
AgeLengthKeyCheck_angl2 = FLTARR(1)

; Find unique lake-years for biomass & production estiamtes
uniqWBIC_Year = WBIC_Year[UNIQ(WBIC_Year, SORT(WBIC_Year))] ; 568 lake years with potential estimates
PRINT, 'Total N of WBIC_years', n_elements(uniqWBIC_Year)
uniqWBIC = WBIC[UNIQ(WBIC, SORT(WBIC))]                     ; 264 lakes
PRINT, 'Total N of WBIC', n_elements(uniqWBIC)

;; Find unique lakes for prodution estimates
;uniqWBIC = WBIC[UNIQ(WBIC, SORT(WBIC))]
;PRINT, 'Total N of lakes (WBIC)', n_elements(uniqWBIC)

; Create arrays for outputs
paramset = FLTARR(234L, N_ELEMENTS(uniqWBIC_Year))            ; all fish
paramsetM = FLTARR(217L, N_ELEMENTS(uniqWBIC_Year))           ; m ales
paramsetF = FLTARR(217L, N_ELEMENTS(uniqWBIC_Year))           ; females
paramsetU = FLTARR(217L, N_ELEMENTS(uniqWBIC_Year))           ; unknowns
paramset_angl = FLTARR(226L, N_ELEMENTS(uniqWBIC_Year))       
AgeBioProd = FLTARR(40L, N_ELEMENTS(uniqWBIC_Year)*27L)       ; all fish
AgeBioProd_angl = FLTARR(25L, N_ELEMENTS(uniqWBIC_Year)*27L)  ; all fish
LengthSelect_Data = FLTARR(20, N_ELEMENTS(uniqWBIC_Year)*37L) ; output array for size-selectivity

; Create arrays for size-at-age outputs 
WAE_size_age = FLTARR(409L, N_ELEMENTS(uniqWBIC_Year)+1L)         ; an array for mean size-at-age
WAE_size_age_all = FLTARR(198, MAX(SurveyYear)-MIN(SurveyYear)+1L)
;WAE_size_age_all = FLTARR(198, 40)
year = INDGEN(MAX(SurveyYear)-MIN(SurveyYear)+1L)+MIN(SurveyYear) ; an index for year
NumLengthBin = 37L                                                ; numebr of length bins in a default array (NEED TO CORRECT)
Nageclass = 28                                                    ; number of age classes
FishProb = FLTARR(27);, Nkey)                                     ; probability of age in a given length bin
LengthDist = FLTARR(NumLengthBin+7L, N_ELEMENTS(uniqWBIC_Year))
LengthDist_angl = FLTARR(NumLengthBin+5L, N_ELEMENTS(uniqWBIC_Year))
LengthDist_angl_PLUS = FLTARR(NumLengthBin, N_ELEMENTS(uniqWBIC_Year))
Prop_LengthDist_angl_PLUS = FLTARR(N_ELEMENTS(uniqWBIC_Year))
WAE_length_bin = FLTARR(NumLengthBin*3L, N_ELEMENTS(uniqWBIC_Year)*NumLengthBin + 37)
WAE_length_mean = FLTARR(NumLengthBin*3L, N_ELEMENTS(uniqWBIC_Year)*NumLengthBin + 37)
WAE_length_binM = FLTARR(NumLengthBin*3L, N_ELEMENTS(uniqWBIC_Year)*NumLengthBin + 37)
WAE_length_meanM = FLTARR(NumLengthBin*3L, N_ELEMENTS(uniqWBIC_Year)*NumLengthBin + 37)
WAE_length_binF = FLTARR(NumLengthBin*3L, N_ELEMENTS(uniqWBIC_Year)*NumLengthBin + 37)
WAE_length_meanF = FLTARR(NumLengthBin*3L, N_ELEMENTS(uniqWBIC_Year)*NumLengthBin + 37)
WAE_length_binU = FLTARR(NumLengthBin*3L, N_ELEMENTS(uniqWBIC_Year)*NumLengthBin + 37)
WAE_length_meanU = FLTARR(NumLengthBin*3L, N_ELEMENTS(uniqWBIC_Year)*NumLengthBin + 37)
WAE_length_bin_angl = FLTARR(NumLengthBin*3L, N_ELEMENTS(uniqWBIC_Year)*NumLengthBin + 37)
WAE_length_mean_angl = FLTARR(NumLengthBin*3L, N_ELEMENTS(uniqWBIC_Year)*NumLengthBin + 37)

; Create arrays for population-level estimates
Total_production = FLTARR(N_ELEMENTS(uniqWBIC_Year))
Total_biomass = FLTARR(N_ELEMENTS(uniqWBIC_Year))
P_over_B = FLTARR(N_ELEMENTS(uniqWBIC_Year))
Total_production_adult = FLTARR(N_ELEMENTS(uniqWBIC_Year))
Total_biomass_adult = FLTARR(N_ELEMENTS(uniqWBIC_Year))
P_over_B_adult = FLTARR(N_ELEMENTS(uniqWBIC_Year))
;Output_production = FLTARR(50L, N_ELEMENTS(uniqWBIC_Year))
YOY_PE = FLTARR(N_ELEMENTS(uniqWBIC_Year))
Total_production_adultM = FLTARR(N_ELEMENTS(uniqWBIC_Year))
Total_production_adultF = FLTARR(N_ELEMENTS(uniqWBIC_Year))
Total_production_adultU = FLTARR(N_ELEMENTS(uniqWBIC_Year))
Total_biomass_adultM = FLTARR(N_ELEMENTS(uniqWBIC_Year))
Total_biomass_adultF = FLTARR(N_ELEMENTS(uniqWBIC_Year))
Total_biomass_adultU = FLTARR(N_ELEMENTS(uniqWBIC_Year))
Total_productionM = FLTARR(N_ELEMENTS(uniqWBIC_Year))
Total_productionF = FLTARR(N_ELEMENTS(uniqWBIC_Year))
Total_productionU = FLTARR(N_ELEMENTS(uniqWBIC_Year))
Total_biomassM = FLTARR(N_ELEMENTS(uniqWBIC_Year))
Total_biomassF = FLTARR(N_ELEMENTS(uniqWBIC_Year))
Total_biomassU = FLTARR(N_ELEMENTS(uniqWBIC_Year))

; create arrays for angling
Total_production_angl = FLTARR(N_ELEMENTS(uniqWBIC_Year))
Total_biomass_angl = FLTARR(N_ELEMENTS(uniqWBIC_Year))
P_over_B_angl = FLTARR(N_ELEMENTS(uniqWBIC_Year))
Ecotroph = fltarr(N_ELEMENTS(uniqWBIC_Year))
Total_production_adult_angl = FLTARR(N_ELEMENTS(uniqWBIC_Year))
Total_biomass_adult_angl = FLTARR(N_ELEMENTS(uniqWBIC_Year))
P_over_B_adult_angl = FLTARR(N_ELEMENTS(uniqWBIC_Year))
;Output_production = FLTARR(50L, N_ELEMENTS(uniqWBIC_Year))
Adult_ecotroph = fltarr(N_ELEMENTS(uniqWBIC_Year))


; Estimate age structure for each lake-year
; 1. Loop through WBIC_years
FOR i = 0L, N_ELEMENTS(uniqWBIC_Year)-1L DO BEGIN
    PRINT, 'i', i
    IF i EQ 0L THEN adj = 0; adjustment to the loop index for outputs
    IF i GT 1L THEN adj = 1

    ; Index for unique WBIC-year walleye stocks
    INDEX_lengthdata = WHERE((WBIC_Year[*] EQ uniqWBIC_Year[i]), INDEX_lengthdatacount)
    IF INDEX_lengthdatacount GT 0 THEN PRINT, 'WBIC_year', WBIC_Year[INDEX_lengthdata[0]]

    IF INDEX_lengthdatacount GT 0 THEN BEGIN; if the length survey data exist...
      PRINT, 'WBIC_year', WBIC_Year[INDEX_lengthdata[0]]
      
      ; Index for unique WBIC_year for walleye YOY
      INDEX_YOYdata = WHERE((WBIC_year_YOY[*] EQ WBIC_Year[INDEX_lengthdata[0]]), INDEX_YOYdatacount)
      paramset[210, i] = INDEX_YOYdatacount

      stock = ' [U]'; code for 'unknown stock type' used in the plot
      IF INDEX_YOYdatacount GT 0 THEN BEGIN; if yoy data exist...
        YOY_PE[i] = ROUND(Density_YOY[INDEX_YOYdata] * LakeArea[INDEX_lengthdata[0]])
        print, 'YOY PE', YOY_PE[i]
        paramset[215, i] = Stock_YOY[INDEX_YOYdata]
        IF Stock_YOY[INDEX_YOYdata] EQ 0 THEN stock = ' [N]'
        IF Stock_YOY[INDEX_YOYdata] EQ 1 THEN stock = ' [S]'
        IF Stock_YOY[INDEX_YOYdata] EQ 2 THEN stock = ' [R]'
        IF Stock_YOY[INDEX_YOYdata] EQ 3 THEN stock = ' [U]'
        paramset[40, i] = Length_YOY[INDEX_YOYdata]
        N_Lake_year_yoy = N_Lake_year_yoy + 1L
        PRINT, 'N of lake-year with harvest data', N_Lake_year_angl
      ENDIF
      IF INDEX_YOYdatacount LE 0 THEN PRINT, 'No YOY data available'

      Sex_prod = Sex[INDEX_lengthdata]                              ; sex data, male=0; female=1; unknown=2
      Length_prod = Length[INDEX_lengthdata]                        ; length data
      FishAge = AgeArray[INDEX_lengthdata]                          ; individual age array
      FishLength = LengthArray[INDEX_lengthdata]                    ; individual length array
      ;Age_prod = Age[INDEX_growthdata]
      ;PRINT, 'FishAge', FishAge
      ;PRINT, 'length_prod', length[INDEX_lengthdata]
      PRINT, 'Population demographics info:'
      Male = WHERE(Sex_prod eq 0, malecount)
      Female = WHERE(Sex_prod eq 1, femalecount)
      unknown = WHERE(Sex_prod eq 2, unknowncount)
      print, 'N of males in survey data', malecount
      print, 'N of females in survey data', femalecount
      print, 'N of unknown in survey data', unknowncount

      ; record basic demographic data
      paramset[0, i] = uniqWBIC_Year[i]                     ; WBIC_year (abbrev)
      paramset[1, i] = WBIC[INDEX_lengthdata[0]]            ; WBIC
      paramset[2, i] = SurveyYear[INDEX_lengthdata[0]]      ; year
      paramsetM[0, i] = uniqWBIC_Year[i]                    ; WBIC_year (abbrev)
      paramsetM[1, i] = WBIC[INDEX_lengthdata[0]]           ; WBIC
      paramsetM[2, i] = SurveyYear[INDEX_lengthdata[0]]     ; year
      paramsetF[0, i] = uniqWBIC_Year[i]                    ; WBIC_year (abbrev)
      paramsetF[1, i] = WBIC[INDEX_lengthdata[0]]           ; WBIC
      paramsetF[2, i] = SurveyYear[INDEX_lengthdata[0]]     ; year
      paramset[231, i] = LakeSizeCode[INDEX_lengthdata[0]]  ; lake size <500 = 0
      paramset[232, i] = RegionCode[INDEX_lengthdata[0]]    ; northeast = 1, northwest=2, south=3
      paramset[233, i] = LakeCode[INDEX_lengthdata[0]]      ; code for size & region combined
      paramset[3, i] = N_ELEMENTS(Length_prod)              ; N of all fish
      paramset[4, i] = malecount                            ; N of males
      paramset[5, i] = femalecount                          ; N of females
      paramset[6, i] = unknowncount                         ; N of unknown
      paramset[7, i] = MAX(length[INDEX_lengthdata])        ; max length for all fish
      paramset[8, i] = MIN(length[INDEX_lengthdata])        ; min length for all fish
      paramset[9, i] = MAX(length[INDEX_lengthdata[male]])  ; max length for males
      paramset[10, i] = MIN(length[INDEX_lengthdata[male]]) ; min length for males
      paramset[11, i] = MAX(length[INDEX_lengthdata[female]]); max length for females
      paramset[12, i] = MIN(length[INDEX_lengthdata[female]]); min length for females
      paramset[219, i] = MEAN(length[INDEX_lengthdata])       ; mean length for all fish
      paramset[220, i] = STDDEV(length[INDEX_lengthdata])     ; SD length for all fish
      paramset[221, i] = MEAN(length[INDEX_lengthdata[male]]) ; mean length for males
      paramset[222, i] = STDDEV(length[INDEX_lengthdata[male]]) ; SD length for males
      paramset[223, i] = MEAN(length[INDEX_lengthdata[female]]) ; mean length for females
      paramset[224, i] = STDDEV(length[INDEX_lengthdata[female]]) ; SD length for females
      print, 'N of fish', paramset[3, i], malecount+femalecount+unknowncount
      print, 'WBIC', paramset[1, i]
      print, 'Year', paramset[2, i]
      print, 'Max length (mm)', Max(length[INDEX_lengthdata])
      print, 'Min length (mm)', Min(length[INDEX_lengthdata])
      print, 'Female max length (mm)', Max(length[INDEX_lengthdata[female]])
      print, 'Female min length (mm)', Min(length[INDEX_lengthdata[female]])
      print, 'Male max length (mm)', Max(length[INDEX_lengthdata[male]])
      print, 'Male min length (mm)', Min(length[INDEX_lengthdata[male]])

      ; assign fish to length groups - all fish
      SizeLT100 = WHERE(Length_prod LT 100., SizeLT100count)
      Size100to120 = WHERE((Length_prod GE 100.) AND (Length_prod LT 120.), Size100to120count)
      Size120to140 = WHERE((Length_prod GE 120.) AND (Length_prod LT 140.), Size120to140count)
      Size140to160 = WHERE((Length_prod GE 140.) AND (Length_prod LT 160.), Size140to160count)
      Size160to180 = WHERE((Length_prod GE 160.) AND (Length_prod LT 180.), Size160to180count)
      Size180to200 = WHERE((Length_prod GE 180.) AND (Length_prod LT 200.), Size180to200count)
      Size200to220 = WHERE((Length_prod GE 200.) AND (Length_prod LT 220.), Size200to220count)
      Size220to240 = WHERE((Length_prod GE 220.) AND (Length_prod LT 240.), Size220to240count)
      Size240to260 = WHERE((Length_prod GE 240.) AND (Length_prod LT 260.), Size240to260count)
      Size260to280 = WHERE((Length_prod GE 260.) AND (Length_prod LT 280.), Size260to280count)
      Size280to300 = WHERE((Length_prod GE 280.) AND (Length_prod LT 300.), Size280to300count)
      Size300to320 = WHERE((Length_prod GE 300.) AND (Length_prod LT 320.), Size300to320count)
      Size320to340 = WHERE((Length_prod GE 320.) AND (Length_prod LT 340.), Size320to340count)
      Size340to360 = WHERE((Length_prod GE 340.) AND (Length_prod LT 360.), Size340to360count)
      Size360to380 = WHERE((Length_prod GE 360.) AND (Length_prod LT 380.), Size360to380count)
      Size380to400 = WHERE((Length_prod GE 380.) AND (Length_prod LT 400.), Size380to400count)
      Size400to420 = WHERE((Length_prod GE 400.) AND (Length_prod LT 420.), Size400to420count)
      Size420to440 = WHERE((Length_prod GE 420.) AND (Length_prod LT 440.), Size420to440count)
      Size440to460 = WHERE((Length_prod GE 440.) AND (Length_prod LT 460.), Size440to460count)
      Size460to480 = WHERE((Length_prod GE 460.) AND (Length_prod LT 480.), Size460to480count)
      Size480to500 = WHERE((Length_prod GE 480.) AND (Length_prod LT 500.), Size480to500count)
      Size500to520 = WHERE((Length_prod GE 500.) AND (Length_prod LT 520.), Size500to520count)
      Size520to540 = WHERE((Length_prod GE 520.) AND (Length_prod LT 540.), Size520to540count)
      Size540to560 = WHERE((Length_prod GE 540.) AND (Length_prod LT 560.), Size540to560count)
      Size560to580 = WHERE((Length_prod GE 560.) AND (Length_prod LT 580.), Size560to580count)
      Size580to600 = WHERE((Length_prod GE 580.) AND (Length_prod LT 600.), Size580to600count)
      Size600to620 = WHERE((Length_prod GE 600.) AND (Length_prod LT 620.), Size600to620count)
      Size620to640 = WHERE((Length_prod GE 620.) AND (Length_prod LT 640.), Size620to640count)
      Size640to660 = WHERE((Length_prod GE 640.) AND (Length_prod LT 660.), Size640to660count)
      Size660to680 = WHERE((Length_prod GE 660.) AND (Length_prod LT 680.), Size660to680count)
      Size680to700 = WHERE((Length_prod GE 680.) AND (Length_prod LT 700.), Size680to700count)
      Size700to720 = WHERE((Length_prod GE 700.) AND (Length_prod LT 720.), Size700to720count)
      Size720to740 = WHERE((Length_prod GE 720.) AND (Length_prod LT 740.), Size720to740count)
      Size740to760 = WHERE((Length_prod GE 740.) AND (Length_prod LT 760.), Size740to760count)
      Size760to780 = WHERE((Length_prod GE 760.) AND (Length_prod LT 780.), Size760to780count)
      Size780to800 = WHERE((Length_prod GE 780.) AND (Length_prod LT 800.), Size780to800count)
      SizeGE800 = WHERE((Length_prod GE 800.), SizeGE800count)

      ; size distribution of the length only data
      LengthDist[0, i] = SizeLT100count
      LengthDist[1, i] = Size100to120count
      LengthDist[2, i] = Size120to140count
      LengthDist[3, i] = Size140to160count
      LengthDist[4, i] = Size160to180count
      LengthDist[5, i] = Size180to200count
      LengthDist[6, i] = Size200to220count
      LengthDist[7, i] = Size220to240count
      LengthDist[8, i] = Size240to260count
      LengthDist[9, i] = Size260to280count
      LengthDist[10, i] = Size280to300count
      LengthDist[11, i] = Size300to320count
      LengthDist[12, i] = Size320to340count
      LengthDist[13, i] = Size340to360count
      LengthDist[14, i] = Size360to380count
      LengthDist[15, i] = Size380to400count
      LengthDist[16, i] = Size400to420count
      LengthDist[17, i] = Size420to440count
      LengthDist[18, i] = Size440to460count
      LengthDist[19, i] = Size460to480count
      LengthDist[20, i] = Size480to500count
      LengthDist[21, i] = Size500to520count
      LengthDist[22, i] = Size520to540count
      LengthDist[23, i] = Size540to560count
      LengthDist[24, i] = Size560to580count
      LengthDist[25, i] = Size580to600count
      LengthDist[26, i] = Size600to620count
      LengthDist[27, i] = Size620to640count
      LengthDist[28, i] = Size640to660count
      LengthDist[29, i] = Size660to680count
      LengthDist[30, i] = Size680to700count
      LengthDist[31, i] = Size700to720count
      LengthDist[32, i] = Size720to740count
      LengthDist[33, i] = Size740to760count
      LengthDist[34, i] = Size760to780count
      LengthDist[35, i] = Size780to800count
      LengthDist[36, i] = SizeGE800count
      PRINT, 'length distribution (bin size = 20mm)', LengthDist[0:36, i]
      LengthDist[37, i] = paramset[1, i]            ; WBIC
      LengthDist[38, i] = paramset[2, i]            ; year
      LengthDist[39, i] = paramset[3, i]            ; sample size
      LengthDist[40, i] = PE[INDEX_lengthdata[0]]   ; adult PE
      LengthDist[41, i] = paramset[4, i]
      LengthDist[42, i] = paramset[5, i]
      LengthDist[43, i] = paramset[6, i]

      ; assign fish to length groups - males
      SizeLT100M = WHERE(Length_prod[male] LT 100., SizeLT100Mcount)
      Size100to120M = WHERE((Length_prod[male] GE 100.) AND (Length_prod[male] LT 120.), Size100to120Mcount)
      Size120to140M = WHERE((Length_prod[male] GE 120.) AND (Length_prod[male] LT 140.), Size120to140Mcount)
      Size140to160M = WHERE((Length_prod[male] GE 140.) AND (Length_prod[male] LT 160.), Size140to160Mcount)
      Size160to180M = WHERE((Length_prod[male] GE 160.) AND (Length_prod[male] LT 180.), Size160to180Mcount)
      Size180to200M = WHERE((Length_prod[male] GE 180.) AND (Length_prod[male] LT 200.), Size180to200Mcount)
      Size200to220M = WHERE((Length_prod[male] GE 200.) AND (Length_prod[male] LT 220.), Size200to220Mcount)
      Size220to240M = WHERE((Length_prod[male] GE 220.) AND (Length_prod[male] LT 240.), Size220to240Mcount)
      Size240to260M = WHERE((Length_prod[male] GE 240.) AND (Length_prod[male] LT 260.), Size240to260Mcount)
      Size260to280M = WHERE((Length_prod[male] GE 260.) AND (Length_prod[male] LT 280.), Size260to280Mcount)
      Size280to300M = WHERE((Length_prod[male] GE 280.) AND (Length_prod[male] LT 300.), Size280to300Mcount)
      Size300to320M = WHERE((Length_prod[male] GE 300.) AND (Length_prod[male] LT 320.), Size300to320Mcount)
      Size320to340M = WHERE((Length_prod[male] GE 320.) AND (Length_prod[male] LT 340.), Size320to340Mcount)
      Size340to360M = WHERE((Length_prod[male] GE 340.) AND (Length_prod[male] LT 360.), Size340to360Mcount)
      Size360to380M = WHERE((Length_prod[male] GE 360.) AND (Length_prod[male] LT 380.), Size360to380Mcount)
      Size380to400M = WHERE((Length_prod[male] GE 380.) AND (Length_prod[male] LT 400.), Size380to400Mcount)
      Size400to420M = WHERE((Length_prod[male] GE 400.) AND (Length_prod[male] LT 420.), Size400to420Mcount)
      Size420to440M = WHERE((Length_prod[male] GE 420.) AND (Length_prod[male] LT 440.), Size420to440Mcount)
      Size440to460M = WHERE((Length_prod[male] GE 440.) AND (Length_prod[male] LT 460.), Size440to460Mcount)
      Size460to480M = WHERE((Length_prod[male] GE 460.) AND (Length_prod[male] LT 480.), Size460to480Mcount)
      Size480to500M = WHERE((Length_prod[male] GE 480.) AND (Length_prod[male] LT 500.), Size480to500Mcount)
      Size500to520M = WHERE((Length_prod[male] GE 500.) AND (Length_prod[male] LT 520.), Size500to520Mcount)
      Size520to540M = WHERE((Length_prod[male] GE 520.) AND (Length_prod[male] LT 540.), Size520to540Mcount)
      Size540to560M = WHERE((Length_prod[male] GE 540.) AND (Length_prod[male] LT 560.), Size540to560Mcount)
      Size560to580M = WHERE((Length_prod[male] GE 560.) AND (Length_prod[male] LT 580.), Size560to580Mcount)
      Size580to600M = WHERE((Length_prod[male] GE 580.) AND (Length_prod[male] LT 600.), Size580to600Mcount)
      Size600to620M = WHERE((Length_prod[male] GE 600.) AND (Length_prod[male] LT 620.), Size600to620Mcount)
      Size620to640M = WHERE((Length_prod[male] GE 620.) AND (Length_prod[male] LT 640.), Size620to640Mcount)
      Size640to660M = WHERE((Length_prod[male] GE 640.) AND (Length_prod[male] LT 660.), Size640to660Mcount)
      Size660to680M = WHERE((Length_prod[male] GE 660.) AND (Length_prod[male] LT 680.), Size660to680Mcount)
      Size680to700M = WHERE((Length_prod[male] GE 680.) AND (Length_prod[male] LT 700.), Size680to700Mcount)
      Size700to720M = WHERE((Length_prod[male] GE 700.) AND (Length_prod[male] LT 720.), Size700to720Mcount)
      Size720to740M = WHERE((Length_prod[male] GE 720.) AND (Length_prod[male] LT 740.), Size720to740Mcount)
      Size740to760M = WHERE((Length_prod[male] GE 740.) AND (Length_prod[male] LT 760.), Size740to760Mcount)
      Size760to780M = WHERE((Length_prod[male] GE 760.) AND (Length_prod[male] LT 780.), Size760to780Mcount)
      Size780to800M = WHERE((Length_prod[male] GE 780.) AND (Length_prod[male] LT 800.), Size780to800Mcount)
      SizeGE800M = WHERE((Length_prod[male] GE 800.), SizeGE800Mcount)

      ; assign fish to length groups - females
      SizeLT100F = WHERE(Length_prod[female] LT 100., SizeLT100Fcount)
      Size100to120F = WHERE((Length_prod[female] GE 100.) AND (Length_prod[female] LT 120.), Size100to120Fcount)
      Size120to140F = WHERE((Length_prod[female] GE 120.) AND (Length_prod[female] LT 140.), Size120to140Fcount)
      Size140to160F = WHERE((Length_prod[female] GE 140.) AND (Length_prod[female] LT 160.), Size140to160Fcount)
      Size160to180F = WHERE((Length_prod[female] GE 160.) AND (Length_prod[female] LT 180.), Size160to180Fcount)
      Size180to200F = WHERE((Length_prod[female] GE 180.) AND (Length_prod[female] LT 200.), Size180to200Fcount)
      Size200to220F = WHERE((Length_prod[female] GE 200.) AND (Length_prod[female] LT 220.), Size200to220Fcount)
      Size220to240F = WHERE((Length_prod[female] GE 220.) AND (Length_prod[female] LT 240.), Size220to240Fcount)
      Size240to260F = WHERE((Length_prod[female] GE 240.) AND (Length_prod[female] LT 260.), Size240to260Fcount)
      Size260to280F = WHERE((Length_prod[female] GE 260.) AND (Length_prod[female] LT 280.), Size260to280Fcount)
      Size280to300F = WHERE((Length_prod[female] GE 280.) AND (Length_prod[female] LT 300.), Size280to300Fcount)
      Size300to320F = WHERE((Length_prod[female] GE 300.) AND (Length_prod[female] LT 320.), Size300to320Fcount)
      Size320to340F = WHERE((Length_prod[female] GE 320.) AND (Length_prod[female] LT 340.), Size320to340Fcount)
      Size340to360F = WHERE((Length_prod[female] GE 340.) AND (Length_prod[female] LT 360.), Size340to360Fcount)
      Size360to380F = WHERE((Length_prod[female] GE 360.) AND (Length_prod[female] LT 380.), Size360to380Fcount)
      Size380to400F = WHERE((Length_prod[female] GE 380.) AND (Length_prod[female] LT 400.), Size380to400Fcount)
      Size400to420F = WHERE((Length_prod[female] GE 400.) AND (Length_prod[female] LT 420.), Size400to420Fcount)
      Size420to440F = WHERE((Length_prod[female] GE 420.) AND (Length_prod[female] LT 440.), Size420to440Fcount)
      Size440to460F = WHERE((Length_prod[female] GE 440.) AND (Length_prod[female] LT 460.), Size440to460Fcount)
      Size460to480F = WHERE((Length_prod[female] GE 460.) AND (Length_prod[female] LT 480.), Size460to480Fcount)
      Size480to500F = WHERE((Length_prod[female] GE 480.) AND (Length_prod[female] LT 500.), Size480to500Fcount)
      Size500to520F = WHERE((Length_prod[female] GE 500.) AND (Length_prod[female] LT 520.), Size500to520Fcount)
      Size520to540F = WHERE((Length_prod[female] GE 520.) AND (Length_prod[female] LT 540.), Size520to540Fcount)
      Size540to560F = WHERE((Length_prod[female] GE 540.) AND (Length_prod[female] LT 560.), Size540to560Fcount)
      Size560to580F = WHERE((Length_prod[female] GE 560.) AND (Length_prod[female] LT 580.), Size560to580Fcount)
      Size580to600F = WHERE((Length_prod[female] GE 580.) AND (Length_prod[female] LT 600.), Size580to600Fcount)
      Size600to620F = WHERE((Length_prod[female] GE 600.) AND (Length_prod[female] LT 620.), Size600to620Fcount)
      Size620to640F = WHERE((Length_prod[female] GE 620.) AND (Length_prod[female] LT 640.), Size620to640Fcount)
      Size640to660F = WHERE((Length_prod[female] GE 640.) AND (Length_prod[female] LT 660.), Size640to660Fcount)
      Size660to680F = WHERE((Length_prod[female] GE 660.) AND (Length_prod[female] LT 680.), Size660to680Fcount)
      Size680to700F = WHERE((Length_prod[female] GE 680.) AND (Length_prod[female] LT 700.), Size680to700Fcount)
      Size700to720F = WHERE((Length_prod[female] GE 700.) AND (Length_prod[female] LT 720.), Size700to720Fcount)
      Size720to740F = WHERE((Length_prod[female] GE 720.) AND (Length_prod[female] LT 740.), Size720to740Fcount)
      Size740to760F = WHERE((Length_prod[female] GE 740.) AND (Length_prod[female] LT 760.), Size740to760Fcount)
      Size760to780F = WHERE((Length_prod[female] GE 760.) AND (Length_prod[female] LT 780.), Size760to780Fcount)
      Size780to800F = WHERE((Length_prod[female] GE 780.) AND (Length_prod[female] LT 800.), Size780to800Fcount)
      SizeGE800F = WHERE((Length_prod[female] GE 800.), SizeGE800Fcount)

      ; assign fish to length groups - unknown
      SizeLT100U = WHERE(Length_prod[unknown] LT 100., SizeLT100Ucount)
      Size100to120U = WHERE((Length_prod[unknown] GE 100.) AND (Length_prod[unknown] LT 120.), Size100to120Ucount)
      Size120to140U = WHERE((Length_prod[unknown] GE 120.) AND (Length_prod[unknown] LT 140.), Size120to140Ucount)
      Size140to160U = WHERE((Length_prod[unknown] GE 140.) AND (Length_prod[unknown] LT 160.), Size140to160Ucount)
      Size160to180U = WHERE((Length_prod[unknown] GE 160.) AND (Length_prod[unknown] LT 180.), Size160to180Ucount)
      Size180to200U = WHERE((Length_prod[unknown] GE 180.) AND (Length_prod[unknown] LT 200.), Size180to200Ucount)
      Size200to220U = WHERE((Length_prod[unknown] GE 200.) AND (Length_prod[unknown] LT 220.), Size200to220Ucount)
      Size220to240U = WHERE((Length_prod[unknown] GE 220.) AND (Length_prod[unknown] LT 240.), Size220to240Ucount)
      Size240to260U = WHERE((Length_prod[unknown] GE 240.) AND (Length_prod[unknown] LT 260.), Size240to260Ucount)
      Size260to280U = WHERE((Length_prod[unknown] GE 260.) AND (Length_prod[unknown] LT 280.), Size260to280Ucount)
      Size280to300U = WHERE((Length_prod[unknown] GE 280.) AND (Length_prod[unknown] LT 300.), Size280to300Ucount)
      Size300to320U = WHERE((Length_prod[unknown] GE 300.) AND (Length_prod[unknown] LT 320.), Size300to320Ucount)
      Size320to340U = WHERE((Length_prod[unknown] GE 320.) AND (Length_prod[unknown] LT 340.), Size320to340Ucount)
      Size340to360U = WHERE((Length_prod[unknown] GE 340.) AND (Length_prod[unknown] LT 360.), Size340to360Ucount)
      Size360to380U = WHERE((Length_prod[unknown] GE 360.) AND (Length_prod[unknown] LT 380.), Size360to380Ucount)
      Size380to400U = WHERE((Length_prod[unknown] GE 380.) AND (Length_prod[unknown] LT 400.), Size380to400Ucount)
      Size400to420U = WHERE((Length_prod[unknown] GE 400.) AND (Length_prod[unknown] LT 420.), Size400to420Ucount)
      Size420to440U = WHERE((Length_prod[unknown] GE 420.) AND (Length_prod[unknown] LT 440.), Size420to440Ucount)
      Size440to460U = WHERE((Length_prod[unknown] GE 440.) AND (Length_prod[unknown] LT 460.), Size440to460Ucount)
      Size460to480U = WHERE((Length_prod[unknown] GE 460.) AND (Length_prod[unknown] LT 480.), Size460to480Ucount)
      Size480to500U = WHERE((Length_prod[unknown] GE 480.) AND (Length_prod[unknown] LT 500.), Size480to500Ucount)
      Size500to520U = WHERE((Length_prod[unknown] GE 500.) AND (Length_prod[unknown] LT 520.), Size500to520Ucount)
      Size520to540U = WHERE((Length_prod[unknown] GE 520.) AND (Length_prod[unknown] LT 540.), Size520to540Ucount)
      Size540to560U = WHERE((Length_prod[unknown] GE 540.) AND (Length_prod[unknown] LT 560.), Size540to560Ucount)
      Size560to580U = WHERE((Length_prod[unknown] GE 560.) AND (Length_prod[unknown] LT 580.), Size560to580Ucount)
      Size580to600U = WHERE((Length_prod[unknown] GE 580.) AND (Length_prod[unknown] LT 600.), Size580to600Ucount)
      Size600to620U = WHERE((Length_prod[unknown] GE 600.) AND (Length_prod[unknown] LT 620.), Size600to620Ucount)
      Size620to640U = WHERE((Length_prod[unknown] GE 620.) AND (Length_prod[unknown] LT 640.), Size620to640Ucount)
      Size640to660U = WHERE((Length_prod[unknown] GE 640.) AND (Length_prod[unknown] LT 660.), Size640to660Ucount)
      Size660to680U = WHERE((Length_prod[unknown] GE 660.) AND (Length_prod[unknown] LT 680.), Size660to680Ucount)
      Size680to700U = WHERE((Length_prod[unknown] GE 680.) AND (Length_prod[unknown] LT 700.), Size680to700Ucount)
      Size700to720U = WHERE((Length_prod[unknown] GE 700.) AND (Length_prod[unknown] LT 720.), Size700to720Ucount)
      Size720to740U = WHERE((Length_prod[unknown] GE 720.) AND (Length_prod[unknown] LT 740.), Size720to740Ucount)
      Size740to760U = WHERE((Length_prod[unknown] GE 740.) AND (Length_prod[unknown] LT 760.), Size740to760Ucount)
      Size760to780U = WHERE((Length_prod[unknown] GE 760.) AND (Length_prod[unknown] LT 780.), Size760to780Ucount)
      Size780to800U = WHERE((Length_prod[unknown] GE 780.) AND (Length_prod[unknown] LT 800.), Size780to800Ucount)
      SizeGE800U = WHERE((Length_prod[unknown] GE 800.), SizeGE800Ucount)

      ; basic information for length-age keys
      WBIC_year_key = Length_key[0, *]
      WBIC_key = Length_key[1, *]
      sample_year_key = Length_key[2, *]
      total_N_fish = Length_key[3, *]
      max_length = Length_key[4, *]
      min_length = Length_key[5, *]
      max_age = Length_key[6, *]
      min_age = Length_key[7, *]
      Length_bin_low = Length_key[8, *]
      Length_N_fish = Length_key[9, *]

      uniqWBIC_Year_key = WBIC_Year_key[UNIQ(WBIC_Year_key, SORT(WBIC_Year_key))]
      PRINT, 'Total N of WBIC_year_key', n_elements(uniqWBIC_Year_key)
      uniqWBIC_key = WBIC_key[UNIQ(WBIC_key, SORT(WBIC_key))]
      PRINT, 'Total N of WBIC_Key', n_elements(uniqWBIC_key)
      
      ; probability of being each age class
      ; all fish
      prop_age0 = Length_key[10, *]
      prop_age1 = Length_key[11, *]
      prop_age2 = Length_key[12, *]
      prop_age3 = Length_key[13, *]
      prop_age4 = Length_key[14, *]
      prop_age5 = Length_key[15, *]
      prop_age6 = Length_key[16, *]
      prop_age7 = Length_key[17, *]
      prop_age8 = Length_key[18, *]
      prop_age9 = Length_key[19, *]
      prop_age10 = Length_key[20, *]
      prop_age11 = Length_key[21, *]
      prop_age12 = Length_key[22, *]
      prop_age13 = Length_key[23, *]
      prop_age14 = Length_key[24, *]
      prop_age15 = Length_key[25, *]
      prop_age16 = Length_key[26, *]
      prop_age17 = Length_key[27, *]
      prop_age18 = Length_key[28, *]
      prop_age19 = Length_key[29, *]
      prop_age20 = Length_key[30, *]
      prop_age21 = Length_key[31, *]
      prop_age22 = Length_key[32, *]
      prop_age23 = Length_key[33, *]
      prop_age24 = Length_key[34, *]
      prop_age25 = Length_key[35, *]
      prop_age26 = Length_key[36, *]
      
      ; males
      Length_N_fishM = Length_key[37, *]
      prop_age0M = Length_key[38, *]
      prop_age1M = Length_key[39, *]
      prop_age2M = Length_key[40, *]
      prop_age3M = Length_key[41, *]
      prop_age4M = Length_key[42, *]
      prop_age5M = Length_key[43, *]
      prop_age6M = Length_key[44, *]
      prop_age7M = Length_key[45, *]
      prop_age8M = Length_key[46, *]
      prop_age9M = Length_key[47, *]
      prop_age10M = Length_key[48, *]
      prop_age11M = Length_key[49, *]
      prop_age12M = Length_key[50, *]
      prop_age13M = Length_key[51, *]
      prop_age14M = Length_key[52, *]
      prop_age15M = Length_key[53, *]
      prop_age16M = Length_key[54, *]
      prop_age17M = Length_key[55, *]
      prop_age18M = Length_key[56, *]
      prop_age19M = Length_key[57, *]
      prop_age20M = Length_key[58, *]
      prop_age21M = Length_key[59, *]
      prop_age22M = Length_key[60, *]
      prop_age23M = Length_key[61, *]
      prop_age24M = Length_key[62, *]
      prop_age25M = Length_key[63, *]
      prop_age26M = Length_key[64, *]
      
      ; females
      Length_N_fishF = Length_key[65, *]
      prop_age0F = Length_key[66, *]
      prop_age1F = Length_key[67, *]
      prop_age2F = Length_key[68, *]
      prop_age3F = Length_key[69, *]
      prop_age4F = Length_key[70, *]
      prop_age5F = Length_key[71, *]
      prop_age6F = Length_key[72, *]
      prop_age7F = Length_key[73, *]
      prop_age8F = Length_key[74, *]
      prop_age9F = Length_key[75, *]
      prop_age10F = Length_key[76, *]
      prop_age11F = Length_key[77, *]
      prop_age12F = Length_key[78, *]
      prop_age13F = Length_key[79, *]
      prop_age14F = Length_key[80, *]
      prop_age15F = Length_key[81, *]
      prop_age16F = Length_key[82, *]
      prop_age17F = Length_key[83, *]
      prop_age18F = Length_key[84, *]
      prop_age19F = Length_key[85, *]
      prop_age20F = Length_key[86, *]
      prop_age21F = Length_key[87, *]
      prop_age22F = Length_key[88, *]
      prop_age23F = Length_key[89, *]
      prop_age24F = Length_key[90, *]
      prop_age25F = Length_key[91, *]
      prop_age26F = Length_key[92, *]

      ; array index for WBIC years w/ LAKE-YEAR specific key
      INDEX_lengthdata2 = WHERE((WBIC_year_key[*] EQ WBIC_Year[INDEX_lengthdata[0]]), INDEX_lengthdata2count)

      IF INDEX_lengthdata2count GT 0 THEN BEGIN; if LAKE-YEAR-specific key exists...
        PRINT, 'WBIC_year', WBIC_year_key[INDEX_lengthdata2[0]]
        ;FishAge = FLTARR(n_elements(INDEX_lengthdata2))
        ;FishProb[0:26, INDEX_lengthdata2] = Length_key[10:36, INDEX_lengthdata2]
        ;PRINT, 'FishProb', TOTAL(FishProb[10, INDEX_lengthdata2[21]])

        ; Check if there is any discrepancy between keys and length data (e.g., sampling bias)... 
        length_key_check = FLTARR(37)
        IF (SizeLT100count GT 0) AND (Length_N_fish[INDEX_lengthdata2[0]] LE 0) THEN length_key_check[0] = SizeLT100count
        IF (Size100to120count GT 0) AND (Length_N_fish[INDEX_lengthdata2[1]] LE 0) THEN length_key_check[1] = Size100to120count
        IF (Size120to140count GT 0) AND (Length_N_fish[INDEX_lengthdata2[2]] LE 0) THEN length_key_check[2] = Size120to140count
        IF (Size140to160count GT 0) AND (Length_N_fish[INDEX_lengthdata2[3]] LE 0) THEN length_key_check[3] = Size140to160count
        IF (Size160to180count GT 0) AND (Length_N_fish[INDEX_lengthdata2[4]] LE 0) THEN length_key_check[4] = Size160to180count
        IF (Size180to200count GT 0) AND (Length_N_fish[INDEX_lengthdata2[5]] LE 0) THEN length_key_check[5] = Size180to200count
        IF (Size200to220count GT 0) AND (Length_N_fish[INDEX_lengthdata2[6]] LE 0) THEN length_key_check[6] = Size200to220count
        IF (Size220to240count GT 0) AND (Length_N_fish[INDEX_lengthdata2[7]] LE 0) THEN length_key_check[7] = Size220to240count
        IF (Size240to260count GT 0) AND (Length_N_fish[INDEX_lengthdata2[8]] LE 0) THEN length_key_check[8] = Size240to260count
        IF (Size260to280count GT 0) AND (Length_N_fish[INDEX_lengthdata2[9]] LE 0) THEN length_key_check[9] = Size260to280count
        IF (Size280to300count GT 0) AND (Length_N_fish[INDEX_lengthdata2[10]] LE 0) THEN length_key_check[10] = Size280to300count
        IF (Size300to320count GT 0) AND (Length_N_fish[INDEX_lengthdata2[11]] LE 0) THEN length_key_check[11] = Size300to320count
        IF (Size320to340count GT 0) AND (Length_N_fish[INDEX_lengthdata2[12]] LE 0) THEN length_key_check[12] = Size320to340count
        IF (Size340to360count GT 0) AND (Length_N_fish[INDEX_lengthdata2[13]] LE 0) THEN length_key_check[13] = Size340to360count
        IF (Size360to380count GT 0) AND (Length_N_fish[INDEX_lengthdata2[14]] LE 0) THEN length_key_check[14] = Size360to380count
        IF (Size380to400count GT 0) AND (Length_N_fish[INDEX_lengthdata2[15]] LE 0) THEN length_key_check[15] = Size380to400count
        IF (Size400to420count GT 0) AND (Length_N_fish[INDEX_lengthdata2[16]] LE 0) THEN length_key_check[16] = Size400to420count
        IF (Size420to440count GT 0) AND (Length_N_fish[INDEX_lengthdata2[17]] LE 0) THEN length_key_check[17] = Size420to440count
        IF (Size440to460count GT 0) AND (Length_N_fish[INDEX_lengthdata2[18]] LE 0) THEN length_key_check[18] = Size440to460count
        IF (Size460to480count GT 0) AND (Length_N_fish[INDEX_lengthdata2[19]] LE 0) THEN length_key_check[19] = Size460to480count
        IF (Size480to500count GT 0) AND (Length_N_fish[INDEX_lengthdata2[20]] LE 0) THEN length_key_check[20] = Size480to500count
        IF (Size500to520count GT 0) AND (Length_N_fish[INDEX_lengthdata2[21]] LE 0) THEN length_key_check[21] = Size500to520count
        IF (Size520to540count GT 0) AND (Length_N_fish[INDEX_lengthdata2[22]] LE 0) THEN length_key_check[22] = Size520to540count
        IF (Size540to560count GT 0) AND (Length_N_fish[INDEX_lengthdata2[23]] LE 0) THEN length_key_check[23] = Size540to560count
        IF (Size560to580count GT 0) AND (Length_N_fish[INDEX_lengthdata2[24]] LE 0) THEN length_key_check[24] = Size560to580count
        IF (Size580to600count GT 0) AND (Length_N_fish[INDEX_lengthdata2[25]] LE 0) THEN length_key_check[25] = Size580to600count
        IF (Size600to620count GT 0) AND (Length_N_fish[INDEX_lengthdata2[26]] LE 0) THEN length_key_check[26] = Size600to620count
        IF (Size620to640count GT 0) AND (Length_N_fish[INDEX_lengthdata2[27]] LE 0) THEN length_key_check[27] = Size620to640count
        IF (Size640to660count GT 0) AND (Length_N_fish[INDEX_lengthdata2[28]] LE 0) THEN length_key_check[28] = Size640to660count
        IF (Size660to680count GT 0) AND (Length_N_fish[INDEX_lengthdata2[29]] LE 0) THEN length_key_check[29] = Size660to680count
        IF (Size680to700count GT 0) AND (Length_N_fish[INDEX_lengthdata2[30]] LE 0) THEN length_key_check[30] = Size680to700count
        IF (Size700to720count GT 0) AND (Length_N_fish[INDEX_lengthdata2[31]] LE 0) THEN length_key_check[31] = Size700to720count
        IF (Size720to740count GT 0) AND (Length_N_fish[INDEX_lengthdata2[32]] LE 0) THEN length_key_check[32] = Size720to740count
        IF (Size740to760count GT 0) AND (Length_N_fish[INDEX_lengthdata2[33]] LE 0) THEN length_key_check[33] = Size740to760count
        IF (Size760to780count GT 0) AND (Length_N_fish[INDEX_lengthdata2[34]] LE 0) THEN length_key_check[34] = Size760to780count
        IF (Size780to800count GT 0) AND (Length_N_fish[INDEX_lengthdata2[35]] LE 0) THEN length_key_check[35] = Size780to8000count
        IF (SizeGE800count GT 0) AND (Length_N_fish[INDEX_lengthdata2[36]] LE 0) THEN length_key_check[36] = SizeGE800count
        PRINT, 'total N of fish w/o key', TOTAL(length_key_check)
        paramset[212, i] = TOTAL(length_key_check)
        PRINT, 'size bins w/o key', length_key_check

        AgeLengthKeyCheck1 = (TOTAL(length_key_check)/N_ELEMENTS(Length_prod)); proportion of length classes that do not have keys
        PRINT, 'AgeLengthKeyCheck1', AgeLengthKeyCheck1
        IF AgeLengthKeyCheck1 LT AgeLengthKeyLevel THEN BEGIN; at least 15% of length classes need to have keys to proceed...
          ; Counter for lake years with the length-age key
          PRINT, 'Lake-year key availabile'
          N_Lake_year_Wkeys = N_Lake_year_Wkeys + 1L
          PRINT, 'N of lake-year with key', N_Lake_year_Wkeys
          paramset[211, i] = 1; age-length key type

          ; 1.Assign age semi-randomly to lengths - all fish
          IF SizeLT100count GT 0 then begin
            LengthBinIndex1 = 0
            LengthBinIndex2 = SizeLT100
            FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
              , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
              , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
              , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
              , prop_age26, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, $
              FishProb, FishAge[LengthBinIndex2], i+NumLengthBin+adj)
            WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
            WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
            AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2 $
              , FishProb, FishAge[LengthBinIndex2] $
              , i+NumLengthBin+adj)
            ;FishAge[LengthBinIndex2]= AgeAssignInd
          ENDIF
          IF Size100to120count GT 0 then begin
            LengthBinIndex1 = 1
            LengthBinIndex2 = Size100to120
            FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
              , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
              , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
              , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
              , prop_age26, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
              , i+NumLengthBin+adj)
            WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
            WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
            AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
              , i+NumLengthBin+adj)
            ;FishAge[LengthBinIndex2]= AgeAssignInd
          ENDIF
          IF Size120to140count GT 0 then begin
            LengthBinIndex1 = 2
            LengthBinIndex2 = Size120to140
            FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
              , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
              , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
              , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
              , prop_age26, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
              , i+NumLengthBin+adj)
            WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
            WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
            AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
              , i+NumLengthBin+adj)
            ;FishAge[LengthBinIndex2]= AgeAssignInd
          ENDIF
          IF Size140to160count GT 0 then begin
            LengthBinIndex1 = 3
            LengthBinIndex2 = Size140to160
            FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
              , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
              , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
              , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
              , prop_age26, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
              , i+NumLengthBin+adj)
            WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
            WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
            AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
              , i+NumLengthBin+adj)
            ;FishAge[LengthBinIndex2]= AgeAssignInd
          ENDIF
          IF Size160to180count GT 0 THEN BEGIN
            LengthBinIndex1 = 4
            LengthBinIndex2 = Size160to180
            FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
              , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
              , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
              , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
              , prop_age26, INDEX_lengthdata2, LengthBinIndex1)            
            AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
              , i+NumLengthBin+adj)
            WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
            WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
            AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
              , i+NumLengthBin+adj)
            ;FishAge[LengthBinIndex2]= AgeAssignInd
          ENDIF
          IF Size180to200count GT 0 then begin
            LengthBinIndex1 = 5
            LengthBinIndex2 = Size180to200
            FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
              , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
              , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
              , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
              , prop_age26, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
              , i+NumLengthBin+adj)
            WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
            WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
            AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
              , i+NumLengthBin+adj)
            ;FishAge[LengthBinIndex2]= AgeAssignInd
          ENDIF
          IF Size200to220count GT 0 then begin
            LengthBinIndex1 = 6
            LengthBinIndex2 = Size200to220
            FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
              , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
              , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
              , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
              , prop_age26, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
              , i+NumLengthBin+adj)
            WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
            WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
            AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
              , i+NumLengthBin+adj)
            ;FishAge[LengthBinIndex2]= AgeAssignInd
          ENDIF
          IF Size220to240count GT 0 then begin
            LengthBinIndex1 = 7
            LengthBinIndex2 = Size220to240
            FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
              , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
              , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
              , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
              , prop_age26, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
              , i+NumLengthBin+adj)
            WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
            WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
            AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
              , i+NumLengthBin+adj)
            ;FishAge[LengthBinIndex2]= AgeAssignInd
          ENDIF
          IF Size240to260count GT 0 then begin
            LengthBinIndex1 = 8
            LengthBinIndex2 = Size240to260
            FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
              , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
              , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
              , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
              , prop_age26, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
              , i+NumLengthBin+adj)
            WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
            WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
            AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
              , i+NumLengthBin+adj)
            ;FishAge[LengthBinIndex2]= AgeAssignInd
          ENDIF
          IF Size260to280count GT 0 then begin
            LengthBinIndex1 = 9
            LengthBinIndex2 = Size260to280
            FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
              , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
              , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
              , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
              , prop_age26, INDEX_lengthdata2, LengthBinIndex1)           
            AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
              , i+NumLengthBin+adj)
            WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
            WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
            AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
              , i+NumLengthBin+adj)
            ;FishAge[LengthBinIndex2]= AgeAssignInd
          ENDIF
          IF Size280to300count GT 0 then begin
            LengthBinIndex1 = 10
            LengthBinIndex2 = Size280to300
            FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
              , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
              , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
              , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
              , prop_age26, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
              , i+NumLengthBin+adj)
            WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
            WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
            AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
              , i+NumLengthBin+adj)
            ;FishAge[LengthBinIndex2]= AgeAssignInd
          ENDIF
          IF Size300to320count GT 0 then begin
            LengthBinIndex1 = 11
            LengthBinIndex2 = Size300to320
            FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
              , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
              , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
              , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
              , prop_age26, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
              , i+NumLengthBin+adj)
            WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
            WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
            AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
              , i+NumLengthBin+adj)
            ;FishAge[LengthBinIndex2]= AgeAssignInd
          ENDIF
          IF Size320to340count GT 0 then begin
            LengthBinIndex1 = 12
            LengthBinIndex2 = Size320to340
            FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
              , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
              , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
              , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
              , prop_age26, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
              , i+NumLengthBin+adj)
            WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
            WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
            AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
              , i+NumLengthBin+adj)
            ;FishAge[LengthBinIndex2]= AgeAssignInd
          ENDIF
          IF Size340to360count GT 0 then begin
            LengthBinIndex1 = 13
            LengthBinIndex2 = Size340to360
            FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
              , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
              , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
              , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
              , prop_age26, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
              , i+NumLengthBin+adj)
            WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
            WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
            AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
              , i+NumLengthBin+adj)
            ;FishAge[LengthBinIndex2]= AgeAssignInd
          ENDIF
          IF Size360to380count GT 0 then begin
            LengthBinIndex1 = 14
            LengthBinIndex2 = Size360to380
            FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
              , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
              , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
              , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
              , prop_age26, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
              , i+NumLengthBin+adj)
            WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
            WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
            AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
              , i+NumLengthBin+adj)
          ENDIF
          IF Size380to400count GT 0 then begin
            LengthBinIndex1 = 15
            LengthBinIndex2 = Size380to400
            FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
              , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
              , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
              , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
              , prop_age26, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
              , i+NumLengthBin+adj)
            WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
            WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
            AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
              , i+NumLengthBin+adj)
            ;FishAge[LengthBinIndex2]= AgeAssignInd
          ENDIF
          IF Size400to420count GT 0 then begin
            LengthBinIndex1 = 16
            LengthBinIndex2 = Size400to420
            FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
              , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
              , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
              , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
              , prop_age26, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
              , i+NumLengthBin+adj)
            WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
            WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
            AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
              , i+NumLengthBin+adj)
            ;FishAge[LengthBinIndex2]= AgeAssignInd
          ENDIF
          IF Size420to440count GT 0 then begin
            LengthBinIndex1 = 17
            LengthBinIndex2 = Size420to440
            FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
              , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
              , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
              , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
              , prop_age26, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
              , i+NumLengthBin+adj)
            WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
            WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
            AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
              , i+NumLengthBin+adj)
            ;FishAge[LengthBinIndex2]= AgeAssignInd
          ENDIF
          IF Size440to460count GT 0 then begin
            LengthBinIndex1 = 18
            LengthBinIndex2 = Size440to460
            FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
              , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
              , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
              , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
              , prop_age26, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
              , i+NumLengthBin+adj)
            WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
            WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
            AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
              , i+NumLengthBin+adj)
            ;FishAge[LengthBinIndex2]= AgeAssignInd
          ENDIF
          IF Size460to480count GT 0 then begin
            LengthBinIndex1 = 19
            LengthBinIndex2 = Size460to480
            FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
              , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
              , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
              , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
              , prop_age26, INDEX_lengthdata2, LengthBinIndex1)            
            AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
              , i+NumLengthBin+adj)
            WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
            WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
            AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
              , i+NumLengthBin+adj)
            ;FishAge[LengthBinIndex2]= AgeAssignInd
          ENDIF
          IF Size480to500count GT 0 then begin
            LengthBinIndex1 = 20
            LengthBinIndex2 = Size480to500
            FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
              , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
              , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
              , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
              , prop_age26, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
              , i+NumLengthBin+adj)
            WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
            WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
            AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
              , i+NumLengthBin+adj)
            ;FishAge[LengthBinIndex2]= AgeAssignInd
          ENDIF
          IF Size500to520count GT 0 then begin
            LengthBinIndex1 = 21
            LengthBinIndex2 = Size500to520
            FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
              , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
              , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
              , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
              , prop_age26, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
              , i+NumLengthBin+adj)
            WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
            WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
            AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
              , i+NumLengthBin+adj)
            ;FishAge[LengthBinIndex2]= AgeAssignInd
          ENDIF
          IF Size520to540count GT 0 then begin
            LengthBinIndex1 = 22
            LengthBinIndex2 = Size520to540
            FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
              , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
              , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
              , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
              , prop_age26, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
              , i+NumLengthBin+adj)
            WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
            WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
            AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
              , i+NumLengthBin+adj)
            ;FishAge[LengthBinIndex2]= AgeAssignInd
          ENDIF
          IF Size540to560count GT 0 then begin
            LengthBinIndex1 = 23
            LengthBinIndex2 = Size540to560
            FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
              , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
              , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
              , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
              , prop_age26, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
              , i+NumLengthBin+adj)
            WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
            WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
            AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
              , i+NumLengthBin+adj)
            ;FishAge[LengthBinIndex2]= AgeAssignInd
          ENDIF
          IF Size560to580count GT 0 then begin
            LengthBinIndex1 = 24
            LengthBinIndex2 = Size560to580
            FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
              , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
              , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
              , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
              , prop_age26, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
              , i+NumLengthBin+adj)
            WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
            WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
            AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
              , i+NumLengthBin+adj)
            ;FishAge[LengthBinIndex2]= AgeAssignInd
          ENDIF
          IF Size580to600count GT 0 then begin
            LengthBinIndex1 = 25
            LengthBinIndex2 = Size580to600
            FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
              , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
              , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
              , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
              , prop_age26, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
              , i+NumLengthBin+adj)
            WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
            WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
            AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
              , i+NumLengthBin+adj)
            ;FishAge[LengthBinIndex2]= AgeAssignInd
          ENDIF
          IF Size600to620count GT 0 then begin
            LengthBinIndex1 = 26
            LengthBinIndex2 = Size600to620
            FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
              , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
              , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
              , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
              , prop_age26, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
              , i+NumLengthBin+adj)
            WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
            WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
            AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
              , i+NumLengthBin+adj)
            ;FishAge[LengthBinIndex2]= AgeAssignInd
          ENDIF
          IF Size620to640count GT 0 then begin
            LengthBinIndex1 = 27
            LengthBinIndex2 = Size620to640
            FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
              , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
              , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
              , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
              , prop_age26, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
              , i+NumLengthBin+adj)
            WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
            WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
            AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
              , i+NumLengthBin+adj)
            ;FishAge[LengthBinIndex2]= AgeAssignInd
          ENDIF
          IF Size640to660count GT 0 then begin
            LengthBinIndex1 = 28
            LengthBinIndex2 = Size640to660
            FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
              , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
              , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
              , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
              , prop_age26, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
              , i+NumLengthBin+adj)
            WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
            WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
            AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
              , i+NumLengthBin+adj)
            ;FishAge[LengthBinIndex2]= AgeAssignInd
          ENDIF
          IF Size660to680count GT 0 then begin
            LengthBinIndex1 = 29
            LengthBinIndex2 = Size660to680
            FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
              , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
              , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
              , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
              , prop_age26, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
              , i+NumLengthBin+adj)
            WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
            WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
            AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
              , i+NumLengthBin+adj)
            ;FishAge[LengthBinIndex2]= AgeAssignInd
          ENDIF
          IF Size680to700count GT 0 then begin
            LengthBinIndex1 = 30
            LengthBinIndex2 = Size680to700
            FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
              , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
              , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
              , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
              , prop_age26, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
              , i+NumLengthBin+adj)
            WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
            WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
            AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
              , i+NumLengthBin+adj)
            ;FishAge[LengthBinIndex2]= AgeAssignInd
          ENDIF
          IF Size700to720count GT 0 then begin
            LengthBinIndex1 = 31
            LengthBinIndex2 = Size700to720
            FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
              , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
              , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
              , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
              , prop_age26, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
              , i+NumLengthBin+adj)
            WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
            WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
            AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
              , i+NumLengthBin+adj)
            ;FishAge[LengthBinIndex2]= AgeAssignInd
          ENDIF
          IF Size720to740count GT 0 then begin
            LengthBinIndex1 = 32
            LengthBinIndex2 = Size720to740
            FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
              , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
              , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
              , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
              , prop_age26, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
              , i+NumLengthBin+adj)
            WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
            WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
            AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
              , i+NumLengthBin+adj)
          ENDIF
          IF Size740to760count GT 0 then begin
            LengthBinIndex1 = 33
            LengthBinIndex2 = Size740to760
            FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
              , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
              , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
              , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
              , prop_age26, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
              , i+NumLengthBin+adj)
            WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
            WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
            AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
              , i+NumLengthBin+adj)
            ;FishAge[LengthBinIndex2]= AgeAssignInd
          ENDIF
          IF Size760to780count GT 0 then begin
            LengthBinIndex1 = 34
            LengthBinIndex2 = Size760to780
            FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
              , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
              , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
              , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
              , prop_age26, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
              , i+NumLengthBin+adj)
            WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
            WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
            AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
              , i+NumLengthBin+adj)
            ;FishAge[LengthBinIndex2]= AgeAssignInd
          ENDIF
          IF Size780to800count GT 0 then begin
            LengthBinIndex1 = 35
            LengthBinIndex2 = Size780to800
            FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
              , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
              , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
              , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
              , prop_age26, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
              , i+NumLengthBin+adj)
            WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
            WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
            AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
              , i+NumLengthBin+adj)
            ;FishAge[LengthBinIndex2]= AgeAssignInd
          ENDIF
          IF Sizege800count GT 0 then begin
            LengthBinIndex1 = 36
            LengthBinIndex2 = SizeGE800
            FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
              , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
              , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
              , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
              , prop_age26, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
              , i+NumLengthBin+adj)
            WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
            WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
            AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
              , i+NumLengthBin+adj)
          ENDIF

          ; 1. Assign age semi-randomly to lengths - MALES
          IF SizeLT100Mcount GT 0 THEN BEGIN
            LengthBinIndex1 = 0
            LengthBinIndex2 = SizeLT100M
            FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
              , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
              , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
              , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
              , prop_age26M, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
              , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
            WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
            AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
            FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
          ENDIF
          IF Size100to120Mcount GT 0 THEN BEGIN
            LengthBinIndex1 = 1
            LengthBinIndex2 = Size100to120M
            FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
              , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
              , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
              , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
              , prop_age26M, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
              , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
            WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
            AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
            FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
          ENDIF
          IF Size120to140Mcount GT 0 THEN BEGIN
            LengthBinIndex1 = 2
            LengthBinIndex2 = Size120to140M
            FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
              , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
              , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
              , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
              , prop_age26M, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
              , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
            WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
            AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
            FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
          ENDIF
          IF Size140to160Mcount GT 0 THEN BEGIN
            LengthBinIndex1 = 3
            LengthBinIndex2 = Size140to160M
            FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
              , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
              , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
              , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
              , prop_age26M, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
              , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
            WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
            AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
            FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
          ENDIF
          IF Size160to180Mcount GT 0 THEN BEGIN
            LengthBinIndex1 = 4
            LengthBinIndex2 = Size160to180M
             FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
              , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
              , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
              , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
              , prop_age26M, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
              , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
            WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
            AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
            FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
          ENDIF
          IF Size180to200Mcount GT 0 THEN BEGIN
            LengthBinIndex1 = 5
            LengthBinIndex2 = Size180to200M
            FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
              , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
              , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
              , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
              , prop_age26M, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
              , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
            WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
            AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
            FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
          ENDIF
          IF Size200to220Mcount GT 0 THEN BEGIN
            LengthBinIndex1 = 6
            LengthBinIndex2 = Size200to220M
            FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
              , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
              , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
              , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
              , prop_age26M, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
              , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
            WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
            ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
            AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
            FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
            FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
          ENDIF
          IF Size220to240Mcount GT 0 THEN BEGIN
            LengthBinIndex1 = 7
            LengthBinIndex2 = Size220to240M
            FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
              , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
              , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
              , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
              , prop_age26M, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
              , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
            WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
            ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
            AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
            FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
            FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
          ENDIF
          IF Size240to260Mcount GT 0 THEN BEGIN
            LengthBinIndex1 = 8
            LengthBinIndex2 = Size240to260M
            FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
              , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
              , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
              , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
              , prop_age26M, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
              , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
            WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
            ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
            AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
            FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
            FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
          ENDIF
          IF Size260to280Mcount GT 0 THEN BEGIN
            LengthBinIndex1 = 9
            LengthBinIndex2 = Size260to280M
             FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
              , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
              , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
              , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
              , prop_age26M, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
              , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
            WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
            ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
            AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
            FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
            FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
          ENDIF
          IF Size280to300Mcount GT 0 THEN BEGIN
            LengthBinIndex1 = 10
            LengthBinIndex2 = Size280to300M
            FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
              , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
              , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
              , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
              , prop_age26M, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
              , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
            WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
            ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
            AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
            FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
            FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
          ENDIF
          IF Size300to320Mcount GT 0 THEN BEGIN
            LengthBinIndex1 = 11
            LengthBinIndex2 = Size300to320M
            FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
              , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
              , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
              , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
              , prop_age26M, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
              , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
            WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
            ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
            AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
            FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
            FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
          ENDIF
          IF Size320to340Mcount GT 0 THEN BEGIN
            LengthBinIndex1 = 12
            LengthBinIndex2 = Size320to340M
            FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
              , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
              , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
              , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
              , prop_age26M, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
              , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
            WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
            ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
            AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
            FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
            FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
          ENDIF
          IF Size340to360Mcount GT 0 THEN BEGIN
            LengthBinIndex1 = 13
            LengthBinIndex2 = Size340to360M
             FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
              , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
              , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
              , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
              , prop_age26M, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
              , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
            WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
            ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
            AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
            FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
            FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
          ENDIF
          IF Size360to380Mcount GT 0 THEN BEGIN
            LengthBinIndex1 = 14
            LengthBinIndex2 = Size360to380M
            FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
              , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
              , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
              , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
              , prop_age26M, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
              , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
            WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
            ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
            AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
            FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
            FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
          ENDIF
          IF Size380to400Mcount GT 0 THEN BEGIN
            LengthBinIndex1 = 15
            LengthBinIndex2 = Size380to400M
            FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
              , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
              , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
              , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
              , prop_age26M, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
              , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
            WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
            ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
            AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
            FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
            FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
          ENDIF
          IF Size400to420Mcount GT 0 THEN BEGIN
            LengthBinIndex1 = 16
            LengthBinIndex2 = Size400to420M
            FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
              , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
              , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
              , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
              , prop_age26M, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
              , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
            WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
            ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
            AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
            FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
            FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
          ENDIF
          IF Size420to440Mcount GT 0 THEN BEGIN
            LengthBinIndex1 = 17
            LengthBinIndex2 = Size420to440M
            FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
              , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
              , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
              , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
              , prop_age26M, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
              , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
            WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
            ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
            AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
            FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
            FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
          ENDIF
          IF Size440to460Mcount GT 0 THEN BEGIN
            LengthBinIndex1 = 18
            LengthBinIndex2 = Size440to460M
             FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
              , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
              , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
              , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
              , prop_age26M, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
              , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
            WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
            ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
            AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
            FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
            FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
          ENDIF
          IF Size460to480Mcount GT 0 THEN BEGIN
            LengthBinIndex1 = 19
            LengthBinIndex2 = Size460to480M
            FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
              , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
              , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
              , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
              , prop_age26M, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
              , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
            WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
            ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
            AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
            FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
            FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
          ENDIF
          IF Size480to500Mcount GT 0 THEN BEGIN
            LengthBinIndex1 = 20
            LengthBinIndex2 = Size480to500M
             FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
              , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
              , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
              , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
              , prop_age26M, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
              , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
            WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
            ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
            AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
            FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
            FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
          ENDIF
          IF Size500to520Mcount GT 0 THEN BEGIN
            LengthBinIndex1 = 21
            LengthBinIndex2 = Size500to520M
            FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
              , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
              , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
              , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
              , prop_age26M, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
              , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
            WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
            ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
            AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
            FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
            FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
          ENDIF
          IF Size520to540Mcount GT 0 THEN BEGIN
            LengthBinIndex1 = 22
            LengthBinIndex2 = Size520to540M
             FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
              , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
              , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
              , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
              , prop_age26M, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
              , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
            WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
            ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
            AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
            FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
            FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
          ENDIF
          IF Size540to560Mcount GT 0 THEN BEGIN
            LengthBinIndex1 = 23
            LengthBinIndex2 = Size540to560M
             FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
              , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
              , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
              , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
              , prop_age26M, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
              , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
            WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
            ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
            AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
            FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
            FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
          ENDIF
          IF Size560to580Mcount GT 0 THEN BEGIN
            LengthBinIndex1 = 24
            LengthBinIndex2 = Size560to580M
             FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
              , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
              , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
              , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
              , prop_age26M, INDEX_lengthdata2, LengthBinIndex1)
            ;PRINT, 'FishProb', FishProb
            AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
              , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
            WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
            ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
            AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
            FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
            FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
          ENDIF
          IF Size580to600Mcount GT 0 THEN BEGIN
            LengthBinIndex1 = 25
            LengthBinIndex2 = Size580to600M
            FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
              , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
              , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
              , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
              , prop_age26M, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
              , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
            WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
            ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
            AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
            FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
            FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
          ENDIF
          IF Size600to620Mcount GT 0 THEN BEGIN
            LengthBinIndex1 = 26
            LengthBinIndex2 = Size600to620M
             FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
              , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
              , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
              , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
              , prop_age26M, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
              , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
            WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
            ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
            AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
            FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
            FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
          ENDIF
          IF Size620to640Mcount GT 0 THEN BEGIN
            LengthBinIndex1 = 27
            LengthBinIndex2 = Size620to640M
            FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
              , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
              , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
              , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
              , prop_age26M, INDEX_lengthdata2, LengthBinIndex1)
            ;PRINT, 'FishProb', FishProb
            AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
              , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
            WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
            ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
            AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
            FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
            FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
          ENDIF
          IF Size640to660Mcount GT 0 THEN BEGIN
            LengthBinIndex1 = 28
            LengthBinIndex2 = Size640to660M
             FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
              , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
              , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
              , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
              , prop_age26M, INDEX_lengthdata2, LengthBinIndex1)
            ;PRINT, 'FishProb', FishProb
            AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
              , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
            WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
            ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
            AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
            FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
            FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
          ENDIF
          IF Size660to680Mcount GT 0 THEN BEGIN
            LengthBinIndex1 = 29
            LengthBinIndex2 = Size660to680M
            FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
              , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
              , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
              , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
              , prop_age26M, INDEX_lengthdata2, LengthBinIndex1)
            ;PRINT, 'FishProb', FishProb
            AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
              , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
            WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
            ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
            AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
            FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
            FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
          ENDIF
          IF Size680to700Mcount GT 0 THEN BEGIN
            LengthBinIndex1 = 30
            LengthBinIndex2 = Size680to700M
            FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
              , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
              , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
              , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
              , prop_age26M, INDEX_lengthdata2, LengthBinIndex1)
            ;PRINT, 'FishProb', FishProb
            AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
              , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
            WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
            ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
            AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
            FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
            FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
          ENDIF
          IF Size700to720Mcount GT 0 THEN BEGIN
            LengthBinIndex1 = 31
            LengthBinIndex2 = Size700to720M
            FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
              , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
              , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
              , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
              , prop_age26M, INDEX_lengthdata2, LengthBinIndex1)
            ;PRINT, 'FishProb', FishProb
            AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
              , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
            WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
            ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
            AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
            FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
            FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
          ENDIF
          IF Size720to740Mcount GT 0 THEN BEGIN
            LengthBinIndex1 = 32
            LengthBinIndex2 = Size720to740M
             FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
              , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
              , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
              , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
              , prop_age26M, INDEX_lengthdata2, LengthBinIndex1)
            ;PRINT, 'FishProb', FishProb
            AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
              , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
            WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
            ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
            AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
            FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
            FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
          ENDIF
          IF Size740to760Mcount GT 0 THEN BEGIN
            LengthBinIndex1 = 33
            LengthBinIndex2 = Size740to760M
            FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
              , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
              , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
              , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
              , prop_age26M, INDEX_lengthdata2, LengthBinIndex1)
            ;PRINT, 'FishProb', FishProb
            AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
              , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
            WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
            ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
            AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
            FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
            FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
          ENDIF
          IF Size760to780Mcount GT 0 THEN BEGIN
            LengthBinIndex1 = 34
            LengthBinIndex2 = Size760to780M
            FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
              , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
              , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
              , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
              , prop_age26M, INDEX_lengthdata2, LengthBinIndex1)
            ;PRINT, 'FishProb', FishProb
            AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
              , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
            WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
            ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
            AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
            FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
            FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
          ENDIF
          IF Size780to800Mcount GT 0 THEN BEGIN
            LengthBinIndex1 = 35
            LengthBinIndex2 = Size780to800M
             FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
              , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
              , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
              , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
              , prop_age26M, INDEX_lengthdata2, LengthBinIndex1)
            ;PRINT, 'FishProb', FishProb
            AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
              , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
            WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
            ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
            AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
            FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
            FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
          ENDIF
          IF Sizege800Mcount GT 0 THEN BEGIN
            LengthBinIndex1 = 36
            LengthBinIndex2 = SizeGE800M
             FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
              , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
              , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
              , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
              , prop_age26M, INDEX_lengthdata2, LengthBinIndex1)
            ;PRINT, 'FishProb', FishProb
            AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
              , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
            WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
            ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
            AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
            FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
            FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
          ENDIF

          ; 1.Assign age semi-randomly to lengths - FEMALES
          IF SizeLT100Fcount GT 0 THEN BEGIN
            LengthBinIndex1 = 0
            LengthBinIndex2 = SizeLT100F
            FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
              , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
              , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
              , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
              , prop_age26F, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
              , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
            WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
            ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
            AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
            FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
            FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
          ENDIF
          IF Size100to120Fcount GT 0 THEN BEGIN
            LengthBinIndex1 = 1
            LengthBinIndex2 = Size100to120F
            FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
              , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
              , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
              , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
              , prop_age26F, INDEX_lengthdata2, LengthBinIndex1)
            ;PRINT, 'FishProb', FishProb
            AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
              , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
            WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
            ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
            AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
            FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
            FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
          ENDIF
          IF Size120to140Fcount GT 0 THEN BEGIN
            LengthBinIndex1 = 2
            LengthBinIndex2 = Size120to140F
            FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
              , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
              , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
              , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
              , prop_age26F, INDEX_lengthdata2, LengthBinIndex1)
            ;PRINT, 'FishProb', FishProb
            AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
              , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
            WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
            ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
            AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
            FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
            FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
          ENDIF
          IF Size140to160Fcount GT 0 THEN BEGIN
            LengthBinIndex1 = 3
            LengthBinIndex2 = Size140to160F
            FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
              , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
              , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
              , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
              , prop_age26F, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
              , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
            WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
            ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
            AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
            FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
            FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
          ENDIF
          IF Size160to180Fcount GT 0 THEN BEGIN
            LengthBinIndex1 = 4
            LengthBinIndex2 = Size160to180F
            FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
              , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
              , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
              , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
              , prop_age26F, INDEX_lengthdata2, LengthBinIndex1)
            ;PRINT, 'FishProb', FishProb
            AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
              , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
            WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
            ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
            AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
            FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
            FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
          ENDIF
          IF Size180to200Fcount GT 0 THEN BEGIN
            LengthBinIndex1 = 5
            LengthBinIndex2 = Size180to200F
             FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
              , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
              , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
              , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
              , prop_age26F, INDEX_lengthdata2, LengthBinIndex1)
            ;PRINT, 'FishProb', FishProb
            AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
              , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
            WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
            ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
            AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
            FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
            FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
          ENDIF
          IF Size200to220Fcount GT 0 THEN BEGIN
            LengthBinIndex1 = 6
            LengthBinIndex2 = Size200to220F
            FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
              , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
              , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
              , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
              , prop_age26F, INDEX_lengthdata2, LengthBinIndex1)
            ;PRINT, 'FishProb', FishProb
            AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
              , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
            WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
            ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
            AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
            FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
            FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
          ENDIF
          IF Size220to240Fcount GT 0 THEN BEGIN
            LengthBinIndex1 = 7
            LengthBinIndex2 = Size220to240F
            FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
              , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
              , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
              , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
              , prop_age26F, INDEX_lengthdata2, LengthBinIndex1)
            ;PRINT, 'FishProb', FishProb
            AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
              , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
            WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
            ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
            AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
            FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
            FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
          ENDIF
          IF Size240to260Fcount GT 0 THEN BEGIN
            LengthBinIndex1 = 8
            LengthBinIndex2 = Size240to260F
            FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
              , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
              , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
              , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
              , prop_age26F, INDEX_lengthdata2, LengthBinIndex1)
            ;PRINT, 'FishProb', FishProb
            AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
              , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
            WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
            ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
            AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
            FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
            FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
          ENDIF
          IF Size260to280Fcount GT 0 THEN BEGIN
            LengthBinIndex1 = 9
            LengthBinIndex2 = Size260to280F
            FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
              , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
              , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
              , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
              , prop_age26F, INDEX_lengthdata2, LengthBinIndex1)
            ;PRINT, 'FishProb', FishProb
            AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
              , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
            WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
            ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
            AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
            FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
            FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
          ENDIF
          IF Size280to300Fcount GT 0 THEN BEGIN
            LengthBinIndex1 = 10
            LengthBinIndex2 = Size280to300F
             FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
              , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
              , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
              , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
              , prop_age26F, INDEX_lengthdata2, LengthBinIndex1)
            ;PRINT, 'FishProb', FishProb
            AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
              , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
            WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
            ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
            AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
            FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
            FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
          ENDIF
          IF Size300to320Fcount GT 0 THEN BEGIN
            LengthBinIndex1 = 11
            LengthBinIndex2 = Size300to320F
             FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
              , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
              , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
              , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
              , prop_age26F, INDEX_lengthdata2, LengthBinIndex1)
            ;PRINT, 'FishProb', FishProb
            AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
              , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
            WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
            ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
            AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
            FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
            FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
          ENDIF
          IF Size320to340Fcount GT 0 THEN BEGIN
            LengthBinIndex1 = 12
            LengthBinIndex2 = Size320to340F
            FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
              , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
              , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
              , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
              , prop_age26F, INDEX_lengthdata2, LengthBinIndex1)
            ;PRINT, 'FishProb', FishProb
            AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
              , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
            WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
            ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
            AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
            FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
            FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
          ENDIF
          IF Size340to360Fcount GT 0 THEN BEGIN
            LengthBinIndex1 = 13
            LengthBinIndex2 = Size340to360F
            FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
              , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
              , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
              , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
              , prop_age26F, INDEX_lengthdata2, LengthBinIndex1)
            ;PRINT, 'FishProb', FishProb    
            AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
              , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
            WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
            ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
            AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
            FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
            FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
          ENDIF
          IF Size360to380Fcount GT 0 THEN BEGIN
            LengthBinIndex1 = 14
            LengthBinIndex2 = Size360to380F
            FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
              , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
              , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
              , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
              , prop_age26F, INDEX_lengthdata2, LengthBinIndex1)
            ;PRINT, 'FishProb', FishProb
            AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
              , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
            WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
            ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
            AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
            FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
            FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
          ENDIF
          IF Size380to400Fcount GT 0 THEN BEGIN
            LengthBinIndex1 = 15
            LengthBinIndex2 = Size380to400F
            FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
              , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
              , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
              , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
              , prop_age26F, INDEX_lengthdata2, LengthBinIndex1)
            ;PRINT, 'FishProb', FishProb
            AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
              , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
            WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
            ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
            AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
            FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
            FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
          ENDIF
          IF Size400to420Fcount GT 0 THEN BEGIN
            LengthBinIndex1 = 16
            LengthBinIndex2 = Size400to420F
            FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
              , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
              , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
              , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
              , prop_age26F, INDEX_lengthdata2, LengthBinIndex1)
            ;PRINT, 'FishProb', FishProb
            AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
              , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
            WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
            ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
            AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
            FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
            FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
          ENDIF
          IF Size420to440Fcount GT 0 THEN BEGIN
            LengthBinIndex1 = 17
            LengthBinIndex2 = Size420to440F
            FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
              , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
              , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
              , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
              , prop_age26F, INDEX_lengthdata2, LengthBinIndex1)
            ;PRINT, 'FishProb', FishProb
            AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
              , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
            WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
            ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
            AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
            FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
            FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
          ENDIF
          IF Size440to460Fcount GT 0 THEN BEGIN
            LengthBinIndex1 = 18
            LengthBinIndex2 = Size440to460F
             FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
              , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
              , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
              , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
              , prop_age26F, INDEX_lengthdata2, LengthBinIndex1)
            ;PRINT, 'FishProb', FishProb
            AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
              , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
            WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
            ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
            AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
            FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
            FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
          ENDIF
          IF Size460to480Fcount GT 0 THEN BEGIN
            LengthBinIndex1 = 19
            LengthBinIndex2 = Size460to480F
            FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
              , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
              , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
              , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
              , prop_age26F, INDEX_lengthdata2, LengthBinIndex1)
            ;PRINT, 'FishProb', FishProb
            AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
              , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
            WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
            ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
            AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
            FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
            FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
          ENDIF
          IF Size480to500Fcount GT 0 THEN BEGIN
            LengthBinIndex1 = 20
            LengthBinIndex2 = Size480to500F
             FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
              , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
              , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
              , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
              , prop_age26F, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
              , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
            WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
            ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
            AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
            FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
            FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
          ENDIF
          IF Size500to520Fcount GT 0 THEN BEGIN
            LengthBinIndex1 = 21
            LengthBinIndex2 = Size500to520F
            FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
              , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
              , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
              , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
              , prop_age26F, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
              , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
            WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
            ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
            AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
            FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
            FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
          ENDIF
          IF Size520to540Fcount GT 0 THEN BEGIN
            LengthBinIndex1 = 22
            LengthBinIndex2 = Size520to540F
            FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
              , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
              , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
              , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
              , prop_age26F, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
              , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
            WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
            ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
            AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
            FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
            FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
          ENDIF
          IF Size540to560Fcount GT 0 THEN BEGIN
            LengthBinIndex1 = 23
            LengthBinIndex2 = Size540to560F
            FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
              , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
              , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
              , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
              , prop_age26F, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
              , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
            WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
            ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
            AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
            FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
            FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
          ENDIF
          IF Size560to580Fcount GT 0 THEN BEGIN
            LengthBinIndex1 = 24
            LengthBinIndex2 = Size560to580F
            FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
              , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
              , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
              , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
              , prop_age26F, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
              , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
            WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
            ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
            AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
            FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
            FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
          ENDIF
          IF Size580to600Fcount GT 0 THEN BEGIN
            LengthBinIndex1 = 25
            LengthBinIndex2 = Size580to600F
              FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
              , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
              , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
              , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
              , prop_age26F, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
              , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
            WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
            ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
            AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
            FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
            FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
          ENDIF
          IF Size600to620Fcount GT 0 THEN BEGIN
            LengthBinIndex1 = 26
            LengthBinIndex2 = Size600to620F
            FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
              , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
              , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
              , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
              , prop_age26F, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
              , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
            WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
            ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
            AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
            FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
            FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
          ENDIF
          IF Size620to640Fcount GT 0 THEN BEGIN
            LengthBinIndex1 = 27
            LengthBinIndex2 = Size620to640F
            FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
              , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
              , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
              , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
              , prop_age26F, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
              , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
            WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
            ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
            AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
            FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
            FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
          ENDIF
          IF Size640to660Fcount GT 0 THEN BEGIN
            LengthBinIndex1 = 28
            LengthBinIndex2 = Size640to660F
            FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
              , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
              , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
              , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
              , prop_age26F, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
              , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
            WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
            ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
            AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
            FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
            FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
          ENDIF
          IF Size660to680Fcount GT 0 THEN BEGIN
            LengthBinIndex1 = 29
            LengthBinIndex2 = Size660to680F
             FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
              , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
              , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
              , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
              , prop_age26F, INDEX_lengthdata2, LengthBinIndex1)
            ;PRINT, 'FishProb', FishProb
            AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
              , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
            WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
            ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
            AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
            FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
            FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
          ENDIF
          IF Size680to700Fcount GT 0 THEN BEGIN
            LengthBinIndex1 = 30
            LengthBinIndex2 = Size680to700F
             FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
              , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
              , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
              , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
              , prop_age26F, INDEX_lengthdata2, LengthBinIndex1)
            ;PRINT, 'FishProb', FishProb
            AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
              , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
            WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
            ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
            AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
            FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
            FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
          ENDIF
          IF Size700to720Fcount GT 0 THEN BEGIN
            LengthBinIndex1 = 31
            LengthBinIndex2 = Size700to720F
            FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
              , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
              , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
              , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
              , prop_age26F, INDEX_lengthdata2, LengthBinIndex1)
            ;PRINT, 'FishProb', FishProb
            AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
              , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
            WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
            ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
            AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
            FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
            FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
          ENDIF
          IF Size720to740Fcount GT 0 THEN BEGIN
            LengthBinIndex1 = 32
            LengthBinIndex2 = Size720to740F
             FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
              , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
              , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
              , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
              , prop_age26F, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
              , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
            WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
            ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
            AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
            FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
            FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
          ENDIF
          IF Size740to760Fcount GT 0 THEN BEGIN
            LengthBinIndex1 = 33
            LengthBinIndex2 = Size740to760F
             FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
              , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
              , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
              , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
              , prop_age26F, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
              , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
            WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
            ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
            AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
            FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
            FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
          ENDIF
          IF Size760to780Fcount GT 0 THEN BEGIN
            LengthBinIndex1 = 34
            LengthBinIndex2 = Size760to780F
             FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
              , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
              , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
              , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
              , prop_age26F, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
              , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
            WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
            ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
            AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
            FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
            FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
          ENDIF
          IF Size780to800Fcount GT 0 THEN BEGIN
            LengthBinIndex1 = 35
            LengthBinIndex2 = Size780to800F
            FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
              , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
              , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
              , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
              , prop_age26F, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
              , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
            WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
            ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
            AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
            FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
            FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
          ENDIF
          IF Sizege800Fcount GT 0 THEN BEGIN
            LengthBinIndex1 = 36
            LengthBinIndex2 = SizeGE800F
             FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
              , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
              , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
              , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
              , prop_age26F, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
              , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
            WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
            ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
            AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
            FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
            FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
          ENDIF

          ; 1.Assign age semi-randomly to lengths - UNKNOWNS
          IF SizeLT100Ucount GT 0 THEN BEGIN
            LengthBinIndex1 = 0
            LengthBinIndex2 = SizeLT100U
            FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
              , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
              , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
              , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
              , prop_age26, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
              , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
            WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
            ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
            AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
            FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
            FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
          ENDIF
          IF Size100to120Ucount GT 0 THEN BEGIN
            LengthBinIndex1 = 1
            LengthBinIndex2 = Size100to120U
             FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
              , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
              , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
              , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
              , prop_age26, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
              , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
            WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
            ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
            AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
            FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
            FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
          ENDIF
          IF Size120to140Ucount GT 0 THEN BEGIN
            LengthBinIndex1 = 2
            LengthBinIndex2 = Size120to140U
            FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
              , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
              , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
              , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
              , prop_age26, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
              , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
            WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
            ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
            AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
            FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
            FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
          ENDIF
          IF Size140to160Ucount GT 0 THEN BEGIN
            LengthBinIndex1 = 3
            LengthBinIndex2 = Size140to160U
            FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
              , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
              , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
              , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
              , prop_age26, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
              , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
            WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
            ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
            AgeAssignIndu = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
            FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
            FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
          ENDIF
          IF Size160to180Ucount GT 0 THEN BEGIN
            LengthBinIndex1 = 4
            LengthBinIndex2 = Size160to180U
            FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
              , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
              , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
              , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
              , prop_age26, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
              , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
            WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
            ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
            AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
            FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
            FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
          ENDIF
          IF Size180to200Ucount GT 0 THEN BEGIN
            LengthBinIndex1 = 5
            LengthBinIndex2 = Size180to200U
            FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
              , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
              , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
              , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
              , prop_age26, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
              , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
            WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
            ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
            AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
            FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
            FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
          ENDIF
          IF Size200to220Ucount GT 0 THEN BEGIN
            LengthBinIndex1 = 6
            LengthBinIndex2 = Size200to220U
            FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
              , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
              , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
              , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
              , prop_age26, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
              , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
            WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
            ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
            AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
            FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
            FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
          ENDIF
          IF Size220to240Ucount GT 0 THEN BEGIN
            LengthBinIndex1 = 7
            LengthBinIndex2 = Size220to240U
            FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
              , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
              , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
              , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
              , prop_age26, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
              , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
            WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
            ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
            AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
            FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
            FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
          ENDIF
          IF Size240to260Ucount GT 0 THEN BEGIN
            LengthBinIndex1 = 8
            LengthBinIndex2 = Size240to260U
            FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
              , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
              , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
              , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
              , prop_age26, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
              , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
            WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
            ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
            AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
            FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
            FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
          ENDIF
          IF Size260to280Ucount GT 0 THEN BEGIN
            LengthBinIndex1 = 9
            LengthBinIndex2 = Size260to280U
            FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
              , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
              , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
              , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
              , prop_age26, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
              , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
            WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
            ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
            AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
            FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
            FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
          ENDIF
          IF Size280to300Ucount GT 0 THEN BEGIN
            LengthBinIndex1 = 10
            LengthBinIndex2 = Size280to300U
            FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
              , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
              , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
              , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
              , prop_age26, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
              , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
            WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
            ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
            AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
            FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
            FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
          ENDIF
          IF Size300to320Ucount GT 0 THEN BEGIN
            LengthBinIndex1 = 11
            LengthBinIndex2 = Size300to320U
             FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
              , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
              , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
              , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
              , prop_age26, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
              , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
            WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
            ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
            AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
            FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
            FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
          ENDIF
          IF Size320to340Ucount GT 0 THEN BEGIN
            LengthBinIndex1 = 12
            LengthBinIndex2 = Size320to340U
            FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
              , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
              , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
              , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
              , prop_age26, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
              , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
            WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
            ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
            AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
            FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
            FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
          ENDIF
          IF Size340to360Ucount GT 0 THEN BEGIN
            LengthBinIndex1 = 13
            LengthBinIndex2 = Size340to360U
            FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
              , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
              , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
              , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
              , prop_age26, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
              , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
            WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
            ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
            AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
            FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
            FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
          ENDIF
          IF Size360to380Ucount GT 0 THEN BEGIN
            LengthBinIndex1 = 14
            LengthBinIndex2 = Size360to380U
             FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
              , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
              , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
              , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
              , prop_age26, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
              , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
            WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
            ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
            AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
            FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
            FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
          ENDIF
          IF Size380to400Ucount GT 0 THEN BEGIN
            LengthBinIndex1 = 15
            LengthBinIndex2 = Size380to400U
             FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
              , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
              , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
              , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
              , prop_age26, INDEX_lengthdata2, LengthBinIndex1)
            ;PRINT, 'FishProb', FishProb
            AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
              , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
            WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
            ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
            AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
            FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
            FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
          ENDIF
          IF Size400to420Ucount GT 0 THEN BEGIN
            LengthBinIndex1 = 16
            LengthBinIndex2 = Size400to420U
             FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
              , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
              , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
              , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
              , prop_age26, INDEX_lengthdata2, LengthBinIndex1)
            ;PRINT, 'FishProb', FishProb
            AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
              , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
            WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
            ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
            AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
            FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
            FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
          ENDIF
          IF Size420to440Ucount GT 0 THEN BEGIN
            LengthBinIndex1 = 17
            LengthBinIndex2 = Size420to440U
             FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
              , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
              , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
              , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
              , prop_age26, INDEX_lengthdata2, LengthBinIndex1)
            ;PRINT, 'FishProb', FishProb
            AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
              , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
            WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
            ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
            AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
            FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
            FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
          ENDIF
          IF Size440to460Ucount GT 0 THEN BEGIN
            LengthBinIndex1 = 18
            LengthBinIndex2 = Size440to460U
             FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
              , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
              , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
              , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
              , prop_age26, INDEX_lengthdata2, LengthBinIndex1)
            ;PRINT, 'FishProb', FishProb
            AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
              , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
            WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
            ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
            AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
            FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
            FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
          ENDIF
          IF Size460to480Ucount GT 0 THEN BEGIN
            LengthBinIndex1 = 19
            LengthBinIndex2 = Size460to480U
            FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
              , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
              , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
              , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
              , prop_age26, INDEX_lengthdata2, LengthBinIndex1)
            ;PRINT, 'FishProb', FishProb
            AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
              , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
            WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
            ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
            AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
            FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
            FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
          ENDIF
          IF Size480to500Ucount GT 0 THEN BEGIN
            LengthBinIndex1 = 20
            LengthBinIndex2 = Size480to500U
            FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
              , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
              , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
              , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
              , prop_age26, INDEX_lengthdata2, LengthBinIndex1)
            ;PRINT, 'FishProb', FishProb
            AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
              , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
            WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
            ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
            AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
            FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
            FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
          ENDIF
          IF Size500to520Ucount GT 0 THEN BEGIN
            LengthBinIndex1 = 21
            LengthBinIndex2 = Size500to520U
            FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
              , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
              , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
              , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
              , prop_age26, INDEX_lengthdata2, LengthBinIndex1)
            ;PRINT, 'FishProb', FishProb
            AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
              , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
            WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
            ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
            AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
            FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
            FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
          ENDIF
          IF Size520to540Ucount GT 0 THEN BEGIN
            LengthBinIndex1 = 22
            LengthBinIndex2 = Size520to540U
             FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
              , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
              , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
              , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
              , prop_age26, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
              , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
            WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
            ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
            AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
            FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
            FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
          ENDIF
          IF Size540to560Ucount GT 0 THEN BEGIN
            LengthBinIndex1 = 23
            LengthBinIndex2 = Size540to560U
            FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
              , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
              , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
              , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
              , prop_age26, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
              , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
            WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
            ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
            AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
            FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
            FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
          ENDIF
          IF Size560to580Ucount GT 0 THEN BEGIN
            LengthBinIndex1 = 24
            LengthBinIndex2 = Size560to580U
            FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
              , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
              , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
              , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
              , prop_age26, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
              , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
            WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
            ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
            AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
            FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
            FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
          ENDIF
          IF Size580to600Ucount GT 0 THEN BEGIN
            LengthBinIndex1 = 25
            LengthBinIndex2 = Size580to600U
             FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
              , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
              , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
              , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
              , prop_age26, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
              , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
            WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
            ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
            AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
            FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
            FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
          ENDIF
          IF Size600to620Ucount GT 0 THEN BEGIN
            LengthBinIndex1 = 26
            LengthBinIndex2 = Size600to620U
             FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
              , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
              , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
              , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
              , prop_age26, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
              , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
            WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
            ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
            AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
            FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
            FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
          ENDIF
          IF Size620to640Ucount GT 0 THEN BEGIN
            LengthBinIndex1 = 27
            LengthBinIndex2 = Size620to640U
            FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
              , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
              , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
              , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
              , prop_age26, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
              , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
            WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
            ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
            AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
            FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
            FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
          ENDIF
          IF Size640to660Ucount GT 0 THEN BEGIN
            LengthBinIndex1 = 28
            LengthBinIndex2 = Size640to660U
            FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
              , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
              , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
              , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
              , prop_age26, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
              , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
            WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
            AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
            FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
          ENDIF
          IF Size660to680Ucount GT 0 THEN BEGIN
            LengthBinIndex1 = 29
            LengthBinIndex2 = Size660to680U
            FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
              , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
              , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
              , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
              , prop_age26, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
              , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
            WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
            AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
            FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
          ENDIF
          IF Size680to700Ucount GT 0 THEN BEGIN
            LengthBinIndex1 = 30
            LengthBinIndex2 = Size680to700U
            FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
              , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
              , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
              , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
              , prop_age26, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
              , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
            WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
            AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
            FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
          ENDIF
          IF Size700to720Ucount GT 0 THEN BEGIN
            LengthBinIndex1 = 31
            LengthBinIndex2 = Size700to720U
            FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
              , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
              , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
              , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
              , prop_age26, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
              , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
            WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
            AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
            FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
          ENDIF
          IF Size720to740Ucount GT 0 THEN BEGIN
            LengthBinIndex1 = 32
            LengthBinIndex2 = Size720to740U
             FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
              , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
              , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
              , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
              , prop_age26, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
              , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
            WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
            AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
            FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
          ENDIF
          IF Size740to760Ucount GT 0 THEN BEGIN
            LengthBinIndex1 = 33
            LengthBinIndex2 = Size740to760U
             FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
              , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
              , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
              , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
              , prop_age26, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
              , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
            WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
            AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
            FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
          ENDIF
          IF Size760to780Ucount GT 0 THEN BEGIN
            LengthBinIndex1 = 34
            LengthBinIndex2 = Size760to780U
            FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
              , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
              , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
              , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
              , prop_age26, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
              , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
            WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
            AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
            FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
          ENDIF
          IF Size780to800Ucount GT 0 THEN BEGIN
            LengthBinIndex1 = 35
            LengthBinIndex2 = Size780to800U
            FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
              , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
              , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
              , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
              , prop_age26, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
              , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
            WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
            AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
            FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
          ENDIF
          IF Sizege800Ucount GT 0 THEN BEGIN
            LengthBinIndex1 = 36
            LengthBinIndex2 = SizeGE800U
             FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
              , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
              , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
              , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
              , prop_age26, INDEX_lengthdata2, LengthBinIndex1)
            AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
              , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
            WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
            AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
              , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
              , i+NumLengthBin+adj)
            FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
            FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
          ENDIF

          ; mean age of stock (age>3)
          Age3plus = WHERE(FishAge GE 3, Age3plusCOUNT)
          IF Age3plusCOUNT GT 0 THEN BEGIN
            paramset[225, i] = MEAN(FishAge[Age3plus]); mean age for all fish
            paramset[226, i] = STDDEV(FishAge[Age3plus]); SD age for all fish
          ENDIF
          Age3Mplus = WHERE(FishAge[male] GE 3, Age3MplusCOUNT)
          IF Age3MplusCOUNT GT 0 THEN BEGIN
            paramset[227, i] = MEAN(FishAge[male[Age3Mplus]]); mean age for males
            paramset[228, i] = STDDEV(FishAge[male[Age3Mplus]]); SD age for males
          ENDIF
          Age3Fplus = WHERE(FishAge[female] GE 3, Age3FplusCOUNT)
          IF Age3FplusCOUNT GT 0 THEN BEGIN
            paramset[229, i] = MEAN(FishAge[female[Age3Fplus]]); mean age for females
            paramset[230, i] = STDDEV(FishAge[female[Age3Fplus]]); SD age for females
          ENDIF

           ; Summary estimated age distribution data (proportion) - SPRING SURVEY
          ; Allocate estimated age data to an array - ALL FISH
          Total_N_ageclass = fltarr(27L, 2L); all
          Total_N_ageclass[0, 0] = TOTAL(WAE_length_bin[10, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 0
          Total_N_ageclass[1, 0] = TOTAL(WAE_length_bin[11, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 1
          Total_N_ageclass[2, 0] = TOTAL(WAE_length_bin[12, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 2
          Total_N_ageclass[3, 0] = TOTAL(WAE_length_bin[13, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 3
          Total_N_ageclass[4, 0] = TOTAL(WAE_length_bin[14, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 4
          Total_N_ageclass[5, 0] = TOTAL(WAE_length_bin[15, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 5
          Total_N_ageclass[6, 0] = TOTAL(WAE_length_bin[16, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 6
          Total_N_ageclass[7, 0] = TOTAL(WAE_length_bin[17, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 7
          Total_N_ageclass[8, 0] = TOTAL(WAE_length_bin[18, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 8
          Total_N_ageclass[9, 0] = TOTAL(WAE_length_bin[19, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 9
          Total_N_ageclass[10, 0] = TOTAL(WAE_length_bin[20, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 10
          Total_N_ageclass[11, 0] = TOTAL(WAE_length_bin[21, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 11
          Total_N_ageclass[12, 0] = TOTAL(WAE_length_bin[22, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 12
          Total_N_ageclass[13, 0] = TOTAL(WAE_length_bin[23, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 13
          Total_N_ageclass[14, 0] = TOTAL(WAE_length_bin[24, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 14
          Total_N_ageclass[15, 0] = TOTAL(WAE_length_bin[25, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 15
          Total_N_ageclass[16, 0] = TOTAL(WAE_length_bin[26, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 16
          Total_N_ageclass[17, 0] = TOTAL(WAE_length_bin[27, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 17
          Total_N_ageclass[18, 0] = TOTAL(WAE_length_bin[28, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 18
          Total_N_ageclass[19, 0] = TOTAL(WAE_length_bin[29, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 19
          Total_N_ageclass[20, 0] = TOTAL(WAE_length_bin[30, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 20
          Total_N_ageclass[21, 0] = TOTAL(WAE_length_bin[31, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 21
          Total_N_ageclass[22, 0] = TOTAL(WAE_length_bin[32, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 22
          Total_N_ageclass[23, 0] = TOTAL(WAE_length_bin[33, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 23
          Total_N_ageclass[24, 0] = TOTAL(WAE_length_bin[34, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 24
          Total_N_ageclass[25, 0] = TOTAL(WAE_length_bin[35, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 25
          Total_N_ageclass[26, 0] = TOTAL(WAE_length_bin[36, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 26
          PRINT, 'Derived age distribution for all fish'
          PRINT, Total_N_ageclass[*, 0]
          PRINT, 'Total number of all fish', TOTAL(Total_N_ageclass[*, 0])

          ; Identify the number of age classes in the data set
          NumAgeClass = WHERE(Total_N_ageclass[*, 0] GT 0, NumAgeClasscount)
          paramset[213, i] = NumAgeClasscount
          PRINT, 'Number of age classes', NumAgeClasscount
          paramset[216, i] = MAX(NumAgeClass)
          PRINT, 'Maximum age classes', MAX(NumAgeClass)

          ; Identify the peak age class (age >3) used for estimating mortality rates with catch curves
          PeakAgeClass = WHERE(Total_N_ageclass[*, 0] EQ MAX(Total_N_ageclass[3:26, 0]), PeakAgeClasscount)
          PRINT, 'Peak age of fully recruited to fishery', PeakAgeClass
          PeakAgeClassLimit = where(PeakAgeClass GE 3, PeakAgeClassLimitcount)
          IF PeakAgeClassLimitcount GT 0 THEN paramset[214, i] = MIN(PeakAgeClass[PeakAgeClassLimit]) $
          ELSE paramset[214, i] = -1
          PRINT, 'Initial age of fully recruited to fishery', PeakAgeClass

          Total_N_ageclass2 = fltarr(27L, 4L); all
          print, 'FishAge[*]', n_elements(FishAge[*])
          print, 'FishAge[*]', (FishAge[*])

          age0Num = where(FishAge[*] EQ 0, age0Numcount)
          age1Num = where(FishAge[*] EQ 1, age1Numcount)
          age2Num = where(FishAge[*] EQ 2, age2Numcount)
          age3Num = where(FishAge[*] EQ 3, age3Numcount)
          age4Num = where(FishAge[*] EQ 4, age4Numcount)
          age5Num = where(FishAge[*] EQ 5, age5Numcount)
          age6Num = where(FishAge[*] EQ 6, age6Numcount)
          age7Num = where(FishAge[*] EQ 7, age7Numcount)
          age8Num = where(FishAge[*] EQ 8, age8Numcount)
          age9Num = where(FishAge[*] EQ 9, age9Numcount)
          age10Num = where(FishAge[*] EQ 10, age10Numcount)
          age11Num = where(FishAge[*] EQ 11, age11Numcount)
          age12Num = where(FishAge[*] EQ 12, age12Numcount)
          age13Num = where(FishAge[*] EQ 13, age13Numcount)
          age14Num = where(FishAge[*] EQ 14, age14Numcount)
          age15Num = where(FishAge[*] EQ 15, age15Numcount)
          age16Num = where(FishAge[*] EQ 16, age16Numcount)
          age17Num = where(FishAge[*] EQ 17, age17Numcount)
          age18Num = where(FishAge[*] EQ 18, age18Numcount)
          age19Num = where(FishAge[*] EQ 19, age19Numcount)
          age20Num = where(FishAge[*] EQ 20, age20Numcount)
          age21Num = where(FishAge[*] EQ 21, age21Numcount)
          age22Num = where(FishAge[*] EQ 22, age22Numcount)
          age23Num = where(FishAge[*] EQ 23, age23Numcount)
          age24Num = where(FishAge[*] EQ 24, age24Numcount)
          age25Num = where(FishAge[*] EQ 25, age25Numcount)
          age26Num = where(FishAge[*] EQ 26, age26Numcount)
          IF age0Numcount GT 0 THEN Total_N_ageclass2[0, 0] = age0Numcount
          IF age1Numcount GT 0 THEN Total_N_ageclass2[1, 0] = age1Numcount
          IF age2Numcount GT 0 THEN Total_N_ageclass2[2, 0] = age2Numcount
          IF age3Numcount GT 0 THEN Total_N_ageclass2[3, 0] = age3Numcount
          IF age4Numcount GT 0 THEN Total_N_ageclass2[4, 0] = age4Numcount
          IF age5Numcount GT 0 THEN Total_N_ageclass2[5, 0] = age5Numcount
          IF age6Numcount GT 0 THEN Total_N_ageclass2[6, 0] = age6Numcount
          IF age7Numcount GT 0 THEN Total_N_ageclass2[7, 0] = age7Numcount
          IF age8Numcount GT 0 THEN Total_N_ageclass2[8, 0] = age8Numcount
          IF age9Numcount GT 0 THEN Total_N_ageclass2[9, 0] = age9Numcount
          IF age10Numcount GT 0 THEN Total_N_ageclass2[10, 0] = age10Numcount
          IF age11Numcount GT 0 THEN Total_N_ageclass2[11, 0] = age11Numcount
          IF age12Numcount GT 0 THEN Total_N_ageclass2[12, 0] = age12Numcount
          IF age13Numcount GT 0 THEN Total_N_ageclass2[13, 0] = age13Numcount
          IF age14Numcount GT 0 THEN Total_N_ageclass2[14, 0] = age14Numcount
          IF age15Numcount GT 0 THEN Total_N_ageclass2[15, 0] = age15Numcount
          IF age16Numcount GT 0 THEN Total_N_ageclass2[16, 0] = age16Numcount
          IF age17Numcount GT 0 THEN Total_N_ageclass2[17, 0] = age17Numcount
          IF age18Numcount GT 0 THEN Total_N_ageclass2[18, 0] = age18Numcount
          IF age19Numcount GT 0 THEN Total_N_ageclass2[19, 0] = age19Numcount
          IF age20Numcount GT 0 THEN Total_N_ageclass2[20, 0] = age20Numcount
          IF age21Numcount GT 0 THEN Total_N_ageclass2[21, 0] = age21Numcount
          IF age22Numcount GT 0 THEN Total_N_ageclass2[22, 0] = age22Numcount
          IF age23Numcount GT 0 THEN Total_N_ageclass2[23, 0] = age23Numcount
          IF age24Numcount GT 0 THEN Total_N_ageclass2[24, 0] = age24Numcount
          IF age25Numcount GT 0 THEN Total_N_ageclass2[25, 0] = age25Numcount
          IF age26Numcount GT 0 THEN Total_N_ageclass2[26, 0] = age26Numcount
          PRINT, 'Derived age distribution for all fish (individual-based)'
          PRINT, Total_N_ageclass2[*, 0]
          PRINT, 'Total number of all fish (INDIVIDUAL-BASED)', total(Total_N_ageclass2[*, 0])

          ; allocate estimated age data to an array - MALES
          Male_N_ageclass = fltarr(27L, 2L); all
          Male_N_ageclass[0, 0] = TOTAL(WAE_length_binM[10, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 0
          Male_N_ageclass[1, 0] = TOTAL(WAE_length_binM[11, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 1
          Male_N_ageclass[2, 0] = TOTAL(WAE_length_binM[12, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 2
          Male_N_ageclass[3, 0] = TOTAL(WAE_length_binM[13, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 3
          Male_N_ageclass[4, 0] = TOTAL(WAE_length_binM[14, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 4
          Male_N_ageclass[5, 0] = TOTAL(WAE_length_binM[15, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 5
          Male_N_ageclass[6, 0] = TOTAL(WAE_length_binM[16, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 6
          Male_N_ageclass[7, 0] = TOTAL(WAE_length_binM[17, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 7
          Male_N_ageclass[8, 0] = TOTAL(WAE_length_binM[18, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 8
          Male_N_ageclass[9, 0] = TOTAL(WAE_length_binM[19, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 9
          Male_N_ageclass[10, 0] = TOTAL(WAE_length_binM[20, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 10
          Male_N_ageclass[11, 0] = TOTAL(WAE_length_binM[21, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 11
          Male_N_ageclass[12, 0] = TOTAL(WAE_length_binM[22, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 12
          Male_N_ageclass[13, 0] = TOTAL(WAE_length_binM[23, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 13
          Male_N_ageclass[14, 0] = TOTAL(WAE_length_binM[24, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 14
          Male_N_ageclass[15, 0] = TOTAL(WAE_length_binM[25, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 15
          Male_N_ageclass[16, 0] = TOTAL(WAE_length_binM[26, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 16
          Male_N_ageclass[17, 0] = TOTAL(WAE_length_binM[27, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 17
          Male_N_ageclass[18, 0] = TOTAL(WAE_length_binM[28, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 18
          Male_N_ageclass[19, 0] = TOTAL(WAE_length_binM[29, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 19
          Male_N_ageclass[20, 0] = TOTAL(WAE_length_binM[30, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 20
          Male_N_ageclass[21, 0] = TOTAL(WAE_length_binM[31, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 21
          Male_N_ageclass[22, 0] = TOTAL(WAE_length_binM[32, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 22
          Male_N_ageclass[23, 0] = TOTAL(WAE_length_binM[33, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 23
          Male_N_ageclass[24, 0] = TOTAL(WAE_length_binM[34, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 24
          Male_N_ageclass[25, 0] = TOTAL(WAE_length_binM[35, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 25
          Male_N_ageclass[26, 0] = TOTAL(WAE_length_binM[36, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 26
          PRINT, 'Derived age distribution for males'
          PRINT, Male_N_ageclass[*, 0]
          PRINT, 'Total number of males', TOTAL(Male_N_ageclass[*, 0])

          age0MNum = where(FishAge[*] EQ 0 AND Sex_prod[*] EQ 0, age0MNumcount)
          age1MNum = where(FishAge[*] EQ 1 AND Sex_prod[*] EQ 0, age1MNumcount)
          age2MNum = where(FishAge[*] EQ 2 AND Sex_prod[*] EQ 0, age2MNumcount)
          age3MNum = where(FishAge[*] EQ 3 AND Sex_prod[*] EQ 0, age3MNumcount)
          age4MNum = where(FishAge[*] EQ 4 AND Sex_prod[*] EQ 0, age4MNumcount)
          age5MNum = where(FishAge[*] EQ 5 AND Sex_prod[*] EQ 0, age5MNumcount)
          age6MNum = where(FishAge[*] EQ 6 AND Sex_prod[*] EQ 0, age6MNumcount)
          age7MNum = where(FishAge[*] EQ 7 AND Sex_prod[*] EQ 0, age7MNumcount)
          age8MNum = where(FishAge[*] EQ 8 AND Sex_prod[*] EQ 0, age8MNumcount)
          age9MNum = where(FishAge[*] EQ 9 AND Sex_prod[*] EQ 0, age9MNumcount)
          age10MNum = where(FishAge[*] EQ 10 AND Sex_prod[*] EQ 0, age10MNumcount)
          age11MNum = where(FishAge[*] EQ 11 AND Sex_prod[*] EQ 0, age11MNumcount)
          age12MNum = where(FishAge[*] EQ 12 AND Sex_prod[*] EQ 0, age12MNumcount)
          age13MNum = where(FishAge[*] EQ 13 AND Sex_prod[*] EQ 0, age13MNumcount)
          age14MNum = where(FishAge[*] EQ 14 AND Sex_prod[*] EQ 0, age14MNumcount)
          age15MNum = where(FishAge[*] EQ 15 AND Sex_prod[*] EQ 0, age15MNumcount)
          age16MNum = where(FishAge[*] EQ 16 AND Sex_prod[*] EQ 0, age16MNumcount)
          age17MNum = where(FishAge[*] EQ 17 AND Sex_prod[*] EQ 0, age17MNumcount)
          age18MNum = where(FishAge[*] EQ 18 AND Sex_prod[*] EQ 0, age18MNumcount)
          age19MNum = where(FishAge[*] EQ 19 AND Sex_prod[*] EQ 0, age19MNumcount)
          age20MNum = where(FishAge[*] EQ 20 AND Sex_prod[*] EQ 0, age20MNumcount)
          age21MNum = where(FishAge[*] EQ 21 AND Sex_prod[*] EQ 0, age21MNumcount)
          age22MNum = where(FishAge[*] EQ 22 AND Sex_prod[*] EQ 0, age22MNumcount)
          age23MNum = where(FishAge[*] EQ 23 AND Sex_prod[*] EQ 0, age23MNumcount)
          age24MNum = where(FishAge[*] EQ 24 AND Sex_prod[*] EQ 0, age24MNumcount)
          age25MNum = where(FishAge[*] EQ 25 AND Sex_prod[*] EQ 0, age25MNumcount)
          age26MNum = where(FishAge[*] EQ 26 AND Sex_prod[*] EQ 0, age26MNumcount)
          IF age0MNumcount GT 0 THEN Total_N_ageclass2[0, 1] = age0MNumcount
          IF age1MNumcount GT 0 THEN Total_N_ageclass2[1, 1] = age1MNumcount
          IF age2MNumcount GT 0 THEN Total_N_ageclass2[2, 1] = age2MNumcount
          IF age3MNumcount GT 0 THEN Total_N_ageclass2[3, 1] = age3MNumcount
          IF age4MNumcount GT 0 THEN Total_N_ageclass2[4, 1] = age4MNumcount
          IF age5MNumcount GT 0 THEN Total_N_ageclass2[5, 1] = age5MNumcount
          IF age6MNumcount GT 0 THEN Total_N_ageclass2[6, 1] = age6MNumcount
          IF age7MNumcount GT 0 THEN Total_N_ageclass2[7, 1] = age7MNumcount
          IF age8MNumcount GT 0 THEN Total_N_ageclass2[8, 1] = age8MNumcount
          IF age9MNumcount GT 0 THEN Total_N_ageclass2[9, 1] = age9MNumcount
          IF age10MNumcount GT 0 THEN Total_N_ageclass2[10, 1] = age10MNumcount
          IF age11MNumcount GT 0 THEN Total_N_ageclass2[11, 1] = age11MNumcount
          IF age12MNumcount GT 0 THEN Total_N_ageclass2[12, 1] = age12MNumcount
          IF age13MNumcount GT 0 THEN Total_N_ageclass2[13, 1] = age13MNumcount
          IF age14MNumcount GT 0 THEN Total_N_ageclass2[14, 1] = age14MNumcount
          IF age15MNumcount GT 0 THEN Total_N_ageclass2[15, 1] = age15MNumcount
          IF age16MNumcount GT 0 THEN Total_N_ageclass2[16, 1] = age16MNumcount
          IF age17MNumcount GT 0 THEN Total_N_ageclass2[17, 1] = age17MNumcount
          IF age18MNumcount GT 0 THEN Total_N_ageclass2[18, 1] = age18MNumcount
          IF age19MNumcount GT 0 THEN Total_N_ageclass2[19, 1] = age19MNumcount
          IF age20MNumcount GT 0 THEN Total_N_ageclass2[20, 1] = age20MNumcount
          IF age21MNumcount GT 0 THEN Total_N_ageclass2[21, 1] = age21MNumcount
          IF age22MNumcount GT 0 THEN Total_N_ageclass2[22, 1] = age22MNumcount
          IF age23MNumcount GT 0 THEN Total_N_ageclass2[23, 1] = age23MNumcount
          IF age24MNumcount GT 0 THEN Total_N_ageclass2[24, 1] = age24MNumcount
          IF age25MNumcount GT 0 THEN Total_N_ageclass2[25, 1] = age25MNumcount
          IF age26MNumcount GT 0 THEN Total_N_ageclass2[26, 1] = age26MNumcount
          PRINT, 'Derived age distribution for MALES (individual-based)'
          PRINT, Total_N_ageclass2[*, 1]
          PRINT, 'Total number of MALES (INDIVIDUAL-BASED)'
          PRINT, total(Total_N_ageclass2[*, 1])

          ; allocate estimated age data to an array - FEMALES
          Female_N_ageclass = fltarr(27L, 2L); all
          Female_N_ageclass[0, 0] = TOTAL(WAE_length_binF[10, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 0
          Female_N_ageclass[1, 0] = TOTAL(WAE_length_binF[11, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 1
          Female_N_ageclass[2, 0] = TOTAL(WAE_length_binF[12, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 2
          Female_N_ageclass[3, 0] = TOTAL(WAE_length_binF[13, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 3
          Female_N_ageclass[4, 0] = TOTAL(WAE_length_binF[14, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 4
          Female_N_ageclass[5, 0] = TOTAL(WAE_length_binF[15, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 5
          Female_N_ageclass[6, 0] = TOTAL(WAE_length_binF[16, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 6
          Female_N_ageclass[7, 0] = TOTAL(WAE_length_binF[17, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 7
          Female_N_ageclass[8, 0] = TOTAL(WAE_length_binF[18, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 8
          Female_N_ageclass[9, 0] = TOTAL(WAE_length_binF[19, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 9
          Female_N_ageclass[10, 0] = TOTAL(WAE_length_binF[20, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 10
          Female_N_ageclass[11, 0] = TOTAL(WAE_length_binF[21, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 11
          Female_N_ageclass[12, 0] = TOTAL(WAE_length_binF[22, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 12
          Female_N_ageclass[13, 0] = TOTAL(WAE_length_binF[23, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 13
          Female_N_ageclass[14, 0] = TOTAL(WAE_length_binF[24, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 14
          Female_N_ageclass[15, 0] = TOTAL(WAE_length_binF[25, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 15
          Female_N_ageclass[16, 0] = TOTAL(WAE_length_binF[26, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 16
          Female_N_ageclass[17, 0] = TOTAL(WAE_length_binF[27, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 17
          Female_N_ageclass[18, 0] = TOTAL(WAE_length_binF[28, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 18
          Female_N_ageclass[19, 0] = TOTAL(WAE_length_binF[29, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 19
          Female_N_ageclass[20, 0] = TOTAL(WAE_length_binF[30, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 20
          Female_N_ageclass[21, 0] = TOTAL(WAE_length_binF[31, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 21
          Female_N_ageclass[22, 0] = TOTAL(WAE_length_binF[32, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 22
          Female_N_ageclass[23, 0] = TOTAL(WAE_length_binF[33, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 23
          Female_N_ageclass[24, 0] = TOTAL(WAE_length_binF[34, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 24
          Female_N_ageclass[25, 0] = TOTAL(WAE_length_binF[35, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 25
          Female_N_ageclass[26, 0] = TOTAL(WAE_length_binF[36, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 26
          PRINT, 'Derived age distribution for females'
          PRINT, Female_N_ageclass[*, 0]
          PRINT, 'Total number of females', total(Female_N_ageclass[*, 0])

          age0FNum = where(FishAge[*] EQ 0 AND Sex_prod[*] EQ 1, age0FNumcount)
          age1FNum = where(FishAge[*] EQ 1 AND Sex_prod[*] EQ 1, age1FNumcount)
          age2FNum = where(FishAge[*] EQ 2 AND Sex_prod[*] EQ 1, age2FNumcount)
          age3FNum = where(FishAge[*] EQ 3 AND Sex_prod[*] EQ 1, age3FNumcount)
          age4FNum = where(FishAge[*] EQ 4 AND Sex_prod[*] EQ 1, age4FNumcount)
          age5FNum = where(FishAge[*] EQ 5 AND Sex_prod[*] EQ 1, age5FNumcount)
          age6FNum = where(FishAge[*] EQ 6 AND Sex_prod[*] EQ 1, age6FNumcount)
          age7FNum = where(FishAge[*] EQ 7 AND Sex_prod[*] EQ 1, age7FNumcount)
          age8FNum = where(FishAge[*] EQ 8 AND Sex_prod[*] EQ 1, age8FNumcount)
          age9FNum = where(FishAge[*] EQ 9 AND Sex_prod[*] EQ 1, age9FNumcount)
          age10FNum = where(FishAge[*] EQ 10 AND Sex_prod[*] EQ 1, age10FNumcount)
          age11FNum = where(FishAge[*] EQ 11 AND Sex_prod[*] EQ 1, age11FNumcount)
          age12FNum = where(FishAge[*] EQ 12 AND Sex_prod[*] EQ 1, age12FNumcount)
          age13FNum = where(FishAge[*] EQ 13 AND Sex_prod[*] EQ 1, age13FNumcount)
          age14FNum = where(FishAge[*] EQ 14 AND Sex_prod[*] EQ 1, age14FNumcount)
          age15FNum = where(FishAge[*] EQ 15 AND Sex_prod[*] EQ 1, age15FNumcount)
          age16FNum = where(FishAge[*] EQ 16 AND Sex_prod[*] EQ 1, age16FNumcount)
          age17FNum = where(FishAge[*] EQ 17 AND Sex_prod[*] EQ 1, age17FNumcount)
          age18FNum = where(FishAge[*] EQ 18 AND Sex_prod[*] EQ 1, age18FNumcount)
          age19FNum = where(FishAge[*] EQ 19 AND Sex_prod[*] EQ 1, age19FNumcount)
          age20FNum = where(FishAge[*] EQ 20 AND Sex_prod[*] EQ 1, age20FNumcount)
          age21FNum = where(FishAge[*] EQ 21 AND Sex_prod[*] EQ 1, age21FNumcount)
          age22FNum = where(FishAge[*] EQ 22 AND Sex_prod[*] EQ 1, age22FNumcount)
          age23FNum = where(FishAge[*] EQ 23 AND Sex_prod[*] EQ 1, age23FNumcount)
          age24FNum = where(FishAge[*] EQ 24 AND Sex_prod[*] EQ 1, age24FNumcount)
          age25FNum = where(FishAge[*] EQ 25 AND Sex_prod[*] EQ 1, age25FNumcount)
          age26FNum = where(FishAge[*] EQ 26 AND Sex_prod[*] EQ 1, age26FNumcount)
          IF age0FNumcount GT 0 THEN Total_N_ageclass2[0, 2] = age0FNumcount
          IF age1FNumcount GT 0 THEN Total_N_ageclass2[1, 2] = age1FNumcount
          IF age2FNumcount GT 0 THEN Total_N_ageclass2[2, 2] = age2FNumcount
          IF age3FNumcount GT 0 THEN Total_N_ageclass2[3, 2] = age3FNumcount
          IF age4FNumcount GT 0 THEN Total_N_ageclass2[4, 2] = age4FNumcount
          IF age5FNumcount GT 0 THEN Total_N_ageclass2[5, 2] = age5FNumcount
          IF age6FNumcount GT 0 THEN Total_N_ageclass2[6, 2] = age6FNumcount
          IF age7FNumcount GT 0 THEN Total_N_ageclass2[7, 2] = age7FNumcount
          IF age8FNumcount GT 0 THEN Total_N_ageclass2[8, 2] = age8FNumcount
          IF age9FNumcount GT 0 THEN Total_N_ageclass2[9, 2] = age9FNumcount
          IF age10FNumcount GT 0 THEN Total_N_ageclass2[10, 2] = age10FNumcount
          IF age11FNumcount GT 0 THEN Total_N_ageclass2[11, 2] = age11FNumcount
          IF age12FNumcount GT 0 THEN Total_N_ageclass2[12, 2] = age12FNumcount
          IF age13FNumcount GT 0 THEN Total_N_ageclass2[13, 2] = age13FNumcount
          IF age14FNumcount GT 0 THEN Total_N_ageclass2[14, 2] = age14FNumcount
          IF age15FNumcount GT 0 THEN Total_N_ageclass2[15, 2] = age15FNumcount
          IF age16FNumcount GT 0 THEN Total_N_ageclass2[16, 2] = age16FNumcount
          IF age17FNumcount GT 0 THEN Total_N_ageclass2[17, 2] = age17FNumcount
          IF age18FNumcount GT 0 THEN Total_N_ageclass2[18, 2] = age18FNumcount
          IF age19FNumcount GT 0 THEN Total_N_ageclass2[19, 2] = age19FNumcount
          IF age20FNumcount GT 0 THEN Total_N_ageclass2[20, 2] = age20FNumcount
          IF age21FNumcount GT 0 THEN Total_N_ageclass2[21, 2] = age21FNumcount
          IF age22FNumcount GT 0 THEN Total_N_ageclass2[22, 2] = age22FNumcount
          IF age23FNumcount GT 0 THEN Total_N_ageclass2[23, 2] = age23FNumcount
          IF age24FNumcount GT 0 THEN Total_N_ageclass2[24, 2] = age24FNumcount
          IF age25FNumcount GT 0 THEN Total_N_ageclass2[25, 2] = age25FNumcount
          IF age26FNumcount GT 0 THEN Total_N_ageclass2[26, 2] = age26FNumcount
          PRINT, 'Derived age distribution for FEMALES (individual-based)'
          PRINT, Total_N_ageclass2[*, 2]
          PRINT, 'Total number of FEMALES (INDIVIDUAL-BASED)'
          PRINT, total(Total_N_ageclass2[*, 2])

          ; allocate estimated age data to an array - unknowns
          Unknown_N_ageclass = fltarr(27L, 2L)
          Unknown_N_ageclass[0, 0] = TOTAL(WAE_length_binU[10, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 0
          Unknown_N_ageclass[1, 0] = TOTAL(WAE_length_binU[11, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 1
          Unknown_N_ageclass[2, 0] = TOTAL(WAE_length_binU[12, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 2
          Unknown_N_ageclass[3, 0] = TOTAL(WAE_length_binU[13, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 3
          Unknown_N_ageclass[4, 0] = TOTAL(WAE_length_binU[14, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 4
          Unknown_N_ageclass[5, 0] = TOTAL(WAE_length_binU[15, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 5
          Unknown_N_ageclass[6, 0] = TOTAL(WAE_length_binU[16, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 6
          Unknown_N_ageclass[7, 0] = TOTAL(WAE_length_binU[17, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 7
          Unknown_N_ageclass[8, 0] = TOTAL(WAE_length_binU[18, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 8
          Unknown_N_ageclass[9, 0] = TOTAL(WAE_length_binU[19, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 9
          Unknown_N_ageclass[10, 0] = TOTAL(WAE_length_binU[20, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 10
          Unknown_N_ageclass[11, 0] = TOTAL(WAE_length_binU[21, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 11
          Unknown_N_ageclass[12, 0] = TOTAL(WAE_length_binU[22, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 12
          Unknown_N_ageclass[13, 0] = TOTAL(WAE_length_binU[23, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 13
          Unknown_N_ageclass[14, 0] = TOTAL(WAE_length_binU[24, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 14
          Unknown_N_ageclass[15, 0] = TOTAL(WAE_length_binU[25, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 15
          Unknown_N_ageclass[16, 0] = TOTAL(WAE_length_binU[26, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 16
          Unknown_N_ageclass[17, 0] = TOTAL(WAE_length_binU[27, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 17
          Unknown_N_ageclass[18, 0] = TOTAL(WAE_length_binU[28, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 18
          Unknown_N_ageclass[19, 0] = TOTAL(WAE_length_binU[29, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 19
          Unknown_N_ageclass[20, 0] = TOTAL(WAE_length_binU[30, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 20
          Unknown_N_ageclass[21, 0] = TOTAL(WAE_length_binU[31, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 21
          Unknown_N_ageclass[22, 0] = TOTAL(WAE_length_binU[32, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 22
          Unknown_N_ageclass[23, 0] = TOTAL(WAE_length_binU[33, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 23
          Unknown_N_ageclass[24, 0] = TOTAL(WAE_length_binU[34, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 24
          Unknown_N_ageclass[25, 0] = TOTAL(WAE_length_binU[35, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 25
          Unknown_N_ageclass[26, 0] = TOTAL(WAE_length_binU[36, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 26
          PRINT, 'Derived age distribution for unknowns'
          PRINT, Unknown_N_ageclass[*, 0]
          PRINT, 'Total number of unknowns', total(Unknown_N_ageclass[*, 0])
          age0UNum = where(FishAge[*] EQ 0 AND Sex_prod[*] EQ 2, age0UNumcount)
          age1UNum = where(FishAge[*] EQ 1 AND Sex_prod[*] EQ 2, age1UNumcount)
          age2UNum = where(FishAge[*] EQ 2 AND Sex_prod[*] EQ 2, age2UNumcount)
          age3UNum = where(FishAge[*] EQ 3 AND Sex_prod[*] EQ 2, age3UNumcount)
          age4UNum = where(FishAge[*] EQ 4 AND Sex_prod[*] EQ 2, age4UNumcount)
          age5UNum = where(FishAge[*] EQ 5 AND Sex_prod[*] EQ 2, age5UNumcount)
          age6UNum = where(FishAge[*] EQ 6 AND Sex_prod[*] EQ 2, age6UNumcount)
          age7UNum = where(FishAge[*] EQ 7 AND Sex_prod[*] EQ 2, age7UNumcount)
          age8UNum = where(FishAge[*] EQ 8 AND Sex_prod[*] EQ 2, age8UNumcount)
          age9UNum = where(FishAge[*] EQ 9 AND Sex_prod[*] EQ 2, age9UNumcount)
          age10UNum = where(FishAge[*] EQ 10 AND Sex_prod[*] EQ 2, age10UNumcount)
          age11UNum = where(FishAge[*] EQ 11 AND Sex_prod[*] EQ 2, age11UNumcount)
          age12UNum = where(FishAge[*] EQ 12 AND Sex_prod[*] EQ 2, age12UNumcount)
          age13UNum = where(FishAge[*] EQ 13 AND Sex_prod[*] EQ 2, age13UNumcount)
          age14UNum = where(FishAge[*] EQ 14 AND Sex_prod[*] EQ 2, age14UNumcount)
          age15UNum = where(FishAge[*] EQ 15 AND Sex_prod[*] EQ 2, age15UNumcount)
          age16UNum = where(FishAge[*] EQ 16 AND Sex_prod[*] EQ 2, age16UNumcount)
          age17UNum = where(FishAge[*] EQ 17 AND Sex_prod[*] EQ 2, age17UNumcount)
          age18UNum = where(FishAge[*] EQ 18 AND Sex_prod[*] EQ 2, age18UNumcount)
          age19UNum = where(FishAge[*] EQ 19 AND Sex_prod[*] EQ 2, age19UNumcount)
          age20UNum = where(FishAge[*] EQ 20 AND Sex_prod[*] EQ 2, age20UNumcount)
          age21UNum = where(FishAge[*] EQ 21 AND Sex_prod[*] EQ 2, age21UNumcount)
          age22UNum = where(FishAge[*] EQ 22 AND Sex_prod[*] EQ 2, age22UNumcount)
          age23UNum = where(FishAge[*] EQ 23 AND Sex_prod[*] EQ 2, age23UNumcount)
          age24UNum = where(FishAge[*] EQ 24 AND Sex_prod[*] EQ 2, age24UNumcount)
          age25UNum = where(FishAge[*] EQ 25 AND Sex_prod[*] EQ 2, age25UNumcount)
          age26UNum = where(FishAge[*] EQ 26 AND Sex_prod[*] EQ 2, age26UNumcount)
          IF age0UNumcount GT 0 THEN Total_N_ageclass2[0, 3] = age0UNumcount
          IF age1UNumcount GT 0 THEN Total_N_ageclass2[1, 3] = age1UNumcount
          IF age2UNumcount GT 0 THEN Total_N_ageclass2[2, 3] = age2UNumcount
          IF age3UNumcount GT 0 THEN Total_N_ageclass2[3, 3] = age3UNumcount
          IF age4UNumcount GT 0 THEN Total_N_ageclass2[4, 3] = age4UNumcount
          IF age5UNumcount GT 0 THEN Total_N_ageclass2[5, 3] = age5UNumcount
          IF age6UNumcount GT 0 THEN Total_N_ageclass2[6, 3] = age6UNumcount
          IF age7UNumcount GT 0 THEN Total_N_ageclass2[7, 3] = age7UNumcount
          IF age8UNumcount GT 0 THEN Total_N_ageclass2[8, 3] = age8UNumcount
          IF age9UNumcount GT 0 THEN Total_N_ageclass2[9, 3] = age9UNumcount
          IF age10UNumcount GT 0 THEN Total_N_ageclass2[10, 3] = age10UNumcount
          IF age11UNumcount GT 0 THEN Total_N_ageclass2[11, 3] = age11UNumcount
          IF age12UNumcount GT 0 THEN Total_N_ageclass2[12, 3] = age12UNumcount
          IF age13UNumcount GT 0 THEN Total_N_ageclass2[13, 3] = age13UNumcount
          IF age14UNumcount GT 0 THEN Total_N_ageclass2[14, 3] = age14UNumcount
          IF age15UNumcount GT 0 THEN Total_N_ageclass2[15, 3] = age15UNumcount
          IF age16UNumcount GT 0 THEN Total_N_ageclass2[16, 3] = age16UNumcount
          IF age17UNumcount GT 0 THEN Total_N_ageclass2[17, 3] = age17UNumcount
          IF age18UNumcount GT 0 THEN Total_N_ageclass2[18, 3] = age18UNumcount
          IF age19UNumcount GT 0 THEN Total_N_ageclass2[19, 3] = age19UNumcount
          IF age20UNumcount GT 0 THEN Total_N_ageclass2[20, 3] = age20UNumcount
          IF age21UNumcount GT 0 THEN Total_N_ageclass2[21, 3] = age21UNumcount
          IF age22UNumcount GT 0 THEN Total_N_ageclass2[22, 3] = age22UNumcount
          IF age23UNumcount GT 0 THEN Total_N_ageclass2[23, 3] = age23UNumcount
          IF age24UNumcount GT 0 THEN Total_N_ageclass2[24, 3] = age24UNumcount
          IF age25UNumcount GT 0 THEN Total_N_ageclass2[25, 3] = age25UNumcount
          IF age26UNumcount GT 0 THEN Total_N_ageclass2[26, 3] = age26UNumcount
          PRINT, 'Derived age distribution for UNKNOWN (individual-based)'
          PRINT, Total_N_ageclass2[*, 3]
          PRINT, 'Total number of UNKNOWN (INDIVIDUAL-BASED)'
          PRINT, TOTAL(Total_N_ageclass2[*, 3])



          ; Estimate age structure using PE - ALL FISH
          Prop_ageclass = fltarr(27L, 4L)
          IF TOTAL(Total_N_ageclass[*, 0]) GT 0. THEN Prop_ageclass[*, 0] = Total_N_ageclass[*, 0]/TOTAL(Total_N_ageclass[*, 0])
          PRINT, 'Relative age distribution - ALL FISH'
          PRINT, Prop_ageclass[*, 0]
          ; Estimate age structure - MALES
          IF TOTAL(Total_N_ageclass[*, 0]) GT 0. THEN Prop_ageclass[*, 1] = Male_N_ageclass[*, 0]/TOTAL(Total_N_ageclass[*, 0])
          PRINT, 'Relative age distribution - MALES'
          PRINT, Prop_ageclass[*, 1]
          ; Estimate age structure - FEMALES
          IF TOTAL(Total_N_ageclass[*, 0]) GT 0. THEN Prop_ageclass[*, 2] = Female_N_ageclass[*, 0]/TOTAL(Total_N_ageclass[*, 0])
          PRINT, 'Relative age distribution - FEMALES'
          PRINT, Prop_ageclass[*, 2]
          ; Estimate age structure - UNKNOWNS
          IF TOTAL(Total_N_ageclass[*, 0]) GT 0. THEN Prop_ageclass[*, 3] = Unknown_N_ageclass[*, 0]/TOTAL(Total_N_ageclass[*, 0])
          PRINT, 'Relative age distribution - UNKNOWN'
          PRINT, Prop_ageclass[*, 3]

          ; Estimate age structure 2 - ALL FISH
          Prop_ageclass2 = fltarr(27L, 4L)
          IF TOTAL(Total_N_ageclass2[*, 0]) GT 0. THEN Prop_ageclass2[*, 0] = Total_N_ageclass2[*, 0]/TOTAL(Total_N_ageclass[*, 0])
          PRINT, 'Relative age distribution2 - ALL FISH'
          PRINT, Prop_ageclass2[*, 0]
          ; Estimate age structure - MALES
          IF TOTAL(Total_N_ageclass2[*, 0]) GT 0. THEN Prop_ageclass2[*, 1] = Total_N_ageclass2[*, 1]/TOTAL(Total_N_ageclass[*, 0])
          PRINT, 'Relative age distribution2 - MALES'
          PRINT, Prop_ageclass2[*, 1]
          ; Estimate age structure - FEMALES
          IF TOTAL(Total_N_ageclass2[*, 0]) GT 0. THEN Prop_ageclass2[*, 2] = Total_N_ageclass2[*, 2]/TOTAL(Total_N_ageclass[*, 0])
          PRINT, 'Relative age distribution2 - FEMALES'
          PRINT, Prop_ageclass2[*, 2]
          ; Estimate age structure - UNKNOWNS
          IF TOTAL(Total_N_ageclass2[*, 0]) GT 0. THEN Prop_ageclass2[*, 3] = Total_N_ageclass2[*, 3]/TOTAL(Total_N_ageclass[*, 0])
          PRINT, 'Relative age distribution2 - UNKNOWN'
          PRINT, Prop_ageclass2[*, 3]

          PRINT, 'Population estimate (PE)', PE[INDEX_lengthdata[0]]
          paramset[13:39, i] = ROUND(Prop_ageclass[*, 0]*PE[INDEX_lengthdata[0]])
          paramset[13, i] = YOY_PE[i]
          PRINT, 'Estimated age distribution - ALL FISH'
          PRINT, paramset[13:39, i]
          paramsetM[13:39, i] = ROUND(Prop_ageclass[*, 1]*PE[INDEX_lengthdata[0]])
          PRINT, 'Estimated age distribution - MALES'
          PRINT, ROUND(Prop_ageclass[*, 1]*PE[INDEX_lengthdata[0]])
          paramsetF[13:39, i] = ROUND(Prop_ageclass[*, 2]*PE[INDEX_lengthdata[0]])
          PRINT, 'Estimated age distribution - FEMALES'
          PRINT, ROUND(Prop_ageclass[*, 2]*PE[INDEX_lengthdata[0]])
          paramsetU[13:39, i] = ROUND(Prop_ageclass[*, 3]*PE[INDEX_lengthdata[0]])
          PRINT, 'Estimated age distribution - UNKNOWNS'
          PRINT, ROUND(Prop_ageclass[*, 3]*PE[INDEX_lengthdata[0]])

          ; Plot estimated age structure
          maleage=ROUND(Prop_ageclass[*, 1]*PE[INDEX_lengthdata[0]])
          femaleage=ROUND(Prop_ageclass[*, 2]*PE[INDEX_lengthdata[0]])
          unknownage=ROUND(Prop_ageclass[*, 3]*PE[INDEX_lengthdata[0]])
          unknownage[0]=YOY_PE[i]
          maleage2=ROUND(Prop_ageclass2[*, 1]*PE[INDEX_lengthdata[0]])
          femaleage2=ROUND(Prop_ageclass2[*, 2]*PE[INDEX_lengthdata[0]])
          unknownage2=ROUND(Prop_ageclass2[*, 3]*PE[INDEX_lengthdata[0]])
          unknownage2[0]=YOY_PE[i]
          !p.font=0
          ;Device, Set_Character_Size=[8,12]
          DEVICE, Get_Decomposed=currentState
          DEVICE, SET_FONT='Courier', /TT_FONT
          DEVICE, DECOMPOSED=0
          cgDisplay, 750, 400, WID=1
          ;!P.Multi = [0,2,1]
          labels = INDGEN(27);
          cgLoadct, 33, Clip=[10,245]
          cgBarPlot, maleage,  YRange=[0,ROUND(MAX(maleage+femaleage+unknownage))*1.3], Colors='BLUE', BarNames=labels $
            , xtitle='Age (years)' $
            , ytitle='Number of fish' $;, xrange=[0, 25]
            , title='Age structure of WI walleye - '+'WBIC: '+STRING(paramset[1, i], FORMAT = '(I7)') $
            +'_Year: '+STRING(fix(paramset[2, i]), FORMAT = '(I4)')+' PE='+STRING(PE[INDEX_lengthdata[0]], FORMAT = '(I5)')+stock
          cgBarPlot, femaleage, Colors='RED', /Overplot, BaseLines=maleage
          cgBarPlot, unknownage, Colors='dark green', /Overplot, BaseLines=maleage+femaleage
          items = ['Male', 'Female', 'Unknown']
          colors = ['BLUE', 'RED', 'dark green']
          AL_Legend, items, Colors=colors, PSym=Replicate(15,3), SymSize=Replicate(1.75,3), $
            Charsize=cgDefCharsize(), Position=[0.75, 0.85], /Normal
          filename='Walleye age structure' + STRING(paramset[1, i], FORMAT = '(I7)') $
            + '_'+STRING(fix(paramset[2, i]), FORMAT = '(I4)') + '.png'
          WRITE_PNG, filename, TVRD(/TRUE)
          DEVICE, DECOMPOSED=old_decomposed
          !p.font=1

          !p.font=0
          ;Device, Set_Character_Size=[8,12]
          DEVICE, Get_Decomposed=currentState
          DEVICE, SET_FONT='Courier', /TT_FONT
          DEVICE, DECOMPOSED=0
          cgDisplay, 750, 400, WID=1
          ;!P.Multi = [0,2,1]
          labels = INDGEN(27);
          cgLoadct, 33, Clip=[10,245]
          cgBarPlot, maleage,  YRange=[0,ROUND(MAX(maleage2+femaleage2+unknownage2))*1.3], Colors='BLUE', BarNames=labels $
            , xtitle='Age (years)' $
            , ytitle='Number of fish' $;, xrange=[0, 25]
            , title='Age structure of WI walleye2 - '+'WBIC: '+STRING(paramset[1, i], FORMAT = '(I7)') $
            +'_Year: '+STRING(fix(paramset[2, i]), FORMAT = '(I4)')+' PE='+STRING(PE[INDEX_lengthdata[0]], FORMAT = '(I5)')+stock
          cgBarPlot, femaleage, Colors='RED', /Overplot, BaseLines=maleage
          cgBarPlot, unknownage, Colors='dark green', /Overplot, BaseLines=maleage+femaleage
          items = ['Male', 'Female', 'Unknown']
          colors = ['BLUE', 'RED', 'dark green']
          AL_Legend, items, Colors=colors, PSym=Replicate(15,3), SymSize=Replicate(1.75,3), $
            Charsize=cgDefCharsize(), Position=[0.75, 0.85], /Normal
          filename='Walleye age structure2' + STRING(paramset[1, i], FORMAT = '(I7)') $
            + '_'+STRING(fix(paramset[2, i]), FORMAT = '(I4)') + '.png'
          WRITE_PNG, filename, TVRD(/TRUE)
          DEVICE, DECOMPOSED=old_decomposed
          !p.font=1

          ; Mean length-at-age from estiamted age structure (meas of mean length-at-age from each length bins) - ALL FISH
          mean_length_at_age = FLTARR(27L, 37L)
          mean_length_at_age[0, *] = (WAE_length_mean[10, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_age[1, *] = (WAE_length_mean[11, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_age[2, *] = (WAE_length_mean[12, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_age[3, *] = (WAE_length_mean[13, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_age[4, *] = (WAE_length_mean[14, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_age[5, *] = (WAE_length_mean[15, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_age[6, *] = (WAE_length_mean[16, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_age[7, *] = (WAE_length_mean[17, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_age[8, *] = (WAE_length_mean[18, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_age[9, *] = (WAE_length_mean[19, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_age[10, *] = (WAE_length_mean[20, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_age[11, *] = (WAE_length_mean[21, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_age[12, *] = (WAE_length_mean[22, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_age[13, *] = (WAE_length_mean[23, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_age[14, *] = (WAE_length_mean[24, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_age[15, *] = (WAE_length_mean[25, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_age[16, *] = (WAE_length_mean[26, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_age[17, *] = (WAE_length_mean[27, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_age[18, *] = (WAE_length_mean[28, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_age[19, *] = (WAE_length_mean[29, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_age[20, *] = (WAE_length_mean[30, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_age[21, *] = (WAE_length_mean[31, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_age[22, *] = (WAE_length_mean[32, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_age[23, *] = (WAE_length_mean[33, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_age[24, *] = (WAE_length_mean[34, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_age[25, *] = (WAE_length_mean[35, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_age[26, *] = (WAE_length_mean[36, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          age0mean = where(mean_length_at_age[0, *] GT 0, age0meancount)
          age1mean = where(mean_length_at_age[1, *] GT 0, age1meancount)
          age2mean = where(mean_length_at_age[2, *] GT 0, age2meancount)
          age3mean = where(mean_length_at_age[3, *] GT 0, age3meancount)
          age4mean = where(mean_length_at_age[4, *] GT 0, age4meancount)
          age5mean = where(mean_length_at_age[5, *] GT 0, age5meancount)
          age6mean = where(mean_length_at_age[6, *] GT 0, age6meancount)
          age7mean = where(mean_length_at_age[7, *] GT 0, age7meancount)
          age8mean = where(mean_length_at_age[8, *] GT 0, age8meancount)
          age9mean = where(mean_length_at_age[9, *] GT 0, age9meancount)
          age10mean = where(mean_length_at_age[10, *] GT 0, age10meancount)
          age11mean = where(mean_length_at_age[11, *] GT 0, age11meancount)
          age12mean = where(mean_length_at_age[12, *] GT 0, age12meancount)
          age13mean = where(mean_length_at_age[13, *] GT 0, age13meancount)
          age14mean = where(mean_length_at_age[14, *] GT 0, age14meancount)
          age15mean = where(mean_length_at_age[15, *] GT 0, age15meancount)
          age16mean = where(mean_length_at_age[16, *] GT 0, age16meancount)
          age17mean = where(mean_length_at_age[17, *] GT 0, age17meancount)
          age18mean = where(mean_length_at_age[18, *] GT 0, age18meancount)
          age19mean = where(mean_length_at_age[19, *] GT 0, age19meancount)
          age20mean = where(mean_length_at_age[20, *] GT 0, age20meancount)
          age21mean = where(mean_length_at_age[21, *] GT 0, age21meancount)
          age22mean = where(mean_length_at_age[22, *] GT 0, age22meancount)
          age23mean = where(mean_length_at_age[23, *] GT 0, age23meancount)
          age24mean = where(mean_length_at_age[24, *] GT 0, age24meancount)
          age25mean = where(mean_length_at_age[25, *] GT 0, age25meancount)
          age26mean = where(mean_length_at_age[26, *] GT 0, age26meancount)
          IF age0meancount GT 0 THEN Total_N_ageclass[0, 1] = TOTAL(WAE_length_mean[10, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age0meancount
          IF age1meancount GT 0 THEN Total_N_ageclass[1, 1] = TOTAL(WAE_length_mean[11, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age1meancount
          IF age2meancount GT 0 THEN Total_N_ageclass[2, 1] = TOTAL(WAE_length_mean[12, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age2meancount
          IF age3meancount GT 0 THEN Total_N_ageclass[3, 1] = TOTAL(WAE_length_mean[13, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age3meancount
          IF age4meancount GT 0 THEN Total_N_ageclass[4, 1] = TOTAL(WAE_length_mean[14, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age4meancount
          IF age5meancount GT 0 THEN Total_N_ageclass[5, 1] = TOTAL(WAE_length_mean[15, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age5meancount
          IF age6meancount GT 0 THEN Total_N_ageclass[6, 1] = TOTAL(WAE_length_mean[16, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age6meancount
          IF age7meancount GT 0 THEN Total_N_ageclass[7, 1] = TOTAL(WAE_length_mean[17, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age7meancount
          IF age8meancount GT 0 THEN Total_N_ageclass[8, 1] = TOTAL(WAE_length_mean[18, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age8meancount
          IF age9meancount GT 0 THEN Total_N_ageclass[9, 1] = TOTAL(WAE_length_mean[19, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age9meancount
          IF age10meancount GT 0 THEN Total_N_ageclass[10, 1] = TOTAL(WAE_length_mean[20, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age10meancount
          IF age11meancount GT 0 THEN Total_N_ageclass[11, 1] = TOTAL(WAE_length_mean[21, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age11meancount
          IF age12meancount GT 0 THEN Total_N_ageclass[12, 1] = TOTAL(WAE_length_mean[22, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age12meancount
          IF age13meancount GT 0 THEN Total_N_ageclass[13, 1] = TOTAL(WAE_length_mean[23, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age13meancount
          IF age14meancount GT 0 THEN Total_N_ageclass[14, 1] = TOTAL(WAE_length_mean[24, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age14meancount
          IF age15meancount GT 0 THEN Total_N_ageclass[15, 1] = TOTAL(WAE_length_mean[25, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age15meancount
          IF age16meancount GT 0 THEN Total_N_ageclass[16, 1] = TOTAL(WAE_length_mean[26, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age16meancount
          IF age17meancount GT 0 THEN Total_N_ageclass[17, 1] = TOTAL(WAE_length_mean[27, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age17meancount
          IF age18meancount GT 0 THEN Total_N_ageclass[18, 1] = TOTAL(WAE_length_mean[28, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age18meancount
          IF age19meancount GT 0 THEN Total_N_ageclass[19, 1] = TOTAL(WAE_length_mean[29, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age19meancount
          IF age20meancount GT 0 THEN Total_N_ageclass[20, 1] = TOTAL(WAE_length_mean[30, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age20meancount
          IF age21meancount GT 0 THEN Total_N_ageclass[21, 1] = TOTAL(WAE_length_mean[31, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age21meancount
          IF age22meancount GT 0 THEN Total_N_ageclass[22, 1] = TOTAL(WAE_length_mean[32, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age22meancount
          IF age23meancount GT 0 THEN Total_N_ageclass[23, 1] = TOTAL(WAE_length_mean[33, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age23meancount
          IF age24meancount GT 0 THEN Total_N_ageclass[24, 1] = TOTAL(WAE_length_mean[34, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age24meancount
          IF age25meancount GT 0 THEN Total_N_ageclass[25, 1] = TOTAL(WAE_length_mean[35, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age25meancount
          IF age26meancount GT 0 THEN Total_N_ageclass[26, 1] = TOTAL(WAE_length_mean[36, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age26meancount

          ; Body length (mm) of YOY - *******NEED TO CHANGE IT TO LAKE-YEAR-SPECIFIC
          YOYNOlength = where((Total_N_ageclass[0, 0] GT 0.) AND (Total_N_ageclass[0, 1] LE 0.), YOYNOlengthcount)
          IF paramset[40, i] LE 0 THEN paramset[40, i] = 104.5
          IF YOYNOlengthcount GT 0 THEN Total_N_ageclass[YOYNOlength, 1] = paramset[40, i]
          PRINT, 'Mean length-at-age'
          PRINT, Total_N_ageclass[*, 1]

          ; Mean length-at-age from estiamted age structure - males
          mean_length_at_ageM = FLTARR(27L, 37L)
          mean_length_at_ageM[0, *] = (WAE_length_meanM[10, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageM[1, *] = (WAE_length_meanM[11, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageM[2, *] = (WAE_length_meanM[12, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageM[3, *] = (WAE_length_meanM[13, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageM[4, *] = (WAE_length_meanM[14, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageM[5, *] = (WAE_length_meanM[15, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageM[6, *] = (WAE_length_meanM[16, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageM[7, *] = (WAE_length_meanM[17, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageM[8, *] = (WAE_length_meanM[18, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageM[9, *] = (WAE_length_meanM[19, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageM[10, *] = (WAE_length_meanM[20, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageM[11, *] = (WAE_length_meanM[21, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageM[12, *] = (WAE_length_meanM[22, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageM[13, *] = (WAE_length_meanM[23, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageM[14, *] = (WAE_length_meanM[24, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageM[15, *] = (WAE_length_meanM[25, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageM[16, *] = (WAE_length_meanM[26, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageM[17, *] = (WAE_length_meanM[27, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageM[18, *] = (WAE_length_meanM[28, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageM[19, *] = (WAE_length_meanM[29, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageM[20, *] = (WAE_length_meanM[30, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageM[21, *] = (WAE_length_meanM[31, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageM[22, *] = (WAE_length_meanM[32, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageM[23, *] = (WAE_length_meanM[33, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageM[24, *] = (WAE_length_meanM[34, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageM[25, *] = (WAE_length_meanM[35, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageM[26, *] = (WAE_length_meanM[36, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          age0Mmean = where(mean_length_at_ageM[0, *] GT 0, age0meanMcount)
          age1Mmean = where(mean_length_at_ageM[1, *] GT 0, age1meanMcount)
          age2Mmean = where(mean_length_at_ageM[2, *] GT 0, age2meanMcount)
          age3Mmean = where(mean_length_at_ageM[3, *] GT 0, age3meanMcount)
          age4Mmean = where(mean_length_at_ageM[4, *] GT 0, age4meanMcount)
          age5Mmean = where(mean_length_at_ageM[5, *] GT 0, age5meanMcount)
          age6Mmean = where(mean_length_at_ageM[6, *] GT 0, age6meanMcount)
          age7Mmean = where(mean_length_at_ageM[7, *] GT 0, age7meanMcount)
          age8Mmean = where(mean_length_at_ageM[8, *] GT 0, age8meanMcount)
          age9Mmean = where(mean_length_at_ageM[9, *] GT 0, age9meanMcount)
          age10Mmean = where(mean_length_at_ageM[10, *] GT 0, age10meanMcount)
          age11Mmean = where(mean_length_at_ageM[11, *] GT 0, age11meanMcount)
          age12Mmean = where(mean_length_at_ageM[12, *] GT 0, age12meanMcount)
          age13Mmean = where(mean_length_at_ageM[13, *] GT 0, age13meanMcount)
          age14Mmean = where(mean_length_at_ageM[14, *] GT 0, age14meanMcount)
          age15Mmean = where(mean_length_at_ageM[15, *] GT 0, age15meanMcount)
          age16Mmean = where(mean_length_at_ageM[16, *] GT 0, age16meanMcount)
          age17Mmean = where(mean_length_at_ageM[17, *] GT 0, age17meanMcount)
          age18Mmean = where(mean_length_at_ageM[18, *] GT 0, age18meanMcount)
          age19Mmean = where(mean_length_at_ageM[19, *] GT 0, age19meanMcount)
          age20Mmean = where(mean_length_at_ageM[20, *] GT 0, age20meanMcount)
          age21Mmean = where(mean_length_at_ageM[21, *] GT 0, age21meanMcount)
          age22Mmean = where(mean_length_at_ageM[22, *] GT 0, age22meanMcount)
          age23Mmean = where(mean_length_at_ageM[23, *] GT 0, age23meanMcount)
          age24Mmean = where(mean_length_at_ageM[24, *] GT 0, age24meanMcount)
          age25Mmean = where(mean_length_at_ageM[25, *] GT 0, age25meanMcount)
          age26Mmean = where(mean_length_at_ageM[26, *] GT 0, age26meanMcount)
          IF age0meanMcount GT 0 THEN Male_N_ageclass[0, 1] = TOTAL(WAE_length_meanM[10, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age0meanMcount
          IF age1meanMcount GT 0 THEN Male_N_ageclass[1, 1] = TOTAL(WAE_length_meanM[11, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age1meanMcount
          IF age2meanMcount GT 0 THEN Male_N_ageclass[2, 1] = TOTAL(WAE_length_meanM[12, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age2meanMcount
          IF age3meanMcount GT 0 THEN Male_N_ageclass[3, 1] = TOTAL(WAE_length_meanM[13, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age3meanMcount
          IF age4meanMcount GT 0 THEN Male_N_ageclass[4, 1] = TOTAL(WAE_length_meanM[14, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age4meanMcount
          IF age5meanMcount GT 0 THEN Male_N_ageclass[5, 1] = TOTAL(WAE_length_meanM[15, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age5meanMcount
          IF age6meanMcount GT 0 THEN Male_N_ageclass[6, 1] = TOTAL(WAE_length_meanM[16, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age6meanMcount
          IF age7meanMcount GT 0 THEN Male_N_ageclass[7, 1] = TOTAL(WAE_length_meanM[17, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age7meanMcount
          IF age8meanMcount GT 0 THEN Male_N_ageclass[8, 1] = TOTAL(WAE_length_meanM[18, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age8meanMcount
          IF age9meanMcount GT 0 THEN Male_N_ageclass[9, 1] = TOTAL(WAE_length_meanM[19, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age9meanMcount
          IF age10meanMcount GT 0 THEN Male_N_ageclass[10, 1] = TOTAL(WAE_length_meanM[20, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age10meanMcount
          IF age11meanMcount GT 0 THEN Male_N_ageclass[11, 1] = TOTAL(WAE_length_meanM[21, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age11meanMcount
          IF age12meanMcount GT 0 THEN Male_N_ageclass[12, 1] = TOTAL(WAE_length_meanM[22, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age12meanMcount
          IF age13meanMcount GT 0 THEN Male_N_ageclass[13, 1] = TOTAL(WAE_length_meanM[23, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age13meanMcount
          IF age14meanMcount GT 0 THEN Male_N_ageclass[14, 1] = TOTAL(WAE_length_meanM[24, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age14meanMcount
          IF age15meanMcount GT 0 THEN Male_N_ageclass[15, 1] = TOTAL(WAE_length_meanM[25, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age15meanMcount
          IF age16meanMcount GT 0 THEN Male_N_ageclass[16, 1] = TOTAL(WAE_length_meanM[26, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age16meanMcount
          IF age17meanMcount GT 0 THEN Male_N_ageclass[17, 1] = TOTAL(WAE_length_meanM[27, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age17meanMcount
          IF age18meanMcount GT 0 THEN Male_N_ageclass[18, 1] = TOTAL(WAE_length_meanM[28, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age18meanMcount
          IF age19meanMcount GT 0 THEN Male_N_ageclass[19, 1] = TOTAL(WAE_length_meanM[29, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age19meanMcount
          IF age20meanMcount GT 0 THEN Male_N_ageclass[20, 1] = TOTAL(WAE_length_meanM[30, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age20meanMcount
          IF age21meanMcount GT 0 THEN Male_N_ageclass[21, 1] = TOTAL(WAE_length_meanM[31, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age21meanMcount
          IF age22meanMcount GT 0 THEN Male_N_ageclass[22, 1] = TOTAL(WAE_length_meanM[32, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age22meanMcount
          IF age23meanMcount GT 0 THEN Male_N_ageclass[23, 1] = TOTAL(WAE_length_meanM[33, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age23meanMcount
          IF age24meanMcount GT 0 THEN Male_N_ageclass[24, 1] = TOTAL(WAE_length_meanM[34, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age24meanMcount
          IF age25meanMcount GT 0 THEN Male_N_ageclass[25, 1] = TOTAL(WAE_length_meanM[35, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age25meanMcount
          IF age26meanMcount GT 0 THEN Male_N_ageclass[26, 1] = TOTAL(WAE_length_meanM[36, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age26meanMcount
          PRINT, 'Mean length-at-age for males'
          PRINT, Male_N_ageclass[*, 1]

          ; Mean length-at-age from estiamted age structure - females
          mean_length_at_ageF = FLTARR(27L, 37L)
          mean_length_at_ageF[0, *] = (WAE_length_meanF[10, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageF[1, *] = (WAE_length_meanF[11, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageF[2, *] = (WAE_length_meanF[12, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageF[3, *] = (WAE_length_meanF[13, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageF[4, *] = (WAE_length_meanF[14, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageF[5, *] = (WAE_length_meanF[15, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageF[6, *] = (WAE_length_meanF[16, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageF[7, *] = (WAE_length_meanF[17, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageF[8, *] = (WAE_length_meanF[18, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageF[9, *] = (WAE_length_meanF[19, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageF[10, *] = (WAE_length_meanF[20, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageF[11, *] = (WAE_length_meanF[21, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageF[12, *] = (WAE_length_meanF[22, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageF[13, *] = (WAE_length_meanF[23, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageF[14, *] = (WAE_length_meanF[24, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageF[15, *] = (WAE_length_meanF[25, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageF[16, *] = (WAE_length_meanF[26, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageF[17, *] = (WAE_length_meanF[27, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageF[18, *] = (WAE_length_meanF[28, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageF[19, *] = (WAE_length_meanF[29, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageF[20, *] = (WAE_length_meanF[30, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageF[21, *] = (WAE_length_meanF[31, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageF[22, *] = (WAE_length_meanF[32, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageF[23, *] = (WAE_length_meanF[33, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageF[24, *] = (WAE_length_meanF[34, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageF[25, *] = (WAE_length_meanF[35, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageF[26, *] = (WAE_length_meanF[36, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          age0Mmean = where(mean_length_at_ageF[0, *] GT 0, age0meanFcount)
          age1Mmean = where(mean_length_at_ageF[1, *] GT 0, age1meanFcount)
          age2Mmean = where(mean_length_at_ageF[2, *] GT 0, age2meanFcount)
          age3Mmean = where(mean_length_at_ageF[3, *] GT 0, age3meanFcount)
          age4Mmean = where(mean_length_at_ageF[4, *] GT 0, age4meanFcount)
          age5Mmean = where(mean_length_at_ageF[5, *] GT 0, age5meanFcount)
          age6Mmean = where(mean_length_at_ageF[6, *] GT 0, age6meanFcount)
          age7Mmean = where(mean_length_at_ageF[7, *] GT 0, age7meanFcount)
          age8Mmean = where(mean_length_at_ageF[8, *] GT 0, age8meanFcount)
          age9Mmean = where(mean_length_at_ageF[9, *] GT 0, age9meanFcount)
          age10Mmean = where(mean_length_at_ageF[10, *] GT 0, age10meanFcount)
          age11Mmean = where(mean_length_at_ageF[11, *] GT 0, age11meanFcount)
          age12Mmean = where(mean_length_at_ageF[12, *] GT 0, age12meanFcount)
          age13Mmean = where(mean_length_at_ageF[13, *] GT 0, age13meanFcount)
          age14Mmean = where(mean_length_at_ageF[14, *] GT 0, age14meanFcount)
          age15Mmean = where(mean_length_at_ageF[15, *] GT 0, age15meanFcount)
          age16Mmean = where(mean_length_at_ageF[16, *] GT 0, age16meanFcount)
          age17Mmean = where(mean_length_at_ageF[17, *] GT 0, age17meanFcount)
          age18Mmean = where(mean_length_at_ageF[18, *] GT 0, age18meanFcount)
          age19Mmean = where(mean_length_at_ageF[19, *] GT 0, age19meanFcount)
          age20Mmean = where(mean_length_at_ageF[20, *] GT 0, age20meanFcount)
          age21Mmean = where(mean_length_at_ageF[21, *] GT 0, age21meanFcount)
          age22Mmean = where(mean_length_at_ageF[22, *] GT 0, age22meanFcount)
          age23Mmean = where(mean_length_at_ageF[23, *] GT 0, age23meanFcount)
          age24Mmean = where(mean_length_at_ageF[24, *] GT 0, age24meanFcount)
          age25Mmean = where(mean_length_at_ageF[25, *] GT 0, age25meanFcount)
          age26Mmean = where(mean_length_at_ageF[26, *] GT 0, age26meanFcount)
          IF age0meanFcount GT 0 THEN Female_N_ageclass[0, 1] = TOTAL(WAE_length_meanF[10, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age0meanFcount
          IF age1meanFcount GT 0 THEN Female_N_ageclass[1, 1] = TOTAL(WAE_length_meanF[11, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age1meanFcount
          IF age2meanFcount GT 0 THEN Female_N_ageclass[2, 1] = TOTAL(WAE_length_meanF[12, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age2meanFcount
          IF age3meanFcount GT 0 THEN Female_N_ageclass[3, 1] = TOTAL(WAE_length_meanF[13, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age3meanFcount
          IF age4meanFcount GT 0 THEN Female_N_ageclass[4, 1] = TOTAL(WAE_length_meanF[14, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age4meanFcount
          IF age5meanFcount GT 0 THEN Female_N_ageclass[5, 1] = TOTAL(WAE_length_meanF[15, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age5meanFcount
          IF age6meanFcount GT 0 THEN Female_N_ageclass[6, 1] = TOTAL(WAE_length_meanF[16, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age6meanFcount
          IF age7meanFcount GT 0 THEN Female_N_ageclass[7, 1] = TOTAL(WAE_length_meanF[17, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age7meanFcount
          IF age8meanFcount GT 0 THEN Female_N_ageclass[8, 1] = TOTAL(WAE_length_meanF[18, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age8meanFcount
          IF age9meanFcount GT 0 THEN Female_N_ageclass[9, 1] = TOTAL(WAE_length_meanF[19, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age9meanFcount
          IF age10meanFcount GT 0 THEN Female_N_ageclass[10, 1] = TOTAL(WAE_length_meanF[20, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age10meanFcount
          IF age11meanFcount GT 0 THEN Female_N_ageclass[11, 1] = TOTAL(WAE_length_meanF[21, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age11meanFcount
          IF age12meanFcount GT 0 THEN Female_N_ageclass[12, 1] = TOTAL(WAE_length_meanF[22, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age12meanFcount
          IF age13meanFcount GT 0 THEN Female_N_ageclass[13, 1] = TOTAL(WAE_length_meanF[23, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age13meanFcount
          IF age14meanFcount GT 0 THEN Female_N_ageclass[14, 1] = TOTAL(WAE_length_meanF[24, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age14meanFcount
          IF age15meanFcount GT 0 THEN Female_N_ageclass[15, 1] = TOTAL(WAE_length_meanF[25, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age15meanFcount
          IF age16meanFcount GT 0 THEN Female_N_ageclass[16, 1] = TOTAL(WAE_length_meanF[26, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age16meanFcount
          IF age17meanFcount GT 0 THEN Female_N_ageclass[17, 1] = TOTAL(WAE_length_meanF[27, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age17meanFcount
          IF age18meanFcount GT 0 THEN Female_N_ageclass[18, 1] = TOTAL(WAE_length_meanF[28, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age18meanFcount
          IF age19meanFcount GT 0 THEN Female_N_ageclass[19, 1] = TOTAL(WAE_length_meanF[29, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age19meanFcount
          IF age20meanFcount GT 0 THEN Female_N_ageclass[20, 1] = TOTAL(WAE_length_meanF[30, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age20meanFcount
          IF age21meanFcount GT 0 THEN Female_N_ageclass[21, 1] = TOTAL(WAE_length_meanF[31, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age21meanFcount
          IF age22meanFcount GT 0 THEN Female_N_ageclass[22, 1] = TOTAL(WAE_length_meanF[32, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age22meanFcount
          IF age23meanFcount GT 0 THEN Female_N_ageclass[23, 1] = TOTAL(WAE_length_meanF[33, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age23meanFcount
          IF age24meanFcount GT 0 THEN Female_N_ageclass[24, 1] = TOTAL(WAE_length_meanF[34, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age24meanFcount
          IF age25meanFcount GT 0 THEN Female_N_ageclass[25, 1] = TOTAL(WAE_length_meanF[35, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age25meanFcount
          IF age26meanFcount GT 0 THEN Female_N_ageclass[26, 1] = TOTAL(WAE_length_meanF[36, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age26meanFcount
          PRINT, 'Mean length-at-age for females'
          PRINT, Female_N_ageclass[*, 1]
          ; Store mean length-at-age in output arrays
          paramset[40L:66, i] = Total_N_ageclass[*, 1]
          paramsetM[40L:66, i] = Male_N_ageclass[*, 1]
          paramsetF[40L:66, i] = Female_N_ageclass[*, 1]
          paramsetU[40L:66, i] = Total_N_ageclass[*, 1]


          ; Convert mean length-at-age to mass-at-age ***use population-level length-mass functions***
          ;Mean_mass = FLTARR(27L, 1)
          Mean_mass = 1.5868E-006*Total_N_ageclass[*, 1]^3.2962
          Mean_massM = 2.7673E-006*Male_N_ageclass[*, 1]^3.1984
          Mean_massF = 3.0031E-006*Female_N_ageclass[*, 1]^3.1988
          Mean_massU = 1.5868E-006*Total_N_ageclass[*, 1]^3.2962
          PRINT, 'Mean mass-at-age'
          PRINT, Mean_mass
          PRINT, 'Mean mass-at-age for males'
          PRINT, Mean_massM
          PRINT, 'Mean mass-at-age for females'
          PRINT, Mean_massF
          ; Store in the output arrays
          paramset[67L:93, i] = Mean_mass
          paramsetM[67L:93, i] = Mean_massM
          paramsetF[67L:93, i] = Mean_massF
          paramsetU[67L:93, i] = Mean_massU

          ; check if there is mass-at-age exists
          ; ALL FISH
          Age_NOmass = WHERE(Mean_mass LE 0, Age_NOmasscount)
          Age_Wmass = WHERE(Mean_mass GT 0, Age_Wmasscount)
          IF Age_Wmasscount GT 0. THEN PRINT, 'age class with mass data', Age_Wmass
          IF Age_NOmasscount GT 0. THEN PRINT, 'age class without mass data', Age_NOmass
          PRINT, 'max age class with mass', max(Age_Wmass)
          PRINT, 'min age class with mass', min(Age_Wmass)
          Age_mass_index = INDGEN(27)
          Age_NOmass_Intrpl = WHERE((Age_NOmass GT MIN(Age_Wmass)) AND (Age_NOmass LT MAX(Age_Wmass)), Age_NOmass_Intrplcount)
          IF Age_NOmass_Intrplcount GT 0 THEN PRINT, 'age class mass need interpolation', Age_NOmass[Age_NOmass_Intrpl]
          ; MALE
          Age_NOmassM = WHERE(Mean_massM LE 0, Age_NOmassMcount)
          Age_WmassM = WHERE(Mean_massM GT 0, Age_WmassMcount)
          IF Age_WmassMcount GT 0. THEN PRINT, 'age class with mass data', Age_WmassM
          IF Age_NOmassMcount GT 0. THEN PRINT, 'age class without mass data', Age_NOmassM
          PRINT, 'max age class with mass', max(Age_WmassM)
          PRINT, 'min age class with mass', min(Age_WmassM)
          Age_mass_indexM = INDGEN(27)
          Age_NOmass_IntrplM = WHERE((Age_NOmassM GT min(Age_WmassM)) AND (Age_NOmassM LT max(Age_WmassM)), Age_NOmass_IntrplMcount)
          IF Age_NOmass_IntrplMcount GT 0 THEN PRINT, 'age class mass need interpolation', Age_NOmassM[Age_NOmass_IntrplM]
          ; FEMALE
          Age_NOmassF = WHERE(Mean_massF LE 0, Age_NOmassFcount)
          Age_WmassF = WHERE(Mean_massF GT 0, Age_WmassFcount)
          IF Age_WmassFcount GT 0. THEN PRINT, 'age class with mass data', Age_WmassF
          IF Age_NOmassFcount GT 0. THEN PRINT, 'age class without mass data', Age_NOmassF
          PRINT, 'max age class with mass', max(Age_WmassF)
          PRINT, 'min age class with mass', min(Age_WmassF)
          Age_mass_indexF = INDGEN(27)
          Age_NOmass_IntrplF = WHERE((Age_NOmassF GT min(Age_WmassF)) AND (Age_NOmassF LT max(Age_WmassF)), Age_NOmass_IntrplFcount)
          IF Age_NOmass_IntrplFcount GT 0 THEN PRINT, 'age class mass need interpolation', Age_NOmassF[Age_NOmass_IntrplF]

          ; calculate biomass-at-age - BIOMASS = MASS x N 
          ;Biomass_ageclass = fltarr(27L, 1)
          Biomass_ageclass = Mean_mass*ROUND(Prop_ageclass[*, 0]*PE[INDEX_lengthdata[0]])
          Biomass_ageclass[0] = Mean_mass[0]*YOY_PE[i]
          PRINT, 'Biomass-at-age (g) - ALL FISH'
          PRINT, Biomass_ageclass
          Biomass_ageclassM = Mean_massM*ROUND(Prop_ageclass[*, 1]*PE[INDEX_lengthdata[0]])
          PRINT, 'Biomass-at-age (g) - MALE'
          PRINT, Biomass_ageclassM
          Biomass_ageclassF = Mean_massF*ROUND(Prop_ageclass[*, 2]*PE[INDEX_lengthdata[0]])
          PRINT, 'Biomass-at-age (g) - FEMALE'
          PRINT, Biomass_ageclassF
          Biomass_ageclassU = Mean_massU*ROUND(Prop_ageclass[*, 3]*PE[INDEX_lengthdata[0]])
          Biomass_ageclassU[0] = Mean_massU[0]*YOY_PE[i]
          PRINT, 'Biomass-at-age (g) - UNKNOWN'
          PRINT, Biomass_ageclassU
          ; Store in the output arrays
          paramset[94L:120, i] = Biomass_ageclass
          paramsetM[94L:120, i] = Biomass_ageclassM
          paramsetF[94L:120, i] = Biomass_ageclassF
          paramsetU[94L:120, i] = Biomass_ageclassU

          ; calculate total and age-specific growth production
          ; total
          Growth_mass = fltarr(27L, 1)
          Mean_biomass = fltarr(27L, 1)
          Production = fltarr(27L, 1)
          FOR Agei = 1L, 26L DO BEGIN
            IF (Agei GE MIN(Age_Wmass)) AND (Agei LT MAX(Age_Wmass)) THEN BEGIN
              IF (Mean_mass[Agei-1L, 0] GT 0.) AND (Mean_mass[Agei, 0] GT 0.) THEN BEGIN
                Growth_mass[Agei, 0] = ALOG(Mean_mass[Agei, 0]/Mean_mass[Agei-1L, 0]); instantanepous rate of growth
                Mean_biomass[Agei, 0] = MEAN(Biomass_ageclass[Agei-1L:Agei, 0]); B hat
                Production[Agei, 0] = Growth_mass[Agei, 0] * Mean_biomass[Agei, 0]; PRODUCTION = B HAT x GROWTH 
              ENDIF
            ENDIF
          ENDFOR
          PRINT, 'Mean growth in mass'
          PRINT, Growth_mass
          PRINT, 'Mean biomass (Bhat)'
          PRINT, Mean_biomass
          PRINT, 'Production'
          PRINT, Production
          paramset[121L:147, i] = Growth_mass
          paramset[148L:174, i] = Mean_biomass
          paramset[175L:201, i] = Production

          ; male
          Growth_massM = fltarr(27L, 1)
          Mean_biomassM = fltarr(27L, 1)
          ProductionM = fltarr(27L, 1)
          ;IF (Mean_mass[3, 0] GT 0) AND (Mean_mass[4, 0] GT 0) THEN Growth_mass[0, 0] = Mean_mass[4, 0] - Mean_mass[3, 0]
          FOR Agei = 1L, 26L DO BEGIN
            IF (Agei GE MIN(Age_WmassM)) AND (Agei LT MAX(Age_WmassM)) THEN BEGIN
              ;print, 'agei', agei
              IF (Mean_massM[Agei-1L, 0] GT 0.) AND (Mean_massM[Agei, 0] GT 0.) THEN BEGIN
                Growth_massM[Agei, 0] = ALOG(Mean_massM[Agei, 0]/Mean_massM[Agei-1L, 0])
                Mean_biomassM[Agei, 0] = MEAN(Biomass_ageclassM[Agei-1L:Agei, 0])
                ProductionM[Agei, 0] = Growth_massM[Agei, 0] * Mean_biomassM[Agei, 0]
              ENDIF
            ENDIF
          ENDFOR
          PRINT, 'Mean growth in mass - MALES'
          PRINT, Growth_massM
          PRINT, 'Mean biomass (Bhat) - MALE'
          PRINT, Mean_biomassM
          PRINT, 'Production - MALE'
          PRINT, ProductionM
          paramsetM[121L:147, i] = Growth_massM
          paramsetM[148L:174, i] = Mean_biomassM
          paramsetM[175L:201, i] = ProductionM

          ; female
          Growth_massF = fltarr(27L, 1)
          Mean_biomassF = fltarr(27L, 1)
          ProductionF = fltarr(27L, 1)
          FOR Agei = 1L, 26L DO BEGIN
            IF (Agei GE MIN(Age_WmassF)) AND (Agei LT MAX(Age_WmassF)) THEN BEGIN
              ;print, 'agei', agei
              IF (Mean_massF[Agei-1L, 0] GT 0.) AND (Mean_massF[Agei, 0] GT 0.) THEN BEGIN
                Growth_massF[Agei, 0] = ALOG(Mean_massF[Agei, 0]/Mean_massF[Agei-1L, 0])
                Mean_biomassF[Agei, 0] = MEAN(Biomass_ageclassF[Agei-1L:Agei, 0])
                ProductionF[Agei, 0] = Growth_massF[Agei, 0] * Mean_biomassM[Agei, 0]
              ENDIF
            ENDIF
          ENDFOR
          PRINT, 'Mean growth in mass - FEMALES'
          PRINT, Growth_massF
          PRINT, 'Mean biomass (Bhat) - FEMALE'
          PRINT, Mean_biomassF
          PRINT, 'Production - FEMALE'
          PRINT, ProductionF
          paramsetF[121L:147, i] = Growth_massF
          paramsetF[148L:174, i] = Mean_biomassF
          paramsetF[175L:201, i] = ProductionF

          ; unknown
          Growth_massU = fltarr(27L, 1)
          Mean_biomassU = fltarr(27L, 1)
          ProductionU = fltarr(27L, 1)
          FOR Agei = 1L, 26L DO BEGIN
            IF (Agei GE MIN(Age_Wmass)) AND (Agei LT MAX(Age_Wmass)) THEN BEGIN
              ;print, 'agei', agei
              IF (Mean_mass[Agei-1L, 0] GT 0.) AND (Mean_mass[Agei, 0] GT 0.) THEN BEGIN
                Growth_massU[Agei, 0] = ALOG(Mean_mass[Agei, 0]/Mean_mass[Agei-1L, 0])
                Mean_biomassU[Agei, 0] = MEAN(Biomass_ageclassU[Agei-1L:Agei, 0])
                ProductionU[Agei, 0] = Growth_massU[Agei, 0] * Mean_biomassU[Agei, 0]
              ENDIF
            ENDIF
          ENDFOR
          PRINT, 'Mean growth in mass - UNKNOWN'
          PRINT, Growth_massU
          PRINT, 'Mean biomass (Bhat) - UNKNOWN'
          PRINT, Mean_biomassU
          PRINT, 'Production - UNKOWN'
          PRINT, ProductionU
          paramsetU[121L:147, i] = Growth_massU
          paramsetU[148L:174, i] = Mean_biomassU
          paramsetU[175L:201, i] = ProductionU

          ; create age-specific biomass plots
          maleBiomass=Biomass_ageclassM/1000.
          femaleBiomass=Biomass_ageclassF/1000.
          unknownBiomass=Biomass_ageclassU/1000.
          !p.font=0
          ;Device, Set_Character_Size=[8,12]
          Device, Get_Decomposed=currentState
          DEVICE, SET_FONT='Courier', /TT_FONT
          DEVICE, DECOMPOSED=0
          cgDisplay, 750, 400, WID=0
          ;!P.Multi = [0,2,1]
          labels = INDGEN(27); ['Exp 1', 'Exp 2', 'Exp 3', 'Exp 4', 'Exp 5']
          cgLoadct, 33, Clip=[10,245]
          cgBarPlot, maleBiomass,  YRange=[0,MAX(maleBiomass+femaleBiomass+unknownBiomass)*1.3], Colors='BLUE', BarNames=labels $
            , xtitle='Age (years)'$
            , ytitle='Biomass (Kg)' $;, xrange=[0, 25]
            , title='Biomass distribution of WI walleye - '+'WBIC: '+STRING(WBIC[INDEX_lengthdata[0]], FORMAT = '(I7)') $
            +'_Year: '+STRING(fix(SurveyYear[INDEX_lengthdata[0]]), FORMAT = '(I4)')+STOCK
          ;XYOutS, ROUND(MEDIAN(INDGEN(27))), ROUND(0.5*(MAX(paramset[13:39, i]))*1.3), Orientation=90.0, /DEVICE
          cgBarPlot, femaleBiomass, Colors='RED', /Overplot, BaseLines=maleBiomass
          cgBarPlot, unknownBiomass, Colors='dark green', /Overplot, BaseLines=maleBiomass+femaleBiomass
          items = ['Male', 'Female', 'Unknown']
          colors = ['BLUE', 'RED', 'dark green']
          AL_Legend, items, Colors=colors, PSym=Replicate(15,3), SymSize=Replicate(1.75,3), $
            Charsize=cgDefCharsize(), Position=[0.75, 0.85], /Normal
          ; file name for WBIC-year-specific age structure
          filename='Walleye biomass'+ STRING(WBIC[INDEX_lengthdata[0]], FORMAT = '(I7)') $
            +'_'+STRING(fix(SurveyYear[INDEX_lengthdata[0]]), FORMAT = '(I4)')+'.png'
          WRITE_PNG, filename, TVRD(/TRUE)
          DEVICE, DECOMPOSED=old_decomposed
          !p.font=1

          paramset[94L:120, i] = Biomass_ageclass
          Growth_mass = fltarr(27L, 1)
          Mean_biomass = fltarr(27L, 1)
          Production = fltarr(27L, 1)
          FOR Agei = 1L, 26L DO BEGIN
            IF (Agei GE MIN(Age_Wmass)) AND (Agei LT MAX(Age_Wmass)) THEN BEGIN
              ;print, 'agei', agei
              IF (Mean_mass[Agei-1L, 0] GT 0.) AND (Mean_mass[Agei, 0] GT 0.) THEN BEGIN
                Growth_mass[Agei, 0] = ALOG(Mean_mass[Agei, 0]/Mean_mass[Agei-1L, 0])
                Mean_biomass[Agei, 0] = MEAN(Biomass_ageclass[Agei-1L:Agei, 0])
                Production[Agei, 0] = Growth_mass[Agei, 0] * Mean_biomass[Agei, 0]
              ENDIF
            ENDIF
          ENDFOR
          PRINT, 'Mean growth in mass'
          PRINT, Growth_mass
          PRINT, 'Mean biomass (Bhat)'
          PRINT, Mean_biomass
          PRINT, 'Production'
          PRINT, Production
          paramset[121L:147, i] = Growth_mass; mean growth w/o sex-specific conversion
          paramset[148L:174, i] = Mean_biomassM + Mean_biomassF + Mean_biomassU
          paramset[175L:201, i] = ProductionM + ProductionF + ProductionU 
          
          
                                  ; *******GAPS IN AGE CLASSS STILL NEED TO be INTERPOLATED!!!!!!!!!!!!!!!!!
          
          
          ; Total biomass
          PRINT, 'Population estimate (PE)', PE[INDEX_lengthdata[0]]
          PRINT, 'Lake area (km2)', LakeArea[INDEX_lengthdata[0]]/1000000.; lake area (km2)
          ; Total biomass - ALL FISH
          IF (LakeArea[INDEX_lengthdata[0]] GT 0.) THEN Total_biomass[i] = TOTAL(Biomass_ageclass[*, 0]) / LakeArea[INDEX_lengthdata[0]]*1000000./1000.
          ; MALE
          IF (LakeArea[INDEX_lengthdata[0]] GT 0.) THEN Total_biomassM[i] = TOTAL(Biomass_ageclassM[*, 0]) / LakeArea[INDEX_lengthdata[0]]*1000000./1000.
          PRINT, 'Total biomass - MALE (kg/km2)'
          PRINT, Total_biomassM[i]
          ; FEMLAE
          IF (LakeArea[INDEX_lengthdata[0]] GT 0.) THEN Total_biomassF[i] = TOTAL(Biomass_ageclassF[*, 0]) / LakeArea[INDEX_lengthdata[0]]*1000000./1000.
          PRINT, 'Total biomass - FEMALE (kg/km2)'
          PRINT, Total_biomassF[i]
          ; UNKNOWN
          IF (LakeArea[INDEX_lengthdata[0]] GT 0.) THEN Total_biomassU[i] = TOTAL(Biomass_ageclassU[*, 0]) / LakeArea[INDEX_lengthdata[0]]*1000000./1000.
          PRINT, 'Total biomass - UNKWON (kg/km2)'
          PRINT, Total_biomassU[i]        
          paramset[202, i] = Total_biomassM[i] + Total_biomassF[i] + Total_biomassU[i]
          PRINT, 'Total biomass (kg/km2)'
          PRINT, Total_biomass[i], paramset[202, i]

          ; Total production
          ; ALL FISH
          Pos_production = WHERE(Production[*, 0] GT 0., Pos_productioncount); negative age-specific production is converted to 0
          IF (Pos_productioncount GT 0.) AND (LakeArea[INDEX_lengthdata[0]] GT 0.) THEN Total_production[i] = TOTAL(Production[Pos_production, 0]) $
            / LakeArea[INDEX_lengthdata[0]]*1000000./1000.
          ; MALE
          Pos_productionM = WHERE(ProductionM[*, 0] GT 0., Pos_productionMcount); negative age-specific production is converted to 0
          IF (Pos_productionMcount GT 0.) AND (LakeArea[INDEX_lengthdata[0]] GT 0.) THEN Total_productionM[i] = TOTAL(ProductionM[Pos_productionM, 0]) $
            / LakeArea[INDEX_lengthdata[0]]*1000000./1000.
          ; FEMALE
          Pos_productionF = WHERE(ProductionF[*, 0] GT 0., Pos_productionFcount); negative age-specific production is converted to 0
          IF (Pos_productionFcount GT 0.) AND (LakeArea[INDEX_lengthdata[0]] GT 0.) THEN Total_productionF[i] = TOTAL(ProductionF[Pos_productionF, 0]) $
            / LakeArea[INDEX_lengthdata[0]]*1000000./1000.           
           ; UNKNOWN
          Pos_productionU = WHERE(ProductionU[*, 0] GT 0., Pos_productionUcount); negative age-specific production is converted to 0
          IF (Pos_productionMcount GT 0.) AND (LakeArea[INDEX_lengthdata[0]] GT 0.) THEN Total_productionU[i] = TOTAL(ProductionU[Pos_productionU, 0]) $
            / LakeArea[INDEX_lengthdata[0]]*1000000./1000. 
          paramset[203, i] = Total_productionM[i] + Total_productionF[i] + Total_productionU[i]
          PRINT, 'Total Production (kg/km2/year)'
          PRINT, Total_production[i], paramset[203, i]
          
          ; PRODUCTION/BIOMASS
          Pos_biomass = WHERE(Total_biomass[i] GT 0., Pos_biomasscount); negative age-specific production is converted to 0
          IF Pos_biomasscount GT 0. THEN P_over_B[i] = Total_production[i] / Total_biomass[i]
          PRINT, 'P/B'
          PRINT, P_over_B[i]
          IF Pos_biomasscount GT 0. THEN P_over_B[i] = paramset[203, i] / paramset[202, i]
          PRINT, 'P/B'
          PRINT, P_over_B[i]          
          paramset[204L, i] = P_over_B[i]

          ; Adult estimates (w/ only >age 3)
          ; Biomass - ALL FISH
          IF (LakeArea[INDEX_lengthdata[0]] GT 0.) THEN Total_biomass_adult[i] = TOTAL(Biomass_ageclass[3L:26L, 0]) / LakeArea[INDEX_lengthdata[0]]*1000000./1000.
          PRINT, 'Total adult biomass (kg/km2)'
          PRINT, Total_biomass_adult[i]
          ; Biomass - MALE
          IF (LakeArea[INDEX_lengthdata[0]] GT 0.) THEN Total_biomass_adultM[i] = TOTAL(Biomass_ageclassM[3L:26L, 0]) / LakeArea[INDEX_lengthdata[0]]*1000000./1000.
          PRINT, 'Total adult biomass - MALE (kg/km2)'
          PRINT, Total_biomass_adultM[i]
          ; Biomass - FEMALE
          IF (LakeArea[INDEX_lengthdata[0]] GT 0.) THEN Total_biomass_adultF[i] = TOTAL(Biomass_ageclassF[3L:26L, 0]) / LakeArea[INDEX_lengthdata[0]]*1000000./1000.
          PRINT, 'Total adult biomass - FEMALE (kg/km2)'
          PRINT, Total_biomass_adultF[i]          
          ; Biomass - UNKWON
          IF (LakeArea[INDEX_lengthdata[0]] GT 0.) THEN Total_biomass_adultU[i] = TOTAL(Biomass_ageclassU[3L:26L, 0]) / LakeArea[INDEX_lengthdata[0]]*1000000./1000.
          PRINT, 'Total adult biomass - UNKNOWN (kg/km2)'
          PRINT, Total_biomass_adultU[i]    

          paramset[205, i] = Total_biomass_adultM[i] +  Total_biomass_adultF[i] + Total_biomass_adultU[i]
          PRINT, 'Total biomass (kg/km2)'
          PRINT, Total_biomass_adult[i], paramset[205, i]

          ; Adult production estimates - ALL FISH
          Growth_mass_adult = fltarr(27L, 1)
          Mean_biomass_adult = fltarr(27L, 1)
          Production_adult = fltarr(27L, 1)
          FOR Agei = 0L, 26L DO BEGIN
            IF (Agei GE 3L) AND (Agei LT MAX(Age_Wmass)) THEN BEGIN
              IF (Mean_mass[Agei-1L, 0] GT 0.) AND (Mean_mass[Agei, 0] GT 0.) THEN BEGIN
                Growth_mass_adult[Agei, 0] = ALOG(Mean_mass[Agei, 0]/Mean_mass[Agei-1L, 0])
                Mean_biomass_adult[Agei, 0] = MEAN(Biomass_ageclass[Agei-1L:Agei, 0])
                Production_adult[Agei, 0] = Growth_mass_adult[Agei, 0] * Mean_biomass_adult[Agei, 0]
              ENDIF
            ENDIF
          ENDFOR
          ; Adult production estimates - MALE
          Growth_mass_adultM = fltarr(27L, 1)
          Mean_biomass_adultM = fltarr(27L, 1)
          Production_adultM = fltarr(27L, 1)
          FOR Agei = 0L, 26L DO BEGIN
            IF (Agei GE 3L) AND (Agei LT MAX(Age_WmassM)) THEN BEGIN
              IF (Mean_massM[Agei-1L, 0] GT 0.) AND (Mean_massM[Agei, 0] GT 0.) THEN BEGIN
                Growth_mass_adultM[Agei, 0] = ALOG(Mean_massM[Agei, 0]/Mean_massM[Agei-1L, 0])
                Mean_biomass_adultM[Agei, 0] = MEAN(Biomass_ageclassM[Agei-1L:Agei, 0])
                Production_adultM[Agei, 0] = Growth_mass_adultM[Agei, 0] * Mean_biomass_adultM[Agei, 0]
              ENDIF
            ENDIF
          ENDFOR
          ; Adult production estimates - FEMALE
          Growth_mass_adultF = fltarr(27L, 1)
          Mean_biomass_adultF = fltarr(27L, 1)
          Production_adultF = fltarr(27L, 1)
          FOR Agei = 0L, 26L DO BEGIN
            IF (Agei GE 3L) AND (Agei LT MAX(Age_WmassF)) THEN BEGIN
              IF (Mean_massF[Agei-1L, 0] GT 0.) AND (Mean_massF[Agei, 0] GT 0.) THEN BEGIN
                Growth_mass_adultF[Agei, 0] = ALOG(Mean_massF[Agei, 0]/Mean_massF[Agei-1L, 0])
                Mean_biomass_adultF[Agei, 0] = MEAN(Biomass_ageclassF[Agei-1L:Agei, 0])
                Production_adultF[Agei, 0] = Growth_mass_adultF[Agei, 0] * Mean_biomass_adultF[Agei, 0]
              ENDIF
            ENDIF
          ENDFOR
          ; Adult production estimates - UNKNOWN
            Growth_mass_adultU = fltarr(27L, 1)
            Mean_biomass_adultU = fltarr(27L, 1)
            Production_adultU = fltarr(27L, 1)
            FOR Agei = 0L, 26L DO BEGIN
              IF (Agei GE 3L) AND (Agei LT MAX(Age_Wmass)) THEN BEGIN
                IF (Mean_massU[Agei-1L, 0] GT 0.) AND (Mean_massU[Agei, 0] GT 0.) THEN BEGIN
                  Growth_mass_adultU[Agei, 0] = ALOG(Mean_massU[Agei, 0]/Mean_massU[Agei-1L, 0])
                  Mean_biomass_adultU[Agei, 0] = MEAN(Biomass_ageclassU[Agei-1L:Agei, 0])
                  Production_adultU[Agei, 0] = Growth_mass_adultU[Agei, 0] * Mean_biomass_adultU[Agei, 0]
                ENDIF
              ENDIF
            ENDFOR

          ; ALL FISH
          Pos_production_adult = WHERE(Production_adult[*, 0] GT 0., Pos_production_adultcount); ***negative age-specific production is converted to 0
          PRINT, 'Array index for positive adult production', Pos_production_adult
          IF (Pos_production_adultcount GT 0.) AND (LakeArea[INDEX_lengthdata[0]] GT 0.)  THEN Total_production_adult[i] = TOTAL(Production_adult[Pos_production_adult, 0]) $
            / LakeArea[INDEX_lengthdata[0]]*1000000./1000.
          ; MALE
          Pos_production_adultM = WHERE(Production_adultM[*, 0] GT 0., Pos_production_adultMcount); ***negative age-specific production is converted to 0
          PRINT, 'Array index for positive adult production - MALE', Pos_production_adultM
          IF (Pos_production_adultMcount GT 0.) AND (LakeArea[INDEX_lengthdata[0]] GT 0.)  THEN Total_production_adultM[i] $
              = TOTAL(Production_adultM[Pos_production_adultM, 0]) / LakeArea[INDEX_lengthdata[0]]*1000000./1000.           
          ; FEMALE
          Pos_production_adultF = WHERE(Production_adultF[*, 0] GT 0., Pos_production_adultFcount); ***negative age-specific production is converted to 0
          PRINT, 'Array index for positive adult production - FEMALE', Pos_production_adultF
          IF (Pos_production_adultFcount GT 0.) AND (LakeArea[INDEX_lengthdata[0]] GT 0.)  THEN Total_production_adultF[i] $
              = TOTAL(Production_adultF[Pos_production_adultF, 0]) / LakeArea[INDEX_lengthdata[0]]*1000000./1000.           
          ; UNKNOWN
          Pos_production_adultU = WHERE(Production_adultU[*, 0] GT 0., Pos_production_adultUcount); ***negative age-specific production is converted to 0
          PRINT, 'Array index for positive adult production - UNKNOWN', Pos_production_adultU
          IF (Pos_production_adultUcount GT 0.) AND (LakeArea[INDEX_lengthdata[0]] GT 0.)  THEN Total_production_adultU[i] $
              = TOTAL(Production_adultU[Pos_production_adultU, 0]) / LakeArea[INDEX_lengthdata[0]]*1000000./1000.
            
          paramset[206L, i] = Total_production_adultM[i] + Total_production_adultF[i] + Total_production_adultU[i]
          PRINT, 'Total adult Production (kg/km2/year)'
          PRINT, Total_production_adult[i], paramset[206L, i]
          IF LakeArea[INDEX_lengthdata[0]] GT 0 THEN paramset[217, i] = Total_production[i] $
            + (Biomass_ageclass[3,0]/1000.)/(LakeArea[INDEX_lengthdata[0]]/1000000.)
          PRINT, 'Surplus adult production (kg/km2/year)'
          PRINT, paramset[217L, i]

          ; PRODUCTION / BIOMASS
          ; ALL FISH
          Pos_biomass_adult = WHERE(Total_biomass_adult[i] GT 0., Pos_biomass_adultcount); negative age-specific production is converted to 0
          IF Pos_biomass_adultcount GT 0. THEN P_over_B_adult[i] = Total_production_adult[i] / Total_biomass_adult[i]
          PRINT, 'Adult P/B'
          PRINT, P_over_B_adult[i]
          IF Pos_biomass_adultcount GT 0. THEN P_over_B_adult[i] = paramset[206, i] / paramset[205, i]
          PRINT, 'Adult P/B'
          PRINT, P_over_B_adult[i]
          paramset[207L, i] = P_over_B_adult[i]
          paramset[208L, i] = PE[INDEX_lengthdata[0]]; population estimate
          paramset[209L, i] = LakeArea[INDEX_lengthdata[0]]/1000000.; lake area (km2)
          


                          ;########################################################
                          ;#Calculate harvested fish age structure for production #
                          ;########################################################
      
          ; array index for angling data
          INDEX_lengthdataAngl = WHERE((WBIC_year_angl[*] EQ WBIC_year[INDEX_lengthdata[0]]), INDEX_lengthdataAnglcount)

          IF INDEX_lengthdataAnglcount GT 0 THEN BEGIN; if angling data exist...
            PRINT, 'WBIC_angl', WBIC_year_angl[INDEX_lengthdataAngl[0]]
            PRINT, 'Harvest data availabile'
            N_Lake_year_angl = N_Lake_year_angl + 1L
            PRINT, 'N of lake-year with harvest data', N_Lake_year_angl

            ;IF INDEX_lengthdataAnglcount GT 0 then begin
            Length_prod_angl = Length_angl[INDEX_lengthdataAngl]; WBIC_year data
            FishAgeAngl = AgeArrayAngl[INDEX_lengthdataAngl]; assigned age
            FishLengthAngl = LengthArrayAngl[INDEX_lengthdataAngl]; length check
            ;PRINT, 'Length_prod_angl', length[INDEX_lengthdata]
            paramset_angl[0, i] = uniqWBIC_Year[i]; WBIC_year (abbrev)
            paramset_angl[1, i] = WBIC_angl[INDEX_lengthdataAngl[0]]; WBIC
            paramset_angl[2, i] = SurveyYear_angl[INDEX_lengthdataAngl[0]]; year
            paramset_angl[3, i] = N_ELements(Length_prod_angl); N of fish
            paramset_angl[7, i] = Max(length_angl[INDEX_lengthdataAngl])
            paramset_angl[8, i] = Min(length_angl[INDEX_lengthdataAngl])
            
            paramset_angl[218, i] = MEAN(length_angl[INDEX_lengthdataAngl]); mean length for all fish
            paramset_angl[219, i] = STDDEV(length_angl[INDEX_lengthdataAngl]); SD length for all fish
            paramset_angl[222, i] = legal_size[INDEX_lengthdataAngl[0]]; legal size

            print, 'N of fish', paramset_angl[3, i];, malecount+femalecount+unknowncount
            print, 'WBIC', paramset_angl[1, i]
            print, 'Year', paramset_angl[2, i]
            print, 'Max length (mm)', Max(length_angl[INDEX_lengthdataAngl])
            print, 'Min length (mm)', Min(length_angl[INDEX_lengthdataAngl])

            ; Length group distributions - all fish
            SizeLT100_angl = WHERE(Length_prod_angl LT 100., SizeLT100_anglcount)
            Size100to120_angl = WHERE((Length_prod_angl GE 100.) AND (Length_prod_angl LT 120.), Size100to120_anglcount)
            Size120to140_angl = WHERE((Length_prod_angl GE 120.) AND (Length_prod_angl LT 140.), Size120to140_anglcount)
            Size140to160_angl = WHERE((Length_prod_angl GE 140.) AND (Length_prod_angl LT 160.), Size140to160_anglcount)
            Size160to180_angl = WHERE((Length_prod_angl GE 160.) AND (Length_prod_angl LT 180.), Size160to180_anglcount)
            Size180to200_angl = WHERE((Length_prod_angl GE 180.) AND (Length_prod_angl LT 200.), Size180to200_anglcount)
            Size200to220_angl = WHERE((Length_prod_angl GE 200.) AND (Length_prod_angl LT 220.), Size200to220_anglcount)
            Size220to240_angl = WHERE((Length_prod_angl GE 220.) AND (Length_prod_angl LT 240.), Size220to240_anglcount)
            Size240to260_angl = WHERE((Length_prod_angl GE 240.) AND (Length_prod_angl LT 260.), Size240to260_anglcount)
            Size260to280_angl = WHERE((Length_prod_angl GE 260.) AND (Length_prod_angl LT 280.), Size260to280_anglcount)
            Size280to300_angl = WHERE((Length_prod_angl GE 280.) AND (Length_prod_angl LT 300.), Size280to300_anglcount)
            Size300to320_angl = WHERE((Length_prod_angl GE 300.) AND (Length_prod_angl LT 320.), Size300to320_anglcount)
            Size320to340_angl = WHERE((Length_prod_angl GE 320.) AND (Length_prod_angl LT 340.), Size320to340_anglcount)
            Size340to360_angl = WHERE((Length_prod_angl GE 340.) AND (Length_prod_angl LT 360.), Size340to360_anglcount)
            Size360to380_angl = WHERE((Length_prod_angl GE 360.) AND (Length_prod_angl LT 380.), Size360to380_anglcount)
            Size380to400_angl = WHERE((Length_prod_angl GE 380.) AND (Length_prod_angl LT 400.), Size380to400_anglcount)
            Size400to420_angl = WHERE((Length_prod_angl GE 400.) AND (Length_prod_angl LT 420.), Size400to420_anglcount)
            Size420to440_angl = WHERE((Length_prod_angl GE 420.) AND (Length_prod_angl LT 440.), Size420to440_anglcount)
            Size440to460_angl = WHERE((Length_prod_angl GE 440.) AND (Length_prod_angl LT 460.), Size440to460_anglcount)
            Size460to480_angl = WHERE((Length_prod_angl GE 460.) AND (Length_prod_angl LT 480.), Size460to480_anglcount)
            Size480to500_angl = WHERE((Length_prod_angl GE 480.) AND (Length_prod_angl LT 500.), Size480to500_anglcount)
            Size500to520_angl = WHERE((Length_prod_angl GE 500.) AND (Length_prod_angl LT 520.), Size500to520_anglcount)
            Size520to540_angl = WHERE((Length_prod_angl GE 520.) AND (Length_prod_angl LT 540.), Size520to540_anglcount)
            Size540to560_angl = WHERE((Length_prod_angl GE 540.) AND (Length_prod_angl LT 560.), Size540to560_anglcount)
            Size560to580_angl = WHERE((Length_prod_angl GE 560.) AND (Length_prod_angl LT 580.), Size560to580_anglcount)
            Size580to600_angl = WHERE((Length_prod_angl GE 580.) AND (Length_prod_angl LT 600.), Size580to600_anglcount)
            Size600to620_angl = WHERE((Length_prod_angl GE 600.) AND (Length_prod_angl LT 620.), Size600to620_anglcount)
            Size620to640_angl = WHERE((Length_prod_angl GE 620.) AND (Length_prod_angl LT 640.), Size620to640_anglcount)
            Size640to660_angl = WHERE((Length_prod_angl GE 640.) AND (Length_prod_angl LT 660.), Size640to660_anglcount)
            Size660to680_angl = WHERE((Length_prod_angl GE 660.) AND (Length_prod_angl LT 680.), Size660to680_anglcount)
            Size680to700_angl = WHERE((Length_prod_angl GE 680.) AND (Length_prod_angl LT 700.), Size680to700_anglcount)
            Size700to720_angl = WHERE((Length_prod_angl GE 700.) AND (Length_prod_angl LT 720.), Size700to720_anglcount)
            Size720to740_angl = WHERE((Length_prod_angl GE 720.) AND (Length_prod_angl LT 740.), Size720to740_anglcount)
            Size740to760_angl = WHERE((Length_prod_angl GE 740.) AND (Length_prod_angl LT 760.), Size740to760_anglcount)
            Size760to780_angl = WHERE((Length_prod_angl GE 760.) AND (Length_prod_angl LT 780.), Size760to780_anglcount)
            Size780to800_angl = WHERE((Length_prod_angl GE 780.) AND (Length_prod_angl LT 800.), Size780to800_anglcount)
            SizeGE800_angl = WHERE((Length_prod_angl GE 800.), SizeGE800_anglcount)
            LengthDist_angl[0, i] = SizeLT100_anglcount
            LengthDist_angl[1, i] = Size100to120_anglcount
            LengthDist_angl[2, i] = Size120to140_anglcount
            LengthDist_angl[3, i] = Size140to160_anglcount
            LengthDist_angl[4, i] = Size160to180_anglcount
            LengthDist_angl[5, i] = Size180to200_anglcount
            LengthDist_angl[6, i] = Size200to220_anglcount
            LengthDist_angl[7, i] = Size220to240_anglcount
            LengthDist_angl[8, i] = Size240to260_anglcount
            LengthDist_angl[9, i] = Size260to280_anglcount
            LengthDist_angl[10, i] = Size280to300_anglcount
            LengthDist_angl[11, i] = Size300to320_anglcount
            LengthDist_angl[12, i] = Size320to340_anglcount
            LengthDist_angl[13, i] = Size340to360_anglcount
            LengthDist_angl[14, i] = Size360to380_anglcount
            LengthDist_angl[15, i] = Size380to400_anglcount
            LengthDist_angl[16, i] = Size400to420_anglcount
            LengthDist_angl[17, i] = Size420to440_anglcount
            LengthDist_angl[18, i] = Size440to460_anglcount
            LengthDist_angl[19, i] = Size460to480_anglcount
            LengthDist_angl[20, i] = Size480to500_anglcount
            LengthDist_angl[21, i] = Size500to520_anglcount
            LengthDist_angl[22, i] = Size520to540_anglcount
            LengthDist_angl[23, i] = Size540to560_anglcount
            LengthDist_angl[24, i] = Size560to580_anglcount
            LengthDist_angl[25, i] = Size580to600_anglcount
            LengthDist_angl[26, i] = Size600to620_anglcount
            LengthDist_angl[27, i] = Size620to640_anglcount
            LengthDist_angl[28, i] = Size640to660_anglcount
            LengthDist_angl[29, i] = Size660to680_anglcount
            LengthDist_angl[30, i] = Size680to700_anglcount
            LengthDist_angl[31, i] = Size700to720_anglcount
            LengthDist_angl[32, i] = Size720to740_anglcount
            LengthDist_angl[33, i] = Size740to760_anglcount
            LengthDist_angl[34, i] = Size760to780_anglcount
            LengthDist_angl[35, i] = Size780to800_anglcount
            LengthDist_angl[36, i] = SizeGE800_anglcount
            PRINT, 'length distribution - angling (bin size = 20mm)', LengthDist_angl[0:36, i]
            LengthDist_angl[37, i] = paramset_angl[1, i]; WBIC 
            LengthDist_angl[38, i] = paramset_angl[2, i]; year
            LengthDist_angl[39, i] = paramset_angl[3, i]; sample size
            LengthDist_angl[40, i] = adultPE_angl[INDEX_lengthdataAngl[0]]; adult PE
            LengthDist_angl[41, i] = HarvRate_angl[INDEX_lengthdataAngl[0]]; harvest rate

            ; identify empty length bins in spring surveys
            IF (SizeLT100_anglcount GT 0) AND (LengthDist[0, i] LE 0) THEN LengthDist_angl_PLUS[0, i] = SizeLT100_anglcount
            IF (Size100to120_anglcount GT 0) AND (LengthDist[1, i] LE 0) THEN LengthDist_angl_PLUS[1, i] = Size100to120_anglcount
            IF (Size120to140_anglcount GT 0) AND (LengthDist[2, i] LE 0) THEN LengthDist_angl_PLUS[2, i] = Size120to140_anglcount
            IF (Size140to160_anglcount GT 0) AND (LengthDist[3, i] LE 0) THEN LengthDist_angl_PLUS[3, i] = Size140to160_anglcount
            IF (Size160to180_anglcount GT 0) AND (LengthDist[4, i] LE 0) THEN LengthDist_angl_PLUS[4, i] = Size160to180_anglcount
            IF (Size180to200_anglcount GT 0) AND (LengthDist[5, i] LE 0) THEN LengthDist_angl_PLUS[5, i] = Size180to200_anglcount
            IF (Size200to220_anglcount GT 0) AND (LengthDist[6, i] LE 0) THEN LengthDist_angl_PLUS[6, i] = Size200to220_anglcount
            IF (Size220to240_anglcount GT 0) AND (LengthDist[7, i] LE 0) THEN LengthDist_angl_PLUS[7, i] = Size220to240_anglcount
            IF (Size240to260_anglcount GT 0) AND (LengthDist[8, i] LE 0) THEN LengthDist_angl_PLUS[8, i] = Size240to260_anglcount
            IF (Size260to280_anglcount GT 0) AND (LengthDist[9, i] LE 0) THEN LengthDist_angl_PLUS[9, i] = Size260to280_anglcount
            IF (Size280to300_anglcount GT 0) AND (LengthDist[10, i] LE 0) THEN LengthDist_angl_PLUS[10, i] = Size280to300_anglcount
            IF (Size300to320_anglcount GT 0) AND (LengthDist[11, i] LE 0) THEN LengthDist_angl_PLUS[11, i] = Size300to320_anglcount
            IF (Size320to340_anglcount GT 0) AND (LengthDist[12, i] LE 0) THEN LengthDist_angl_PLUS[12, i] = Size320to340_anglcount
            IF (Size340to360_anglcount GT 0) AND (LengthDist[13, i] LE 0) THEN LengthDist_angl_PLUS[13, i] = Size340to360_anglcount
            IF (Size360to380_anglcount GT 0) AND (LengthDist[14, i] LE 0) THEN LengthDist_angl_PLUS[14, i] = Size360to380_anglcount
            IF (Size380to400_anglcount GT 0) AND (LengthDist[15, i] LE 0) THEN LengthDist_angl_PLUS[15, i] = Size380to400_anglcount
            IF (Size400to420_anglcount GT 0) AND (LengthDist[16, i] LE 0) THEN LengthDist_angl_PLUS[16, i] = Size400to420_anglcount
            IF (Size420to440_anglcount GT 0) AND (LengthDist[17, i] LE 0) THEN LengthDist_angl_PLUS[17, i] = Size420to440_anglcount
            IF (Size440to460_anglcount GT 0) AND (LengthDist[18, i] LE 0) THEN LengthDist_angl_PLUS[18, i] = Size440to460_anglcount
            IF (Size460to480_anglcount GT 0) AND (LengthDist[19, i] LE 0) THEN LengthDist_angl_PLUS[19, i] = Size460to480_anglcount
            IF (Size480to500_anglcount GT 0) AND (LengthDist[20, i] LE 0) THEN LengthDist_angl_PLUS[20, i] = Size480to500_anglcount
            IF (Size500to520_anglcount GT 0) AND (LengthDist[21, i] LE 0) THEN LengthDist_angl_PLUS[21, i] = Size500to520_anglcount
            IF (Size520to540_anglcount GT 0) AND (LengthDist[22, i] LE 0) THEN LengthDist_angl_PLUS[22, i] = Size520to540_anglcount
            IF (Size540to560_anglcount GT 0) AND (LengthDist[23, i] LE 0) THEN LengthDist_angl_PLUS[23, i] = Size540to560_anglcount
            IF (Size560to580_anglcount GT 0) AND (LengthDist[24, i] LE 0) THEN LengthDist_angl_PLUS[24, i] = Size560to580_anglcount
            IF (Size580to600_anglcount GT 0) AND (LengthDist[25, i] LE 0) THEN LengthDist_angl_PLUS[25, i] = Size580to600_anglcount
            IF (Size600to620_anglcount GT 0) AND (LengthDist[26, i] LE 0) THEN LengthDist_angl_PLUS[26, i] = Size600to620_anglcount
            IF (Size620to640_anglcount GT 0) AND (LengthDist[27, i] LE 0) THEN LengthDist_angl_PLUS[27, i] = Size620to640_anglcount
            IF (Size640to660_anglcount GT 0) AND (LengthDist[28, i] LE 0) THEN LengthDist_angl_PLUS[28, i] = Size640to660_anglcount
            IF (Size660to680_anglcount GT 0) AND (LengthDist[29, i] LE 0) THEN LengthDist_angl_PLUS[29, i] = Size660to680_anglcount
            IF (Size680to700_anglcount GT 0) AND (LengthDist[30, i] LE 0) THEN LengthDist_angl_PLUS[30, i] = Size680to700_anglcount
            IF (Size700to720_anglcount GT 0) AND (LengthDist[31, i] LE 0) THEN LengthDist_angl_PLUS[31, i] = Size700to720_anglcount
            IF (Size720to740_anglcount GT 0) AND (LengthDist[32, i] LE 0) THEN LengthDist_angl_PLUS[32, i] = Size720to740_anglcount
            IF (Size740to760_anglcount GT 0) AND (LengthDist[33, i] LE 0) THEN LengthDist_angl_PLUS[33, i] = Size740to760_anglcount
            IF (Size760to780_anglcount GT 0) AND (LengthDist[34, i] LE 0) THEN LengthDist_angl_PLUS[34, i] = Size760to780_anglcount
            IF (Size780to800_anglcount GT 0) AND (LengthDist[35, i] LE 0) THEN LengthDist_angl_PLUS[35, i] = Size780to800_anglcount
            IF (SizeGE800_anglcount GT 0) AND (LengthDist[36, i] LE 0) THEN LengthDist_angl_PLUS[36, i] = SizeGE800_anglcount
            IF TOTAL(LengthDist_angl_PLUS[*, i]) GT 0 THEN PRINT, 'length bins w/o spring survey data (bin size = 20mm)', LengthDist_angl_PLUS[0:36, i]
            Prop_LengthDist_angl_PLUS[i] = TOTAL(LengthDist_angl_PLUS[*, i]) / TOTAL(LengthDist_angl[*, i])
            
            ; If fish some elngth bins were not sampled in spring surveys, they were not included in age structure analysis 
            IF LengthDist_angl_PLUS[0, i] GT 0 THEN SizeLT100_anglcount = 0
            IF LengthDist_angl_PLUS[1, i] GT 0 THEN Size100to120_anglcount = 0
            IF LengthDist_angl_PLUS[2, i] GT 0 THEN Size120to140_anglcount = 0
            IF LengthDist_angl_PLUS[3, i] GT 0 THEN Size140to160_anglcount = 0
            IF LengthDist_angl_PLUS[4, i] GT 0 THEN Size160to180_anglcount = 0
            IF LengthDist_angl_PLUS[5, i] GT 0 THEN Size180to200_anglcount = 0
            IF LengthDist_angl_PLUS[6, i] GT 0 THEN Size200to220_anglcount = 0
            IF LengthDist_angl_PLUS[7, i] GT 0 THEN Size220to240_anglcount = 0
            IF LengthDist_angl_PLUS[8, i] GT 0 THEN Size240to260_anglcount = 0
            IF LengthDist_angl_PLUS[9, i] GT 0 THEN Size260to280_anglcount = 0
            IF LengthDist_angl_PLUS[10, i] GT 0 THEN Size280to300_anglcount = 0
            IF LengthDist_angl_PLUS[11, i] GT 0 THEN Size300to320_anglcount = 0
            IF LengthDist_angl_PLUS[12, i] GT 0 THEN Size320to340_anglcount = 0
            IF LengthDist_angl_PLUS[13, i] GT 0 THEN Size340to360_anglcount = 0
            IF LengthDist_angl_PLUS[14, i] GT 0 THEN Size360to380_anglcount = 0
            IF LengthDist_angl_PLUS[15, i] GT 0 THEN Size380to400_anglcount = 0
            IF LengthDist_angl_PLUS[16, i] GT 0 THEN Size400to420_anglcount = 0
            IF LengthDist_angl_PLUS[17, i] GT 0 THEN Size420to440_anglcount = 0
            IF LengthDist_angl_PLUS[18, i] GT 0 THEN Size440to460_anglcount = 0
            IF LengthDist_angl_PLUS[19, i] GT 0 THEN Size460to480_anglcount = 0
            IF LengthDist_angl_PLUS[20, i] GT 0 THEN Size480to500_anglcount = 0
            IF LengthDist_angl_PLUS[21, i] GT 0 THEN Size500to520_anglcount = 0
            IF LengthDist_angl_PLUS[22, i] GT 0 THEN Size520to540_anglcount = 0
            IF LengthDist_angl_PLUS[23, i] GT 0 THEN Size540to560_anglcount = 0
            IF LengthDist_angl_PLUS[24, i] GT 0 THEN Size560to580_anglcount = 0
            IF LengthDist_angl_PLUS[25, i] GT 0 THEN Size580to600_anglcount = 0
            IF LengthDist_angl_PLUS[26, i] GT 0 THEN Size600to620_anglcount = 0
            IF LengthDist_angl_PLUS[27, i] GT 0 THEN Size620to640_anglcount = 0
            IF LengthDist_angl_PLUS[28, i] GT 0 THEN Size640to660_anglcount = 0
            IF LengthDist_angl_PLUS[29, i] GT 0 THEN Size660to680_anglcount = 0
            IF LengthDist_angl_PLUS[30, i] GT 0 THEN Size680to700_anglcount = 0
            IF LengthDist_angl_PLUS[31, i] GT 0 THEN Size700to720_anglcount = 0
            IF LengthDist_angl_PLUS[32, i] GT 0 THEN Size720to740_anglcount = 0
            IF LengthDist_angl_PLUS[33, i] GT 0 THEN Size740to760_anglcount = 0
            IF LengthDist_angl_PLUS[34, i] GT 0 THEN Size760to780_anglcount = 0
            IF LengthDist_angl_PLUS[35, i] GT 0 THEN Size780to800_anglcount = 0
            IF LengthDist_angl_PLUS[36, i] GT 0 THEN SizeGE800_anglcount = 0
              
            ; array index for WBIC years w/ key
            INDEX_lengthdataAngl2 = WHERE((WBIC_year_key[*] EQ WBIC_Year_angl[INDEX_lengthdataAngl[0]]), INDEX_lengthdataAngl2count)

            IF (INDEX_lengthdataAngl2count GT 0) THEN BEGIN

            length_key_check_angl_angl = fltarr(37)
            IF (SizeLT100_anglcount GT 0) AND (Length_N_fish[INDEX_lengthdataAngl2[0]] LE 0) THEN length_key_check_angl[0] = SizeLT100_anglcount
            IF (Size100to120_anglcount GT 0) AND (Length_N_fish[INDEX_lengthdataAngl2[1]] LE 0) THEN length_key_check_angl[1] = Size100to120_anglcount
            IF (Size120to140_anglcount GT 0) AND (Length_N_fish[INDEX_lengthdataAngl2[2]] LE 0) THEN length_key_check_angl[2] = Size120to140_anglcount
            IF (Size140to160_anglcount GT 0) AND (Length_N_fish[INDEX_lengthdataAngl2[3]] LE 0) THEN length_key_check_angl[3] = Size140to160_anglcount
            IF (Size160to180_anglcount GT 0) AND (Length_N_fish[INDEX_lengthdataAngl2[4]] LE 0) THEN length_key_check_angl[4] = Size160to180_anglcount
            IF (Size180to200_anglcount GT 0) AND (Length_N_fish[INDEX_lengthdataAngl2[5]] LE 0) THEN length_key_check_angl[5] = Size180to200_anglcount
            IF (Size200to220_anglcount GT 0) AND (Length_N_fish[INDEX_lengthdataAngl2[6]] LE 0) THEN length_key_check_angl[6] = Size200to220_anglcount
            IF (Size220to240_anglcount GT 0) AND (Length_N_fish[INDEX_lengthdataAngl2[7]] LE 0) THEN length_key_check_angl[7] = Size220to240_anglcount
            IF (Size240to260_anglcount GT 0) AND (Length_N_fish[INDEX_lengthdataAngl2[8]] LE 0) THEN length_key_check_angl[8] = Size240to260_anglcount
            IF (Size260to280_anglcount GT 0) AND (Length_N_fish[INDEX_lengthdataAngl2[9]] LE 0) THEN length_key_check_angl[9] = Size260to280_anglcount
            IF (Size280to300_anglcount GT 0) AND (Length_N_fish[INDEX_lengthdataAngl2[10]] LE 0) THEN length_key_check_angl[10] = Size280to300_anglcount
            IF (Size300to320_anglcount GT 0) AND (Length_N_fish[INDEX_lengthdataAngl2[11]] LE 0) THEN length_key_check_angl[11] = Size300to320_anglcount
            IF (Size320to340_anglcount GT 0) AND (Length_N_fish[INDEX_lengthdataAngl2[12]] LE 0) THEN length_key_check_angl[12] = Size320to340_anglcount
            IF (Size340to360_anglcount GT 0) AND (Length_N_fish[INDEX_lengthdataAngl2[13]] LE 0) THEN length_key_check_angl[13] = Size340to360_anglcount
            IF (Size360to380_anglcount GT 0) AND (Length_N_fish[INDEX_lengthdataAngl2[14]] LE 0) THEN length_key_check_angl[14] = Size360to380_anglcount
            IF (Size380to400_anglcount GT 0) AND (Length_N_fish[INDEX_lengthdataAngl2[15]] LE 0) THEN length_key_check_angl[15] = Size380to400_anglcount
            IF (Size400to420_anglcount GT 0) AND (Length_N_fish[INDEX_lengthdataAngl2[16]] LE 0) THEN length_key_check_angl[16] = Size400to420_anglcount
            IF (Size420to440_anglcount GT 0) AND (Length_N_fish[INDEX_lengthdataAngl2[17]] LE 0) THEN length_key_check_angl[17] = Size420to440_anglcount
            IF (Size440to460_anglcount GT 0) AND (Length_N_fish[INDEX_lengthdataAngl2[18]] LE 0) THEN length_key_check_angl[18] = Size440to460_anglcount
            IF (Size460to480_anglcount GT 0) AND (Length_N_fish[INDEX_lengthdataAngl2[19]] LE 0) THEN length_key_check_angl[19] = Size460to480_anglcount
            IF (Size480to500_anglcount GT 0) AND (Length_N_fish[INDEX_lengthdataAngl2[20]] LE 0) THEN length_key_check_angl[20] = Size480to500_anglcount
            IF (Size500to520_anglcount GT 0) AND (Length_N_fish[INDEX_lengthdataAngl2[21]] LE 0) THEN length_key_check_angl[21] = Size500to520_anglcount
            IF (Size520to540_anglcount GT 0) AND (Length_N_fish[INDEX_lengthdataAngl2[22]] LE 0) THEN length_key_check_angl[22] = Size520to540_anglcount
            IF (Size540to560_anglcount GT 0) AND (Length_N_fish[INDEX_lengthdataAngl2[23]] LE 0) THEN length_key_check_angl[23] = Size540to560_anglcount
            IF (Size560to580_anglcount GT 0) AND (Length_N_fish[INDEX_lengthdataAngl2[24]] LE 0) THEN length_key_check_angl[24] = Size560to580_anglcount
            IF (Size580to600_anglcount GT 0) AND (Length_N_fish[INDEX_lengthdataAngl2[25]] LE 0) THEN length_key_check_angl[25] = Size580to600_anglcount
            IF (Size600to620_anglcount GT 0) AND (Length_N_fish[INDEX_lengthdataAngl2[26]] LE 0) THEN length_key_check_angl[26] = Size600to620_anglcount
            IF (Size620to640_anglcount GT 0) AND (Length_N_fish[INDEX_lengthdataAngl2[27]] LE 0) THEN length_key_check_angl[27] = Size620to640_anglcount
            IF (Size640to660_anglcount GT 0) AND (Length_N_fish[INDEX_lengthdataAngl2[28]] LE 0) THEN length_key_check_angl[28] = Size640to660_anglcount
            IF (Size660to680_anglcount GT 0) AND (Length_N_fish[INDEX_lengthdataAngl2[29]] LE 0) THEN length_key_check_angl[29] = Size660to680_anglcount
            IF (Size680to700_anglcount GT 0) AND (Length_N_fish[INDEX_lengthdataAngl2[30]] LE 0) THEN length_key_check_angl[30] = Size680to700_anglcount
            IF (Size700to720_anglcount GT 0) AND (Length_N_fish[INDEX_lengthdataAngl2[31]] LE 0) THEN length_key_check_angl[31] = Size700to720_anglcount
            IF (Size720to740_anglcount GT 0) AND (Length_N_fish[INDEX_lengthdataAngl2[32]] LE 0) THEN length_key_check_angl[32] = Size720to740_anglcount
            IF (Size740to760_anglcount GT 0) AND (Length_N_fish[INDEX_lengthdataAngl2[33]] LE 0) THEN length_key_check_angl[33] = Size740to760_anglcount
            IF (Size760to780_anglcount GT 0) AND (Length_N_fish[INDEX_lengthdataAngl2[34]] LE 0) THEN length_key_check_angl[34] = Size760to780_anglcount
            IF (Size780to800_anglcount GT 0) AND (Length_N_fish[INDEX_lengthdataAngl2[35]] LE 0) THEN length_key_check_angl[35] = Size780to8000_anglcount
            IF (SizeGE800_anglcount GT 0) AND (Length_N_fish[INDEX_lengthdataAngl2[36]] LE 0) THEN length_key_check_angl[36] = SizeGE800_anglcount
            PRINT, 'total N of fish w/o key', TOTAL(length_key_check_angl)
            paramset[212, i] = TOTAL(length_key_check_angl)
            PRINT, 'size bins w/o key', length_key_check_angl

            AgeLengthKeyCheck_angl1 = (TOTAL(length_key_check_angl)/N_ELEMENTS(Length_prod_angl))
            PRINT, 'AgeLengthKeyCheck_angl1', AgeLengthKeyCheck_angl1

            IF AgeLengthKeyCheck_angl1 LT AgeLengthKeyLevel THEN BEGIN

                ; 1.Assign age semi-randomly to lengths - all fish
                IF SizeLT100_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 0
                  LengthBinIndex2 = SizeLT100_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl2, LengthBinIndex1)
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size100to120_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 1
                  LengthBinIndex2 = Size100to120_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl2, LengthBinIndex1)
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size120to140_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 2
                  LengthBinIndex2 = Size120to140_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl2, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size140to160_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 3
                  LengthBinIndex2 = Size140to160_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl2, LengthBinIndex1)
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size160to180_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 4
                  LengthBinIndex2 = Size160to180_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl2, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size180to200_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 5
                  LengthBinIndex2 = Size180to200_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl2, LengthBinIndex1)
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size200to220_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 6
                  LengthBinIndex2 = Size200to220_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl2, LengthBinIndex1)
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size220to240_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 7
                  LengthBinIndex2 = Size220to240_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl2, LengthBinIndex1)
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size240to260_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 8
                  LengthBinIndex2 = Size240to260_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl2, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size260to280_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 9
                  LengthBinIndex2 = Size260to280_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl2, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size280to300_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 10
                  LengthBinIndex2 = Size280to300_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl2, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size300to320_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 11
                  LengthBinIndex2 = Size300to320_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl2, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size320to340_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 12
                  LengthBinIndex2 = Size320to340_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl2, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size340to360_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 13
                  LengthBinIndex2 = Size340to360_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl2, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size360to380_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 14
                  LengthBinIndex2 = Size360to380_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl2, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size380to400_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 15
                  LengthBinIndex2 = Size380to400_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl2, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size400to420_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 16
                  LengthBinIndex2 = Size400to420_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl2, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size420to440_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 17
                  LengthBinIndex2 = Size420to440_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl2, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size440to460_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 18
                  LengthBinIndex2 = Size440to460_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl2, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size460to480_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 19
                  LengthBinIndex2 = Size460to480_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl2, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size480to500_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 20
                  LengthBinIndex2 = Size480to500_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl2, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size500to520_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 21
                  LengthBinIndex2 = Size500to520_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl2, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size520to540_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 22
                  LengthBinIndex2 = Size520to540_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl2, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size540to560_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 23
                  LengthBinIndex2 = Size540to560_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl2, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size560to580_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 24
                  LengthBinIndex2 = Size560to580_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl2, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
    
                IF Size580to600_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 25
                  LengthBinIndex2 = Size580to600_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl2, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size600to620_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 26
                  LengthBinIndex2 = Size600to620_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl2, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size620to640_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 27
                  LengthBinIndex2 = Size620to640_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl2, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size640to660_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 28
                  LengthBinIndex2 = Size640to660_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl2, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size660to680_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 29
                  LengthBinIndex2 = Size660to680_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl2, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size680to700_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 30
                  LengthBinIndex2 = Size680to700_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl2, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size700to720_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 31
                  LengthBinIndex2 = Size700to720_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl2, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size720to740_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 32
                  LengthBinIndex2 = Size720to740_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl2, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size740to760_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 33
                  LengthBinIndex2 = Size740to760_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl2, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size760to780_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 34
                  LengthBinIndex2 = Size760to780_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl2, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size780to800_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 35
                  LengthBinIndex2 = Size780to800_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl2, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Sizege800_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 36
                  LengthBinIndex2 = SizeGE800_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl2, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                
                PRINT, "Age of fish harvested by anglers (FishAgeAngl)", FishAgeAngl
                PRINT, "Length of fish harvested by anglers (FishLengthAngl)", FishLengthAngl

                ; mean age (all fish)
                AgeAnglAll = WHERE(FishAgeAngl GE 0, AgeAnglAllCOUNT)
                IF AgeAnglAllCOUNT GT 0 THEN BEGIN
                  paramset_angl[220, i] = MEAN(FishAgeAngl[AgeAnglAll]); mean age for all fish
                  paramset_angl[221, i] = STDDEV(FishAgeAngl[AgeAnglAll]); SD age for all fish
                ENDIF
    
                ; Age structure of harvested fish (angling)
                Total_N_ageclass_angl = FLTARR(27L, 2L)
                Total_N_ageclass_angl[0, 0] = TOTAL(WAE_length_bin_angl[10, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 0
                Total_N_ageclass_angl[1, 0] = TOTAL(WAE_length_bin_angl[11, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 1
                Total_N_ageclass_angl[2, 0] = TOTAL(WAE_length_bin_angl[12, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 2
                Total_N_ageclass_angl[3, 0] = TOTAL(WAE_length_bin_angl[13, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 3
                Total_N_ageclass_angl[4, 0] = TOTAL(WAE_length_bin_angl[14, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 4
                Total_N_ageclass_angl[5, 0] = TOTAL(WAE_length_bin_angl[15, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 5
                Total_N_ageclass_angl[6, 0] = TOTAL(WAE_length_bin_angl[16, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 6
                Total_N_ageclass_angl[7, 0] = TOTAL(WAE_length_bin_angl[17, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 7
                Total_N_ageclass_angl[8, 0] = TOTAL(WAE_length_bin_angl[18, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 8
                Total_N_ageclass_angl[9, 0] = TOTAL(WAE_length_bin_angl[19, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 9
                Total_N_ageclass_angl[10, 0] = TOTAL(WAE_length_bin_angl[20, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 10
                Total_N_ageclass_angl[11, 0] = TOTAL(WAE_length_bin_angl[21, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 11
                Total_N_ageclass_angl[12, 0] = TOTAL(WAE_length_bin_angl[22, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 12
                Total_N_ageclass_angl[13, 0] = TOTAL(WAE_length_bin_angl[23, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 13
                Total_N_ageclass_angl[14, 0] = TOTAL(WAE_length_bin_angl[24, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 14
                Total_N_ageclass_angl[15, 0] = TOTAL(WAE_length_bin_angl[25, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 15
                Total_N_ageclass_angl[16, 0] = TOTAL(WAE_length_bin_angl[26, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 16
                Total_N_ageclass_angl[17, 0] = TOTAL(WAE_length_bin_angl[27, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 17
                Total_N_ageclass_angl[18, 0] = TOTAL(WAE_length_bin_angl[28, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 18
                Total_N_ageclass_angl[19, 0] = TOTAL(WAE_length_bin_angl[29, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 19
                Total_N_ageclass_angl[20, 0] = TOTAL(WAE_length_bin_angl[30, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 20
                Total_N_ageclass_angl[21, 0] = TOTAL(WAE_length_bin_angl[31, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 21
                Total_N_ageclass_angl[22, 0] = TOTAL(WAE_length_bin_angl[32, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 22
                Total_N_ageclass_angl[23, 0] = TOTAL(WAE_length_bin_angl[33, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 23
                Total_N_ageclass_angl[24, 0] = TOTAL(WAE_length_bin_angl[34, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 24
                Total_N_ageclass_angl[25, 0] = TOTAL(WAE_length_bin_angl[35, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 25
                Total_N_ageclass_angl[26, 0] = TOTAL(WAE_length_bin_angl[36, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 26
                PRINT, 'Derived age distribution of harvested fish'
                PRINT, Total_N_ageclass_angl[*, 0]
                PRINT, 'Total number of harvested fish samples', TOTAL(Total_N_ageclass_angl[*, 0])
    
                ; Estimate age structure of harvested fish
                ; calcualte relative age distribution 
                Total_prop_ageclass_angl = FLTARR(27L, 2L)
                IF TOTAL(Total_N_ageclass_angl[*, 0]) GT 0 THEN Total_prop_ageclass_angl[*, 0] $
                               = Total_N_ageclass_angl[*, 0]/TOTAL(Total_N_ageclass_angl[*, 0])
                PRINT, 'Relative age distribution (angling)'
                PRINT, Total_prop_ageclass_angl[*, 0]
                PRINT, 'Total N of harvested fish (angling)', N_harv_angl[INDEX_lengthdataAngl[0]] $
                  , HarvRate_angl[INDEX_lengthdataAngl[0]] * adultPE_angl[INDEX_lengthdataAngl[0]]
                IF TOTAL(Total_N_ageclass_angl[*, 0]) GT 0 THEN paramset_angl[13:39, i] $
                        = ROUND(Total_prop_ageclass_angl[*, 0] * HarvRate_angl[INDEX_lengthdataAngl[0]] * adultPE_angl[INDEX_lengthdataAngl[0]])
                PRINT, 'Estimated age distribution of harvested fish'
                PRINT, paramset_angl[13:39, i]
    
                ; Calculate mean length-at-age for harvested fish
                mean_length_at_age_angl = FLTARR(27L, 37L)
                mean_length_at_age_angl[0, *] = (WAE_length_mean_angl[10, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
                mean_length_at_age_angl[1, *] = (WAE_length_mean_angl[11, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
                mean_length_at_age_angl[2, *] = (WAE_length_mean_angl[12, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
                mean_length_at_age_angl[3, *] = (WAE_length_mean_angl[13, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
                mean_length_at_age_angl[4, *] = (WAE_length_mean_angl[14, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
                mean_length_at_age_angl[5, *] = (WAE_length_mean_angl[15, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
                mean_length_at_age_angl[6, *] = (WAE_length_mean_angl[16, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
                mean_length_at_age_angl[7, *] = (WAE_length_mean_angl[17, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
                mean_length_at_age_angl[8, *] = (WAE_length_mean_angl[18, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
                mean_length_at_age_angl[9, *] = (WAE_length_mean_angl[19, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
                mean_length_at_age_angl[10, *] = (WAE_length_mean_angl[20, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
                mean_length_at_age_angl[11, *] = (WAE_length_mean_angl[21, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
                mean_length_at_age_angl[12, *] = (WAE_length_mean_angl[22, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
                mean_length_at_age_angl[13, *] = (WAE_length_mean_angl[23, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
                mean_length_at_age_angl[14, *] = (WAE_length_mean_angl[24, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
                mean_length_at_age_angl[15, *] = (WAE_length_mean_angl[25, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
                mean_length_at_age_angl[16, *] = (WAE_length_mean_angl[26, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
                mean_length_at_age_angl[17, *] = (WAE_length_mean_angl[27, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
                mean_length_at_age_angl[18, *] = (WAE_length_mean_angl[28, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
                mean_length_at_age_angl[19, *] = (WAE_length_mean_angl[29, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
                mean_length_at_age_angl[20, *] = (WAE_length_mean_angl[30, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
                mean_length_at_age_angl[21, *] = (WAE_length_mean_angl[31, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
                mean_length_at_age_angl[22, *] = (WAE_length_mean_angl[32, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
                mean_length_at_age_angl[23, *] = (WAE_length_mean_angl[33, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
                mean_length_at_age_angl[24, *] = (WAE_length_mean_angl[34, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
                mean_length_at_age_angl[25, *] = (WAE_length_mean_angl[35, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
                mean_length_at_age_angl[26, *] = (WAE_length_mean_angl[36, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
                age0mean_angl = where(mean_length_at_age_angl[0, *] GT 0, age0mean_anglcount)
                age1mean_angl = where(mean_length_at_age_angl[1, *] GT 0, age1mean_anglcount)
                age2mean_angl = where(mean_length_at_age_angl[2, *] GT 0, age2mean_anglcount)
                age3mean_angl = where(mean_length_at_age_angl[3, *] GT 0, age3mean_anglcount)
                age4mean_angl = where(mean_length_at_age_angl[4, *] GT 0, age4mean_anglcount)
                age5mean_angl = where(mean_length_at_age_angl[5, *] GT 0, age5mean_anglcount)
                age6mean_angl = where(mean_length_at_age_angl[6, *] GT 0, age6mean_anglcount)
                age7mean_angl = where(mean_length_at_age_angl[7, *] GT 0, age7mean_anglcount)
                age8mean_angl = where(mean_length_at_age_angl[8, *] GT 0, age8mean_anglcount)
                age9mean_angl = where(mean_length_at_age_angl[9, *] GT 0, age9mean_anglcount)
                age10mean_angl = where(mean_length_at_age_angl[10, *] GT 0, age10mean_anglcount)
                age11mean_angl = where(mean_length_at_age_angl[11, *] GT 0, age11mean_anglcount)
                age12mean_angl = where(mean_length_at_age_angl[12, *] GT 0, age12mean_anglcount)
                age13mean_angl = where(mean_length_at_age_angl[13, *] GT 0, age13mean_anglcount)
                age14mean_angl = where(mean_length_at_age_angl[14, *] GT 0, age14mean_anglcount)
                age15mean_angl = where(mean_length_at_age_angl[15, *] GT 0, age15mean_anglcount)
                age16mean_angl = where(mean_length_at_age_angl[16, *] GT 0, age16mean_anglcount)
                age17mean_angl = where(mean_length_at_age_angl[17, *] GT 0, age17mean_anglcount)
                age18mean_angl = where(mean_length_at_age_angl[18, *] GT 0, age18mean_anglcount)
                age19mean_angl = where(mean_length_at_age_angl[19, *] GT 0, age19mean_anglcount)
                age20mean_angl = where(mean_length_at_age_angl[20, *] GT 0, age20mean_anglcount)
                age21mean_angl = where(mean_length_at_age_angl[21, *] GT 0, age21mean_anglcount)
                age22mean_angl = where(mean_length_at_age_angl[22, *] GT 0, age22mean_anglcount)
                age23mean_angl = where(mean_length_at_age_angl[23, *] GT 0, age23mean_anglcount)
                age24mean_angl = where(mean_length_at_age_angl[24, *] GT 0, age24mean_anglcount)
                age25mean_angl = where(mean_length_at_age_angl[25, *] GT 0, age25mean_anglcount)
                age26mean_angl = where(mean_length_at_age_angl[26, *] GT 0, age26mean_anglcount)
                IF age0mean_anglcount GT 0 THEN Total_N_ageclass_angl[0, 1] = TOTAL(WAE_length_mean_angl[10, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age0mean_anglcount
                IF age1mean_anglcount GT 0 THEN Total_N_ageclass_angl[1, 1] = TOTAL(WAE_length_mean_angl[11, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age1mean_anglcount
                IF age2mean_anglcount GT 0 THEN Total_N_ageclass_angl[2, 1] = TOTAL(WAE_length_mean_angl[12, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age2mean_anglcount
                IF age3mean_anglcount GT 0 THEN Total_N_ageclass_angl[3, 1] = TOTAL(WAE_length_mean_angl[13, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age3mean_anglcount
                IF age4mean_anglcount GT 0 THEN Total_N_ageclass_angl[4, 1] = TOTAL(WAE_length_mean_angl[14, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age4mean_anglcount
                IF age5mean_anglcount GT 0 THEN Total_N_ageclass_angl[5, 1] = TOTAL(WAE_length_mean_angl[15, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age5mean_anglcount
                IF age6mean_anglcount GT 0 THEN Total_N_ageclass_angl[6, 1] = TOTAL(WAE_length_mean_angl[16, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age6mean_anglcount
                IF age7mean_anglcount GT 0 THEN Total_N_ageclass_angl[7, 1] = TOTAL(WAE_length_mean_angl[17, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age7mean_anglcount
                IF age8mean_anglcount GT 0 THEN Total_N_ageclass_angl[8, 1] = TOTAL(WAE_length_mean_angl[18, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age8mean_anglcount
                IF age9mean_anglcount GT 0 THEN Total_N_ageclass_angl[9, 1] = TOTAL(WAE_length_mean_angl[19, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age9mean_anglcount
                IF age10mean_anglcount GT 0 THEN Total_N_ageclass_angl[10, 1] = TOTAL(WAE_length_mean_angl[20, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age10mean_anglcount
                IF age11mean_anglcount GT 0 THEN Total_N_ageclass_angl[11, 1] = TOTAL(WAE_length_mean_angl[21, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age11mean_anglcount
                IF age12mean_anglcount GT 0 THEN Total_N_ageclass_angl[12, 1] = TOTAL(WAE_length_mean_angl[22, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age12mean_anglcount
                IF age13mean_anglcount GT 0 THEN Total_N_ageclass_angl[13, 1] = TOTAL(WAE_length_mean_angl[23, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age13mean_anglcount
                IF age14mean_anglcount GT 0 THEN Total_N_ageclass_angl[14, 1] = TOTAL(WAE_length_mean_angl[24, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age14mean_anglcount
                IF age15mean_anglcount GT 0 THEN Total_N_ageclass_angl[15, 1] = TOTAL(WAE_length_mean_angl[25, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age15mean_anglcount
                IF age16mean_anglcount GT 0 THEN Total_N_ageclass_angl[16, 1] = TOTAL(WAE_length_mean_angl[26, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age16mean_anglcount
                IF age17mean_anglcount GT 0 THEN Total_N_ageclass_angl[17, 1] = TOTAL(WAE_length_mean_angl[27, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age17mean_anglcount
                IF age18mean_anglcount GT 0 THEN Total_N_ageclass_angl[18, 1] = TOTAL(WAE_length_mean_angl[28, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age18mean_anglcount
                IF age19mean_anglcount GT 0 THEN Total_N_ageclass_angl[19, 1] = TOTAL(WAE_length_mean_angl[29, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age19mean_anglcount
                IF age20mean_anglcount GT 0 THEN Total_N_ageclass_angl[20, 1] = TOTAL(WAE_length_mean_angl[30, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age20mean_anglcount
                IF age21mean_anglcount GT 0 THEN Total_N_ageclass_angl[21, 1] = TOTAL(WAE_length_mean_angl[31, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age21mean_anglcount
                IF age22mean_anglcount GT 0 THEN Total_N_ageclass_angl[22, 1] = TOTAL(WAE_length_mean_angl[32, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age22mean_anglcount
                IF age23mean_anglcount GT 0 THEN Total_N_ageclass_angl[23, 1] = TOTAL(WAE_length_mean_angl[33, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age23mean_anglcount
                IF age24mean_anglcount GT 0 THEN Total_N_ageclass_angl[24, 1] = TOTAL(WAE_length_mean_angl[34, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age24mean_anglcount
                IF age25mean_anglcount GT 0 THEN Total_N_ageclass_angl[25, 1] = TOTAL(WAE_length_mean_angl[35, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age25mean_anglcount
                IF age26mean_anglcount GT 0 THEN Total_N_ageclass_angl[26, 1] = TOTAL(WAE_length_mean_angl[36, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age26mean_anglcount
                PRINT, 'Mean length-at-age of harvested fish'
                PRINT, Total_N_ageclass_angl[*, 1]
                paramset_angl[40L:66, i] = Total_N_ageclass_angl[*, 1]
                
                ; convert length to mass (no sex information for creel data)
                Mean_mass_angl = FLTARR(27L, 1)
                Mean_mass_angl = 1.5868E-006*Total_N_ageclass_angl[*, 1]^3.2962
                PRINT, 'Mean mass-at-age of harvested fish'
                PRINT, Mean_mass_angl
                paramset_angl[67L:93, i] = Mean_mass_angl
                Age_NOmass_angl = WHERE(Mean_mass LE 0, Age_NOmass_anglcount)
                Age_Wmass_angl = WHERE(Mean_mass_angl GT 0, Age_Wmass_anglcount)
                IF Age_Wmass_anglcount GT 0. THEN PRINT, 'age class with mass data for harvested fish', Age_Wmass_angl
                IF Age_NOmass_anglcount GT 0. THEN PRINT, 'age class without mass data of harvested fish', Age_NOmass_angl
                PRINT, 'max age class with mass of harvested fish', MAX(Age_Wmass_angl)
                PRINT, 'min age class with mass of harvested fish', MIN(Age_Wmass_angl)
                Age_mass_angl_index = INDGEN(27)
                Age_NOmass_angl_Intrpl = WHERE((Age_NOmass_angl GT min(Age_Wmass_angl)) AND (Age_NOmass_angl LT max(Age_Wmass_angl)), Age_NOmass_angl_Intrplcount)
                IF Age_NOmass_angl_Intrplcount GT 0 THEN PRINT, 'age class mass need interpolation', Age_NOmass_angl[Age_NOmass_angl_Intrpl]
    
                ; calculate age-specific biomass
                Biomass_ageclass_angl = FLTARR(27L, 1)
                Biomass_ageclass_angl = Mean_mass*ROUND(Total_prop_ageclass_angl[*, 0]*HarvRate_angl[INDEX_lengthdataAngl[0]] $
                  * adultPE_angl[INDEX_lengthdataAngl[0]]); growth and mass are the same as the original stocks
                PRINT, 'Biomass-at-age of harvested fish'
                PRINT, Biomass_ageclass_angl
                PRINT, 'Max biomass', MAX(Biomass_ageclass_angl)
                paramset_angl[94L:120, i] = Biomass_ageclass_angl
    
                 ; total adult biomass based on mean mass
                Pos_length_ageclass = WHERE(Total_N_ageclass[3:26, 1] GT 0, Pos_length_ageclassCount)
                Pos_length_ageclass_angl = WHERE(Total_N_ageclass_angl[3:26, 1] GT 0, Pos_length_ageclass_anglCount)
                
                ; biomass
                IF Pos_length_ageclassCount GT 0 THEN paramset_angl[223, i] = adultPE_angl[INDEX_lengthdataAngl[0]] $
                  * MEAN(1.5868E-006*Total_N_ageclass[Pos_length_ageclass, 1]^3.2962) $
                  /LakeArea[INDEX_lengthdata[0]]*1000000./1000.
                
                ; harvested biomass
                ;IF Pos_length_ageclassCount GT 0 THEN paramset_angl[223, i] = HarvRate_angl[INDEX_lengthdataAngl[0]]
                ;  * adultPE_angl[INDEX_lengthdataAngl[0]* MEAN(1.5868E-006*Total_N_ageclass[Pos_length_ageclass, i]^3.2962)
                IF Pos_length_ageclass_anglCount GT 0 THEN paramset_angl[224, i] = HarvRate_angl[INDEX_lengthdataAngl[0]] $
                * adultPE_angl[INDEX_lengthdataAngl[0]] * MEAN(1.5868E-006*Total_N_ageclass_angl[Pos_length_ageclass_angl, 1]^3.2962) $
                /LakeArea[INDEX_lengthdata[0]]*1000000./1000.
                
                ; harvestable biomass (35%)
                IF Pos_length_ageclassCount GT 0 THEN paramset_angl[225, i] = TotAlowCat[INDEX_lengthdataAngl[0]] $
                  * MEAN(1.5868E-006*Total_N_ageclass[Pos_length_ageclass, 1]^3.2962) $ 
                  /LakeArea[INDEX_lengthdata[0]]*1000000./1000.
                 
                ; create age-specific biomass plots
                Biomass_ageclass_anglAll=Biomass_ageclass_angl/1000.
                ;femaleBiomass=Biomass_ageclassF/1000.
                ;unknownBiomass=Biomass_ageclassU/1000.
                !p.font=0
                ;Device, Set_Character_Size=[8,12]
                Device, Get_Decomposed=currentState
                DEVICE, SET_FONT='Courier', /TT_FONT
                DEVICE, DECOMPOSED=0
                cgDisplay, 750, 400, WID=4
                ;!P.Multi = [0,2,1]
                labels = INDGEN(27); ['Exp 1', 'Exp 2', 'Exp 3', 'Exp 4', 'Exp 5']
                cgLoadct, 33, Clip=[10,245]
                cgBarPlot, Biomass_ageclass_anglAll,  YRange=[0,MAX(Biomass_ageclass_anglALL)*1.2], Colors='DARKGRAY', BarNames=labels $
                  , xtitle='Age (years)'$
                  , ytitle='Biomass (Kg)' $;, xrange=[0, 25]
                  , title='Harvested (ANGL) biomass distribution of WI walleye stocks - '+'WBIC: '+STRING(WBIC[INDEX_lengthdata[0]], FORMAT = '(I7)') $
                  +'_Year: '+STRING(fix(SurveyYear[INDEX_lengthdata[0]]), FORMAT = '(I4)')
                ;XYOutS, ROUND(MEDIAN(INDGEN(27))), ROUND(0.5*(MAX(paramset[13:39, i]))*1.3), Orientation=90.0, /DEVICE
                ;cgBarPlot, femaleBiomass, Colors='RED', /Overplot, BaseLines=maleBiomass
                ;cgBarPlot, unknownBiomass, Colors='dark green', /Overplot, BaseLines=maleBiomass+femaleBiomass
                ;items = ['Male', 'Female', 'Unknown']
                ;colors = ['BLUE', 'RED', 'dark green']
                ;AL_Legend, items, Colors=colors, PSym=Replicate(15,3), SymSize=Replicate(1.75,3), $
                ;  Charsize=cgDefCharsize(), Position=[0.75, 0.85], /Normal
    
                ; file name for WBIC-year-specific age structure
                filename='Walleye harveseted (ANGL) biomass'+ STRING(WBIC[INDEX_lengthdata[0]], FORMAT = '(I7)') $
                  +'_'+STRING(fix(SurveyYear[INDEX_lengthdata[0]]), FORMAT = '(I4)')+'.png'
                WRITE_PNG, filename, TVRD(/TRUE)
                DEVICE, DECOMPOSED=old_decomposed
                !p.font=1
    
;                ; calcualte production???    
;                ;Growth_mass = fltarr(27L, 1); ??? USE VALUES FROM TOTAL POPULATIONS????
;                Mean_biomass_angl = FLTARR(27L, 1)
;                Production_angl = FLTARR(27L, 1)
;                ;IF (Mean_mass[3, 0] GT 0) AND (Mean_mass[4, 0] GT 0) THEN Growth_mass[0, 0] = Mean_mass[4, 0] - Mean_mass[3, 0]
;                FOR Agei = 1L, 26L DO BEGIN
;                  IF (Agei GE MIN(Age_Wmass_angl)) AND (Agei LT MAX(Age_Wmass_angl)) THEN BEGIN
;                    ;print, 'agei', agei
;                    IF (Mean_mass_angl[Agei-1L, 0] GT 0.) AND (Mean_mass_angl[Agei, 0] GT 0.) THEN BEGIN
;                      ;Growth_mass[Agei, 0] = ALOG(Mean_mass[Agei, 0]/Mean_mass[Agei-1L, 0])
;                      Mean_biomass_angl[Agei, 0] = MEAN(Biomass_ageclass_angl[Agei-1L:Agei, 0])
;                      Production_angl[Agei, 0] = Growth_mass[Agei, 0] * Mean_biomass_angl[Agei, 0]
;                    ENDIF
;                  ENDIF
;                ENDFOR
;                PRINT, 'Mean growth in mass'
;                PRINT, Growth_mass
;                PRINT, 'Mean biomass (Bhat) of harvested fish'
;                PRINT, Mean_biomass_angl
;                PRINT, 'Harvested production'
;                PRINT, Production_angl
;                paramset_angl[121L:147, i] = Growth_mass
;                paramset_angl[148L:174, i] = Mean_biomass_angl
;                paramset_angl[175L:201, i] = Production_angl
    
    
                ; calculate total biomass
                PRINT, 'Total number of harvested fish (angling)', N_harv_angl[INDEX_lengthdataAngl[0]] $
                  , HarvRate_angl[INDEX_lengthdataAngl[0]] * adultPE_angl[INDEX_lengthdataAngl[0]]
                PRINT, 'Lake area (km2)', LakeArea[INDEX_lengthdata[0]]/1000000.; lake area (km2)
                IF (LakeArea[INDEX_lengthdata[0]] GT 0.) THEN Total_biomass_angl[i] = TOTAL(Biomass_ageclass_angl[*, 0]) / LakeArea[INDEX_lengthdata[0]]*1000000./1000.
                PRINT, 'Total harvested biomass (kg/km2)'
                PRINT, Total_biomass_angl[i]
                paramset_angl[202, i] = Total_biomass_angl[i]
   
;                ; calcualte total production
;                Pos_production_angl = WHERE(Production_angl[*, 0] GT 0., Pos_production_anglcount); negative age-specific production is converted to 0
;                IF (Pos_production_anglcount GT 0.) AND (LakeArea[INDEX_lengthdata[0]] GT 0.) THEN $
;                  Total_production_angl[i] = TOTAL(Production_angl[Pos_production_angl, 0]) $
;                  / LakeArea[INDEX_lengthdata[0]]*1000000./1000.
;                PRINT, 'Total harvested production (kg/km2/year)'
;                PRINT, Total_production_angl[i]
;                paramset_angl[203, i] = Total_production_angl[i]

;                ; calcualte %harvested production (wrong!)
;                IF (Total_production[i] GT 0.) THEN Ecotroph[i] = Total_production_angl[i]/Total_production[i]
;                PRINT, 'Harvested production/total production'
;                PRINT, Ecotroph[i]
;                paramset_angl[208L, i] = Ecotroph[i]
    
;                ; calculate P/B (N/A)
;                Pos_biomass_angl = WHERE(Total_biomass_angl[i] GT 0., Pos_biomass_anglcount); negative age-specific production is converted to 0
;                IF Pos_biomass_anglcount GT 0. THEN P_over_B_angl[i] = Total_production_angl[i] / Total_biomass_angl[i]
;                PRINT, 'Harvested P/B'
;                PRINT, P_over_B_angl[i]
;                paramset_angl[204L, i] = P_over_B_angl[i]
    
                ; Calculate total adult biomass (w/ only >age 3)
                IF (LakeArea[INDEX_lengthdata[0]] GT 0.) THEN Total_biomass_adult_angl[i] $
                  = TOTAL(Biomass_ageclass_angl[3L:26L, 0]) / LakeArea[INDEX_lengthdata[0]]*1000000./1000.
                PRINT, 'Total harvested adult biomass (kg/km2)'
                PRINT, Total_biomass_adult_angl[i]
                paramset_angl[205L, i] = Total_biomass_adult_angl[i]
    
;                ; calculate adult production (wrong!)
;                ;Growth_mass_adult = fltarr(27L, 1)
;                Mean_biomass_adult_angl = fltarr(27L, 1)
;                Production_adult_angl = fltarr(27L, 1)
;                FOR Agei = 1L, 26L DO BEGIN
;                  IF (Agei GE 3L) AND (Agei LT MAX(Age_Wmass_angl)) THEN BEGIN
;                    ;print, 'agei', agei
;                    IF (Mean_mass_angl[Agei-1L, 0] GT 0.) AND (Mean_mass_angl[Agei, 0] GT 0.) THEN BEGIN
;                      ;Growth_mass_adult[Agei, 0] = ALOG(Mean_mass[Agei, 0]/Mean_mass[Agei-1L, 0])
;                      Mean_biomass_adult_angl[Agei, 0] = MEAN(Biomass_ageclass_angl[Agei-1L:Agei, 0])
;                      Production_adult_angl[Agei, 0] = Growth_mass_adult[Agei, 0] * Mean_biomass_adult_angl[Agei, 0]
;                    ENDIF
;                  ENDIF
;                ENDFOR
;                Pos_production_adult_angl = WHERE(Production_adult_angl[*, 0] GT 0., Pos_production_adult_anglcount); ***negative age-specific production is converted to 0
;                PRINT, 'Array index for positive harvested adult production', Pos_production_adult_angl
;                IF (Pos_production_adult_anglcount GT 0.) AND (LakeArea[INDEX_lengthdata[0]] GT 0.)  THEN $
;                  Total_production_adult_angl[i] = TOTAL(Production_adult_angl[Pos_production_adult, 0]) $
;                  / LakeArea[INDEX_lengthdata[0]]*1000000./1000.
;                PRINT, 'Net harvested adult Production (kg/km2/year)'
;                PRINT, Total_production_adult_angl[i]
;                paramset_angl[206L, i] = Total_production_adult_angl[i]
;                
;                ; calculate P/B
;                Pos_biomass_adult_angl = WHERE(Total_biomass_adult_angl[i] GT 0., Pos_biomass_adult_anglcount); negative age-specific production is converted to 0
;                IF Pos_biomass_adult_anglcount GT 0. THEN P_over_B_adult_angl[i] = Total_production_adult_angl[i] / Total_biomass_adult_angl[i]
;                PRINT, 'Harvested adult P/B'
;                PRINT, P_over_B_adult_angl[i]
;                paramset_angl[207L, i] = P_over_B_adult_angl[i]
    
                ;****calculate % harvested production****
                ;IF (Total_production_adult[i] GT 0.) THEN Adult_ecotroph[i] = Total_production_adult_angl[i]/Total_production_adult[i]
                IF (Total_production_adult[i] GT 0.) THEN Adult_ecotroph[i] = Total_biomass_adult_angl[i] $
                  /(Total_production_adult[i]+(Biomass_ageclass[3,0]/1000.)/(LakeArea[INDEX_lengthdata[0]]/1000000.))
                PRINT, 'harvested adult biomass/total adult production'
                PRINT, Adult_ecotroph[i]
                paramset_angl[209L, i] = Adult_ecotroph[i]
                ;IF adultPE_angl[INDEX_lengthdataAngl[0]] GT 0 THEN paramset_angl[210L, i] = N_harv_angl[INDEX_lengthdataAngl[0]]/adultPE_angl[INDEX_lengthdataAngl[0]]
                paramset_angl[210L, i] = HarvRate_angl[INDEX_lengthdataAngl[0]]
 
              ENDIF
             ENDIF; END OF INDEX_lengthdataAnglcount
             IF INDEX_lengthdataAnglcount LE 0 THEN PRINT, 'Harvest data not availabile'
          ENDIF
         ENDIF
        ENDIF; END of WBIC_year key



      ;***calculate biomass and production of walleye stocks w/ lake-specific keys***
      IF (INDEX_lengthdata2count LE 0) OR (AgeLengthKeyCheck1 GE AgeLengthKeyLevel) THEN BEGIN; if there is no lake-year-specific key...
        PRINT, 'Lake-year key not availabile'
        WBIC2 = WBIC[INDEX_lengthdata[0]]
        PRINT, 'WBIC', WBIC[INDEX_lengthdata[0]]

        INDEX_lengthdata2b = WHERE((WBIC_key[*] EQ WBIC2), INDEX_lengthdata2bcount); $
        ;, COMPLEMENT = INDEX_lengthdata2c, NCOMPLEMENT = INDEX_lengthdata2Ccount
        ;    INDEX_YOYdata2b = WHERE((WBIC_year_YOY[*] EQ WBIC[INDEX_lengthdata2b[0]]), INDEX_YOYdata2bcount)
        ;    IF INDEX_YOYdata2bcount GT 0 THEN BEGIN
        ;      YOY_PE[i] = ROUND(Density_YOY[INDEX_YOYdata2b] * LakeArea[INDEX_lengthdata2b[0]])
        ;      print, 'YOY PE', YOY_PE[i]
        ;    ENDIF
        ;    IF INDEX_YOYdata2bcount LE 0 THEN PRINT, 'No YOY data available'

        IF INDEX_lengthdata2bcount GT 0 THEN BEGIN; if lake-specific key exists...
          WBIC_year_key = Length_key2[0, *]
          WBIC_key = Length_key2[1, *]
          sample_year_key = Length_key2[2, *]
          total_N_fish = Length_key2[3, *]
          max_length = Length_key2[4, *]
          min_length = Length_key2[5, *]
          max_age = Length_key2[6, *]
          min_age = Length_key2[7, *]
          Length_bin_low = Length_key2[8, *]
          Length_N_fish = Length_key2[9, *]
          prop_age0 = Length_key2[10, *]
          prop_age1 = Length_key2[11, *]
          prop_age2 = Length_key2[12, *]
          prop_age3 = Length_key2[13, *]
          prop_age4 = Length_key2[14, *]
          prop_age5 = Length_key2[15, *]
          prop_age6 = Length_key2[16, *]
          prop_age7 = Length_key2[17, *]
          prop_age8 = Length_key2[18, *]
          prop_age9 = Length_key2[19, *]
          prop_age10 = Length_key2[20, *]
          prop_age11 = Length_key2[21, *]
          prop_age12 = Length_key2[22, *]
          prop_age13 = Length_key2[23, *]
          prop_age14 = Length_key2[24, *]
          prop_age15 = Length_key2[25, *]
          prop_age16 = Length_key2[26, *]
          prop_age17 = Length_key2[27, *]
          prop_age18 = Length_key2[28, *]
          prop_age19 = Length_key2[29, *]
          prop_age20 = Length_key2[30, *]
          prop_age21 = Length_key2[31, *]
          prop_age22 = Length_key2[32, *]
          prop_age23 = Length_key2[33, *]
          prop_age24 = Length_key2[34, *]
          prop_age25 = Length_key2[35, *]
          prop_age26 = Length_key2[36, *]

          Length_N_fishM = Length_key2[37, *]
          prop_age0M = Length_key2[38, *]
          prop_age1M = Length_key2[39, *]
          prop_age2M = Length_key2[40, *]
          prop_age3M = Length_key2[41, *]
          prop_age4M = Length_key2[42, *]
          prop_age5M = Length_key2[43, *]
          prop_age6M = Length_key2[44, *]
          prop_age7M = Length_key2[45, *]
          prop_age8M = Length_key2[46, *]
          prop_age9M = Length_key2[47, *]
          prop_age10M = Length_key2[48, *]
          prop_age11M = Length_key2[49, *]
          prop_age12M = Length_key2[50, *]
          prop_age13M = Length_key2[51, *]
          prop_age14M = Length_key2[52, *]
          prop_age15M = Length_key2[53, *]
          prop_age16M = Length_key2[54, *]
          prop_age17M = Length_key2[55, *]
          prop_age18M = Length_key2[56, *]
          prop_age19M = Length_key2[57, *]
          prop_age20M = Length_key2[58, *]
          prop_age21M = Length_key2[59, *]
          prop_age22M = Length_key2[60, *]
          prop_age23M = Length_key2[61, *]
          prop_age24M = Length_key2[62, *]
          prop_age25M = Length_key2[63, *]
          prop_age26M = Length_key2[64, *]

          Length_N_fishF = Length_key2[65, *]
          prop_age0F = Length_key2[66, *]
          prop_age1F = Length_key2[67, *]
          prop_age2F = Length_key2[68, *]
          prop_age3F = Length_key2[69, *]
          prop_age4F = Length_key2[70, *]
          prop_age5F = Length_key2[71, *]
          prop_age6F = Length_key2[72, *]
          prop_age7F = Length_key2[73, *]
          prop_age8F = Length_key2[74, *]
          prop_age9F = Length_key2[75, *]
          prop_age10F = Length_key2[76, *]
          prop_age11F = Length_key2[77, *]
          prop_age12F = Length_key2[78, *]
          prop_age13F = Length_key2[79, *]
          prop_age14F = Length_key2[80, *]
          prop_age15F = Length_key2[81, *]
          prop_age16F = Length_key2[82, *]
          prop_age17F = Length_key2[83, *]
          prop_age18F = Length_key2[84, *]
          prop_age19F = Length_key2[85, *]
          prop_age20F = Length_key2[86, *]
          prop_age21F = Length_key2[87, *]
          prop_age22F = Length_key2[88, *]
          prop_age23F = Length_key2[89, *]
          prop_age24F = Length_key2[90, *]
          prop_age25F = Length_key2[91, *]
          prop_age26F = Length_key2[92, *]
          PRINT, 'WBIC', WBIC[INDEX_lengthdata[0]]

          paramset[211, i] = 2; age-length key type

          INDEX_lengthdata3 = WHERE((WBIC_key[*] EQ WBIC2), INDEX_lengthdata3count)

          IF INDEX_lengthdata3count GT 0 THEN BEGIN; if lake-specific key exists...
            ;IF INDEX_lengthdata2bcount GT 0 THEN BEGIN; if lake-specific key exists...
            PRINT, 'Lake key available'
            PRINT, 'WBIC', WBIC_key[INDEX_lengthdata3[0]]

            ; Check if age-key for all fish exist for size bins with data...
            length_key_check = fltarr(37)
            IF (SizeLT100count GT 0) AND (Length_N_fish[INDEX_lengthdata3[0]] LE 0) THEN length_key_check[0] = SizeLT100count
            IF (Size100to120count GT 0) AND (Length_N_fish[INDEX_lengthdata3[1]] LE 0) THEN length_key_check[1] = Size100to120count
            IF (Size120to140count GT 0) AND (Length_N_fish[INDEX_lengthdata3[2]] LE 0) THEN length_key_check[2] = Size120to140count
            IF (Size140to160count GT 0) AND (Length_N_fish[INDEX_lengthdata3[3]] LE 0) THEN length_key_check[3] = Size140to160count
            IF (Size160to180count GT 0) AND (Length_N_fish[INDEX_lengthdata3[4]] LE 0) THEN length_key_check[4] = Size160to180count
            IF (Size180to200count GT 0) AND (Length_N_fish[INDEX_lengthdata3[5]] LE 0) THEN length_key_check[5] = Size180to200count
            IF (Size200to220count GT 0) AND (Length_N_fish[INDEX_lengthdata3[6]] LE 0) THEN length_key_check[6] = Size200to220count
            IF (Size220to240count GT 0) AND (Length_N_fish[INDEX_lengthdata3[7]] LE 0) THEN length_key_check[7] = Size220to240count
            IF (Size240to260count GT 0) AND (Length_N_fish[INDEX_lengthdata3[8]] LE 0) THEN length_key_check[8] = Size240to260count
            IF (Size260to280count GT 0) AND (Length_N_fish[INDEX_lengthdata3[9]] LE 0) THEN length_key_check[9] = Size260to280count
            IF (Size280to300count GT 0) AND (Length_N_fish[INDEX_lengthdata3[10]] LE 0) THEN length_key_check[10] = Size280to300count
            IF (Size300to320count GT 0) AND (Length_N_fish[INDEX_lengthdata3[11]] LE 0) THEN length_key_check[11] = Size300to320count
            IF (Size320to340count GT 0) AND (Length_N_fish[INDEX_lengthdata3[12]] LE 0) THEN length_key_check[12] = Size320to340count
            IF (Size340to360count GT 0) AND (Length_N_fish[INDEX_lengthdata3[13]] LE 0) THEN length_key_check[13] = Size340to360count
            IF (Size360to380count GT 0) AND (Length_N_fish[INDEX_lengthdata3[14]] LE 0) THEN length_key_check[14] = Size360to380count
            IF (Size380to400count GT 0) AND (Length_N_fish[INDEX_lengthdata3[15]] LE 0) THEN length_key_check[15] = Size380to400count
            IF (Size400to420count GT 0) AND (Length_N_fish[INDEX_lengthdata3[16]] LE 0) THEN length_key_check[16] = Size400to420count
            IF (Size420to440count GT 0) AND (Length_N_fish[INDEX_lengthdata3[17]] LE 0) THEN length_key_check[17] = Size420to440count
            IF (Size440to460count GT 0) AND (Length_N_fish[INDEX_lengthdata3[18]] LE 0) THEN length_key_check[18] = Size440to460count
            IF (Size460to480count GT 0) AND (Length_N_fish[INDEX_lengthdata3[19]] LE 0) THEN length_key_check[19] = Size460to480count
            IF (Size480to500count GT 0) AND (Length_N_fish[INDEX_lengthdata3[20]] LE 0) THEN length_key_check[20] = Size480to500count
            IF (Size500to520count GT 0) AND (Length_N_fish[INDEX_lengthdata3[21]] LE 0) THEN length_key_check[21] = Size500to520count
            IF (Size520to540count GT 0) AND (Length_N_fish[INDEX_lengthdata3[22]] LE 0) THEN length_key_check[22] = Size520to540count
            IF (Size540to560count GT 0) AND (Length_N_fish[INDEX_lengthdata3[23]] LE 0) THEN length_key_check[23] = Size540to560count
            IF (Size560to580count GT 0) AND (Length_N_fish[INDEX_lengthdata3[24]] LE 0) THEN length_key_check[24] = Size560to580count
            IF (Size580to600count GT 0) AND (Length_N_fish[INDEX_lengthdata3[25]] LE 0) THEN length_key_check[25] = Size580to600count
            IF (Size600to620count GT 0) AND (Length_N_fish[INDEX_lengthdata3[26]] LE 0) THEN length_key_check[26] = Size600to620count
            IF (Size620to640count GT 0) AND (Length_N_fish[INDEX_lengthdata3[27]] LE 0) THEN length_key_check[27] = Size620to640count
            IF (Size640to660count GT 0) AND (Length_N_fish[INDEX_lengthdata3[28]] LE 0) THEN length_key_check[28] = Size640to660count
            IF (Size660to680count GT 0) AND (Length_N_fish[INDEX_lengthdata3[29]] LE 0) THEN length_key_check[29] = Size660to680count
            IF (Size680to700count GT 0) AND (Length_N_fish[INDEX_lengthdata3[30]] LE 0) THEN length_key_check[30] = Size680to700count
            IF (Size700to720count GT 0) AND (Length_N_fish[INDEX_lengthdata3[31]] LE 0) THEN length_key_check[31] = Size700to720count
            IF (Size720to740count GT 0) AND (Length_N_fish[INDEX_lengthdata3[32]] LE 0) THEN length_key_check[32] = Size720to740count
            IF (Size740to760count GT 0) AND (Length_N_fish[INDEX_lengthdata3[33]] LE 0) THEN length_key_check[33] = Size740to760count
            IF (Size760to780count GT 0) AND (Length_N_fish[INDEX_lengthdata3[34]] LE 0) THEN length_key_check[34] = Size760to780count
            IF (Size780to800count GT 0) AND (Length_N_fish[INDEX_lengthdata3[35]] LE 0) THEN length_key_check[35] = Size780to800count
            IF (SizeGE800count GT 0) AND (Length_N_fish[INDEX_lengthdata3[36]] LE 0) THEN length_key_check[36] = SizeGE800count
            PRINT, 'total N of fish w/o key', TOTAL(length_key_check)
            paramset[212, i] = TOTAL(length_key_check)
            PRINT, 'size bins w/o key', length_key_check

            AgeLengthKeyCheck2 = (TOTAL(length_key_check)/N_ELEMENTS(Length_prod))

            IF AgeLengthKeyCheck2 LT AgeLengthKeyLevel THEN BEGIN

              N_Lake_Wkeys = N_Lake_Wkeys + 1L
              PRINT, 'N of lakes with key', N_Lake_Wkeys

              ;        ; if age-length key does not exist - males
              ;        IF (SizeLT100Mcount GT 0) AND (Length_N_fishM[INDEX_lengthdata3[0]] LE 0) THEN $
              ;          Length_key2[38L:64L, INDEX_lengthdata3[0]] = Length_key2[10L:36L, INDEX_lengthdata3[0]]
              ;        IF (Size100to120Mcount GT 0) AND (Length_N_fishM[INDEX_lengthdata3[1]] LE 0) THEN $
              ;          Length_key2[38L:64L, INDEX_lengthdata3[1]] = Length_key2[10L:36L, INDEX_lengthdata3[1]]
              ;        IF (Size120to140Mcount GT 0) AND (Length_N_fishM[INDEX_lengthdata3[2]] LE 0) THEN $
              ;          Length_key2[38L:64L, INDEX_lengthdata3[2]] = Length_key2[10L:36L, INDEX_lengthdata3[2]]
              ;        IF (Size140to160Mcount GT 0) AND (Length_N_fishM[INDEX_lengthdata3[3]] LE 0) THEN $
              ;          Length_key2[38L:64L, INDEX_lengthdata3[3]] = Length_key2[10L:36L, INDEX_lengthdata3[3]]
              ;        IF (Size160to180Mcount GT 0) AND (Length_N_fishM[INDEX_lengthdata3[4]] LE 0) THEN $
              ;          Length_key2[38L:64L, INDEX_lengthdata3[4]] = Length_key2[10L:36L, INDEX_lengthdata3[4]]
              ;        IF (Size180to200Mcount GT 0) AND (Length_N_fishM[INDEX_lengthdata3[5]] LE 0) THEN $
              ;          Length_key2[38L:64L, INDEX_lengthdata3[5]] = Length_key2[10L:36L, INDEX_lengthdata3[5]]
              ;        IF (Size200to220Mcount GT 0) AND (Length_N_fishM[INDEX_lengthdata3[6]] LE 0) THEN $
              ;          Length_key2[38L:64L, INDEX_lengthdata3[6]] = Length_key2[10L:36L, INDEX_lengthdata3[6]]
              ;        IF (Size220to240Mcount GT 0) AND (Length_N_fishM[INDEX_lengthdata3[7]] LE 0) THEN $
              ;          Length_key2[38L:64L, INDEX_lengthdata3[7]] = Length_key2[10L:36L, INDEX_lengthdata3[7]]
              ;        IF (Size240to260Mcount GT 0) AND (Length_N_fishM[INDEX_lengthdata3[8]] LE 0) THEN $
              ;          Length_key2[38L:64L, INDEX_lengthdata3[8]] = Length_key2[10L:36L, INDEX_lengthdata3[8]]
              ;        IF (Size260to280Mcount GT 0) AND (Length_N_fishM[INDEX_lengthdata3[9]] LE 0) THEN $
              ;          Length_key2[38L:64L, INDEX_lengthdata3[9]] = Length_key2[10L:36L, INDEX_lengthdata3[9]]
              ;        IF (Size280to300Mcount GT 0) AND (Length_N_fishM[INDEX_lengthdata3[10]] LE 0) THEN $
              ;          Length_key2[38L:64L, INDEX_lengthdata3[10]] = Length_key2[10L:36L, INDEX_lengthdata3[10]]
              ;        IF (Size300to320Mcount GT 0) AND (Length_N_fishM[INDEX_lengthdata3[11]] LE 0) THEN $
              ;          Length_key2[38L:64L, INDEX_lengthdata3[11]] = Length_key2[10L:36L, INDEX_lengthdata3[11]]
              ;        IF (Size320to340Mcount GT 0) AND (Length_N_fishM[INDEX_lengthdata3[12]] LE 0) THEN $
              ;          Length_key2[38L:64L, INDEX_lengthdata3[12]] = Length_key2[10L:36L, INDEX_lengthdata3[12]]
              ;        IF (Size340to360Mcount GT 0) AND (Length_N_fishM[INDEX_lengthdata3[13]] LE 0) THEN $
              ;          Length_key2[38L:64L, INDEX_lengthdata3[13]] = Length_key2[10L:36L, INDEX_lengthdata3[13]]
              ;        IF (Size360to380Mcount GT 0) AND (Length_N_fishM[INDEX_lengthdata3[14]] LE 0) THEN $
              ;          Length_key2[38L:64L, INDEX_lengthdata3[14]] = Length_key2[10L:36L, INDEX_lengthdata3[14]]
              ;        IF (Size380to400Mcount GT 0) AND (Length_N_fishM[INDEX_lengthdata3[15]] LE 0) THEN $
              ;          Length_key2[38L:64L, INDEX_lengthdata3[15]] = Length_key2[10L:36L, INDEX_lengthdata3[15]]
              ;        IF (Size400to420Mcount GT 0) AND (Length_N_fishM[INDEX_lengthdata3[16]] LE 0) THEN $
              ;          Length_key2[38L:64L, INDEX_lengthdata3[16]] = Length_key2[10L:36L, INDEX_lengthdata3[16]]
              ;        IF (Size420to440Mcount GT 0) AND (Length_N_fishM[INDEX_lengthdata3[17]] LE 0) THEN $
              ;          Length_key2[38L:64L, INDEX_lengthdata3[17]] = Length_key2[10L:36L, INDEX_lengthdata3[17]]
              ;        IF (Size440to460Mcount GT 0) AND (Length_N_fishM[INDEX_lengthdata3[18]] LE 0) THEN $
              ;          Length_key2[38L:64L, INDEX_lengthdata3[18]] = Length_key2[10L:36L, INDEX_lengthdata3[18]]
              ;        IF (Size460to480Mcount GT 0) AND (Length_N_fishM[INDEX_lengthdata3[19]] LE 0) THEN $
              ;          Length_key2[38L:64L, INDEX_lengthdata3[19]] = Length_key2[10L:36L, INDEX_lengthdata3[19]]
              ;        IF (Size480to500Mcount GT 0) AND (Length_N_fishM[INDEX_lengthdata3[20]] LE 0) THEN $
              ;          Length_key2[38L:64L, INDEX_lengthdata3[20]] = Length_key2[10L:36L, INDEX_lengthdata3[20]]
              ;        IF (Size500to520Mcount GT 0) AND (Length_N_fishM[INDEX_lengthdata3[21]] LE 0) THEN $
              ;          Length_key2[38L:64L, INDEX_lengthdata3[21]] = Length_key2[10L:36L, INDEX_lengthdata3[21]]
              ;        IF (Size520to540Mcount GT 0) AND (Length_N_fishM[INDEX_lengthdata3[22]] LE 0) THEN $
              ;          Length_key2[38L:64L, INDEX_lengthdata3[22]] = Length_key2[10L:36L, INDEX_lengthdata3[22]]
              ;        IF (Size540to560Mcount GT 0) AND (Length_N_fishM[INDEX_lengthdata3[23]] LE 0) THEN $
              ;          Length_key2[38L:64L, INDEX_lengthdata3[23]] = Length_key2[10L:36L, INDEX_lengthdata3[23]]
              ;        IF (Size560to580Mcount GT 0) AND (Length_N_fishM[INDEX_lengthdata3[24]] LE 0) THEN $
              ;          Length_key2[38L:64L, INDEX_lengthdata3[24]] = Length_key2[10L:36L, INDEX_lengthdata3[24]]
              ;        IF (Size580to600Mcount GT 0) AND (Length_N_fishM[INDEX_lengthdata3[25]] LE 0) THEN $
              ;          Length_key2[38L:64L, INDEX_lengthdata3[25]] = Length_key2[10L:36L, INDEX_lengthdata3[25]]
              ;        IF (Size600to620Mcount GT 0) AND (Length_N_fishM[INDEX_lengthdata3[26]] LE 0) THEN $
              ;          Length_key2[38L:64L, INDEX_lengthdata3[26]] = Length_key2[10L:36L, INDEX_lengthdata3[26]]
              ;        IF (Size620to640Mcount GT 0) AND (Length_N_fishM[INDEX_lengthdata3[27]] LE 0) THEN $
              ;          Length_key2[38L:64L, INDEX_lengthdata3[27]] = Length_key2[10L:36L, INDEX_lengthdata3[27]]
              ;        IF (Size640to660Mcount GT 0) AND (Length_N_fishM[INDEX_lengthdata3[28]] LE 0) THEN $
              ;          Length_key2[38L:64L, INDEX_lengthdata3[28]] = Length_key2[10L:36L, INDEX_lengthdata3[28]]
              ;        IF (Size660to680Mcount GT 0) AND (Length_N_fishM[INDEX_lengthdata3[29]] LE 0) THEN $
              ;          Length_key2[38L:64L, INDEX_lengthdata3[29]] = Length_key2[10L:36L, INDEX_lengthdata3[29]]
              ;        IF (Size680to700Mcount GT 0) AND (Length_N_fishM[INDEX_lengthdata3[30]] LE 0) THEN $
              ;          Length_key2[38L:64L, INDEX_lengthdata3[30]] = Length_key2[10L:36L, INDEX_lengthdata3[30]]
              ;        IF (Size700to720Mcount GT 0) AND (Length_N_fishM[INDEX_lengthdata3[31]] LE 0) THEN $
              ;          Length_key2[38L:64L, INDEX_lengthdata3[31]] = Length_key2[10L:36L, INDEX_lengthdata3[31]]
              ;        IF (Size720to740Mcount GT 0) AND (Length_N_fishM[INDEX_lengthdata3[32]] LE 0) THEN $
              ;          Length_key2[38L:64L, INDEX_lengthdata3[32]] = Length_key2[10L:36L, INDEX_lengthdata3[32]]
              ;        IF (Size740to760Mcount GT 0) AND (Length_N_fishM[INDEX_lengthdata3[33]] LE 0) THEN $
              ;          Length_key2[38L:64L, INDEX_lengthdata3[33]] = Length_key2[10L:36L, INDEX_lengthdata3[33]]
              ;        IF (Size760to780Mcount GT 0) AND (Length_N_fishM[INDEX_lengthdata3[34]] LE 0) THEN $
              ;          Length_key2[38L:64L, INDEX_lengthdata3[34]] = Length_key2[10L:36L, INDEX_lengthdata3[34]]
              ;        IF (Size780to800Mcount GT 0) AND (Length_N_fishM[INDEX_lengthdata3[35]] LE 0) THEN $
              ;          Length_key2[38L:64L, INDEX_lengthdata3[35]] = Length_key2[10L:36L, INDEX_lengthdata3[35]]
              ;        IF (SizeGE800Mcount GT 0) AND (Length_N_fishM[INDEX_lengthdata3[36]] LE 0) THEN $
              ;          Length_key2[38L:64L, INDEX_lengthdata3[36]] = Length_key2[10L:36L, INDEX_lengthdata3[36]]
              ;        prop_age0M[INDEX_lengthdata3] = Length_key2[38, INDEX_lengthdata3]
              ;        prop_age1M[INDEX_lengthdata3] = Length_key2[39, INDEX_lengthdata3]
              ;        prop_age2M[INDEX_lengthdata3] = Length_key2[40, INDEX_lengthdata3]
              ;        prop_age3M[INDEX_lengthdata3] = Length_key2[41, INDEX_lengthdata3]
              ;        prop_age4M[INDEX_lengthdata3] = Length_key2[42, INDEX_lengthdata3]
              ;        prop_age5M[INDEX_lengthdata3] = Length_key2[43, INDEX_lengthdata3]
              ;        prop_age6M[INDEX_lengthdata3] = Length_key2[44, INDEX_lengthdata3]
              ;        prop_age7M[INDEX_lengthdata3] = Length_key2[45, INDEX_lengthdata3]
              ;        prop_age8M[INDEX_lengthdata3] = Length_key2[46, INDEX_lengthdata3]
              ;        prop_age9M[INDEX_lengthdata3] = Length_key2[47, INDEX_lengthdata3]
              ;        prop_age10M[INDEX_lengthdata3] = Length_key2[48, INDEX_lengthdata3]
              ;        prop_age11M[INDEX_lengthdata3] = Length_key2[49, INDEX_lengthdata3]
              ;        prop_age12M[INDEX_lengthdata3] = Length_key2[50, INDEX_lengthdata3]
              ;        prop_age13M[INDEX_lengthdata3] = Length_key2[51, INDEX_lengthdata3]
              ;        prop_age14M[INDEX_lengthdata3] = Length_key2[52, INDEX_lengthdata3]
              ;        prop_age15M[INDEX_lengthdata3] = Length_key2[53, INDEX_lengthdata3]
              ;        prop_age16M[INDEX_lengthdata3] = Length_key2[54, INDEX_lengthdata3]
              ;        prop_age17M[INDEX_lengthdata3] = Length_key2[55, INDEX_lengthdata3]
              ;        prop_age18M[INDEX_lengthdata3] = Length_key2[56, INDEX_lengthdata3]
              ;        prop_age19M[INDEX_lengthdata3] = Length_key2[57, INDEX_lengthdata3]
              ;        prop_age20M[INDEX_lengthdata3] = Length_key2[58, INDEX_lengthdata3]
              ;        prop_age21M[INDEX_lengthdata3] = Length_key2[59, INDEX_lengthdata3]
              ;        prop_age22M[INDEX_lengthdata3] = Length_key2[60, INDEX_lengthdata3]
              ;        prop_age23M[INDEX_lengthdata3] = Length_key2[61, INDEX_lengthdata3]
              ;        prop_age24M[INDEX_lengthdata3] = Length_key2[62, INDEX_lengthdata3]
              ;        prop_age25M[INDEX_lengthdata3] = Length_key2[63, INDEX_lengthdata3]
              ;        prop_age26M[INDEX_lengthdata3] = Length_key2[64, INDEX_lengthdata3]
              ;
              ;        ; if age-length key does not exist - females
              ;        IF (SizeLT100Fcount GT 0) AND (Length_N_fishF[INDEX_lengthdata3[0]] LE 0) THEN $
              ;          Length_key2[66L:92L, INDEX_lengthdata3[0]] = Length_key2[10L:36L, INDEX_lengthdata3[0]]
              ;        IF (Size100to120Fcount GT 0) AND (Length_N_fishF[INDEX_lengthdata3[1]] LE 0) THEN $
              ;          Length_key2[66L:92L, INDEX_lengthdata3[1]] = Length_key2[10L:36L, INDEX_lengthdata3[1]]
              ;        IF (Size120to140Fcount GT 0) AND (Length_N_fishF[INDEX_lengthdata3[2]] LE 0) THEN $
              ;          Length_key2[66L:92L, INDEX_lengthdata3[2]] = Length_key2[10L:36L, INDEX_lengthdata3[2]]
              ;        IF (Size140to160Fcount GT 0) AND (Length_N_fishF[INDEX_lengthdata3[3]] LE 0) THEN $
              ;          Length_key2[66L:92L, INDEX_lengthdata3[3]] = Length_key2[10L:36L, INDEX_lengthdata3[3]]
              ;        IF (Size160to180Fcount GT 0) AND (Length_N_fishF[INDEX_lengthdata3[4]] LE 0) THEN $
              ;          Length_key2[66L:92L, INDEX_lengthdata3[4]] = Length_key2[10L:36L, INDEX_lengthdata3[4]]
              ;        IF (Size180to200Fcount GT 0) AND (Length_N_fishF[INDEX_lengthdata3[5]] LE 0) THEN $
              ;          Length_key2[66L:92L, INDEX_lengthdata3[5]] = Length_key2[10L:36L, INDEX_lengthdata3[5]]
              ;        IF (Size200to220Fcount GT 0) AND (Length_N_fishF[INDEX_lengthdata3[6]] LE 0) THEN $
              ;          Length_key2[66L:92L, INDEX_lengthdata3[6]] = Length_key2[10L:36L, INDEX_lengthdata3[6]]
              ;        IF (Size220to240Fcount GT 0) AND (Length_N_fishF[INDEX_lengthdata3[7]] LE 0) THEN $
              ;          Length_key2[66L:92L, INDEX_lengthdata3[7]] = Length_key2[10L:36L, INDEX_lengthdata3[7]]
              ;        IF (Size240to260Fcount GT 0) AND (Length_N_fishF[INDEX_lengthdata3[8]] LE 0) THEN $
              ;          Length_key2[66L:92L, INDEX_lengthdata3[8]] = Length_key2[10L:36L, INDEX_lengthdata3[8]]
              ;        IF (Size260to280Fcount GT 0) AND (Length_N_fishF[INDEX_lengthdata3[9]] LE 0) THEN $
              ;          Length_key2[66L:92L, INDEX_lengthdata3[9]] = Length_key2[10L:36L, INDEX_lengthdata3[9]]
              ;        IF (Size280to300Fcount GT 0) AND (Length_N_fishF[INDEX_lengthdata3[10]] LE 0) THEN $
              ;          Length_key2[66L:92L, INDEX_lengthdata3[10]] = Length_key2[10L:36L, INDEX_lengthdata3[10]]
              ;        IF (Size300to320Fcount GT 0) AND (Length_N_fishF[INDEX_lengthdata3[11]] LE 0) THEN $
              ;          Length_key2[66L:92L, INDEX_lengthdata3[11]] = Length_key2[10L:36L, INDEX_lengthdata3[11]]
              ;        IF (Size320to340Fcount GT 0) AND (Length_N_fishF[INDEX_lengthdata3[12]] LE 0) THEN $
              ;          Length_key2[66L:92L, INDEX_lengthdata3[12]] = Length_key2[10L:36L, INDEX_lengthdata3[12]]
              ;        IF (Size340to360Fcount GT 0) AND (Length_N_fishF[INDEX_lengthdata3[13]] LE 0) THEN $
              ;          Length_key2[66L:92L, INDEX_lengthdata3[13]] = Length_key2[10L:36L, INDEX_lengthdata3[13]]
              ;        IF (Size360to380Fcount GT 0) AND (Length_N_fishF[INDEX_lengthdata3[14]] LE 0) THEN $
              ;          Length_key2[66L:92L, INDEX_lengthdata3[14]] = Length_key2[10L:36L, INDEX_lengthdata3[14]]
              ;        IF (Size380to400Fcount GT 0) AND (Length_N_fishF[INDEX_lengthdata3[15]] LE 0) THEN $
              ;          Length_key2[66L:92L, INDEX_lengthdata3[15]] = Length_key2[10L:36L, INDEX_lengthdata3[15]]
              ;        IF (Size400to420Fcount GT 0) AND (Length_N_fishF[INDEX_lengthdata3[16]] LE 0) THEN $
              ;          Length_key2[66L:92L, INDEX_lengthdata3[16]] = Length_key2[10L:36L, INDEX_lengthdata3[16]]
              ;        IF (Size420to440Fcount GT 0) AND (Length_N_fishF[INDEX_lengthdata3[17]] LE 0) THEN $
              ;          Length_key2[66L:92L, INDEX_lengthdata3[17]] = Length_key2[10L:36L, INDEX_lengthdata3[17]]
              ;        IF (Size440to460Fcount GT 0) AND (Length_N_fishF[INDEX_lengthdata3[18]] LE 0) THEN $
              ;          Length_key2[66L:92L, INDEX_lengthdata3[18]] = Length_key2[10L:36L, INDEX_lengthdata3[18]]
              ;        IF (Size460to480Fcount GT 0) AND (Length_N_fishF[INDEX_lengthdata3[19]] LE 0) THEN $
              ;          Length_key2[66L:92L, INDEX_lengthdata3[19]] = Length_key2[10L:36L, INDEX_lengthdata3[19]]
              ;        IF (Size480to500Fcount GT 0) AND (Length_N_fishF[INDEX_lengthdata3[20]] LE 0) THEN $
              ;          Length_key2[66L:92L, INDEX_lengthdata3[20]] = Length_key2[10L:36L, INDEX_lengthdata3[20]]
              ;        IF (Size500to520Fcount GT 0) AND (Length_N_fishF[INDEX_lengthdata3[21]] LE 0) THEN $
              ;          Length_key2[66L:92L, INDEX_lengthdata3[21]] = Length_key2[10L:36L, INDEX_lengthdata3[21]]
              ;        IF (Size520to540Fcount GT 0) AND (Length_N_fishF[INDEX_lengthdata3[22]] LE 0) THEN $
              ;          Length_key2[66L:92L, INDEX_lengthdata3[22]] = Length_key2[10L:36L, INDEX_lengthdata3[22]]
              ;        IF (Size540to560Fcount GT 0) AND (Length_N_fishF[INDEX_lengthdata3[23]] LE 0) THEN $
              ;          Length_key2[66L:92L, INDEX_lengthdata3[23]] = Length_key2[10L:36L, INDEX_lengthdata3[23]]
              ;        IF (Size560to580Fcount GT 0) AND (Length_N_fishF[INDEX_lengthdata3[24]] LE 0) THEN $
              ;          Length_key2[66L:92L, INDEX_lengthdata3[24]] = Length_key2[10L:36L, INDEX_lengthdata3[24]]
              ;        IF (Size580to600Fcount GT 0) AND (Length_N_fishF[INDEX_lengthdata3[25]] LE 0) THEN $
              ;          Length_key2[66L:92L, INDEX_lengthdata3[25]] = Length_key2[10L:36L, INDEX_lengthdata3[25]]
              ;        IF (Size600to620Fcount GT 0) AND (Length_N_fishF[INDEX_lengthdata3[26]] LE 0) THEN $
              ;          Length_key2[66L:92L, INDEX_lengthdata3[26]] = Length_key2[10L:36L, INDEX_lengthdata3[26]]
              ;        IF (Size620to640Mcount GT 0) AND (Length_N_fishF[INDEX_lengthdata3[27]] LE 0) THEN $
              ;          Length_key2[66L:92L, INDEX_lengthdata3[27]] = Length_key2[10L:36L, INDEX_lengthdata3[27]]
              ;        IF (Size640to660Fcount GT 0) AND (Length_N_fishF[INDEX_lengthdata3[28]] LE 0) THEN $
              ;          Length_key2[66L:92L, INDEX_lengthdata3[28]] = Length_key2[10L:36L, INDEX_lengthdata3[28]]
              ;        IF (Size660to680Fcount GT 0) AND (Length_N_fishF[INDEX_lengthdata3[29]] LE 0) THEN $
              ;          Length_key2[66L:92L, INDEX_lengthdata3[29]] = Length_key2[10L:36L, INDEX_lengthdata3[29]]
              ;        IF (Size680to700Fcount GT 0) AND (Length_N_fishF[INDEX_lengthdata3[30]] LE 0) THEN $
              ;          Length_key2[66L:92L, INDEX_lengthdata3[30]] = Length_key2[10L:36L, INDEX_lengthdata3[30]]
              ;        IF (Size700to720Fcount GT 0) AND (Length_N_fishF[INDEX_lengthdata3[31]] LE 0) THEN $
              ;          Length_key2[66L:92L, INDEX_lengthdata3[31]] = Length_key2[10L:36L, INDEX_lengthdata3[31]]
              ;        IF (Size720to740Fcount GT 0) AND (Length_N_fishF[INDEX_lengthdata3[32]] LE 0) THEN $
              ;          Length_key2[66L:92L, INDEX_lengthdata3[32]] = Length_key2[10L:36L, INDEX_lengthdata3[32]]
              ;        IF (Size740to760Fcount GT 0) AND (Length_N_fishF[INDEX_lengthdata3[33]] LE 0) THEN $
              ;          Length_key2[66L:92L, INDEX_lengthdata3[33]] = Length_key2[10L:36L, INDEX_lengthdata3[33]]
              ;        IF (Size760to780Fcount GT 0) AND (Length_N_fishF[INDEX_lengthdata3[34]] LE 0) THEN $
              ;          Length_key2[66L:92L, INDEX_lengthdata3[34]] = Length_key2[10L:36L, INDEX_lengthdata3[34]]
              ;        IF (Size780to800Fcount GT 0) AND (Length_N_fishF[INDEX_lengthdata3[35]] LE 0) THEN $
              ;          Length_key2[66L:92L, INDEX_lengthdata3[35]] = Length_key2[10L:36L, INDEX_lengthdata3[35]]
              ;        IF (SizeGE800Fcount GT 0) AND (Length_N_fishF[INDEX_lengthdata3[36]] LE 0) THEN $
              ;          Length_key2[66L:92L, INDEX_lengthdata3[36]] = Length_key2[10L:36L, INDEX_lengthdata3[36]]
              ;        prop_age0F[INDEX_lengthdata3] = Length_key2[66, INDEX_lengthdata3]
              ;        prop_age1F[INDEX_lengthdata3] = Length_key2[67, INDEX_lengthdata3]
              ;        prop_age2F[INDEX_lengthdata3] = Length_key2[68, INDEX_lengthdata3]
              ;        prop_age3F[INDEX_lengthdata3] = Length_key2[69, INDEX_lengthdata3]
              ;        prop_age4F[INDEX_lengthdata3] = Length_key2[70, INDEX_lengthdata3]
              ;        prop_age5F[INDEX_lengthdata3] = Length_key2[71, INDEX_lengthdata3]
              ;        prop_age6F[INDEX_lengthdata3] = Length_key2[72, INDEX_lengthdata3]
              ;        prop_age7F[INDEX_lengthdata3] = Length_key2[73, INDEX_lengthdata3]
              ;        prop_age8F[INDEX_lengthdata3] = Length_key2[74, INDEX_lengthdata3]
              ;        prop_age9F[INDEX_lengthdata3] = Length_key2[75, INDEX_lengthdata3]
              ;        prop_age10F[INDEX_lengthdata3] = Length_key2[76, INDEX_lengthdata3]
              ;        prop_age11F[INDEX_lengthdata3] = Length_key2[77, INDEX_lengthdata3]
              ;        prop_age12F[INDEX_lengthdata3] = Length_key2[78, INDEX_lengthdata3]
              ;        prop_age13F[INDEX_lengthdata3] = Length_key2[79, INDEX_lengthdata3]
              ;        prop_age14F[INDEX_lengthdata3] = Length_key2[80, INDEX_lengthdata3]
              ;        prop_age15F[INDEX_lengthdata3] = Length_key2[81, INDEX_lengthdata3]
              ;        prop_age16F[INDEX_lengthdata3] = Length_key2[82, INDEX_lengthdata3]
              ;        prop_age17F[INDEX_lengthdata3] = Length_key2[83, INDEX_lengthdata3]
              ;        prop_age18F[INDEX_lengthdata3] = Length_key2[84, INDEX_lengthdata3]
              ;        prop_age19F[INDEX_lengthdata3] = Length_key2[85, INDEX_lengthdata3]
              ;        prop_age20F[INDEX_lengthdata3] = Length_key2[86, INDEX_lengthdata3]
              ;        prop_age21F[INDEX_lengthdata3] = Length_key2[87, INDEX_lengthdata3]
              ;        prop_age22F[INDEX_lengthdata3] = Length_key2[88, INDEX_lengthdata3]
              ;        prop_age23F[INDEX_lengthdata3] = Length_key2[89, INDEX_lengthdata3]
              ;        prop_age24F[INDEX_lengthdata3] = Length_key2[90, INDEX_lengthdata3]
              ;        prop_age25F[INDEX_lengthdata3] = Length_key2[91, INDEX_lengthdata3]
              ;        prop_age26F[INDEX_lengthdata3] = Length_key2[92, INDEX_lengthdata3]

              ; 1.Assign age semi-randomly to lengths - all fish
              IF SizeLT100count GT 0 then begin
                LengthBinIndex1 = 0
                LengthBinIndex2 = SizeLT100
                FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                  , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                  , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                  , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                  , prop_age26, INDEX_lengthdata3, LengthBinIndex1)
                AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, $
                  FishProb, FishAge[LengthBinIndex2] $
                  , i+NumLengthBin+adj)
                WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
                WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
                AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2 $
                  , FishProb, FishAge[LengthBinIndex2] $
                  , i+NumLengthBin+adj)
                ;FishAge[LengthBinIndex2]= AgeAssignInd
              ENDIF
              IF Size100to120count GT 0 then begin
                LengthBinIndex1 = 1
                LengthBinIndex2 = Size100to120
                FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                  , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                  , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                  , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                  , prop_age26, INDEX_lengthdata3, LengthBinIndex1)
                AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                  , i+NumLengthBin+adj)
                WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
                WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
                AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                  , i+NumLengthBin+adj)
                ;FishAge[LengthBinIndex2]= AgeAssignInd
              ENDIF
              IF Size120to140count GT 0 then begin
                LengthBinIndex1 = 2
                LengthBinIndex2 = Size120to140
                FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                  , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                  , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                  , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                  , prop_age26, INDEX_lengthdata3, LengthBinIndex1)
                AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                  , i+NumLengthBin+adj)
                WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
                WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
                AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                  , i+NumLengthBin+adj)
                ;FishAge[LengthBinIndex2]= AgeAssignInd
              ENDIF
              IF Size140to160count GT 0 then begin
                LengthBinIndex1 = 3
                LengthBinIndex2 = Size140to160
                FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                  , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                  , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                  , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                  , prop_age26, INDEX_lengthdata3, LengthBinIndex1)
                AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                  , i+NumLengthBin+adj)
                WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
                WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
                AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                  , i+NumLengthBin+adj)
                ;FishAge[LengthBinIndex2]= AgeAssignInd
              ENDIF
              IF Size160to180count GT 0 THEN BEGIN
                LengthBinIndex1 = 4
                LengthBinIndex2 = Size160to180
                FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                  , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                  , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                  , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                  , prop_age26, INDEX_lengthdata3, LengthBinIndex1)
                AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                  , i+NumLengthBin+adj)
                WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
                WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
                AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                  , i+NumLengthBin+adj)
                ;FishAge[LengthBinIndex2]= AgeAssignInd
              ENDIF
              IF Size180to200count GT 0 then begin
                LengthBinIndex1 = 5
                LengthBinIndex2 = Size180to200
                FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                  , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                  , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                  , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                  , prop_age26, INDEX_lengthdata3, LengthBinIndex1)
                AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                  , i+NumLengthBin+adj)
                WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
                WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
                AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                  , i+NumLengthBin+adj)
                ;FishAge[LengthBinIndex2]= AgeAssignInd
              ENDIF
              IF Size200to220count GT 0 then begin
                LengthBinIndex1 = 6
                LengthBinIndex2 = Size200to220
                FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                  , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                  , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                  , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                  , prop_age26, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                  , i+NumLengthBin+adj)
                WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
                WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
                AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                  , i+NumLengthBin+adj)
                ;FishAge[LengthBinIndex2]= AgeAssignInd
              ENDIF
              IF Size220to240count GT 0 then begin
                LengthBinIndex1 = 7
                LengthBinIndex2 = Size220to240
                 FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                  , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                  , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                  , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                  , prop_age26, INDEX_lengthdata3, LengthBinIndex1)
                AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                  , i+NumLengthBin+adj)
                WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
                WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
                AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                  , i+NumLengthBin+adj)
                ;FishAge[LengthBinIndex2]= AgeAssignInd
              ENDIF
              IF Size240to260count GT 0 then begin
                LengthBinIndex1 = 8
                LengthBinIndex2 = Size240to260
                FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                  , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                  , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                  , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                  , prop_age26, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                  , i+NumLengthBin+adj)
                WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
                WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
                AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                  , i+NumLengthBin+adj)
                ;FishAge[LengthBinIndex2]= AgeAssignInd
              ENDIF
              IF Size260to280count GT 0 then begin
                LengthBinIndex1 = 9
                LengthBinIndex2 = Size260to280
                FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                  , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                  , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                  , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                  , prop_age26, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                  , i+NumLengthBin+adj)
                WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
                WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
                AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                  , i+NumLengthBin+adj)
                ;FishAge[LengthBinIndex2]= AgeAssignInd
              ENDIF
              IF Size280to300count GT 0 then begin
                LengthBinIndex1 = 10
                LengthBinIndex2 = Size280to300
                FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                  , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                  , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                  , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                  , prop_age26, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                  , i+NumLengthBin+adj)
                WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
                WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
                AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                  , i+NumLengthBin+adj)
                ;FishAge[LengthBinIndex2]= AgeAssignInd
              ENDIF
              IF Size300to320count GT 0 then begin
                LengthBinIndex1 = 11
                LengthBinIndex2 = Size300to320
                FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                  , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                  , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                  , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                  , prop_age26, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                  , i+NumLengthBin+adj)
                WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
                WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
                AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                  , i+NumLengthBin+adj)
                ;FishAge[LengthBinIndex2]= AgeAssignInd
              ENDIF
              IF Size320to340count GT 0 then begin
                LengthBinIndex1 = 12
                LengthBinIndex2 = Size320to340
                FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                  , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                  , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                  , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                  , prop_age26, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                  , i+NumLengthBin+adj)
                WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
                WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
                AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                  , i+NumLengthBin+adj)
                ;FishAge[LengthBinIndex2]= AgeAssignInd
              ENDIF
              IF Size340to360count GT 0 then begin
                LengthBinIndex1 = 13
                LengthBinIndex2 = Size340to360
                FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                  , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                  , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                  , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                  , prop_age26, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                  , i+NumLengthBin+adj)
                WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
                WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
                AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                  , i+NumLengthBin+adj)
                ;FishAge[LengthBinIndex2]= AgeAssignInd
              ENDIF
              IF Size360to380count GT 0 then begin
                LengthBinIndex1 = 14
                LengthBinIndex2 = Size360to380
                 FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                  , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                  , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                  , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                  , prop_age26, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                  , i+NumLengthBin+adj)
                WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
                WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
                AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                  , i+NumLengthBin+adj)
                ;FishAge[LengthBinIndex2]= AgeAssignInd
              ENDIF
              IF Size380to400count GT 0 then begin
                LengthBinIndex1 = 15
                LengthBinIndex2 = Size380to400
                FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                  , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                  , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                  , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                  , prop_age26, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                  , i+NumLengthBin+adj)
                WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
                WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
                AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                  , i+NumLengthBin+adj)
                ;FishAge[LengthBinIndex2]= AgeAssignInd
              ENDIF
              IF Size400to420count GT 0 then begin
                LengthBinIndex1 = 16
                LengthBinIndex2 = Size400to420
                FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                  , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                  , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                  , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                  , prop_age26, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                  , i+NumLengthBin+adj)
                WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
                WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
                AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                  , i+NumLengthBin+adj)
                ;FishAge[LengthBinIndex2]= AgeAssignInd
              ENDIF
              IF Size420to440count GT 0 then begin
                LengthBinIndex1 = 17
                LengthBinIndex2 = Size420to440
                FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                  , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                  , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                  , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                  , prop_age26, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                  , i+NumLengthBin+adj)
                WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
                WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
                AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                  , i+NumLengthBin+adj)
                ;FishAge[LengthBinIndex2]= AgeAssignInd
              ENDIF
              IF Size440to460count GT 0 then begin
                LengthBinIndex1 = 18
                LengthBinIndex2 = Size440to460
                FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                  , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                  , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                  , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                  , prop_age26, INDEX_lengthdata3, LengthBinIndex1)
                AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                  , i+NumLengthBin+adj)
                WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
                WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
                AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                  , i+NumLengthBin+adj)
                ;FishAge[LengthBinIndex2]= AgeAssignInd
              ENDIF
              IF Size460to480count GT 0 then begin
                LengthBinIndex1 = 19
                LengthBinIndex2 = Size460to480
                 FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                  , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                  , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                  , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                  , prop_age26, INDEX_lengthdata3, LengthBinIndex1)
                AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                  , i+NumLengthBin+adj)
                WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
                WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
                AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                  , i+NumLengthBin+adj)
                ;FishAge[LengthBinIndex2]= AgeAssignInd
              ENDIF
              IF Size480to500count GT 0 then begin
                LengthBinIndex1 = 20
                LengthBinIndex2 = Size480to500
                FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                  , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                  , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                  , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                  , prop_age26, INDEX_lengthdata3, LengthBinIndex1)
                AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                  , i+NumLengthBin+adj)
                WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
                WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
                AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                  , i+NumLengthBin+adj)
                ;FishAge[LengthBinIndex2]= AgeAssignInd
              ENDIF
              IF Size500to520count GT 0 then begin
                LengthBinIndex1 = 21
                LengthBinIndex2 = Size500to520
                FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                  , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                  , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                  , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                  , prop_age26, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                  , i+NumLengthBin+adj)
                WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
                WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
                AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                  , i+NumLengthBin+adj)
                ;FishAge[LengthBinIndex2]= AgeAssignInd
              ENDIF
              IF Size520to540count GT 0 then begin
                LengthBinIndex1 = 22
                LengthBinIndex2 = Size520to540
                FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                  , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                  , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                  , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                  , prop_age26, INDEX_lengthdata3, LengthBinIndex1)
                AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                  , i+NumLengthBin+adj)
                WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
                WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
                AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                  , i+NumLengthBin+adj)
                ;FishAge[LengthBinIndex2]= AgeAssignInd
              ENDIF
              IF Size540to560count GT 0 then begin
                LengthBinIndex1 = 23
                LengthBinIndex2 = Size540to560
                FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                  , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                  , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                  , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                  , prop_age26, INDEX_lengthdata3, LengthBinIndex1)
                AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                  , i+NumLengthBin+adj)
                WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
                WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
                AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                  , i+NumLengthBin+adj)
                ;FishAge[LengthBinIndex2]= AgeAssignInd
              ENDIF
              IF Size560to580count GT 0 then begin
                LengthBinIndex1 = 24
                LengthBinIndex2 = Size560to580
                FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                  , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                  , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                  , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                  , prop_age26, INDEX_lengthdata3, LengthBinIndex1)
                AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                  , i+NumLengthBin+adj)
                WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
                WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
                AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                  , i+NumLengthBin+adj)
                ;FishAge[LengthBinIndex2]= AgeAssignInd
              ENDIF
              IF Size580to600count GT 0 then begin
                LengthBinIndex1 = 25
                LengthBinIndex2 = Size580to600
                 FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                  , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                  , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                  , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                  , prop_age26, INDEX_lengthdata3, LengthBinIndex1)
                AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                  , i+NumLengthBin+adj)
                WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
                WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
                AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                  , i+NumLengthBin+adj)
                ;FishAge[LengthBinIndex2]= AgeAssignInd
              ENDIF
              IF Size600to620count GT 0 then begin
                LengthBinIndex1 = 26
                LengthBinIndex2 = Size600to620
                FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                  , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                  , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                  , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                  , prop_age26, INDEX_lengthdata3, LengthBinIndex1)
                AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                  , i+NumLengthBin+adj)
                WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
                WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
                AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                  , i+NumLengthBin+adj)
                ;FishAge[LengthBinIndex2]= AgeAssignInd
              ENDIF
              IF Size620to640count GT 0 then begin
                LengthBinIndex1 = 27
                LengthBinIndex2 = Size620to640
                FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                  , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                  , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                  , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                  , prop_age26, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                  , i+NumLengthBin+adj)
                WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
                WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
                AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                  , i+NumLengthBin+adj)
              ENDIF
              IF Size640to660count GT 0 then begin
                LengthBinIndex1 = 28
                LengthBinIndex2 = Size640to660
                FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                  , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                  , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                  , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                  , prop_age26, INDEX_lengthdata3, LengthBinIndex1)
                AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                  , i+NumLengthBin+adj)
                WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
                WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
                AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                  , i+NumLengthBin+adj)
                ;FishAge[LengthBinIndex2]= AgeAssignInd
                ;PRINT, 'FishAgeInd', AgeAssignInd
                ;PRINT, 'FishAge', FishAge[LengthBinIndex2]
              ENDIF
              IF Size660to680count GT 0 then begin
                LengthBinIndex1 = 29
                LengthBinIndex2 = Size660to680
                 FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                  , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                  , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                  , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                  , prop_age26, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                  , i+NumLengthBin+adj)
                WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
                WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
                AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                  , i+NumLengthBin+adj)
                ;FishAge[LengthBinIndex2]= AgeAssignInd
              ENDIF
              IF Size680to700count GT 0 then begin
                LengthBinIndex1 = 30
                LengthBinIndex2 = Size680to700
                 FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                  , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                  , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                  , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                  , prop_age26, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                  , i+NumLengthBin+adj)
                WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
                WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
                AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                  , i+NumLengthBin+adj)
                ;FishAge[LengthBinIndex2]= AgeAssignInd
              ENDIF
              IF Size700to720count GT 0 then begin
                LengthBinIndex1 = 31
                LengthBinIndex2 = Size700to720
                FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                  , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                  , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                  , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                  , prop_age26, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                  , i+NumLengthBin+adj)
                WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
                WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
                AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                  , i+NumLengthBin+adj)
                ;FishAge[LengthBinIndex2]= AgeAssignInd
              ENDIF
              IF Size720to740count GT 0 then begin
                LengthBinIndex1 = 32
                LengthBinIndex2 = Size720to740
                 FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                  , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                  , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                  , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                  , prop_age26, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                  , i+NumLengthBin+adj)
                WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
                WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
                AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                  , i+NumLengthBin+adj)
                ;FishAge[LengthBinIndex2]= AgeAssignInd
              ENDIF
              IF Size740to760count GT 0 then begin
                LengthBinIndex1 = 33
                LengthBinIndex2 = Size740to760
                FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                  , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                  , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                  , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                  , prop_age26, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                  , i+NumLengthBin+adj)
                WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
                WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
                AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                  , i+NumLengthBin+adj)
                ;FishAge[LengthBinIndex2]= AgeAssignInd
              ENDIF
              IF Size760to780count GT 0 then begin
                LengthBinIndex1 = 34
                LengthBinIndex2 = Size760to780
                FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                  , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                  , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                  , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                  , prop_age26, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                  , i+NumLengthBin+adj)
                WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
                WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
                AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                  , i+NumLengthBin+adj)
                ;FishAge[LengthBinIndex2]= AgeAssignInd
              ENDIF
              IF Size780to800count GT 0 then begin
                LengthBinIndex1 = 35
                LengthBinIndex2 = Size780to800
                FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                  , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                  , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                  , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                  , prop_age26, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                  , i+NumLengthBin+adj)
                WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
                WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
                AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                  , i+NumLengthBin+adj)
                ;FishAge[LengthBinIndex2]= AgeAssignInd
              ENDIF
              IF Sizege800count GT 0 then begin
                LengthBinIndex1 = 36
                LengthBinIndex2 = SizeGE800
                 FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                  , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                  , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                  , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                  , prop_age26, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                  , i+NumLengthBin+adj)
                WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
                WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
                AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                  , i+NumLengthBin+adj)
                ;FishAge[LengthBinIndex2]= AgeAssignInd
              ENDIF

              ; 1. Assign age semi-randomly to lengths - MALES
              IF SizeLT100Mcount GT 0 THEN BEGIN
                LengthBinIndex1 = 0
                LengthBinIndex2 = SizeLT100M
                FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
                  , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
                  , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
                  , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
                  , prop_age26M, INDEX_lengthdata3, LengthBinIndex1)
                AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
                  , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
                WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
                ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
                AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
                FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
                FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
              ENDIF
              IF Size100to120Mcount GT 0 THEN BEGIN
                LengthBinIndex1 = 1
                LengthBinIndex2 = Size100to120M
                FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
                  , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
                  , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
                  , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
                  , prop_age26M, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
                  , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
                WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
                ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
                AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
                FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
                FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
              ENDIF
              IF Size120to140Mcount GT 0 THEN BEGIN
                LengthBinIndex1 = 2
                LengthBinIndex2 = Size120to140M
                FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
                  , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
                  , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
                  , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
                  , prop_age26M, INDEX_lengthdata3, LengthBinIndex1)
                AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
                  , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
                WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
                ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
                AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
                FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
                FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
              ENDIF
              IF Size140to160Mcount GT 0 THEN BEGIN
                LengthBinIndex1 = 3
                LengthBinIndex2 = Size140to160M
                FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
                  , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
                  , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
                  , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
                  , prop_age26M, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
                  , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
                WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
                ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
                AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
                FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
                FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
              ENDIF
              IF Size160to180Mcount GT 0 THEN BEGIN
                LengthBinIndex1 = 4
                LengthBinIndex2 = Size160to180M
                FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
                  , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
                  , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
                  , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
                  , prop_age26M, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
                  , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
                WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
                ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
                AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
                FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
                FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
              ENDIF
              IF Size180to200Mcount GT 0 THEN BEGIN
                LengthBinIndex1 = 5
                LengthBinIndex2 = Size180to200M
                FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
                  , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
                  , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
                  , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
                  , prop_age26M, INDEX_lengthdata3, LengthBinIndex1)
                AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
                  , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
                WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
                ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
                AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
                FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
                FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
              ENDIF
              IF Size200to220Mcount GT 0 THEN BEGIN
                LengthBinIndex1 = 6
                LengthBinIndex2 = Size200to220M
                FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
                  , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
                  , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
                  , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
                  , prop_age26M, INDEX_lengthdata3, LengthBinIndex1)
                AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
                  , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
                WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
                ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
                AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
                FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
                FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
              ENDIF
              IF Size220to240Mcount GT 0 THEN BEGIN
                LengthBinIndex1 = 7
                LengthBinIndex2 = Size220to240M
                FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
                  , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
                  , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
                  , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
                  , prop_age26M, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
                  , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
                WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
                ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
                AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
                FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
                FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
              ENDIF
              IF Size240to260Mcount GT 0 THEN BEGIN
                LengthBinIndex1 = 8
                LengthBinIndex2 = Size240to260M
                FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
                  , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
                  , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
                  , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
                  , prop_age26M, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
                  , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
                WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
                ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
                AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
                FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
                FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
              ENDIF
              IF Size260to280Mcount GT 0 THEN BEGIN
                LengthBinIndex1 = 9
                LengthBinIndex2 = Size260to280M
                FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
                  , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
                  , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
                  , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
                  , prop_age26M, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                
                AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
                  , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
                WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
                ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
                AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
                FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
                FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
              ENDIF
              IF Size280to300Mcount GT 0 THEN BEGIN
                LengthBinIndex1 = 10
                LengthBinIndex2 = Size280to300M
                FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
                  , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
                  , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
                  , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
                  , prop_age26M, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                
                AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
                  , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
                WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
                ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
                AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
                FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
                FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
              ENDIF
              IF Size300to320Mcount GT 0 THEN BEGIN
                LengthBinIndex1 = 11
                LengthBinIndex2 = Size300to320M
                FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
                  , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
                  , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
                  , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
                  , prop_age26M, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                
                AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
                  , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
                WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
                ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
                AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
                FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
                FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
              ENDIF
              IF Size320to340Mcount GT 0 THEN BEGIN
                LengthBinIndex1 = 12
                LengthBinIndex2 = Size320to340M
                FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
                  , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
                  , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
                  , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
                  , prop_age26M, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                
                AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
                  , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
                WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
                ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
                AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
                FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
                FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
              ENDIF
              IF Size340to360Mcount GT 0 THEN BEGIN
                LengthBinIndex1 = 13
                LengthBinIndex2 = Size340to360M
                FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
                  , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
                  , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
                  , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
                  , prop_age26M, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                
                AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
                  , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
                WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
                ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
                AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
                FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
                FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
              ENDIF
              IF Size360to380Mcount GT 0 THEN BEGIN
                LengthBinIndex1 = 14
                LengthBinIndex2 = Size360to380M
                 FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
                  , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
                  , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
                  , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
                  , prop_age26M, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                
                AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
                  , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
                WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
                ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
                AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
                FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
                FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
              ENDIF
              IF Size380to400Mcount GT 0 THEN BEGIN
                LengthBinIndex1 = 15
                LengthBinIndex2 = Size380to400M
                FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
                  , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
                  , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
                  , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
                  , prop_age26M, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
                  , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
                WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
                ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
                AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
                FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
                FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
              ENDIF
              IF Size400to420Mcount GT 0 THEN BEGIN
                LengthBinIndex1 = 16
                LengthBinIndex2 = Size400to420M
                FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
                  , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
                  , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
                  , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
                  , prop_age26M, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
                  , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
                WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
                ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
                AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
                FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
                FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
              ENDIF
              IF Size420to440Mcount GT 0 THEN BEGIN
                LengthBinIndex1 = 17
                LengthBinIndex2 = Size420to440M
                FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
                  , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
                  , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
                  , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
                  , prop_age26M, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
                  , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
                WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
                ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
                AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
                FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
                FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
              ENDIF
              IF Size440to460Mcount GT 0 THEN BEGIN
                LengthBinIndex1 = 18
                LengthBinIndex2 = Size440to460M
                FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
                  , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
                  , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
                  , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
                  , prop_age26M, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
                  , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
                WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
                ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
                AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
                FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
                FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
              ENDIF
              IF Size460to480Mcount GT 0 THEN BEGIN
                LengthBinIndex1 = 19
                LengthBinIndex2 = Size460to480M
                FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
                  , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
                  , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
                  , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
                  , prop_age26M, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
                  , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
                WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
                ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
                AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
                FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
                FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
              ENDIF
              IF Size480to500Mcount GT 0 THEN BEGIN
                LengthBinIndex1 = 20
                LengthBinIndex2 = Size480to500M
                FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
                  , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
                  , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
                  , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
                  , prop_age26M, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
                  , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
                WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
                ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
                AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
                FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
                FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
              ENDIF
              IF Size500to520Mcount GT 0 THEN BEGIN
                LengthBinIndex1 = 21
                LengthBinIndex2 = Size500to520M
                FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
                  , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
                  , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
                  , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
                  , prop_age26M, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
                  , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
                WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
                ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
                AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
                FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
                FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
              ENDIF
              IF Size520to540Mcount GT 0 THEN BEGIN
                LengthBinIndex1 = 22
                LengthBinIndex2 = Size520to540M
                 FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
                  , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
                  , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
                  , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
                  , prop_age26M, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                
                AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
                  , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
                WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
                ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
                AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
                FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
                FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
              ENDIF
              IF Size540to560Mcount GT 0 THEN BEGIN
                LengthBinIndex1 = 23
                LengthBinIndex2 = Size540to560M
                FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
                  , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
                  , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
                  , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
                  , prop_age26M, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                
                AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
                  , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
                WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
                ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
                AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
                FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
                FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
              ENDIF
              IF Size560to580Mcount GT 0 THEN BEGIN
                LengthBinIndex1 = 24
                LengthBinIndex2 = Size560to580M
                FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
                  , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
                  , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
                  , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
                  , prop_age26M, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
                  , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
                WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
                ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
                AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
                FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
                FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
              ENDIF
              IF Size580to600Mcount GT 0 THEN BEGIN
                LengthBinIndex1 = 25
                LengthBinIndex2 = Size580to600M
                 FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
                  , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
                  , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
                  , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
                  , prop_age26M, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
                  , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
                WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
                ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
                AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
                FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
                FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
              ENDIF
              IF Size600to620Mcount GT 0 THEN BEGIN
                LengthBinIndex1 = 26
                LengthBinIndex2 = Size600to620M
                FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
                  , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
                  , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
                  , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
                  , prop_age26M, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
                  , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
                WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
                ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
                AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
                FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
                FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
              ENDIF
              IF Size620to640Mcount GT 0 THEN BEGIN
                LengthBinIndex1 = 27
                LengthBinIndex2 = Size620to640M
                FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
                  , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
                  , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
                  , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
                  , prop_age26M, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
                  , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
                WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
                ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
                AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
                FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
                FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
              ENDIF
              IF Size640to660Mcount GT 0 THEN BEGIN
                LengthBinIndex1 = 28
                LengthBinIndex2 = Size640to660M
                FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
                  , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
                  , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
                  , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
                  , prop_age26M, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
                  , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
                WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
                ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
                AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
                FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
                FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
              ENDIF
              IF Size660to680Mcount GT 0 THEN BEGIN
                LengthBinIndex1 = 29
                LengthBinIndex2 = Size660to680M
                FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
                  , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
                  , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
                  , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
                  , prop_age26M, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
                  , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
                WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
                ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
                AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
                FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
                FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
              ENDIF
              IF Size680to700Mcount GT 0 THEN BEGIN
                LengthBinIndex1 = 30
                LengthBinIndex2 = Size680to700M
                 FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
                  , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
                  , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
                  , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
                  , prop_age26M, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                
                AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
                  , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
                WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
                ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
                AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
                FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
                FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
              ENDIF
              IF Size700to720Mcount GT 0 THEN BEGIN
                LengthBinIndex1 = 31
                LengthBinIndex2 = Size700to720M
                FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
                  , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
                  , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
                  , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
                  , prop_age26M, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
                  , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
                WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
                ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
                AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
                FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
                FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
              ENDIF
              IF Size720to740Mcount GT 0 THEN BEGIN
                LengthBinIndex1 = 32
                LengthBinIndex2 = Size720to740M
                 FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
                  , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
                  , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
                  , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
                  , prop_age26M, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                
                AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
                  , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
                WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
                ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
                AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
                FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
                FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
              ENDIF
              IF Size740to760Mcount GT 0 THEN BEGIN
                LengthBinIndex1 = 33
                LengthBinIndex2 = Size740to760M
                 FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
                  , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
                  , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
                  , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
                  , prop_age26M, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                
                AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
                  , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
                WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
                ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
                AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
                FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
                FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
              ENDIF
              IF Size760to780Mcount GT 0 THEN BEGIN
                LengthBinIndex1 = 34
                LengthBinIndex2 = Size760to780M
                 FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
                  , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
                  , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
                  , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
                  , prop_age26M, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                
                AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
                  , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
                WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
                ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
                AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
                FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
                FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
              ENDIF
              IF Size780to800Mcount GT 0 THEN BEGIN
                LengthBinIndex1 = 35
                LengthBinIndex2 = Size780to800M
                FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
                  , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
                  , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
                  , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
                  , prop_age26M, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                
                AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
                  , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
                WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
                ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
                AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
                FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
                FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
              ENDIF
              IF Sizege800Mcount GT 0 THEN BEGIN
                LengthBinIndex1 = 36
                LengthBinIndex2 = SizeGE800M
                FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
                  , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
                  , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
                  , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
                  , prop_age26M, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
                  , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
                WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
                ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
                AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
                FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
                FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
              ENDIF

              ; 1.Assign age semi-randomly to lengths - females
              IF SizeLT100Fcount GT 0 THEN BEGIN
                LengthBinIndex1 = 0
                LengthBinIndex2 = SizeLT100F
                FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
                  , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
                  , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
                  , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
                  , prop_age26F, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
      
                AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
                  , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
                WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
                ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
                AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
                FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
                FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
              ENDIF
              IF Size100to120Fcount GT 0 THEN BEGIN
                LengthBinIndex1 = 1
                LengthBinIndex2 = Size100to120F
                FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
                  , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
                  , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
                  , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
                  , prop_age26F, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb

                AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
                  , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
                WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
                ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
                AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
                FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
                FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
              ENDIF
              IF Size120to140Fcount GT 0 THEN BEGIN
                LengthBinIndex1 = 2
                LengthBinIndex2 = Size120to140F
                FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
                  , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
                  , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
                  , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
                  , prop_age26F, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
                  , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
                WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
                ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
                AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
                FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
                FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
              ENDIF
              IF Size140to160Fcount GT 0 THEN BEGIN
                LengthBinIndex1 = 3
                LengthBinIndex2 = Size140to160F
                 FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
                  , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
                  , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
                  , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
                  , prop_age26F, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
                  , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
                WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
                ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
                AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
                FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
                FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
              ENDIF
              IF Size160to180Fcount GT 0 THEN BEGIN
                LengthBinIndex1 = 4
                LengthBinIndex2 = Size160to180F
                FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
                  , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
                  , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
                  , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
                  , prop_age26F, INDEX_lengthdata3, LengthBinIndex1)
                AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
                  , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
                WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
                ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
                AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
                FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
                FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
              ENDIF
              IF Size180to200Fcount GT 0 THEN BEGIN
                LengthBinIndex1 = 5
                LengthBinIndex2 = Size180to200F
                 FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
                  , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
                  , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
                  , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
                  , prop_age26F, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb               
                
                AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
                  , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
                WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
                ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
                AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
                FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
                FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
              ENDIF
              IF Size200to220Fcount GT 0 THEN BEGIN
                LengthBinIndex1 = 6
                LengthBinIndex2 = Size200to220F
                FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
                  , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
                  , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
                  , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
                  , prop_age26F, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                
                AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
                  , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
                WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
                ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
                AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
                FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
                FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
              ENDIF
              IF Size220to240Fcount GT 0 THEN BEGIN
                LengthBinIndex1 = 7
                LengthBinIndex2 = Size220to240F
                 FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
                  , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
                  , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
                  , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
                  , prop_age26F, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
                  , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
                WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
                ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
                AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
                FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
                FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
              ENDIF
              IF Size240to260Fcount GT 0 THEN BEGIN
                LengthBinIndex1 = 8
                LengthBinIndex2 = Size240to260F
                FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
                  , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
                  , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
                  , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
                  , prop_age26F, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
                  , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
                WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
                ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
                AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
                FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
                FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
              ENDIF
              IF Size260to280Fcount GT 0 THEN BEGIN
                LengthBinIndex1 = 9
                LengthBinIndex2 = Size260to280F
                FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
                  , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
                  , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
                  , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
                  , prop_age26F, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                
                AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
                  , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
                WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
                ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
                AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
                FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
                FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
              ENDIF
              IF Size280to300Fcount GT 0 THEN BEGIN
                LengthBinIndex1 = 10
                LengthBinIndex2 = Size280to300F
                FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
                  , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
                  , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
                  , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
                  , prop_age26F, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                
                AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
                  , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
                WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
                ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
                AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
                FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
                FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
              ENDIF
              IF Size300to320Fcount GT 0 THEN BEGIN
                LengthBinIndex1 = 11
                LengthBinIndex2 = Size300to320F
                FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
                  , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
                  , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
                  , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
                  , prop_age26F, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                
                AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
                  , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
                WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
                ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
                AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
                FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
                FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
              ENDIF
              IF Size320to340Fcount GT 0 THEN BEGIN
                LengthBinIndex1 = 12
                LengthBinIndex2 = Size320to340F
                 FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
                  , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
                  , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
                  , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
                  , prop_age26F, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
                  , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
                WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
                ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
                AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
                FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
                FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
              ENDIF
              IF Size340to360Fcount GT 0 THEN BEGIN
                LengthBinIndex1 = 13
                LengthBinIndex2 = Size340to360F
                FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
                  , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
                  , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
                  , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
                  , prop_age26F, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                
                AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
                  , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
                WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
                ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
                AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
                FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
                FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
              ENDIF
              IF Size360to380Fcount GT 0 THEN BEGIN
                LengthBinIndex1 = 14
                LengthBinIndex2 = Size360to380F
                FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
                  , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
                  , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
                  , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
                  , prop_age26F, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
                  , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
                WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
                ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
                AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
                FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
                FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
              ENDIF
              IF Size380to400Fcount GT 0 THEN BEGIN
                LengthBinIndex1 = 15
                LengthBinIndex2 = Size380to400F
                FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
                  , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
                  , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
                  , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
                  , prop_age26F, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                
                AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
                  , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
                WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
                ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
                AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
                FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
                FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
              ENDIF
              IF Size400to420Fcount GT 0 THEN BEGIN
                LengthBinIndex1 = 16
                LengthBinIndex2 = Size400to420F
                 FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
                  , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
                  , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
                  , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
                  , prop_age26F, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                
                AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
                  , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
                WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
                ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
                AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
                FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
                FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
              ENDIF
              IF Size420to440Fcount GT 0 THEN BEGIN
                LengthBinIndex1 = 17
                LengthBinIndex2 = Size420to440F
                FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
                  , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
                  , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
                  , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
                  , prop_age26F, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                
                AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
                  , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
                WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
                ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
                AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
                FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
                FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
              ENDIF
              IF Size440to460Fcount GT 0 THEN BEGIN
                LengthBinIndex1 = 18
                LengthBinIndex2 = Size440to460F
                FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
                  , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
                  , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
                  , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
                  , prop_age26F, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                
                AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
                  , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
                WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
                ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
                AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
                FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
                FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
              ENDIF
              IF Size460to480Fcount GT 0 THEN BEGIN
                LengthBinIndex1 = 19
                LengthBinIndex2 = Size460to480F
                 FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
                  , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
                  , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
                  , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
                  , prop_age26F, INDEX_lengthdata3, LengthBinIndex1)
                AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
                  , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
                WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
                ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
                AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
                FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
                FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
              ENDIF
              IF Size480to500Fcount GT 0 THEN BEGIN
                LengthBinIndex1 = 20
                LengthBinIndex2 = Size480to500F
                FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
                  , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
                  , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
                  , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
                  , prop_age26F, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
                  , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
                WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
                ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
                AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
                FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
                FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
              ENDIF
              IF Size500to520Fcount GT 0 THEN BEGIN
                LengthBinIndex1 = 21
                LengthBinIndex2 = Size500to520F
                FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
                  , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
                  , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
                  , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
                  , prop_age26F, INDEX_lengthdata3, LengthBinIndex1)
                AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
                  , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
                WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
                ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
                AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
                FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
                FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
              ENDIF
              IF Size520to540Fcount GT 0 THEN BEGIN
                LengthBinIndex1 = 22
                LengthBinIndex2 = Size520to540F
                 FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
                  , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
                  , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
                  , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
                  , prop_age26F, INDEX_lengthdata3, LengthBinIndex1)
                AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
                  , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
                WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
                ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
                AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
                FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
                FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
              ENDIF
              IF Size540to560Fcount GT 0 THEN BEGIN
                LengthBinIndex1 = 23
                LengthBinIndex2 = Size540to560F
                FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
                  , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
                  , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
                  , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
                  , prop_age26F, INDEX_lengthdata3, LengthBinIndex1)
                AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
                  , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
                WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
                ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
                AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
                FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
                FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
              ENDIF
              IF Size560to580Fcount GT 0 THEN BEGIN
                LengthBinIndex1 = 24
                LengthBinIndex2 = Size560to580F
                FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
                  , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
                  , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
                  , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
                  , prop_age26F, INDEX_lengthdata3, LengthBinIndex1)
                AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
                  , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
                WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
                ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
                AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
                FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
                FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
              ENDIF
              IF Size580to600Fcount GT 0 THEN BEGIN
                LengthBinIndex1 = 25
                LengthBinIndex2 = Size580to600F
                FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
                  , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
                  , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
                  , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
                  , prop_age26F, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
                  , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
                WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
                ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
                AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
                FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
                FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
              ENDIF
              IF Size600to620Fcount GT 0 THEN BEGIN
                LengthBinIndex1 = 26
                LengthBinIndex2 = Size600to620F
                FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
                  , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
                  , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
                  , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
                  , prop_age26F, INDEX_lengthdata3, LengthBinIndex1)
                AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
                  , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
                WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
                ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
                AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
                FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
                FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
              ENDIF
              IF Size620to640Fcount GT 0 THEN BEGIN
                LengthBinIndex1 = 27
                LengthBinIndex2 = Size620to640F
                FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
                  , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
                  , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
                  , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
                  , prop_age26F, INDEX_lengthdata3, LengthBinIndex1)
                AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
                  , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
                WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
                ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
                AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
                FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
                FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
              ENDIF
              IF Size640to660Fcount GT 0 THEN BEGIN
                LengthBinIndex1 = 28
                LengthBinIndex2 = Size640to660F
                 FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
                  , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
                  , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
                  , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
                  , prop_age26F, INDEX_lengthdata3, LengthBinIndex1)
                AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
                  , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
                WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
                ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
                AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
                FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
                FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
              ENDIF
              IF Size660to680Fcount GT 0 THEN BEGIN
                LengthBinIndex1 = 29
                LengthBinIndex2 = Size660to680F
                 FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
                  , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
                  , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
                  , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
                  , prop_age26F, INDEX_lengthdata3, LengthBinIndex1)
                AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
                  , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
                WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
                ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
                AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
                FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
                FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
              ENDIF
              IF Size680to700Fcount GT 0 THEN BEGIN
                LengthBinIndex1 = 30
                LengthBinIndex2 = Size680to700F
                 FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
                  , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
                  , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
                  , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
                  , prop_age26F, INDEX_lengthdata3, LengthBinIndex1)
                AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
                  , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
                WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
                ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
                AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
                FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
                FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
              ENDIF
              IF Size700to720Fcount GT 0 THEN BEGIN
                LengthBinIndex1 = 31
                LengthBinIndex2 = Size700to720F
                 FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
                  , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
                  , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
                  , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
                  , prop_age26F, INDEX_lengthdata3, LengthBinIndex1)
                AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
                  , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
                WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
                ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
                AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
                FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
                FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
              ENDIF
              IF Size720to740Fcount GT 0 THEN BEGIN
                LengthBinIndex1 = 32
                LengthBinIndex2 = Size720to740F
                 FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
                  , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
                  , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
                  , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
                  , prop_age26F, INDEX_lengthdata3, LengthBinIndex1)
                AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
                  , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
                WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
                ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
                AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
                FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
                FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
              ENDIF
              IF Size740to760Fcount GT 0 THEN BEGIN
                LengthBinIndex1 = 33
                LengthBinIndex2 = Size740to760F
                FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
                  , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
                  , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
                  , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
                  , prop_age26F, INDEX_lengthdata3, LengthBinIndex1)   
                AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
                  , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
                WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
                ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
                AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
                FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
                FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
              ENDIF
              IF Size760to780Fcount GT 0 THEN BEGIN
                LengthBinIndex1 = 34
                LengthBinIndex2 = Size760to780F
                FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
                  , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
                  , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
                  , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
                  , prop_age26F, INDEX_lengthdata3, LengthBinIndex1)
                AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
                  , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
                WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
                ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
                AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
                FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
                FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
              ENDIF
              IF Size780to800Fcount GT 0 THEN BEGIN
                LengthBinIndex1 = 35
                LengthBinIndex2 = Size780to800F
                FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
                  , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
                  , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
                  , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
                  , prop_age26F, INDEX_lengthdata3, LengthBinIndex1)
                AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
                  , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
                WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
                ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
                AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
                FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
                FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
              ENDIF
              IF Sizege800Fcount GT 0 THEN BEGIN
                LengthBinIndex1 = 36
                LengthBinIndex2 = SizeGE800F
                FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
                  , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
                  , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
                  , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
                  , prop_age26F, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
                  , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
                WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
                ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
                AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
                FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
                FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
              ENDIF

              ; 1.Assign age semi-randomly to lengths - UNKNOWNS
              IF SizeLT100Ucount GT 0 THEN BEGIN
                LengthBinIndex1 = 0
                LengthBinIndex2 = SizeLT100U
                FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                  , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                  , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                  , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                  , prop_age26, INDEX_lengthdata3, LengthBinIndex1)
                AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
                  , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
                WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
                ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
                AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
                FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
                FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
              ENDIF
              IF Size100to120Ucount GT 0 THEN BEGIN
                LengthBinIndex1 = 1
                LengthBinIndex2 = Size100to120U
                FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                  , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                  , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                  , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                  , prop_age26, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
                  , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
                WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
                ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
                AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
                FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
                FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
              ENDIF
              IF Size120to140Ucount GT 0 THEN BEGIN
                LengthBinIndex1 = 2
                LengthBinIndex2 = Size120to140U
                FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                  , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                  , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                  , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                  , prop_age26, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
                  , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
                WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
                ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
                AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
                FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
                FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
              ENDIF
              IF Size140to160Ucount GT 0 THEN BEGIN
                LengthBinIndex1 = 3
                LengthBinIndex2 = Size140to160U
                FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                  , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                  , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                  , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                  , prop_age26, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
                  , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
                WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
                ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
                AgeAssignIndu = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
                FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
                FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
              ENDIF
              IF Size160to180Ucount GT 0 THEN BEGIN
                LengthBinIndex1 = 4
                LengthBinIndex2 = Size160to180U
                FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                  , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                  , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                  , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                  , prop_age26, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
                  , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
                WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
                ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
                AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
                FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
                FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
              ENDIF
              IF Size180to200Ucount GT 0 THEN BEGIN
                LengthBinIndex1 = 5
                LengthBinIndex2 = Size180to200U
                 FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                  , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                  , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                  , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                  , prop_age26, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                
                AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
                  , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
                WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
                ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
                AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
                FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
                FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
              ENDIF
              IF Size200to220Ucount GT 0 THEN BEGIN
                LengthBinIndex1 = 6
                LengthBinIndex2 = Size200to220U
                FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                  , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                  , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                  , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                  , prop_age26, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
                  , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
                WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
                ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
                AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
                FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
                FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
              ENDIF
              IF Size220to240Ucount GT 0 THEN BEGIN
                LengthBinIndex1 = 7
                LengthBinIndex2 = Size220to240U
                FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                  , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                  , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                  , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                  , prop_age26, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb

                AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
                  , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
                WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
                ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
                AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
                FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
                FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
              ENDIF
              IF Size240to260Ucount GT 0 THEN BEGIN
                LengthBinIndex1 = 8
                LengthBinIndex2 = Size240to260U
                 FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                  , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                  , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                  , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                  , prop_age26, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                
                AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
                  , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
                WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
                ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
                AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
                FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
                FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
              ENDIF
              IF Size260to280Ucount GT 0 THEN BEGIN
                LengthBinIndex1 = 9
                LengthBinIndex2 = Size260to280U
                FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                  , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                  , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                  , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                  , prop_age26, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
                  , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
                WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
                ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
                AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
                FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
                FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
              ENDIF
              IF Size280to300Ucount GT 0 THEN BEGIN
                LengthBinIndex1 = 10
                LengthBinIndex2 = Size280to300U
                FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                  , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                  , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                  , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                  , prop_age26, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                
                AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
                  , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
                WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
                ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
                AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
                FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
                FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
              ENDIF
              IF Size300to320Ucount GT 0 THEN BEGIN
                LengthBinIndex1 = 11
                LengthBinIndex2 = Size300to320U
                FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                  , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                  , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                  , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                  , prop_age26, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                
                AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
                  , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
                WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
                ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
                AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
                FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
                FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
              ENDIF
              IF Size320to340Ucount GT 0 THEN BEGIN
                LengthBinIndex1 = 12
                LengthBinIndex2 = Size320to340U
                FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                  , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                  , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                  , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                  , prop_age26, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                
                AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
                  , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
                WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
                ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
                AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
                FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
                FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
              ENDIF

              IF Size340to360Ucount GT 0 THEN BEGIN
                LengthBinIndex1 = 13
                LengthBinIndex2 = Size340to360U
                FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                  , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                  , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                  , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                  , prop_age26, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                
                AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
                  , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
                WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
                ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
                AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
                FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
                FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
              ENDIF
              IF Size360to380Ucount GT 0 THEN BEGIN
                LengthBinIndex1 = 14
                LengthBinIndex2 = Size360to380U
                FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                  , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                  , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                  , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                  , prop_age26, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                
                AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
                  , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
                WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
                ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
                AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
                FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
                FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
              ENDIF
              IF Size380to400Ucount GT 0 THEN BEGIN
                LengthBinIndex1 = 15
                LengthBinIndex2 = Size380to400U
                 FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                  , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                  , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                  , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                  , prop_age26, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                
                AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
                  , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
                WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
                ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
                AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
                FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
                FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
              ENDIF
              IF Size400to420Ucount GT 0 THEN BEGIN
                LengthBinIndex1 = 16
                LengthBinIndex2 = Size400to420U
                 FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                  , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                  , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                  , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                  , prop_age26, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                
                AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
                  , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
                WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
                ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
                AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
                FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
                FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
              ENDIF
              IF Size420to440Ucount GT 0 THEN BEGIN
                LengthBinIndex1 = 17
                LengthBinIndex2 = Size420to440U
                 FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                  , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                  , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                  , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                  , prop_age26, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                
                AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
                  , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
                WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
                ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
                AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
                FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
                FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
              ENDIF
              IF Size440to460Ucount GT 0 THEN BEGIN
                LengthBinIndex1 = 18
                LengthBinIndex2 = Size440to460U
                FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                  , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                  , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                  , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                  , prop_age26, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                
                AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
                  , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
                WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
                ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
                AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
                FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
                FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
              ENDIF
              IF Size460to480Ucount GT 0 THEN BEGIN
                LengthBinIndex1 = 19
                LengthBinIndex2 = Size460to480U
                FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                  , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                  , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                  , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                  , prop_age26, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                
                AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
                  , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
                WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
                ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
                AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
                FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
                FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
              ENDIF
              IF Size480to500Ucount GT 0 THEN BEGIN
                LengthBinIndex1 = 20
                LengthBinIndex2 = Size480to500U
                FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                  , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                  , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                  , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                  , prop_age26, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                
                AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
                  , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
                WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
                ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
                AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
                FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
                FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
              ENDIF
              IF Size500to520Ucount GT 0 THEN BEGIN
                LengthBinIndex1 = 21
                LengthBinIndex2 = Size500to520U
                 FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                  , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                  , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                  , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                  , prop_age26, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                
                AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
                  , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
                WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
                ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
                AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
                FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
                FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
              ENDIF
              IF Size520to540Ucount GT 0 THEN BEGIN
                LengthBinIndex1 = 22
                LengthBinIndex2 = Size520to540U
                FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                  , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                  , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                  , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                  , prop_age26, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
                  , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
                WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
                ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
                AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
                FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
                FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
              ENDIF

              IF Size540to560Ucount GT 0 THEN BEGIN
                LengthBinIndex1 = 23
                LengthBinIndex2 = Size540to560U
                 FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                  , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                  , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                  , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                  , prop_age26, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb

                AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
                  , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
                WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
                ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
                AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
                FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
                FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
              ENDIF
              IF Size560to580Ucount GT 0 THEN BEGIN
                LengthBinIndex1 = 24
                LengthBinIndex2 = Size560to580U
                FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                  , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                  , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                  , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                  , prop_age26, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                
                AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
                  , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
                WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
                ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
                AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
                FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
                FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
              ENDIF
              IF Size580to600Ucount GT 0 THEN BEGIN
                LengthBinIndex1 = 25
                LengthBinIndex2 = Size580to600U
                 FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                  , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                  , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                  , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                  , prop_age26, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                
                AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
                  , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
                WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
                ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
                AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
                FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
                FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
              ENDIF
              IF Size600to620Ucount GT 0 THEN BEGIN
                LengthBinIndex1 = 26
                LengthBinIndex2 = Size600to620U
                FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                  , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                  , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                  , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                  , prop_age26, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                
                AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
                  , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
                WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
                ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
                AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
                FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
                FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
              ENDIF
              IF Size620to640Ucount GT 0 THEN BEGIN
                LengthBinIndex1 = 27
                LengthBinIndex2 = Size620to640U
                FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                  , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                  , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                  , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                  , prop_age26, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb                
                
                AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
                  , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
                WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
                ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
                AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
                FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
                FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
              ENDIF
              IF Size640to660Ucount GT 0 THEN BEGIN
                LengthBinIndex1 = 28
                LengthBinIndex2 = Size640to660U
                FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                  , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                  , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                  , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                  , prop_age26, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                
                AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
                  , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
                WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
                ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
                AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
                FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
                FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
              ENDIF
              IF Size660to680Ucount GT 0 THEN BEGIN
                LengthBinIndex1 = 29
                LengthBinIndex2 = Size660to680U
                 FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                  , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                  , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                  , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                  , prop_age26, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                
                AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
                  , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
                WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
                ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
                AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
                FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
                FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
              ENDIF
              IF Size680to700Ucount GT 0 THEN BEGIN
                LengthBinIndex1 = 30
                LengthBinIndex2 = Size680to700U
                 FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                  , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                  , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                  , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                  , prop_age26, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
                  , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
                WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
                ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
                AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
                FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
                FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
              ENDIF
              IF Size700to720Ucount GT 0 THEN BEGIN
                LengthBinIndex1 = 31
                LengthBinIndex2 = Size700to720U
                FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                  , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                  , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                  , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                  , prop_age26, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
                  , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
                WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
                ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
                AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
                FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
                FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
              ENDIF
              IF Size720to740Ucount GT 0 THEN BEGIN
                LengthBinIndex1 = 32
                LengthBinIndex2 = Size720to740U
                FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                  , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                  , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                  , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                  , prop_age26, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
                  , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
                WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
                ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
                AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
                FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
                FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
              ENDIF
              IF Size740to760Ucount GT 0 THEN BEGIN
                LengthBinIndex1 = 33
                LengthBinIndex2 = Size740to760U
                FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                  , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                  , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                  , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                  , prop_age26, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
                  , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
                WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
                ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
                AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
                FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
                FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
              ENDIF
              IF Size760to780Ucount GT 0 THEN BEGIN
                LengthBinIndex1 = 34
                LengthBinIndex2 = Size760to780U
                FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                  , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                  , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                  , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                  , prop_age26, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                
                AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
                  , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
                WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
                ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
                AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
                FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
                FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
              ENDIF
              IF Size780to800Ucount GT 0 THEN BEGIN
                LengthBinIndex1 = 35
                LengthBinIndex2 = Size780to800U
                FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                  , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                  , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                  , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                  , prop_age26, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
                  , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
                WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
                ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
                AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
                FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
                FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
              ENDIF
              IF Sizege800Ucount GT 0 THEN BEGIN
                LengthBinIndex1 = 36
                LengthBinIndex2 = SizeGE800U
                FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                  , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                  , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                  , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                  , prop_age26, INDEX_lengthdata3, LengthBinIndex1)
                ;PRINT, 'FishProb', FishProb
                AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
                  , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
                WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
                ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
                AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
                  , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
                  , i+NumLengthBin+adj)
                ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
                FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
                FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
              ENDIF
              ;PRINT, 'WBIC_year', WBIC_year_key[INDEX_lengthdata3[0]]
              ;PRINT, 'WBIC', WBIC_year_key[INDEX_lengthdata3[0]]

              PRINT, "Age of fish(FishAge)", FishAge
              PRINT, "Length of fish (FishLength)", FishLength
              
              
              Age3plus = WHERE(FishAge GE 3, Age3plusCOUNT)
              IF Age3plusCOUNT GT 0 THEN BEGIN
                paramset[225, i] = MEAN(FishAge[Age3plus]); mean age for all fish
                paramset[226, i] = STDDEV(FishAge[Age3plus]); SD age for all fish
              ENDIF
              Age3Mplus = WHERE(FishAge[male] GE 3, Age3MplusCOUNT)
              IF Age3MplusCOUNT GT 0 THEN BEGIN
                paramset[227, i] = MEAN(FishAge[male[Age3Mplus]]); min age for males
                paramset[228, i] = STDDEV(FishAge[male[Age3Mplus]]); min age for males
              ENDIF
              Age3Fplus = WHERE(FishAge[female] GE 3, Age3FplusCOUNT)
              IF Age3FplusCOUNT GT 0 THEN BEGIN
                paramset[229, i] = MEAN(FishAge[female[Age3Fplus]]); max age for females
                paramset[230, i] = STDDEV(FishAge[female[Age3Fplus]]); min age for females
              ENDIF


          ; Summary estimated age distribution data - SPRING SURVEY
          ; Allocate estimated age data to an array - ALL FISH
          Total_N_ageclass = fltarr(27L, 2L); all
          Total_N_ageclass[0, 0] = TOTAL(WAE_length_bin[10, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 0
          Total_N_ageclass[1, 0] = TOTAL(WAE_length_bin[11, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 1
          Total_N_ageclass[2, 0] = TOTAL(WAE_length_bin[12, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 2
          Total_N_ageclass[3, 0] = TOTAL(WAE_length_bin[13, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 3
          Total_N_ageclass[4, 0] = TOTAL(WAE_length_bin[14, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 4
          Total_N_ageclass[5, 0] = TOTAL(WAE_length_bin[15, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 5
          Total_N_ageclass[6, 0] = TOTAL(WAE_length_bin[16, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 6
          Total_N_ageclass[7, 0] = TOTAL(WAE_length_bin[17, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 7
          Total_N_ageclass[8, 0] = TOTAL(WAE_length_bin[18, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 8
          Total_N_ageclass[9, 0] = TOTAL(WAE_length_bin[19, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 9
          Total_N_ageclass[10, 0] = TOTAL(WAE_length_bin[20, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 10
          Total_N_ageclass[11, 0] = TOTAL(WAE_length_bin[21, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 11
          Total_N_ageclass[12, 0] = TOTAL(WAE_length_bin[22, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 12
          Total_N_ageclass[13, 0] = TOTAL(WAE_length_bin[23, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 13
          Total_N_ageclass[14, 0] = TOTAL(WAE_length_bin[24, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 14
          Total_N_ageclass[15, 0] = TOTAL(WAE_length_bin[25, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 15
          Total_N_ageclass[16, 0] = TOTAL(WAE_length_bin[26, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 16
          Total_N_ageclass[17, 0] = TOTAL(WAE_length_bin[27, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 17
          Total_N_ageclass[18, 0] = TOTAL(WAE_length_bin[28, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 18
          Total_N_ageclass[19, 0] = TOTAL(WAE_length_bin[29, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 19
          Total_N_ageclass[20, 0] = TOTAL(WAE_length_bin[30, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 20
          Total_N_ageclass[21, 0] = TOTAL(WAE_length_bin[31, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 21
          Total_N_ageclass[22, 0] = TOTAL(WAE_length_bin[32, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 22
          Total_N_ageclass[23, 0] = TOTAL(WAE_length_bin[33, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 23
          Total_N_ageclass[24, 0] = TOTAL(WAE_length_bin[34, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 24
          Total_N_ageclass[25, 0] = TOTAL(WAE_length_bin[35, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 25
          Total_N_ageclass[26, 0] = TOTAL(WAE_length_bin[36, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 26
          PRINT, 'Derived age distribution for all fish'
          PRINT, Total_N_ageclass[*, 0]
          PRINT, 'Total number of all fish', TOTAL(Total_N_ageclass[*, 0])

          ; Identify the number of age classes in the data set
          NumAgeClass = WHERE(Total_N_ageclass[*, 0] GT 0, NumAgeClasscount)
          paramset[213, i] = NumAgeClasscount
          PRINT, 'Number of age classes', NumAgeClasscount
          paramset[216, i] = MAX(NumAgeClass)
          PRINT, 'Maximum age classes', MAX(NumAgeClass)

          ; Identify the peak age class (age >3) used for estimating mortality rates with catch curves
          PeakAgeClass = WHERE(Total_N_ageclass[*, 0] EQ MAX(Total_N_ageclass[3:26, 0]), PeakAgeClasscount)
          PRINT, 'Peak age of fully recruited to fishery', PeakAgeClass
          PeakAgeClassLimit = where(PeakAgeClass GE 3, PeakAgeClassLimitcount)
          IF PeakAgeClassLimitcount GT 0 THEN paramset[214, i] = MIN(PeakAgeClass[PeakAgeClassLimit]) $
          ELSE paramset[214, i] = -1
          PRINT, 'Initial age of fully recruited to fishery', PeakAgeClass

          Total_N_ageclass2 = fltarr(27L, 4L); all
          print, 'FishAge[*]', n_elements(FishAge[*])
          print, 'FishAge[*]', (FishAge[*])

          age0Num = where(FishAge[*] EQ 0, age0Numcount)
          age1Num = where(FishAge[*] EQ 1, age1Numcount)
          age2Num = where(FishAge[*] EQ 2, age2Numcount)
          age3Num = where(FishAge[*] EQ 3, age3Numcount)
          age4Num = where(FishAge[*] EQ 4, age4Numcount)
          age5Num = where(FishAge[*] EQ 5, age5Numcount)
          age6Num = where(FishAge[*] EQ 6, age6Numcount)
          age7Num = where(FishAge[*] EQ 7, age7Numcount)
          age8Num = where(FishAge[*] EQ 8, age8Numcount)
          age9Num = where(FishAge[*] EQ 9, age9Numcount)
          age10Num = where(FishAge[*] EQ 10, age10Numcount)
          age11Num = where(FishAge[*] EQ 11, age11Numcount)
          age12Num = where(FishAge[*] EQ 12, age12Numcount)
          age13Num = where(FishAge[*] EQ 13, age13Numcount)
          age14Num = where(FishAge[*] EQ 14, age14Numcount)
          age15Num = where(FishAge[*] EQ 15, age15Numcount)
          age16Num = where(FishAge[*] EQ 16, age16Numcount)
          age17Num = where(FishAge[*] EQ 17, age17Numcount)
          age18Num = where(FishAge[*] EQ 18, age18Numcount)
          age19Num = where(FishAge[*] EQ 19, age19Numcount)
          age20Num = where(FishAge[*] EQ 20, age20Numcount)
          age21Num = where(FishAge[*] EQ 21, age21Numcount)
          age22Num = where(FishAge[*] EQ 22, age22Numcount)
          age23Num = where(FishAge[*] EQ 23, age23Numcount)
          age24Num = where(FishAge[*] EQ 24, age24Numcount)
          age25Num = where(FishAge[*] EQ 25, age25Numcount)
          age26Num = where(FishAge[*] EQ 26, age26Numcount)
          IF age0Numcount GT 0 THEN Total_N_ageclass2[0, 0] = age0Numcount
          IF age1Numcount GT 0 THEN Total_N_ageclass2[1, 0] = age1Numcount
          IF age2Numcount GT 0 THEN Total_N_ageclass2[2, 0] = age2Numcount
          IF age3Numcount GT 0 THEN Total_N_ageclass2[3, 0] = age3Numcount
          IF age4Numcount GT 0 THEN Total_N_ageclass2[4, 0] = age4Numcount
          IF age5Numcount GT 0 THEN Total_N_ageclass2[5, 0] = age5Numcount
          IF age6Numcount GT 0 THEN Total_N_ageclass2[6, 0] = age6Numcount
          IF age7Numcount GT 0 THEN Total_N_ageclass2[7, 0] = age7Numcount
          IF age8Numcount GT 0 THEN Total_N_ageclass2[8, 0] = age8Numcount
          IF age9Numcount GT 0 THEN Total_N_ageclass2[9, 0] = age9Numcount
          IF age10Numcount GT 0 THEN Total_N_ageclass2[10, 0] = age10Numcount
          IF age11Numcount GT 0 THEN Total_N_ageclass2[11, 0] = age11Numcount
          IF age12Numcount GT 0 THEN Total_N_ageclass2[12, 0] = age12Numcount
          IF age13Numcount GT 0 THEN Total_N_ageclass2[13, 0] = age13Numcount
          IF age14Numcount GT 0 THEN Total_N_ageclass2[14, 0] = age14Numcount
          IF age15Numcount GT 0 THEN Total_N_ageclass2[15, 0] = age15Numcount
          IF age16Numcount GT 0 THEN Total_N_ageclass2[16, 0] = age16Numcount
          IF age17Numcount GT 0 THEN Total_N_ageclass2[17, 0] = age17Numcount
          IF age18Numcount GT 0 THEN Total_N_ageclass2[18, 0] = age18Numcount
          IF age19Numcount GT 0 THEN Total_N_ageclass2[19, 0] = age19Numcount
          IF age20Numcount GT 0 THEN Total_N_ageclass2[20, 0] = age20Numcount
          IF age21Numcount GT 0 THEN Total_N_ageclass2[21, 0] = age21Numcount
          IF age22Numcount GT 0 THEN Total_N_ageclass2[22, 0] = age22Numcount
          IF age23Numcount GT 0 THEN Total_N_ageclass2[23, 0] = age23Numcount
          IF age24Numcount GT 0 THEN Total_N_ageclass2[24, 0] = age24Numcount
          IF age25Numcount GT 0 THEN Total_N_ageclass2[25, 0] = age25Numcount
          IF age26Numcount GT 0 THEN Total_N_ageclass2[26, 0] = age26Numcount
          PRINT, 'Derived age distribution for all fish (individual-based)'
          PRINT, Total_N_ageclass2[*, 0]
          PRINT, 'Total number of all fish (INDIVIDUAL-BASED)', total(Total_N_ageclass2[*, 0])

          ; allocate estimated age data to an array - MALES
          Male_N_ageclass = fltarr(27L, 2L); all
          Male_N_ageclass[0, 0] = TOTAL(WAE_length_binM[10, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 0
          Male_N_ageclass[1, 0] = TOTAL(WAE_length_binM[11, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 1
          Male_N_ageclass[2, 0] = TOTAL(WAE_length_binM[12, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 2
          Male_N_ageclass[3, 0] = TOTAL(WAE_length_binM[13, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 3
          Male_N_ageclass[4, 0] = TOTAL(WAE_length_binM[14, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 4
          Male_N_ageclass[5, 0] = TOTAL(WAE_length_binM[15, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 5
          Male_N_ageclass[6, 0] = TOTAL(WAE_length_binM[16, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 6
          Male_N_ageclass[7, 0] = TOTAL(WAE_length_binM[17, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 7
          Male_N_ageclass[8, 0] = TOTAL(WAE_length_binM[18, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 8
          Male_N_ageclass[9, 0] = TOTAL(WAE_length_binM[19, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 9
          Male_N_ageclass[10, 0] = TOTAL(WAE_length_binM[20, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 10
          Male_N_ageclass[11, 0] = TOTAL(WAE_length_binM[21, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 11
          Male_N_ageclass[12, 0] = TOTAL(WAE_length_binM[22, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 12
          Male_N_ageclass[13, 0] = TOTAL(WAE_length_binM[23, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 13
          Male_N_ageclass[14, 0] = TOTAL(WAE_length_binM[24, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 14
          Male_N_ageclass[15, 0] = TOTAL(WAE_length_binM[25, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 15
          Male_N_ageclass[16, 0] = TOTAL(WAE_length_binM[26, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 16
          Male_N_ageclass[17, 0] = TOTAL(WAE_length_binM[27, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 17
          Male_N_ageclass[18, 0] = TOTAL(WAE_length_binM[28, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 18
          Male_N_ageclass[19, 0] = TOTAL(WAE_length_binM[29, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 19
          Male_N_ageclass[20, 0] = TOTAL(WAE_length_binM[30, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 20
          Male_N_ageclass[21, 0] = TOTAL(WAE_length_binM[31, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 21
          Male_N_ageclass[22, 0] = TOTAL(WAE_length_binM[32, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 22
          Male_N_ageclass[23, 0] = TOTAL(WAE_length_binM[33, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 23
          Male_N_ageclass[24, 0] = TOTAL(WAE_length_binM[34, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 24
          Male_N_ageclass[25, 0] = TOTAL(WAE_length_binM[35, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 25
          Male_N_ageclass[26, 0] = TOTAL(WAE_length_binM[36, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 26
          PRINT, 'Derived age distribution for males'
          PRINT, Male_N_ageclass[*, 0]
          PRINT, 'Total number of males', TOTAL(Male_N_ageclass[*, 0])

          age0MNum = where(FishAge[*] EQ 0 AND Sex_prod[*] EQ 0, age0MNumcount)
          age1MNum = where(FishAge[*] EQ 1 AND Sex_prod[*] EQ 0, age1MNumcount)
          age2MNum = where(FishAge[*] EQ 2 AND Sex_prod[*] EQ 0, age2MNumcount)
          age3MNum = where(FishAge[*] EQ 3 AND Sex_prod[*] EQ 0, age3MNumcount)
          age4MNum = where(FishAge[*] EQ 4 AND Sex_prod[*] EQ 0, age4MNumcount)
          age5MNum = where(FishAge[*] EQ 5 AND Sex_prod[*] EQ 0, age5MNumcount)
          age6MNum = where(FishAge[*] EQ 6 AND Sex_prod[*] EQ 0, age6MNumcount)
          age7MNum = where(FishAge[*] EQ 7 AND Sex_prod[*] EQ 0, age7MNumcount)
          age8MNum = where(FishAge[*] EQ 8 AND Sex_prod[*] EQ 0, age8MNumcount)
          age9MNum = where(FishAge[*] EQ 9 AND Sex_prod[*] EQ 0, age9MNumcount)
          age10MNum = where(FishAge[*] EQ 10 AND Sex_prod[*] EQ 0, age10MNumcount)
          age11MNum = where(FishAge[*] EQ 11 AND Sex_prod[*] EQ 0, age11MNumcount)
          age12MNum = where(FishAge[*] EQ 12 AND Sex_prod[*] EQ 0, age12MNumcount)
          age13MNum = where(FishAge[*] EQ 13 AND Sex_prod[*] EQ 0, age13MNumcount)
          age14MNum = where(FishAge[*] EQ 14 AND Sex_prod[*] EQ 0, age14MNumcount)
          age15MNum = where(FishAge[*] EQ 15 AND Sex_prod[*] EQ 0, age15MNumcount)
          age16MNum = where(FishAge[*] EQ 16 AND Sex_prod[*] EQ 0, age16MNumcount)
          age17MNum = where(FishAge[*] EQ 17 AND Sex_prod[*] EQ 0, age17MNumcount)
          age18MNum = where(FishAge[*] EQ 18 AND Sex_prod[*] EQ 0, age18MNumcount)
          age19MNum = where(FishAge[*] EQ 19 AND Sex_prod[*] EQ 0, age19MNumcount)
          age20MNum = where(FishAge[*] EQ 20 AND Sex_prod[*] EQ 0, age20MNumcount)
          age21MNum = where(FishAge[*] EQ 21 AND Sex_prod[*] EQ 0, age21MNumcount)
          age22MNum = where(FishAge[*] EQ 22 AND Sex_prod[*] EQ 0, age22MNumcount)
          age23MNum = where(FishAge[*] EQ 23 AND Sex_prod[*] EQ 0, age23MNumcount)
          age24MNum = where(FishAge[*] EQ 24 AND Sex_prod[*] EQ 0, age24MNumcount)
          age25MNum = where(FishAge[*] EQ 25 AND Sex_prod[*] EQ 0, age25MNumcount)
          age26MNum = where(FishAge[*] EQ 26 AND Sex_prod[*] EQ 0, age26MNumcount)
          IF age0MNumcount GT 0 THEN Total_N_ageclass2[0, 1] = age0MNumcount
          IF age1MNumcount GT 0 THEN Total_N_ageclass2[1, 1] = age1MNumcount
          IF age2MNumcount GT 0 THEN Total_N_ageclass2[2, 1] = age2MNumcount
          IF age3MNumcount GT 0 THEN Total_N_ageclass2[3, 1] = age3MNumcount
          IF age4MNumcount GT 0 THEN Total_N_ageclass2[4, 1] = age4MNumcount
          IF age5MNumcount GT 0 THEN Total_N_ageclass2[5, 1] = age5MNumcount
          IF age6MNumcount GT 0 THEN Total_N_ageclass2[6, 1] = age6MNumcount
          IF age7MNumcount GT 0 THEN Total_N_ageclass2[7, 1] = age7MNumcount
          IF age8MNumcount GT 0 THEN Total_N_ageclass2[8, 1] = age8MNumcount
          IF age9MNumcount GT 0 THEN Total_N_ageclass2[9, 1] = age9MNumcount
          IF age10MNumcount GT 0 THEN Total_N_ageclass2[10, 1] = age10MNumcount
          IF age11MNumcount GT 0 THEN Total_N_ageclass2[11, 1] = age11MNumcount
          IF age12MNumcount GT 0 THEN Total_N_ageclass2[12, 1] = age12MNumcount
          IF age13MNumcount GT 0 THEN Total_N_ageclass2[13, 1] = age13MNumcount
          IF age14MNumcount GT 0 THEN Total_N_ageclass2[14, 1] = age14MNumcount
          IF age15MNumcount GT 0 THEN Total_N_ageclass2[15, 1] = age15MNumcount
          IF age16MNumcount GT 0 THEN Total_N_ageclass2[16, 1] = age16MNumcount
          IF age17MNumcount GT 0 THEN Total_N_ageclass2[17, 1] = age17MNumcount
          IF age18MNumcount GT 0 THEN Total_N_ageclass2[18, 1] = age18MNumcount
          IF age19MNumcount GT 0 THEN Total_N_ageclass2[19, 1] = age19MNumcount
          IF age20MNumcount GT 0 THEN Total_N_ageclass2[20, 1] = age20MNumcount
          IF age21MNumcount GT 0 THEN Total_N_ageclass2[21, 1] = age21MNumcount
          IF age22MNumcount GT 0 THEN Total_N_ageclass2[22, 1] = age22MNumcount
          IF age23MNumcount GT 0 THEN Total_N_ageclass2[23, 1] = age23MNumcount
          IF age24MNumcount GT 0 THEN Total_N_ageclass2[24, 1] = age24MNumcount
          IF age25MNumcount GT 0 THEN Total_N_ageclass2[25, 1] = age25MNumcount
          IF age26MNumcount GT 0 THEN Total_N_ageclass2[26, 1] = age26MNumcount
          PRINT, 'Derived age distribution for MALES (individual-based)'
          PRINT, Total_N_ageclass2[*, 1]
          PRINT, 'Total number of MALES (INDIVIDUAL-BASED)'
          PRINT, total(Total_N_ageclass2[*, 1])

          ; allocate estimated age data to an array -FEMALES
          Female_N_ageclass = fltarr(27L, 2L); all
          Female_N_ageclass[0, 0] = TOTAL(WAE_length_binF[10, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 0
          Female_N_ageclass[1, 0] = TOTAL(WAE_length_binF[11, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 1
          Female_N_ageclass[2, 0] = TOTAL(WAE_length_binF[12, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 2
          Female_N_ageclass[3, 0] = TOTAL(WAE_length_binF[13, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 3
          Female_N_ageclass[4, 0] = TOTAL(WAE_length_binF[14, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 4
          Female_N_ageclass[5, 0] = TOTAL(WAE_length_binF[15, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 5
          Female_N_ageclass[6, 0] = TOTAL(WAE_length_binF[16, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 6
          Female_N_ageclass[7, 0] = TOTAL(WAE_length_binF[17, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 7
          Female_N_ageclass[8, 0] = TOTAL(WAE_length_binF[18, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 8
          Female_N_ageclass[9, 0] = TOTAL(WAE_length_binF[19, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 9
          Female_N_ageclass[10, 0] = TOTAL(WAE_length_binF[20, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 10
          Female_N_ageclass[11, 0] = TOTAL(WAE_length_binF[21, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 11
          Female_N_ageclass[12, 0] = TOTAL(WAE_length_binF[22, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 12
          Female_N_ageclass[13, 0] = TOTAL(WAE_length_binF[23, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 13
          Female_N_ageclass[14, 0] = TOTAL(WAE_length_binF[24, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 14
          Female_N_ageclass[15, 0] = TOTAL(WAE_length_binF[25, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 15
          Female_N_ageclass[16, 0] = TOTAL(WAE_length_binF[26, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 16
          Female_N_ageclass[17, 0] = TOTAL(WAE_length_binF[27, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 17
          Female_N_ageclass[18, 0] = TOTAL(WAE_length_binF[28, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 18
          Female_N_ageclass[19, 0] = TOTAL(WAE_length_binF[29, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 19
          Female_N_ageclass[20, 0] = TOTAL(WAE_length_binF[30, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 20
          Female_N_ageclass[21, 0] = TOTAL(WAE_length_binF[31, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 21
          Female_N_ageclass[22, 0] = TOTAL(WAE_length_binF[32, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 22
          Female_N_ageclass[23, 0] = TOTAL(WAE_length_binF[33, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 23
          Female_N_ageclass[24, 0] = TOTAL(WAE_length_binF[34, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 24
          Female_N_ageclass[25, 0] = TOTAL(WAE_length_binF[35, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 25
          Female_N_ageclass[26, 0] = TOTAL(WAE_length_binF[36, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 26
          PRINT, 'Derived age distribution for females'
          PRINT, Female_N_ageclass[*, 0]
          PRINT, 'Total number of females', total(Female_N_ageclass[*, 0])

          age0FNum = where(FishAge[*] EQ 0 AND Sex_prod[*] EQ 1, age0FNumcount)
          age1FNum = where(FishAge[*] EQ 1 AND Sex_prod[*] EQ 1, age1FNumcount)
          age2FNum = where(FishAge[*] EQ 2 AND Sex_prod[*] EQ 1, age2FNumcount)
          age3FNum = where(FishAge[*] EQ 3 AND Sex_prod[*] EQ 1, age3FNumcount)
          age4FNum = where(FishAge[*] EQ 4 AND Sex_prod[*] EQ 1, age4FNumcount)
          age5FNum = where(FishAge[*] EQ 5 AND Sex_prod[*] EQ 1, age5FNumcount)
          age6FNum = where(FishAge[*] EQ 6 AND Sex_prod[*] EQ 1, age6FNumcount)
          age7FNum = where(FishAge[*] EQ 7 AND Sex_prod[*] EQ 1, age7FNumcount)
          age8FNum = where(FishAge[*] EQ 8 AND Sex_prod[*] EQ 1, age8FNumcount)
          age9FNum = where(FishAge[*] EQ 9 AND Sex_prod[*] EQ 1, age9FNumcount)
          age10FNum = where(FishAge[*] EQ 10 AND Sex_prod[*] EQ 1, age10FNumcount)
          age11FNum = where(FishAge[*] EQ 11 AND Sex_prod[*] EQ 1, age11FNumcount)
          age12FNum = where(FishAge[*] EQ 12 AND Sex_prod[*] EQ 1, age12FNumcount)
          age13FNum = where(FishAge[*] EQ 13 AND Sex_prod[*] EQ 1, age13FNumcount)
          age14FNum = where(FishAge[*] EQ 14 AND Sex_prod[*] EQ 1, age14FNumcount)
          age15FNum = where(FishAge[*] EQ 15 AND Sex_prod[*] EQ 1, age15FNumcount)
          age16FNum = where(FishAge[*] EQ 16 AND Sex_prod[*] EQ 1, age16FNumcount)
          age17FNum = where(FishAge[*] EQ 17 AND Sex_prod[*] EQ 1, age17FNumcount)
          age18FNum = where(FishAge[*] EQ 18 AND Sex_prod[*] EQ 1, age18FNumcount)
          age19FNum = where(FishAge[*] EQ 19 AND Sex_prod[*] EQ 1, age19FNumcount)
          age20FNum = where(FishAge[*] EQ 20 AND Sex_prod[*] EQ 1, age20FNumcount)
          age21FNum = where(FishAge[*] EQ 21 AND Sex_prod[*] EQ 1, age21FNumcount)
          age22FNum = where(FishAge[*] EQ 22 AND Sex_prod[*] EQ 1, age22FNumcount)
          age23FNum = where(FishAge[*] EQ 23 AND Sex_prod[*] EQ 1, age23FNumcount)
          age24FNum = where(FishAge[*] EQ 24 AND Sex_prod[*] EQ 1, age24FNumcount)
          age25FNum = where(FishAge[*] EQ 25 AND Sex_prod[*] EQ 1, age25FNumcount)
          age26FNum = where(FishAge[*] EQ 26 AND Sex_prod[*] EQ 1, age26FNumcount)
          IF age0FNumcount GT 0 THEN Total_N_ageclass2[0, 2] = age0FNumcount
          IF age1FNumcount GT 0 THEN Total_N_ageclass2[1, 2] = age1FNumcount
          IF age2FNumcount GT 0 THEN Total_N_ageclass2[2, 2] = age2FNumcount
          IF age3FNumcount GT 0 THEN Total_N_ageclass2[3, 2] = age3FNumcount
          IF age4FNumcount GT 0 THEN Total_N_ageclass2[4, 2] = age4FNumcount
          IF age5FNumcount GT 0 THEN Total_N_ageclass2[5, 2] = age5FNumcount
          IF age6FNumcount GT 0 THEN Total_N_ageclass2[6, 2] = age6FNumcount
          IF age7FNumcount GT 0 THEN Total_N_ageclass2[7, 2] = age7FNumcount
          IF age8FNumcount GT 0 THEN Total_N_ageclass2[8, 2] = age8FNumcount
          IF age9FNumcount GT 0 THEN Total_N_ageclass2[9, 2] = age9FNumcount
          IF age10FNumcount GT 0 THEN Total_N_ageclass2[10, 2] = age10FNumcount
          IF age11FNumcount GT 0 THEN Total_N_ageclass2[11, 2] = age11FNumcount
          IF age12FNumcount GT 0 THEN Total_N_ageclass2[12, 2] = age12FNumcount
          IF age13FNumcount GT 0 THEN Total_N_ageclass2[13, 2] = age13FNumcount
          IF age14FNumcount GT 0 THEN Total_N_ageclass2[14, 2] = age14FNumcount
          IF age15FNumcount GT 0 THEN Total_N_ageclass2[15, 2] = age15FNumcount
          IF age16FNumcount GT 0 THEN Total_N_ageclass2[16, 2] = age16FNumcount
          IF age17FNumcount GT 0 THEN Total_N_ageclass2[17, 2] = age17FNumcount
          IF age18FNumcount GT 0 THEN Total_N_ageclass2[18, 2] = age18FNumcount
          IF age19FNumcount GT 0 THEN Total_N_ageclass2[19, 2] = age19FNumcount
          IF age20FNumcount GT 0 THEN Total_N_ageclass2[20, 2] = age20FNumcount
          IF age21FNumcount GT 0 THEN Total_N_ageclass2[21, 2] = age21FNumcount
          IF age22FNumcount GT 0 THEN Total_N_ageclass2[22, 2] = age22FNumcount
          IF age23FNumcount GT 0 THEN Total_N_ageclass2[23, 2] = age23FNumcount
          IF age24FNumcount GT 0 THEN Total_N_ageclass2[24, 2] = age24FNumcount
          IF age25FNumcount GT 0 THEN Total_N_ageclass2[25, 2] = age25FNumcount
          IF age26FNumcount GT 0 THEN Total_N_ageclass2[26, 2] = age26FNumcount
          PRINT, 'Derived age distribution for FEMALES (individual-based)'
          PRINT, Total_N_ageclass2[*, 2]
          PRINT, 'Total number of FEMALES (INDIVIDUAL-BASED)'
          PRINT, total(Total_N_ageclass2[*, 2])

          ; allocate estimated age data to an array - unknowns
          Unknown_N_ageclass = fltarr(27L, 2L)
          Unknown_N_ageclass[0, 0] = TOTAL(WAE_length_binU[10, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 0
          Unknown_N_ageclass[1, 0] = TOTAL(WAE_length_binU[11, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 1
          Unknown_N_ageclass[2, 0] = TOTAL(WAE_length_binU[12, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 2
          Unknown_N_ageclass[3, 0] = TOTAL(WAE_length_binU[13, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 3
          Unknown_N_ageclass[4, 0] = TOTAL(WAE_length_binU[14, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 4
          Unknown_N_ageclass[5, 0] = TOTAL(WAE_length_binU[15, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 5
          Unknown_N_ageclass[6, 0] = TOTAL(WAE_length_binU[16, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 6
          Unknown_N_ageclass[7, 0] = TOTAL(WAE_length_binU[17, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 7
          Unknown_N_ageclass[8, 0] = TOTAL(WAE_length_binU[18, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 8
          Unknown_N_ageclass[9, 0] = TOTAL(WAE_length_binU[19, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 9
          Unknown_N_ageclass[10, 0] = TOTAL(WAE_length_binU[20, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 10
          Unknown_N_ageclass[11, 0] = TOTAL(WAE_length_binU[21, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 11
          Unknown_N_ageclass[12, 0] = TOTAL(WAE_length_binU[22, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 12
          Unknown_N_ageclass[13, 0] = TOTAL(WAE_length_binU[23, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 13
          Unknown_N_ageclass[14, 0] = TOTAL(WAE_length_binU[24, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 14
          Unknown_N_ageclass[15, 0] = TOTAL(WAE_length_binU[25, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 15
          Unknown_N_ageclass[16, 0] = TOTAL(WAE_length_binU[26, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 16
          Unknown_N_ageclass[17, 0] = TOTAL(WAE_length_binU[27, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 17
          Unknown_N_ageclass[18, 0] = TOTAL(WAE_length_binU[28, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 18
          Unknown_N_ageclass[19, 0] = TOTAL(WAE_length_binU[29, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 19
          Unknown_N_ageclass[20, 0] = TOTAL(WAE_length_binU[30, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 20
          Unknown_N_ageclass[21, 0] = TOTAL(WAE_length_binU[31, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 21
          Unknown_N_ageclass[22, 0] = TOTAL(WAE_length_binU[32, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 22
          Unknown_N_ageclass[23, 0] = TOTAL(WAE_length_binU[33, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 23
          Unknown_N_ageclass[24, 0] = TOTAL(WAE_length_binU[34, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 24
          Unknown_N_ageclass[25, 0] = TOTAL(WAE_length_binU[35, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 25
          Unknown_N_ageclass[26, 0] = TOTAL(WAE_length_binU[36, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 26
          PRINT, 'Derived age distribution for unknowns'
          PRINT, Unknown_N_ageclass[*, 0]
          PRINT, 'Total number of unknowns', total(Unknown_N_ageclass[*, 0])
          age0UNum = where(FishAge[*] EQ 0 AND Sex_prod[*] EQ 2, age0UNumcount)
          age1UNum = where(FishAge[*] EQ 1 AND Sex_prod[*] EQ 2, age1UNumcount)
          age2UNum = where(FishAge[*] EQ 2 AND Sex_prod[*] EQ 2, age2UNumcount)
          age3UNum = where(FishAge[*] EQ 3 AND Sex_prod[*] EQ 2, age3UNumcount)
          age4UNum = where(FishAge[*] EQ 4 AND Sex_prod[*] EQ 2, age4UNumcount)
          age5UNum = where(FishAge[*] EQ 5 AND Sex_prod[*] EQ 2, age5UNumcount)
          age6UNum = where(FishAge[*] EQ 6 AND Sex_prod[*] EQ 2, age6UNumcount)
          age7UNum = where(FishAge[*] EQ 7 AND Sex_prod[*] EQ 2, age7UNumcount)
          age8UNum = where(FishAge[*] EQ 8 AND Sex_prod[*] EQ 2, age8UNumcount)
          age9UNum = where(FishAge[*] EQ 9 AND Sex_prod[*] EQ 2, age9UNumcount)
          age10UNum = where(FishAge[*] EQ 10 AND Sex_prod[*] EQ 2, age10UNumcount)
          age11UNum = where(FishAge[*] EQ 11 AND Sex_prod[*] EQ 2, age11UNumcount)
          age12UNum = where(FishAge[*] EQ 12 AND Sex_prod[*] EQ 2, age12UNumcount)
          age13UNum = where(FishAge[*] EQ 13 AND Sex_prod[*] EQ 2, age13UNumcount)
          age14UNum = where(FishAge[*] EQ 14 AND Sex_prod[*] EQ 2, age14UNumcount)
          age15UNum = where(FishAge[*] EQ 15 AND Sex_prod[*] EQ 2, age15UNumcount)
          age16UNum = where(FishAge[*] EQ 16 AND Sex_prod[*] EQ 2, age16UNumcount)
          age17UNum = where(FishAge[*] EQ 17 AND Sex_prod[*] EQ 2, age17UNumcount)
          age18UNum = where(FishAge[*] EQ 18 AND Sex_prod[*] EQ 2, age18UNumcount)
          age19UNum = where(FishAge[*] EQ 19 AND Sex_prod[*] EQ 2, age19UNumcount)
          age20UNum = where(FishAge[*] EQ 20 AND Sex_prod[*] EQ 2, age20UNumcount)
          age21UNum = where(FishAge[*] EQ 21 AND Sex_prod[*] EQ 2, age21UNumcount)
          age22UNum = where(FishAge[*] EQ 22 AND Sex_prod[*] EQ 2, age22UNumcount)
          age23UNum = where(FishAge[*] EQ 23 AND Sex_prod[*] EQ 2, age23UNumcount)
          age24UNum = where(FishAge[*] EQ 24 AND Sex_prod[*] EQ 2, age24UNumcount)
          age25UNum = where(FishAge[*] EQ 25 AND Sex_prod[*] EQ 2, age25UNumcount)
          age26UNum = where(FishAge[*] EQ 26 AND Sex_prod[*] EQ 2, age26UNumcount)
          IF age0UNumcount GT 0 THEN Total_N_ageclass2[0, 3] = age0UNumcount
          IF age1UNumcount GT 0 THEN Total_N_ageclass2[1, 3] = age1UNumcount
          IF age2UNumcount GT 0 THEN Total_N_ageclass2[2, 3] = age2UNumcount
          IF age3UNumcount GT 0 THEN Total_N_ageclass2[3, 3] = age3UNumcount
          IF age4UNumcount GT 0 THEN Total_N_ageclass2[4, 3] = age4UNumcount
          IF age5UNumcount GT 0 THEN Total_N_ageclass2[5, 3] = age5UNumcount
          IF age6UNumcount GT 0 THEN Total_N_ageclass2[6, 3] = age6UNumcount
          IF age7UNumcount GT 0 THEN Total_N_ageclass2[7, 3] = age7UNumcount
          IF age8UNumcount GT 0 THEN Total_N_ageclass2[8, 3] = age8UNumcount
          IF age9UNumcount GT 0 THEN Total_N_ageclass2[9, 3] = age9UNumcount
          IF age10UNumcount GT 0 THEN Total_N_ageclass2[10, 3] = age10UNumcount
          IF age11UNumcount GT 0 THEN Total_N_ageclass2[11, 3] = age11UNumcount
          IF age12UNumcount GT 0 THEN Total_N_ageclass2[12, 3] = age12UNumcount
          IF age13UNumcount GT 0 THEN Total_N_ageclass2[13, 3] = age13UNumcount
          IF age14UNumcount GT 0 THEN Total_N_ageclass2[14, 3] = age14UNumcount
          IF age15UNumcount GT 0 THEN Total_N_ageclass2[15, 3] = age15UNumcount
          IF age16UNumcount GT 0 THEN Total_N_ageclass2[16, 3] = age16UNumcount
          IF age17UNumcount GT 0 THEN Total_N_ageclass2[17, 3] = age17UNumcount
          IF age18UNumcount GT 0 THEN Total_N_ageclass2[18, 3] = age18UNumcount
          IF age19UNumcount GT 0 THEN Total_N_ageclass2[19, 3] = age19UNumcount
          IF age20UNumcount GT 0 THEN Total_N_ageclass2[20, 3] = age20UNumcount
          IF age21UNumcount GT 0 THEN Total_N_ageclass2[21, 3] = age21UNumcount
          IF age22UNumcount GT 0 THEN Total_N_ageclass2[22, 3] = age22UNumcount
          IF age23UNumcount GT 0 THEN Total_N_ageclass2[23, 3] = age23UNumcount
          IF age24UNumcount GT 0 THEN Total_N_ageclass2[24, 3] = age24UNumcount
          IF age25UNumcount GT 0 THEN Total_N_ageclass2[25, 3] = age25UNumcount
          IF age26UNumcount GT 0 THEN Total_N_ageclass2[26, 3] = age26UNumcount
          PRINT, 'Derived age distribution for UNKNOWN (individual-based)'
          PRINT, Total_N_ageclass2[*, 3]
          PRINT, 'Total number of UNKNOWN (INDIVIDUAL-BASED)'
          PRINT, total(Total_N_ageclass2[*, 3])

          ; Estimate age structure using PE- ALL FISH
          Prop_ageclass = fltarr(27L, 4L)
          IF TOTAL(Total_N_ageclass[*, 0]) GT 0. THEN Prop_ageclass[*, 0] = Total_N_ageclass[*, 0]/TOTAL(Total_N_ageclass[*, 0])
          PRINT, 'Relative age distribution - ALL FISH'
          PRINT, Prop_ageclass[*, 0]
          ; Estimate age structure - MALES
          IF TOTAL(Total_N_ageclass[*, 0]) GT 0. THEN Prop_ageclass[*, 1] = Male_N_ageclass[*, 0]/TOTAL(Total_N_ageclass[*, 0])
          PRINT, 'Relative age distribution - MALES'
          PRINT, Prop_ageclass[*, 1]
          ; Estimate age structure - FEMALES
          IF TOTAL(Total_N_ageclass[*, 0]) GT 0. THEN Prop_ageclass[*, 2] = Female_N_ageclass[*, 0]/TOTAL(Total_N_ageclass[*, 0])
          PRINT, 'Relative age distribution - FEMALES'
          PRINT, Prop_ageclass[*, 2]
          ; Estimate age structure - UNKNOWNS
          IF TOTAL(Total_N_ageclass[*, 0]) GT 0. THEN Prop_ageclass[*, 3] = Unknown_N_ageclass[*, 0]/TOTAL(Total_N_ageclass[*, 0])
          PRINT, 'Relative age distribution - UNKNOWN'
          PRINT, Prop_ageclass[*, 3]

          ; Estimate age structure 2 - ALL FISH
          Prop_ageclass2 = fltarr(27L, 4L)
          IF TOTAL(Total_N_ageclass2[*, 0]) GT 0. THEN Prop_ageclass2[*, 0] = Total_N_ageclass2[*, 0]/TOTAL(Total_N_ageclass[*, 0])
          PRINT, 'Relative age distribution2 - ALL FISH'
          PRINT, Prop_ageclass2[*, 0]
          ; Estimate age structure - MALES
          IF TOTAL(Total_N_ageclass2[*, 0]) GT 0. THEN Prop_ageclass2[*, 1] = Total_N_ageclass2[*, 1]/TOTAL(Total_N_ageclass[*, 0])
          PRINT, 'Relative age distribution2 - MALES'
          PRINT, Prop_ageclass2[*, 1]
          ; Estimate age structure - FEMALES
          IF TOTAL(Total_N_ageclass2[*, 0]) GT 0. THEN Prop_ageclass2[*, 2] = Total_N_ageclass2[*, 2]/TOTAL(Total_N_ageclass[*, 0])
          PRINT, 'Relative age distribution2 - FEMALES'
          PRINT, Prop_ageclass2[*, 2]
          ; Estimate age structure - UNKNOWNS
          IF TOTAL(Total_N_ageclass2[*, 0]) GT 0. THEN Prop_ageclass2[*, 3] = Total_N_ageclass2[*, 3]/TOTAL(Total_N_ageclass[*, 0])
          PRINT, 'Relative age distribution2 - UNKNOWN'
          PRINT, Prop_ageclass2[*, 3]

          PRINT, 'Population estimate (PE)', PE[INDEX_lengthdata[0]]
          paramset[13:39, i] = ROUND(Prop_ageclass[*, 0]*PE[INDEX_lengthdata[0]])
          paramset[13, i] = YOY_PE[i]
          PRINT, 'Estimated age distribution - ALL FISH'
          PRINT, paramset[13:39, i]
          paramsetM[13:39, i] = ROUND(Prop_ageclass[*, 1]*PE[INDEX_lengthdata[0]])
          PRINT, 'Estimated age distribution - MALES'
          PRINT, ROUND(Prop_ageclass[*, 1]*PE[INDEX_lengthdata[0]])
          paramsetF[13:39, i] = ROUND(Prop_ageclass[*, 2]*PE[INDEX_lengthdata[0]])
          PRINT, 'Estimated age distribution - FEMALES'
          PRINT, ROUND(Prop_ageclass[*, 2]*PE[INDEX_lengthdata[0]])
          paramsetU[13:39, i] = ROUND(Prop_ageclass[*, 3]*PE[INDEX_lengthdata[0]])
          PRINT, 'Estimated age distribution - UNKNOWNS'
          PRINT, ROUND(Prop_ageclass[*, 3]*PE[INDEX_lengthdata[0]])

          ; Plot estimated age structure
          maleage=ROUND(Prop_ageclass[*, 1]*PE[INDEX_lengthdata[0]])
          femaleage=ROUND(Prop_ageclass[*, 2]*PE[INDEX_lengthdata[0]])
          unknownage=ROUND(Prop_ageclass[*, 3]*PE[INDEX_lengthdata[0]])
          unknownage[0]=YOY_PE[i]
          maleage2=ROUND(Prop_ageclass2[*, 1]*PE[INDEX_lengthdata[0]])
          femaleage2=ROUND(Prop_ageclass2[*, 2]*PE[INDEX_lengthdata[0]])
          unknownage2=ROUND(Prop_ageclass2[*, 3]*PE[INDEX_lengthdata[0]])
          unknownage2[0]=YOY_PE[i]
          !p.font=0
          ;Device, Set_Character_Size=[8,12]
          DEVICE, Get_Decomposed=currentState
          DEVICE, SET_FONT='Courier', /TT_FONT
          DEVICE, DECOMPOSED=0
          cgDisplay, 750, 400, WID=1
          ;!P.Multi = [0,2,1]
          labels = INDGEN(27);
          cgLoadct, 33, Clip=[10,245]
          cgBarPlot, maleage,  YRange=[0,ROUND(MAX(maleage+femaleage+unknownage))*1.3], Colors='BLUE', BarNames=labels $
            , xtitle='Age (years)' $
            , ytitle='Number of fish' $;, xrange=[0, 25]
            , title='Age structure of WI walleye - '+'WBIC: '+STRING(paramset[1, i], FORMAT = '(I7)') $
            +'_Year: '+STRING(fix(paramset[2, i]), FORMAT = '(I4)')+' PE='+STRING(PE[INDEX_lengthdata[0]], FORMAT = '(I5)')+stock
          cgBarPlot, femaleage, Colors='RED', /Overplot, BaseLines=maleage
          cgBarPlot, unknownage, Colors='dark green', /Overplot, BaseLines=maleage+femaleage
          items = ['Male', 'Female', 'Unknown']
          colors = ['BLUE', 'RED', 'dark green']
          AL_Legend, items, Colors=colors, PSym=Replicate(15,3), SymSize=Replicate(1.75,3), $
            Charsize=cgDefCharsize(), Position=[0.75, 0.85], /Normal
          filename='Walleye age structure' + STRING(paramset[1, i], FORMAT = '(I7)') $
            + '_'+STRING(fix(paramset[2, i]), FORMAT = '(I4)') + '.png'
          WRITE_PNG, filename, TVRD(/TRUE)
          DEVICE, DECOMPOSED=old_decomposed
          !p.font=1

          !p.font=0
          ;Device, Set_Character_Size=[8,12]
          DEVICE, Get_Decomposed=currentState
          DEVICE, SET_FONT='Courier', /TT_FONT
          DEVICE, DECOMPOSED=0
          cgDisplay, 750, 400, WID=1
          ;!P.Multi = [0,2,1]
          labels = INDGEN(27);
          cgLoadct, 33, Clip=[10,245]
          cgBarPlot, maleage,  YRange=[0,ROUND(MAX(maleage2+femaleage2+unknownage2))*1.3], Colors='BLUE', BarNames=labels $
            , xtitle='Age (years)' $
            , ytitle='Number of fish' $;, xrange=[0, 25]
            , title='Age structure of WI walleye2 - '+'WBIC: '+STRING(paramset[1, i], FORMAT = '(I7)') $
            +'_Year: '+STRING(fix(paramset[2, i]), FORMAT = '(I4)')+' PE='+STRING(PE[INDEX_lengthdata[0]], FORMAT = '(I5)')+stock
          cgBarPlot, femaleage, Colors='RED', /Overplot, BaseLines=maleage
          cgBarPlot, unknownage, Colors='dark green', /Overplot, BaseLines=maleage+femaleage
          items = ['Male', 'Female', 'Unknown']
          colors = ['BLUE', 'RED', 'dark green']
          AL_Legend, items, Colors=colors, PSym=Replicate(15,3), SymSize=Replicate(1.75,3), $
            Charsize=cgDefCharsize(), Position=[0.75, 0.85], /Normal
          filename='Walleye age structure2' + STRING(paramset[1, i], FORMAT = '(I7)') $
            + '_'+STRING(fix(paramset[2, i]), FORMAT = '(I4)') + '.png'
          WRITE_PNG, filename, TVRD(/TRUE)
          DEVICE, DECOMPOSED=old_decomposed
          !p.font=1

          ; Mean length-at-age from estiamted age structure (meas of mean length-at-age from each length bins) - ALL FISH
          mean_length_at_age = FLTARR(27L, 37L)
          mean_length_at_age[0, *] = (WAE_length_mean[10, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_age[1, *] = (WAE_length_mean[11, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_age[2, *] = (WAE_length_mean[12, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_age[3, *] = (WAE_length_mean[13, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_age[4, *] = (WAE_length_mean[14, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_age[5, *] = (WAE_length_mean[15, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_age[6, *] = (WAE_length_mean[16, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_age[7, *] = (WAE_length_mean[17, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_age[8, *] = (WAE_length_mean[18, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_age[9, *] = (WAE_length_mean[19, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_age[10, *] = (WAE_length_mean[20, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_age[11, *] = (WAE_length_mean[21, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_age[12, *] = (WAE_length_mean[22, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_age[13, *] = (WAE_length_mean[23, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_age[14, *] = (WAE_length_mean[24, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_age[15, *] = (WAE_length_mean[25, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_age[16, *] = (WAE_length_mean[26, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_age[17, *] = (WAE_length_mean[27, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_age[18, *] = (WAE_length_mean[28, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_age[19, *] = (WAE_length_mean[29, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_age[20, *] = (WAE_length_mean[30, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_age[21, *] = (WAE_length_mean[31, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_age[22, *] = (WAE_length_mean[32, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_age[23, *] = (WAE_length_mean[33, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_age[24, *] = (WAE_length_mean[34, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_age[25, *] = (WAE_length_mean[35, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_age[26, *] = (WAE_length_mean[36, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          age0mean = where(mean_length_at_age[0, *] GT 0, age0meancount)
          age1mean = where(mean_length_at_age[1, *] GT 0, age1meancount)
          age2mean = where(mean_length_at_age[2, *] GT 0, age2meancount)
          age3mean = where(mean_length_at_age[3, *] GT 0, age3meancount)
          age4mean = where(mean_length_at_age[4, *] GT 0, age4meancount)
          age5mean = where(mean_length_at_age[5, *] GT 0, age5meancount)
          age6mean = where(mean_length_at_age[6, *] GT 0, age6meancount)
          age7mean = where(mean_length_at_age[7, *] GT 0, age7meancount)
          age8mean = where(mean_length_at_age[8, *] GT 0, age8meancount)
          age9mean = where(mean_length_at_age[9, *] GT 0, age9meancount)
          age10mean = where(mean_length_at_age[10, *] GT 0, age10meancount)
          age11mean = where(mean_length_at_age[11, *] GT 0, age11meancount)
          age12mean = where(mean_length_at_age[12, *] GT 0, age12meancount)
          age13mean = where(mean_length_at_age[13, *] GT 0, age13meancount)
          age14mean = where(mean_length_at_age[14, *] GT 0, age14meancount)
          age15mean = where(mean_length_at_age[15, *] GT 0, age15meancount)
          age16mean = where(mean_length_at_age[16, *] GT 0, age16meancount)
          age17mean = where(mean_length_at_age[17, *] GT 0, age17meancount)
          age18mean = where(mean_length_at_age[18, *] GT 0, age18meancount)
          age19mean = where(mean_length_at_age[19, *] GT 0, age19meancount)
          age20mean = where(mean_length_at_age[20, *] GT 0, age20meancount)
          age21mean = where(mean_length_at_age[21, *] GT 0, age21meancount)
          age22mean = where(mean_length_at_age[22, *] GT 0, age22meancount)
          age23mean = where(mean_length_at_age[23, *] GT 0, age23meancount)
          age24mean = where(mean_length_at_age[24, *] GT 0, age24meancount)
          age25mean = where(mean_length_at_age[25, *] GT 0, age25meancount)
          age26mean = where(mean_length_at_age[26, *] GT 0, age26meancount)
          IF age0meancount GT 0 THEN Total_N_ageclass[0, 1] = TOTAL(WAE_length_mean[10, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age0meancount
          IF age1meancount GT 0 THEN Total_N_ageclass[1, 1] = TOTAL(WAE_length_mean[11, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age1meancount
          IF age2meancount GT 0 THEN Total_N_ageclass[2, 1] = TOTAL(WAE_length_mean[12, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age2meancount
          IF age3meancount GT 0 THEN Total_N_ageclass[3, 1] = TOTAL(WAE_length_mean[13, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age3meancount
          IF age4meancount GT 0 THEN Total_N_ageclass[4, 1] = TOTAL(WAE_length_mean[14, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age4meancount
          IF age5meancount GT 0 THEN Total_N_ageclass[5, 1] = TOTAL(WAE_length_mean[15, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age5meancount
          IF age6meancount GT 0 THEN Total_N_ageclass[6, 1] = TOTAL(WAE_length_mean[16, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age6meancount
          IF age7meancount GT 0 THEN Total_N_ageclass[7, 1] = TOTAL(WAE_length_mean[17, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age7meancount
          IF age8meancount GT 0 THEN Total_N_ageclass[8, 1] = TOTAL(WAE_length_mean[18, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age8meancount
          IF age9meancount GT 0 THEN Total_N_ageclass[9, 1] = TOTAL(WAE_length_mean[19, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age9meancount
          IF age10meancount GT 0 THEN Total_N_ageclass[10, 1] = TOTAL(WAE_length_mean[20, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age10meancount
          IF age11meancount GT 0 THEN Total_N_ageclass[11, 1] = TOTAL(WAE_length_mean[21, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age11meancount
          IF age12meancount GT 0 THEN Total_N_ageclass[12, 1] = TOTAL(WAE_length_mean[22, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age12meancount
          IF age13meancount GT 0 THEN Total_N_ageclass[13, 1] = TOTAL(WAE_length_mean[23, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age13meancount
          IF age14meancount GT 0 THEN Total_N_ageclass[14, 1] = TOTAL(WAE_length_mean[24, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age14meancount
          IF age15meancount GT 0 THEN Total_N_ageclass[15, 1] = TOTAL(WAE_length_mean[25, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age15meancount
          IF age16meancount GT 0 THEN Total_N_ageclass[16, 1] = TOTAL(WAE_length_mean[26, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age16meancount
          IF age17meancount GT 0 THEN Total_N_ageclass[17, 1] = TOTAL(WAE_length_mean[27, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age17meancount
          IF age18meancount GT 0 THEN Total_N_ageclass[18, 1] = TOTAL(WAE_length_mean[28, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age18meancount
          IF age19meancount GT 0 THEN Total_N_ageclass[19, 1] = TOTAL(WAE_length_mean[29, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age19meancount
          IF age20meancount GT 0 THEN Total_N_ageclass[20, 1] = TOTAL(WAE_length_mean[30, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age20meancount
          IF age21meancount GT 0 THEN Total_N_ageclass[21, 1] = TOTAL(WAE_length_mean[31, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age21meancount
          IF age22meancount GT 0 THEN Total_N_ageclass[22, 1] = TOTAL(WAE_length_mean[32, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age22meancount
          IF age23meancount GT 0 THEN Total_N_ageclass[23, 1] = TOTAL(WAE_length_mean[33, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age23meancount
          IF age24meancount GT 0 THEN Total_N_ageclass[24, 1] = TOTAL(WAE_length_mean[34, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age24meancount
          IF age25meancount GT 0 THEN Total_N_ageclass[25, 1] = TOTAL(WAE_length_mean[35, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age25meancount
          IF age26meancount GT 0 THEN Total_N_ageclass[26, 1] = TOTAL(WAE_length_mean[36, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age26meancount

          ; Body length (mm) of YOY - *******NEED TO CHANGE IT TO LAKE-YEAR-SPECIFIC
          YOYNOlength = where((Total_N_ageclass[0, 0] GT 0.) AND (Total_N_ageclass[0, 1] LE 0.), YOYNOlengthcount)
          IF paramset[40, i] LE 0 THEN paramset[40, i] = 104.5
          IF YOYNOlengthcount GT 0 THEN Total_N_ageclass[YOYNOlength, 1] = paramset[40, i]
          PRINT, 'Mean length-at-age'
          PRINT, Total_N_ageclass[*, 1]

          ; Mean length-at-age from estiamted age structure - males
          mean_length_at_ageM = FLTARR(27L, 37L)
          mean_length_at_ageM[0, *] = (WAE_length_meanM[10, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageM[1, *] = (WAE_length_meanM[11, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageM[2, *] = (WAE_length_meanM[12, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageM[3, *] = (WAE_length_meanM[13, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageM[4, *] = (WAE_length_meanM[14, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageM[5, *] = (WAE_length_meanM[15, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageM[6, *] = (WAE_length_meanM[16, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageM[7, *] = (WAE_length_meanM[17, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageM[8, *] = (WAE_length_meanM[18, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageM[9, *] = (WAE_length_meanM[19, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageM[10, *] = (WAE_length_meanM[20, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageM[11, *] = (WAE_length_meanM[21, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageM[12, *] = (WAE_length_meanM[22, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageM[13, *] = (WAE_length_meanM[23, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageM[14, *] = (WAE_length_meanM[24, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageM[15, *] = (WAE_length_meanM[25, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageM[16, *] = (WAE_length_meanM[26, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageM[17, *] = (WAE_length_meanM[27, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageM[18, *] = (WAE_length_meanM[28, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageM[19, *] = (WAE_length_meanM[29, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageM[20, *] = (WAE_length_meanM[30, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageM[21, *] = (WAE_length_meanM[31, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageM[22, *] = (WAE_length_meanM[32, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageM[23, *] = (WAE_length_meanM[33, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageM[24, *] = (WAE_length_meanM[34, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageM[25, *] = (WAE_length_meanM[35, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageM[26, *] = (WAE_length_meanM[36, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          age0Mmean = where(mean_length_at_ageM[0, *] GT 0, age0meanMcount)
          age1Mmean = where(mean_length_at_ageM[1, *] GT 0, age1meanMcount)
          age2Mmean = where(mean_length_at_ageM[2, *] GT 0, age2meanMcount)
          age3Mmean = where(mean_length_at_ageM[3, *] GT 0, age3meanMcount)
          age4Mmean = where(mean_length_at_ageM[4, *] GT 0, age4meanMcount)
          age5Mmean = where(mean_length_at_ageM[5, *] GT 0, age5meanMcount)
          age6Mmean = where(mean_length_at_ageM[6, *] GT 0, age6meanMcount)
          age7Mmean = where(mean_length_at_ageM[7, *] GT 0, age7meanMcount)
          age8Mmean = where(mean_length_at_ageM[8, *] GT 0, age8meanMcount)
          age9Mmean = where(mean_length_at_ageM[9, *] GT 0, age9meanMcount)
          age10Mmean = where(mean_length_at_ageM[10, *] GT 0, age10meanMcount)
          age11Mmean = where(mean_length_at_ageM[11, *] GT 0, age11meanMcount)
          age12Mmean = where(mean_length_at_ageM[12, *] GT 0, age12meanMcount)
          age13Mmean = where(mean_length_at_ageM[13, *] GT 0, age13meanMcount)
          age14Mmean = where(mean_length_at_ageM[14, *] GT 0, age14meanMcount)
          age15Mmean = where(mean_length_at_ageM[15, *] GT 0, age15meanMcount)
          age16Mmean = where(mean_length_at_ageM[16, *] GT 0, age16meanMcount)
          age17Mmean = where(mean_length_at_ageM[17, *] GT 0, age17meanMcount)
          age18Mmean = where(mean_length_at_ageM[18, *] GT 0, age18meanMcount)
          age19Mmean = where(mean_length_at_ageM[19, *] GT 0, age19meanMcount)
          age20Mmean = where(mean_length_at_ageM[20, *] GT 0, age20meanMcount)
          age21Mmean = where(mean_length_at_ageM[21, *] GT 0, age21meanMcount)
          age22Mmean = where(mean_length_at_ageM[22, *] GT 0, age22meanMcount)
          age23Mmean = where(mean_length_at_ageM[23, *] GT 0, age23meanMcount)
          age24Mmean = where(mean_length_at_ageM[24, *] GT 0, age24meanMcount)
          age25Mmean = where(mean_length_at_ageM[25, *] GT 0, age25meanMcount)
          age26Mmean = where(mean_length_at_ageM[26, *] GT 0, age26meanMcount)
          IF age0meanMcount GT 0 THEN Male_N_ageclass[0, 1] = TOTAL(WAE_length_meanM[10, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age0meanMcount
          IF age1meanMcount GT 0 THEN Male_N_ageclass[1, 1] = TOTAL(WAE_length_meanM[11, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age1meanMcount
          IF age2meanMcount GT 0 THEN Male_N_ageclass[2, 1] = TOTAL(WAE_length_meanM[12, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age2meanMcount
          IF age3meanMcount GT 0 THEN Male_N_ageclass[3, 1] = TOTAL(WAE_length_meanM[13, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age3meanMcount
          IF age4meanMcount GT 0 THEN Male_N_ageclass[4, 1] = TOTAL(WAE_length_meanM[14, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age4meanMcount
          IF age5meanMcount GT 0 THEN Male_N_ageclass[5, 1] = TOTAL(WAE_length_meanM[15, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age5meanMcount
          IF age6meanMcount GT 0 THEN Male_N_ageclass[6, 1] = TOTAL(WAE_length_meanM[16, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age6meanMcount
          IF age7meanMcount GT 0 THEN Male_N_ageclass[7, 1] = TOTAL(WAE_length_meanM[17, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age7meanMcount
          IF age8meanMcount GT 0 THEN Male_N_ageclass[8, 1] = TOTAL(WAE_length_meanM[18, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age8meanMcount
          IF age9meanMcount GT 0 THEN Male_N_ageclass[9, 1] = TOTAL(WAE_length_meanM[19, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age9meanMcount
          IF age10meanMcount GT 0 THEN Male_N_ageclass[10, 1] = TOTAL(WAE_length_meanM[20, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age10meanMcount
          IF age11meanMcount GT 0 THEN Male_N_ageclass[11, 1] = TOTAL(WAE_length_meanM[21, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age11meanMcount
          IF age12meanMcount GT 0 THEN Male_N_ageclass[12, 1] = TOTAL(WAE_length_meanM[22, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age12meanMcount
          IF age13meanMcount GT 0 THEN Male_N_ageclass[13, 1] = TOTAL(WAE_length_meanM[23, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age13meanMcount
          IF age14meanMcount GT 0 THEN Male_N_ageclass[14, 1] = TOTAL(WAE_length_meanM[24, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age14meanMcount
          IF age15meanMcount GT 0 THEN Male_N_ageclass[15, 1] = TOTAL(WAE_length_meanM[25, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age15meanMcount
          IF age16meanMcount GT 0 THEN Male_N_ageclass[16, 1] = TOTAL(WAE_length_meanM[26, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age16meanMcount
          IF age17meanMcount GT 0 THEN Male_N_ageclass[17, 1] = TOTAL(WAE_length_meanM[27, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age17meanMcount
          IF age18meanMcount GT 0 THEN Male_N_ageclass[18, 1] = TOTAL(WAE_length_meanM[28, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age18meanMcount
          IF age19meanMcount GT 0 THEN Male_N_ageclass[19, 1] = TOTAL(WAE_length_meanM[29, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age19meanMcount
          IF age20meanMcount GT 0 THEN Male_N_ageclass[20, 1] = TOTAL(WAE_length_meanM[30, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age20meanMcount
          IF age21meanMcount GT 0 THEN Male_N_ageclass[21, 1] = TOTAL(WAE_length_meanM[31, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age21meanMcount
          IF age22meanMcount GT 0 THEN Male_N_ageclass[22, 1] = TOTAL(WAE_length_meanM[32, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age22meanMcount
          IF age23meanMcount GT 0 THEN Male_N_ageclass[23, 1] = TOTAL(WAE_length_meanM[33, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age23meanMcount
          IF age24meanMcount GT 0 THEN Male_N_ageclass[24, 1] = TOTAL(WAE_length_meanM[34, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age24meanMcount
          IF age25meanMcount GT 0 THEN Male_N_ageclass[25, 1] = TOTAL(WAE_length_meanM[35, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age25meanMcount
          IF age26meanMcount GT 0 THEN Male_N_ageclass[26, 1] = TOTAL(WAE_length_meanM[36, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age26meanMcount
          PRINT, 'Mean length-at-age for males'
          PRINT, Male_N_ageclass[*, 1]

          ; Mean length-at-age from estiamted age structure - females
          mean_length_at_ageF = FLTARR(27L, 37L)
          mean_length_at_ageF[0, *] = (WAE_length_meanF[10, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageF[1, *] = (WAE_length_meanF[11, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageF[2, *] = (WAE_length_meanF[12, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageF[3, *] = (WAE_length_meanF[13, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageF[4, *] = (WAE_length_meanF[14, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageF[5, *] = (WAE_length_meanF[15, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageF[6, *] = (WAE_length_meanF[16, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageF[7, *] = (WAE_length_meanF[17, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageF[8, *] = (WAE_length_meanF[18, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageF[9, *] = (WAE_length_meanF[19, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageF[10, *] = (WAE_length_meanF[20, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageF[11, *] = (WAE_length_meanF[21, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageF[12, *] = (WAE_length_meanF[22, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageF[13, *] = (WAE_length_meanF[23, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageF[14, *] = (WAE_length_meanF[24, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageF[15, *] = (WAE_length_meanF[25, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageF[16, *] = (WAE_length_meanF[26, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageF[17, *] = (WAE_length_meanF[27, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageF[18, *] = (WAE_length_meanF[28, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageF[19, *] = (WAE_length_meanF[29, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageF[20, *] = (WAE_length_meanF[30, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageF[21, *] = (WAE_length_meanF[31, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageF[22, *] = (WAE_length_meanF[32, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageF[23, *] = (WAE_length_meanF[33, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageF[24, *] = (WAE_length_meanF[34, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageF[25, *] = (WAE_length_meanF[35, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageF[26, *] = (WAE_length_meanF[36, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          age0Mmean = where(mean_length_at_ageF[0, *] GT 0, age0meanFcount)
          age1Mmean = where(mean_length_at_ageF[1, *] GT 0, age1meanFcount)
          age2Mmean = where(mean_length_at_ageF[2, *] GT 0, age2meanFcount)
          age3Mmean = where(mean_length_at_ageF[3, *] GT 0, age3meanFcount)
          age4Mmean = where(mean_length_at_ageF[4, *] GT 0, age4meanFcount)
          age5Mmean = where(mean_length_at_ageF[5, *] GT 0, age5meanFcount)
          age6Mmean = where(mean_length_at_ageF[6, *] GT 0, age6meanFcount)
          age7Mmean = where(mean_length_at_ageF[7, *] GT 0, age7meanFcount)
          age8Mmean = where(mean_length_at_ageF[8, *] GT 0, age8meanFcount)
          age9Mmean = where(mean_length_at_ageF[9, *] GT 0, age9meanFcount)
          age10Mmean = where(mean_length_at_ageF[10, *] GT 0, age10meanFcount)
          age11Mmean = where(mean_length_at_ageF[11, *] GT 0, age11meanFcount)
          age12Mmean = where(mean_length_at_ageF[12, *] GT 0, age12meanFcount)
          age13Mmean = where(mean_length_at_ageF[13, *] GT 0, age13meanFcount)
          age14Mmean = where(mean_length_at_ageF[14, *] GT 0, age14meanFcount)
          age15Mmean = where(mean_length_at_ageF[15, *] GT 0, age15meanFcount)
          age16Mmean = where(mean_length_at_ageF[16, *] GT 0, age16meanFcount)
          age17Mmean = where(mean_length_at_ageF[17, *] GT 0, age17meanFcount)
          age18Mmean = where(mean_length_at_ageF[18, *] GT 0, age18meanFcount)
          age19Mmean = where(mean_length_at_ageF[19, *] GT 0, age19meanFcount)
          age20Mmean = where(mean_length_at_ageF[20, *] GT 0, age20meanFcount)
          age21Mmean = where(mean_length_at_ageF[21, *] GT 0, age21meanFcount)
          age22Mmean = where(mean_length_at_ageF[22, *] GT 0, age22meanFcount)
          age23Mmean = where(mean_length_at_ageF[23, *] GT 0, age23meanFcount)
          age24Mmean = where(mean_length_at_ageF[24, *] GT 0, age24meanFcount)
          age25Mmean = where(mean_length_at_ageF[25, *] GT 0, age25meanFcount)
          age26Mmean = where(mean_length_at_ageF[26, *] GT 0, age26meanFcount)
          IF age0meanFcount GT 0 THEN Female_N_ageclass[0, 1] = TOTAL(WAE_length_meanF[10, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age0meanFcount
          IF age1meanFcount GT 0 THEN Female_N_ageclass[1, 1] = TOTAL(WAE_length_meanF[11, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age1meanFcount
          IF age2meanFcount GT 0 THEN Female_N_ageclass[2, 1] = TOTAL(WAE_length_meanF[12, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age2meanFcount
          IF age3meanFcount GT 0 THEN Female_N_ageclass[3, 1] = TOTAL(WAE_length_meanF[13, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age3meanFcount
          IF age4meanFcount GT 0 THEN Female_N_ageclass[4, 1] = TOTAL(WAE_length_meanF[14, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age4meanFcount
          IF age5meanFcount GT 0 THEN Female_N_ageclass[5, 1] = TOTAL(WAE_length_meanF[15, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age5meanFcount
          IF age6meanFcount GT 0 THEN Female_N_ageclass[6, 1] = TOTAL(WAE_length_meanF[16, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age6meanFcount
          IF age7meanFcount GT 0 THEN Female_N_ageclass[7, 1] = TOTAL(WAE_length_meanF[17, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age7meanFcount
          IF age8meanFcount GT 0 THEN Female_N_ageclass[8, 1] = TOTAL(WAE_length_meanF[18, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age8meanFcount
          IF age9meanFcount GT 0 THEN Female_N_ageclass[9, 1] = TOTAL(WAE_length_meanF[19, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age9meanFcount
          IF age10meanFcount GT 0 THEN Female_N_ageclass[10, 1] = TOTAL(WAE_length_meanF[20, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age10meanFcount
          IF age11meanFcount GT 0 THEN Female_N_ageclass[11, 1] = TOTAL(WAE_length_meanF[21, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age11meanFcount
          IF age12meanFcount GT 0 THEN Female_N_ageclass[12, 1] = TOTAL(WAE_length_meanF[22, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age12meanFcount
          IF age13meanFcount GT 0 THEN Female_N_ageclass[13, 1] = TOTAL(WAE_length_meanF[23, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age13meanFcount
          IF age14meanFcount GT 0 THEN Female_N_ageclass[14, 1] = TOTAL(WAE_length_meanF[24, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age14meanFcount
          IF age15meanFcount GT 0 THEN Female_N_ageclass[15, 1] = TOTAL(WAE_length_meanF[25, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age15meanFcount
          IF age16meanFcount GT 0 THEN Female_N_ageclass[16, 1] = TOTAL(WAE_length_meanF[26, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age16meanFcount
          IF age17meanFcount GT 0 THEN Female_N_ageclass[17, 1] = TOTAL(WAE_length_meanF[27, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age17meanFcount
          IF age18meanFcount GT 0 THEN Female_N_ageclass[18, 1] = TOTAL(WAE_length_meanF[28, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age18meanFcount
          IF age19meanFcount GT 0 THEN Female_N_ageclass[19, 1] = TOTAL(WAE_length_meanF[29, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age19meanFcount
          IF age20meanFcount GT 0 THEN Female_N_ageclass[20, 1] = TOTAL(WAE_length_meanF[30, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age20meanFcount
          IF age21meanFcount GT 0 THEN Female_N_ageclass[21, 1] = TOTAL(WAE_length_meanF[31, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age21meanFcount
          IF age22meanFcount GT 0 THEN Female_N_ageclass[22, 1] = TOTAL(WAE_length_meanF[32, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age22meanFcount
          IF age23meanFcount GT 0 THEN Female_N_ageclass[23, 1] = TOTAL(WAE_length_meanF[33, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age23meanFcount
          IF age24meanFcount GT 0 THEN Female_N_ageclass[24, 1] = TOTAL(WAE_length_meanF[34, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age24meanFcount
          IF age25meanFcount GT 0 THEN Female_N_ageclass[25, 1] = TOTAL(WAE_length_meanF[35, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age25meanFcount
          IF age26meanFcount GT 0 THEN Female_N_ageclass[26, 1] = TOTAL(WAE_length_meanF[36, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age26meanFcount
          PRINT, 'Mean length-at-age for females'
          PRINT, Female_N_ageclass[*, 1]
          ; Store mean length-at-age in output arrays
          paramset[40L:66, i] = Total_N_ageclass[*, 1]
          paramsetM[40L:66, i] = Male_N_ageclass[*, 1]
          paramsetF[40L:66, i] = Female_N_ageclass[*, 1]
          paramsetU[40L:66, i] = Total_N_ageclass[*, 1]


          ; Convert mean length-at-age to mass-at-age  ***use population-level length-mass functions***
          ;Mean_mass = FLTARR(27L, 1)
          Mean_mass = 1.5868E-006*Total_N_ageclass[*, 1]^3.2962
          Mean_massM = 2.7673E-006*Male_N_ageclass[*, 1]^3.1984
          Mean_massF = 3.0031E-006*Female_N_ageclass[*, 1]^3.1988
          Mean_massU = 1.5868E-006*Total_N_ageclass[*, 1]^3.2962
          PRINT, 'Mean mass-at-age'
          PRINT, Mean_mass
          PRINT, 'Mean mass-at-age for males'
          PRINT, Mean_massM
          PRINT, 'Mean mass-at-age for females'
          PRINT, Mean_massF
          ; Store in the output arrays
          paramset[67L:93, i] = Mean_mass
          paramsetM[67L:93, i] = Mean_massM
          paramsetF[67L:93, i] = Mean_massF
          paramsetU[67L:93, i] = Mean_massU

          ; check if there is mass-at-age exists
          ; ALL FISH
          Age_NOmass = WHERE(Mean_mass LE 0, Age_NOmasscount)
          Age_Wmass = WHERE(Mean_mass GT 0, Age_Wmasscount)
          IF Age_Wmasscount GT 0. THEN PRINT, 'age class with mass data', Age_Wmass
          IF Age_NOmasscount GT 0. THEN PRINT, 'age class without mass data', Age_NOmass
          PRINT, 'max age class with mass', max(Age_Wmass)
          PRINT, 'min age class with mass', min(Age_Wmass)
          Age_mass_index = INDGEN(27)
          Age_NOmass_Intrpl = WHERE((Age_NOmass GT MIN(Age_Wmass)) AND (Age_NOmass LT MAX(Age_Wmass)), Age_NOmass_Intrplcount)
          IF Age_NOmass_Intrplcount GT 0 THEN PRINT, 'age class mass need interpolation', Age_NOmass[Age_NOmass_Intrpl]
          ; MALE
          Age_NOmassM = WHERE(Mean_massM LE 0, Age_NOmassMcount)
          Age_WmassM = WHERE(Mean_massM GT 0, Age_WmassMcount)
          IF Age_WmassMcount GT 0. THEN PRINT, 'age class with mass data', Age_WmassM
          IF Age_NOmassMcount GT 0. THEN PRINT, 'age class without mass data', Age_NOmassM
          PRINT, 'max age class with mass', max(Age_WmassM)
          PRINT, 'min age class with mass', min(Age_WmassM)
          Age_mass_indexM = INDGEN(27)
          Age_NOmass_IntrplM = WHERE((Age_NOmassM GT min(Age_WmassM)) AND (Age_NOmassM LT max(Age_WmassM)), Age_NOmass_IntrplMcount)
          IF Age_NOmass_IntrplMcount GT 0 THEN PRINT, 'age class mass need interpolation', Age_NOmassM[Age_NOmass_IntrplM]
          ; FEMALE
          Age_NOmassF = WHERE(Mean_massF LE 0, Age_NOmassFcount)
          Age_WmassF = WHERE(Mean_massF GT 0, Age_WmassFcount)
          IF Age_WmassFcount GT 0. THEN PRINT, 'age class with mass data', Age_WmassF
          IF Age_NOmassFcount GT 0. THEN PRINT, 'age class without mass data', Age_NOmassF
          PRINT, 'max age class with mass', max(Age_WmassF)
          PRINT, 'min age class with mass', min(Age_WmassF)
          Age_mass_indexF = INDGEN(27)
          Age_NOmass_IntrplF = WHERE((Age_NOmassF GT min(Age_WmassF)) AND (Age_NOmassF LT max(Age_WmassF)), Age_NOmass_IntrplFcount)
          IF Age_NOmass_IntrplFcount GT 0 THEN PRINT, 'age class mass need interpolation', Age_NOmassF[Age_NOmass_IntrplF]

          ; calculate biomass-at-age - BIOMASS = MASS x N 
          ;Biomass_ageclass = fltarr(27L, 1)
          Biomass_ageclass = Mean_mass*ROUND(Prop_ageclass[*, 0]*PE[INDEX_lengthdata[0]])
          Biomass_ageclass[0] = Mean_mass[0]*YOY_PE[i]
          PRINT, 'Biomass-at-age (g) - ALL FISH'
          PRINT, Biomass_ageclass
          Biomass_ageclassM = Mean_massM*ROUND(Prop_ageclass[*, 1]*PE[INDEX_lengthdata[0]])
          PRINT, 'Biomass-at-age (g) - MALE'
          PRINT, Biomass_ageclassM
          Biomass_ageclassF = Mean_massF*ROUND(Prop_ageclass[*, 2]*PE[INDEX_lengthdata[0]])
          PRINT, 'Biomass-at-age (g) - FEMALE'
          PRINT, Biomass_ageclassF
          Biomass_ageclassU = Mean_massU*ROUND(Prop_ageclass[*, 3]*PE[INDEX_lengthdata[0]])
          Biomass_ageclassU[0] = Mean_massU[0]*YOY_PE[i]
          PRINT, 'Biomass-at-age (g) - UNKNOWN'
          PRINT, Biomass_ageclassU
          ; Store in the output arrays
          paramset[94L:120, i] = Biomass_ageclass
          paramsetM[94L:120, i] = Biomass_ageclassM
          paramsetF[94L:120, i] = Biomass_ageclassF
          paramsetU[94L:120, i] = Biomass_ageclassU

          ; calculate total and age-specific growth production
          ; total
          Growth_mass = fltarr(27L, 1)
          Mean_biomass = fltarr(27L, 1)
          Production = fltarr(27L, 1)
          FOR Agei = 1L, 26L DO BEGIN
            IF (Agei GE MIN(Age_Wmass)) AND (Agei LT MAX(Age_Wmass)) THEN BEGIN
              IF (Mean_mass[Agei-1L, 0] GT 0.) AND (Mean_mass[Agei, 0] GT 0.) THEN BEGIN
                Growth_mass[Agei, 0] = ALOG(Mean_mass[Agei, 0]/Mean_mass[Agei-1L, 0]); instantanepous rate of growth
                Mean_biomass[Agei, 0] = MEAN(Biomass_ageclass[Agei-1L:Agei, 0]); B hat
                Production[Agei, 0] = Growth_mass[Agei, 0] * Mean_biomass[Agei, 0]; PRODUCTION = B HAT x GROWTH 
              ENDIF
            ENDIF
          ENDFOR
          PRINT, 'Mean growth in mass'
          PRINT, Growth_mass
          PRINT, 'Mean biomass (Bhat)'
          PRINT, Mean_biomass
          PRINT, 'Production'
          PRINT, Production
          paramset[121L:147, i] = Growth_mass
          paramset[148L:174, i] = Mean_biomass
          paramset[175L:201, i] = Production

          ; male
          Growth_massM = fltarr(27L, 1)
          Mean_biomassM = fltarr(27L, 1)
          ProductionM = fltarr(27L, 1)
          ;IF (Mean_mass[3, 0] GT 0) AND (Mean_mass[4, 0] GT 0) THEN Growth_mass[0, 0] = Mean_mass[4, 0] - Mean_mass[3, 0]
          FOR Agei = 1L, 26L DO BEGIN
            IF (Agei GE MIN(Age_WmassM)) AND (Agei LT MAX(Age_WmassM)) THEN BEGIN
              ;print, 'agei', agei
              IF (Mean_massM[Agei-1L, 0] GT 0.) AND (Mean_massM[Agei, 0] GT 0.) THEN BEGIN
                Growth_massM[Agei, 0] = ALOG(Mean_massM[Agei, 0]/Mean_massM[Agei-1L, 0])
                Mean_biomassM[Agei, 0] = MEAN(Biomass_ageclassM[Agei-1L:Agei, 0])
                ProductionM[Agei, 0] = Growth_massM[Agei, 0] * Mean_biomassM[Agei, 0]
              ENDIF
            ENDIF
          ENDFOR
          PRINT, 'Mean growth in mass - MALES'
          PRINT, Growth_massM
          PRINT, 'Mean biomass (Bhat) - MALE'
          PRINT, Mean_biomassM
          PRINT, 'Production - MALE'
          PRINT, ProductionM
          paramsetM[121L:147, i] = Growth_massM
          paramsetM[148L:174, i] = Mean_biomassM
          paramsetM[175L:201, i] = ProductionM

          ; female
          Growth_massF = fltarr(27L, 1)
          Mean_biomassF = fltarr(27L, 1)
          ProductionF = fltarr(27L, 1)
          FOR Agei = 1L, 26L DO BEGIN
            IF (Agei GE MIN(Age_WmassF)) AND (Agei LT MAX(Age_WmassF)) THEN BEGIN
              ;print, 'agei', agei
              IF (Mean_massF[Agei-1L, 0] GT 0.) AND (Mean_massF[Agei, 0] GT 0.) THEN BEGIN
                Growth_massF[Agei, 0] = ALOG(Mean_massF[Agei, 0]/Mean_massF[Agei-1L, 0])
                Mean_biomassF[Agei, 0] = MEAN(Biomass_ageclassF[Agei-1L:Agei, 0])
                ProductionF[Agei, 0] = Growth_massF[Agei, 0] * Mean_biomassM[Agei, 0]
              ENDIF
            ENDIF
          ENDFOR
          PRINT, 'Mean growth in mass - FEMALES'
          PRINT, Growth_massF
          PRINT, 'Mean biomass (Bhat) - FEMALE'
          PRINT, Mean_biomassF
          PRINT, 'Production - FEMALE'
          PRINT, ProductionF
          paramsetF[121L:147, i] = Growth_massF
          paramsetF[148L:174, i] = Mean_biomassF
          paramsetF[175L:201, i] = ProductionF

          ; unknown
          Growth_massU = fltarr(27L, 1)
          Mean_biomassU = fltarr(27L, 1)
          ProductionU = fltarr(27L, 1)
          FOR Agei = 1L, 26L DO BEGIN
            IF (Agei GE MIN(Age_Wmass)) AND (Agei LT MAX(Age_Wmass)) THEN BEGIN
              ;print, 'agei', agei
              IF (Mean_mass[Agei-1L, 0] GT 0.) AND (Mean_mass[Agei, 0] GT 0.) THEN BEGIN
                Growth_massU[Agei, 0] = ALOG(Mean_mass[Agei, 0]/Mean_mass[Agei-1L, 0])
                Mean_biomassU[Agei, 0] = MEAN(Biomass_ageclassU[Agei-1L:Agei, 0])
                ProductionU[Agei, 0] = Growth_massU[Agei, 0] * Mean_biomassU[Agei, 0]
              ENDIF
            ENDIF
          ENDFOR
          PRINT, 'Mean growth in mass - UNKNOWN'
          PRINT, Growth_massU
          PRINT, 'Mean biomass (Bhat) - UNKNOWN'
          PRINT, Mean_biomassU
          PRINT, 'Production - UNKOWN'
          PRINT, ProductionU
          paramsetU[121L:147, i] = Growth_massU
          paramsetU[148L:174, i] = Mean_biomassU
          paramsetU[175L:201, i] = ProductionU

          ; create age-specific biomass plots
          maleBiomass=Biomass_ageclassM/1000.
          femaleBiomass=Biomass_ageclassF/1000.
          unknownBiomass=Biomass_ageclassU/1000.

          !p.font=0
          ;Device, Set_Character_Size=[8,12]
          Device, Get_Decomposed=currentState
          DEVICE, SET_FONT='Courier', /TT_FONT
          DEVICE, DECOMPOSED=0
          cgDisplay, 750, 400, WID=0
          ;!P.Multi = [0,2,1]
          labels = INDGEN(27); ['Exp 1', 'Exp 2', 'Exp 3', 'Exp 4', 'Exp 5']
          cgLoadct, 33, Clip=[10,245]
          cgBarPlot, maleBiomass,  YRange=[0,MAX(maleBiomass+femaleBiomass+unknownBiomass)*1.3], Colors='BLUE', BarNames=labels $
            , xtitle='Age (years)'$
            , ytitle='Biomass (Kg)' $;, xrange=[0, 25]
            , title='Biomass distribution of WI walleye - '+'WBIC: '+STRING(WBIC[INDEX_lengthdata[0]], FORMAT = '(I7)') $
            +'_Year: '+STRING(fix(SurveyYear[INDEX_lengthdata[0]]), FORMAT = '(I4)')+STOCK
          ;XYOutS, ROUND(MEDIAN(INDGEN(27))), ROUND(0.5*(MAX(paramset[13:39, i]))*1.3), Orientation=90.0, /DEVICE
          cgBarPlot, femaleBiomass, Colors='RED', /Overplot, BaseLines=maleBiomass
          cgBarPlot, unknownBiomass, Colors='dark green', /Overplot, BaseLines=maleBiomass+femaleBiomass
          items = ['Male', 'Female', 'Unknown']
          colors = ['BLUE', 'RED', 'dark green']
          AL_Legend, items, Colors=colors, PSym=Replicate(15,3), SymSize=Replicate(1.75,3), $
            Charsize=cgDefCharsize(), Position=[0.75, 0.85], /Normal
          ; file name for WBIC-year-specific age structure
          filename='Walleye biomass'+ STRING(WBIC[INDEX_lengthdata[0]], FORMAT = '(I7)') $
            +'_'+STRING(fix(SurveyYear[INDEX_lengthdata[0]]), FORMAT = '(I4)')+'.png'
          WRITE_PNG, filename, TVRD(/TRUE)
          DEVICE, DECOMPOSED=old_decomposed
          !p.font=1

          paramset[94L:120, i] = Biomass_ageclass

          Growth_mass = fltarr(27L, 1)
          Mean_biomass = fltarr(27L, 1)
          Production = fltarr(27L, 1)
          FOR Agei = 1L, 26L DO BEGIN
            IF (Agei GE MIN(Age_Wmass)) AND (Agei LT MAX(Age_Wmass)) THEN BEGIN
              ;print, 'agei', agei
              IF (Mean_mass[Agei-1L, 0] GT 0.) AND (Mean_mass[Agei, 0] GT 0.) THEN BEGIN
                Growth_mass[Agei, 0] = ALOG(Mean_mass[Agei, 0]/Mean_mass[Agei-1L, 0])
                Mean_biomass[Agei, 0] = MEAN(Biomass_ageclass[Agei-1L:Agei, 0])
                Production[Agei, 0] = Growth_mass[Agei, 0] * Mean_biomass[Agei, 0]
              ENDIF
            ENDIF
          ENDFOR
          PRINT, 'Mean growth in mass'
          PRINT, Growth_mass
          PRINT, 'Mean biomass (Bhat)'
          PRINT, Mean_biomass
          PRINT, 'Production'
          PRINT, Production
          paramset[121L:147, i] = Growth_mass; mean growth w/o sex-specific conversion
          paramset[148L:174, i] = Mean_biomassM + Mean_biomassF + Mean_biomassU
          paramset[175L:201, i] = ProductionM + ProductionF + ProductionU  
          ; *******GAPS IN AGE CLASSS STILL NEED TO be INTERPOLATED!!!!!!!!!!!!!!!!!
          
          ; Total biomass
          PRINT, 'Population estimate (PE)', PE[INDEX_lengthdata[0]]
          PRINT, 'Lake area (km2)', LakeArea[INDEX_lengthdata[0]]/1000000.; lake area (km2)
          ; Total biomass - ALL FISH
          IF (LakeArea[INDEX_lengthdata[0]] GT 0.) THEN Total_biomass[i] = TOTAL(Biomass_ageclass[*, 0]) / LakeArea[INDEX_lengthdata[0]]*1000000./1000.
          ; MALE
          IF (LakeArea[INDEX_lengthdata[0]] GT 0.) THEN Total_biomassM[i] = TOTAL(Biomass_ageclassM[*, 0]) / LakeArea[INDEX_lengthdata[0]]*1000000./1000.
          PRINT, 'Total biomass - MALE (kg/km2)'
          PRINT, Total_biomassM[i]
          ; FEMLAE
          IF (LakeArea[INDEX_lengthdata[0]] GT 0.) THEN Total_biomassF[i] = TOTAL(Biomass_ageclassF[*, 0]) / LakeArea[INDEX_lengthdata[0]]*1000000./1000.
          PRINT, 'Total biomass - FEMALE (kg/km2)'
          PRINT, Total_biomassF[i]
          ; UNKNOWN
          IF (LakeArea[INDEX_lengthdata[0]] GT 0.) THEN Total_biomassU[i] = TOTAL(Biomass_ageclassU[*, 0]) / LakeArea[INDEX_lengthdata[0]]*1000000./1000.
          PRINT, 'Total biomass - UNKWON (kg/km2)'
          PRINT, Total_biomassU[i]        
          
          paramset[202, i] = Total_biomassM[i] +  Total_biomassF[i] + Total_biomassU[i]
          PRINT, 'Total biomass (kg/km2)'
          PRINT, Total_biomass[i], paramset[202, i]

          ; Total production
          ; ALL FISH
          Pos_production = WHERE(Production[*, 0] GT 0., Pos_productioncount); negative age-specific production is converted to 0
          IF (Pos_productioncount GT 0.) AND (LakeArea[INDEX_lengthdata[0]] GT 0.) THEN Total_production[i] = TOTAL(Production[Pos_production, 0]) $
            / LakeArea[INDEX_lengthdata[0]]*1000000./1000.
          ; MALE
          Pos_productionM = WHERE(ProductionM[*, 0] GT 0., Pos_productionMcount); negative age-specific production is converted to 0
          IF (Pos_productionMcount GT 0.) AND (LakeArea[INDEX_lengthdata[0]] GT 0.) THEN Total_productionM[i] = TOTAL(ProductionM[Pos_productionM, 0]) $
            / LakeArea[INDEX_lengthdata[0]]*1000000./1000.
          ; FEMALE
          Pos_productionF = WHERE(ProductionF[*, 0] GT 0., Pos_productionFcount); negative age-specific production is converted to 0
          IF (Pos_productionFcount GT 0.) AND (LakeArea[INDEX_lengthdata[0]] GT 0.) THEN Total_productionF[i] = TOTAL(ProductionF[Pos_productionF, 0]) $
            / LakeArea[INDEX_lengthdata[0]]*1000000./1000.           
           ; UNKNOWN
          Pos_productionU = WHERE(ProductionU[*, 0] GT 0., Pos_productionUcount); negative age-specific production is converted to 0
          IF (Pos_productionMcount GT 0.) AND (LakeArea[INDEX_lengthdata[0]] GT 0.) THEN Total_productionU[i] = TOTAL(ProductionU[Pos_productionU, 0]) $
            / LakeArea[INDEX_lengthdata[0]]*1000000./1000. 
          
          paramset[203, i] = Total_productionM[i] + Total_productionF[i] + Total_productionU[i]
          PRINT, 'Total Production (kg/km2/year)'
          PRINT, Total_production[i], paramset[203, i]
          
          ; PRODUCTION/BIOMASS
          Pos_biomass = WHERE(Total_biomass[i] GT 0., Pos_biomasscount); negative age-specific production is converted to 0
          IF Pos_biomasscount GT 0. THEN P_over_B[i] = Total_production[i] / Total_biomass[i]
          PRINT, 'P/B'
          PRINT, P_over_B[i]
          IF Pos_biomasscount GT 0. THEN P_over_B[i] = paramset[203, i] / paramset[202, i]
          PRINT, 'P/B'
          PRINT, P_over_B[i]          
          paramset[204L, i] = P_over_B[i]

          ; Adult estimates (w/ only >age 3)
          ; Biomass - ALL FISH
          IF (LakeArea[INDEX_lengthdata[0]] GT 0.) THEN Total_biomass_adult[i] = TOTAL(Biomass_ageclass[3L:26L, 0]) / LakeArea[INDEX_lengthdata[0]]*1000000./1000.
          PRINT, 'Total adult biomass (kg/km2)'
          PRINT, Total_biomass_adult[i]
          ; Biomass - MALE
          IF (LakeArea[INDEX_lengthdata[0]] GT 0.) THEN Total_biomass_adultM[i] = TOTAL(Biomass_ageclassM[3L:26L, 0]) / LakeArea[INDEX_lengthdata[0]]*1000000./1000.
          PRINT, 'Total adult biomass - MALE (kg/km2)'
          PRINT, Total_biomass_adultM[i]
          ; Biomass - FEMALE
          IF (LakeArea[INDEX_lengthdata[0]] GT 0.) THEN Total_biomass_adultF[i] = TOTAL(Biomass_ageclassF[3L:26L, 0]) / LakeArea[INDEX_lengthdata[0]]*1000000./1000.
          PRINT, 'Total adult biomass - FEMALE (kg/km2)'
          PRINT, Total_biomass_adultF[i]          
          ; Biomass - UNKWON
          IF (LakeArea[INDEX_lengthdata[0]] GT 0.) THEN Total_biomass_adultU[i] = TOTAL(Biomass_ageclassU[3L:26L, 0]) / LakeArea[INDEX_lengthdata[0]]*1000000./1000.
          PRINT, 'Total adult biomass - UNKNOWN (kg/km2)'
          PRINT, Total_biomass_adultU[i]    

          paramset[205, i] = Total_biomass_adultM[i] +  Total_biomass_adultF[i] + Total_biomass_adultU[i]
          PRINT, 'Total biomass (kg/km2)'
          PRINT, Total_biomass_adult[i], paramset[205, i]

          ; Adult production estimates - ALL FISH
          Growth_mass_adult = fltarr(27L, 1)
          Mean_biomass_adult = fltarr(27L, 1)
          Production_adult = fltarr(27L, 1)
          FOR Agei = 0L, 26L DO BEGIN
            IF (Agei GE 3L) AND (Agei LT MAX(Age_Wmass)) THEN BEGIN
              IF (Mean_mass[Agei-1L, 0] GT 0.) AND (Mean_mass[Agei, 0] GT 0.) THEN BEGIN
                Growth_mass_adult[Agei, 0] = ALOG(Mean_mass[Agei, 0]/Mean_mass[Agei-1L, 0])
                Mean_biomass_adult[Agei, 0] = MEAN(Biomass_ageclass[Agei-1L:Agei, 0])
                Production_adult[Agei, 0] = Growth_mass_adult[Agei, 0] * Mean_biomass_adult[Agei, 0]
              ENDIF
            ENDIF
          ENDFOR
          ; Adult production estimates - MALE
          Growth_mass_adultM = fltarr(27L, 1)
          Mean_biomass_adultM = fltarr(27L, 1)
          Production_adultM = fltarr(27L, 1)
          FOR Agei = 0L, 26L DO BEGIN
            IF (Agei GE 3L) AND (Agei LT MAX(Age_WmassM)) THEN BEGIN
              IF (Mean_massM[Agei-1L, 0] GT 0.) AND (Mean_massM[Agei, 0] GT 0.) THEN BEGIN
                Growth_mass_adultM[Agei, 0] = ALOG(Mean_massM[Agei, 0]/Mean_massM[Agei-1L, 0])
                Mean_biomass_adultM[Agei, 0] = MEAN(Biomass_ageclassM[Agei-1L:Agei, 0])
                Production_adultM[Agei, 0] = Growth_mass_adultM[Agei, 0] * Mean_biomass_adultM[Agei, 0]
              ENDIF
            ENDIF
          ENDFOR
          ; Adult production estimates - FEMALE
          Growth_mass_adultF = fltarr(27L, 1)
          Mean_biomass_adultF = fltarr(27L, 1)
          Production_adultF = fltarr(27L, 1)
          FOR Agei = 0L, 26L DO BEGIN
            IF (Agei GE 3L) AND (Agei LT MAX(Age_WmassF)) THEN BEGIN
              IF (Mean_massF[Agei-1L, 0] GT 0.) AND (Mean_massF[Agei, 0] GT 0.) THEN BEGIN
                Growth_mass_adultF[Agei, 0] = ALOG(Mean_massF[Agei, 0]/Mean_massF[Agei-1L, 0])
                Mean_biomass_adultF[Agei, 0] = MEAN(Biomass_ageclassF[Agei-1L:Agei, 0])
                Production_adultF[Agei, 0] = Growth_mass_adultF[Agei, 0] * Mean_biomass_adultF[Agei, 0]
              ENDIF
            ENDIF
          ENDFOR
          ; Adult production estimates - UNKNOWN
            Growth_mass_adultU = fltarr(27L, 1)
            Mean_biomass_adultU = fltarr(27L, 1)
            Production_adultU = fltarr(27L, 1)
            FOR Agei = 0L, 26L DO BEGIN
              IF (Agei GE 3L) AND (Agei LT MAX(Age_Wmass)) THEN BEGIN
                IF (Mean_massU[Agei-1L, 0] GT 0.) AND (Mean_massU[Agei, 0] GT 0.) THEN BEGIN
                  Growth_mass_adultU[Agei, 0] = ALOG(Mean_massU[Agei, 0]/Mean_massU[Agei-1L, 0])
                  Mean_biomass_adultU[Agei, 0] = MEAN(Biomass_ageclassU[Agei-1L:Agei, 0])
                  Production_adultU[Agei, 0] = Growth_mass_adultU[Agei, 0] * Mean_biomass_adultU[Agei, 0]
                ENDIF
              ENDIF
            ENDFOR

          ; ALL FISH
          Pos_production_adult = WHERE(Production_adult[*, 0] GT 0., Pos_production_adultcount); ***negative age-specific production is converted to 0
          PRINT, 'Array index for positive adult production', Pos_production_adult
          IF (Pos_production_adultcount GT 0.) AND (LakeArea[INDEX_lengthdata[0]] GT 0.)  THEN Total_production_adult[i] = TOTAL(Production_adult[Pos_production_adult, 0]) $
            / LakeArea[INDEX_lengthdata[0]]*1000000./1000.
          ; MALE
          Pos_production_adultM = WHERE(Production_adultM[*, 0] GT 0., Pos_production_adultMcount); ***negative age-specific production is converted to 0
          PRINT, 'Array index for positive adult production - MALE', Pos_production_adultM
          IF (Pos_production_adultMcount GT 0.) AND (LakeArea[INDEX_lengthdata[0]] GT 0.)  THEN Total_production_adultM[i] $
              = TOTAL(Production_adultM[Pos_production_adultM, 0]) / LakeArea[INDEX_lengthdata[0]]*1000000./1000.           
          ; FEMALE
          Pos_production_adultF = WHERE(Production_adultF[*, 0] GT 0., Pos_production_adultFcount); ***negative age-specific production is converted to 0
          PRINT, 'Array index for positive adult production - FEMALE', Pos_production_adultF
          IF (Pos_production_adultFcount GT 0.) AND (LakeArea[INDEX_lengthdata[0]] GT 0.)  THEN Total_production_adultF[i] $
              = TOTAL(Production_adultF[Pos_production_adultF, 0]) / LakeArea[INDEX_lengthdata[0]]*1000000./1000.           
          ; UNKNOWN
          Pos_production_adultU = WHERE(Production_adultU[*, 0] GT 0., Pos_production_adultUcount); ***negative age-specific production is converted to 0
          PRINT, 'Array index for positive adult production - UNKNOWN', Pos_production_adultU
          IF (Pos_production_adultUcount GT 0.) AND (LakeArea[INDEX_lengthdata[0]] GT 0.)  THEN Total_production_adultU[i] $
              = TOTAL(Production_adultU[Pos_production_adultU, 0]) / LakeArea[INDEX_lengthdata[0]]*1000000./1000.
            
          paramset[206L, i] = Total_production_adultM[i] + Total_production_adultF[i] + Total_production_adultU[i]
          PRINT, 'Total adult Production (kg/km2/year)'
          PRINT, Total_production_adult[i], paramset[206L, i]
          IF LakeArea[INDEX_lengthdata[0]] GT 0 THEN paramset[217, i] = Total_production[i] + Biomass_ageclass[3,0]/LakeArea[INDEX_lengthdata[0]]*1000000./1000.
          PRINT, 'Surplus adult production (kg/km2/year)'
          PRINT, paramset[217L, i]
          
          ; PRODUCTION / BIOMASS
          ; ALL FISH
          Pos_biomass_adult = WHERE(Total_biomass_adult[i] GT 0., Pos_biomass_adultcount); negative age-specific production is converted to 0
          IF Pos_biomass_adultcount GT 0. THEN P_over_B_adult[i] = Total_production_adult[i] / Total_biomass_adult[i]
          PRINT, 'Adult P/B'
          PRINT, P_over_B_adult[i]
          IF Pos_biomass_adultcount GT 0. THEN P_over_B_adult[i] = paramset[206, i] / paramset[205, i]
          PRINT, 'Adult P/B'
          PRINT, P_over_B_adult[i]
          
          paramset[207L, i] = P_over_B_adult[i]
          paramset[208L, i] = PE[INDEX_lengthdata[0]]; population estimate
          paramset[209L, i] = LakeArea[INDEX_lengthdata[0]]/1000000.; lake area (km2)
          
          

                          ;########################################################
                          ;#Calculate harvested fish age structure for production
                          ;########################################################
      
      ; array index for angling data
      INDEX_lengthdataAngl = WHERE((WBIC_year_angl[*] EQ WBIC_year[INDEX_lengthdata[0]]), INDEX_lengthdataAnglcount)
      INDEX_lengthdataAngl2 = WHERE((WBIC_year_key[*] EQ WBIC_Year_angl[INDEX_lengthdataAngl[0]]), INDEX_lengthdataAngl2count)
      
      IF (INDEX_lengthdataAngl2count LE 0) OR (AgeLengthKeyCheck_angl1 GE AgeLengthKeyLevel) THEN BEGIN; if there is no lake-year-specific key...

      IF (INDEX_lengthdataAnglcount GT 0) THEN BEGIN; if angling data exist...
        PRINT, 'WBIC_angl', WBIC_year_angl[INDEX_lengthdataAngl[0]]
        PRINT, 'Harvest data availabile'
        N_Lake_angl = N_Lake_angl + 1L
        PRINT, 'N of lake-year with harvest data', N_Lake_angl

        ;IF INDEX_lengthdataAnglcount GT 0 then begin
        Length_prod_angl = Length_angl[INDEX_lengthdataAngl]; WBIC_year data
        FishAgeAngl = AgeArrayAngl[INDEX_lengthdataAngl]; assigned age
        FishLengthAngl = LengthArrayAngl[INDEX_lengthdataAngl]; length check
        ;PRINT, 'Length_prod_angl', length[INDEX_lengthdata]

        paramset_angl[0, i] = uniqWBIC_Year[i]; WBIC_year (abbrev)
        paramset_angl[1, i] = WBIC_angl[INDEX_lengthdataAngl[0]]; WBIC
        paramset_angl[2, i] = SurveyYear_angl[INDEX_lengthdataAngl[0]]; year
        paramset_angl[3, i] = N_ELements(Length_prod_angl); N of fish
        paramset_angl[7, i] = Max(length_angl[INDEX_lengthdataAngl])
        paramset_angl[8, i] = Min(length_angl[INDEX_lengthdataAngl])

        paramset_angl[218, i] = MEAN(length_angl[INDEX_lengthdataAngl]); mean length for all fish
        paramset_angl[219, i] = STDDEV(length_angl[INDEX_lengthdataAngl]); SD length for all fish
        paramset_angl[222, i] = legal_size[INDEX_lengthdataAngl[0]]; legal size
        
        print, 'N of fish', paramset_angl[3, i];, malecount+femalecount+unknowncount
        print, 'WBIC', paramset_angl[1, i]
        print, 'Year', paramset_angl[2, i]
        print, 'Max length (mm)', Max(length_angl[INDEX_lengthdataAngl])
        print, 'Min length (mm)', Min(length_angl[INDEX_lengthdataAngl])

        ; Length group distributions - all fish
        SizeLT100_angl = WHERE(Length_prod_angl LT 100., SizeLT100_anglcount)
        Size100to120_angl = WHERE((Length_prod_angl GE 100.) AND (Length_prod_angl LT 120.), Size100to120_anglcount)
        Size120to140_angl = WHERE((Length_prod_angl GE 120.) AND (Length_prod_angl LT 140.), Size120to140_anglcount)
        Size140to160_angl = WHERE((Length_prod_angl GE 140.) AND (Length_prod_angl LT 160.), Size140to160_anglcount)
        Size160to180_angl = WHERE((Length_prod_angl GE 160.) AND (Length_prod_angl LT 180.), Size160to180_anglcount)
        Size180to200_angl = WHERE((Length_prod_angl GE 180.) AND (Length_prod_angl LT 200.), Size180to200_anglcount)
        Size200to220_angl = WHERE((Length_prod_angl GE 200.) AND (Length_prod_angl LT 220.), Size200to220_anglcount)
        Size220to240_angl = WHERE((Length_prod_angl GE 220.) AND (Length_prod_angl LT 240.), Size220to240_anglcount)
        Size240to260_angl = WHERE((Length_prod_angl GE 240.) AND (Length_prod_angl LT 260.), Size240to260_anglcount)
        Size260to280_angl = WHERE((Length_prod_angl GE 260.) AND (Length_prod_angl LT 280.), Size260to280_anglcount)
        Size280to300_angl = WHERE((Length_prod_angl GE 280.) AND (Length_prod_angl LT 300.), Size280to300_anglcount)
        Size300to320_angl = WHERE((Length_prod_angl GE 300.) AND (Length_prod_angl LT 320.), Size300to320_anglcount)
        Size320to340_angl = WHERE((Length_prod_angl GE 320.) AND (Length_prod_angl LT 340.), Size320to340_anglcount)
        Size340to360_angl = WHERE((Length_prod_angl GE 340.) AND (Length_prod_angl LT 360.), Size340to360_anglcount)
        Size360to380_angl = WHERE((Length_prod_angl GE 360.) AND (Length_prod_angl LT 380.), Size360to380_anglcount)
        Size380to400_angl = WHERE((Length_prod_angl GE 380.) AND (Length_prod_angl LT 400.), Size380to400_anglcount)
        Size400to420_angl = WHERE((Length_prod_angl GE 400.) AND (Length_prod_angl LT 420.), Size400to420_anglcount)
        Size420to440_angl = WHERE((Length_prod_angl GE 420.) AND (Length_prod_angl LT 440.), Size420to440_anglcount)
        Size440to460_angl = WHERE((Length_prod_angl GE 440.) AND (Length_prod_angl LT 460.), Size440to460_anglcount)
        Size460to480_angl = WHERE((Length_prod_angl GE 460.) AND (Length_prod_angl LT 480.), Size460to480_anglcount)
        Size480to500_angl = WHERE((Length_prod_angl GE 480.) AND (Length_prod_angl LT 500.), Size480to500_anglcount)
        Size500to520_angl = WHERE((Length_prod_angl GE 500.) AND (Length_prod_angl LT 520.), Size500to520_anglcount)
        Size520to540_angl = WHERE((Length_prod_angl GE 520.) AND (Length_prod_angl LT 540.), Size520to540_anglcount)
        Size540to560_angl = WHERE((Length_prod_angl GE 540.) AND (Length_prod_angl LT 560.), Size540to560_anglcount)
        Size560to580_angl = WHERE((Length_prod_angl GE 560.) AND (Length_prod_angl LT 580.), Size560to580_anglcount)
        Size580to600_angl = WHERE((Length_prod_angl GE 580.) AND (Length_prod_angl LT 600.), Size580to600_anglcount)
        Size600to620_angl = WHERE((Length_prod_angl GE 600.) AND (Length_prod_angl LT 620.), Size600to620_anglcount)
        Size620to640_angl = WHERE((Length_prod_angl GE 620.) AND (Length_prod_angl LT 640.), Size620to640_anglcount)
        Size640to660_angl = WHERE((Length_prod_angl GE 640.) AND (Length_prod_angl LT 660.), Size640to660_anglcount)
        Size660to680_angl = WHERE((Length_prod_angl GE 660.) AND (Length_prod_angl LT 680.), Size660to680_anglcount)
        Size680to700_angl = WHERE((Length_prod_angl GE 680.) AND (Length_prod_angl LT 700.), Size680to700_anglcount)
        Size700to720_angl = WHERE((Length_prod_angl GE 700.) AND (Length_prod_angl LT 720.), Size700to720_anglcount)
        Size720to740_angl = WHERE((Length_prod_angl GE 720.) AND (Length_prod_angl LT 740.), Size720to740_anglcount)
        Size740to760_angl = WHERE((Length_prod_angl GE 740.) AND (Length_prod_angl LT 760.), Size740to760_anglcount)
        Size760to780_angl = WHERE((Length_prod_angl GE 760.) AND (Length_prod_angl LT 780.), Size760to780_anglcount)
        Size780to800_angl = WHERE((Length_prod_angl GE 780.) AND (Length_prod_angl LT 800.), Size780to800_anglcount)
        SizeGE800_angl = WHERE((Length_prod_angl GE 800.), SizeGE800_anglcount)
        LengthDist_angl[0, i] = SizeLT100_anglcount
        LengthDist_angl[1, i] = Size100to120_anglcount
        LengthDist_angl[2, i] = Size120to140_anglcount
        LengthDist_angl[3, i] = Size140to160_anglcount
        LengthDist_angl[4, i] = Size160to180_anglcount
        LengthDist_angl[5, i] = Size180to200_anglcount
        LengthDist_angl[6, i] = Size200to220_anglcount
        LengthDist_angl[7, i] = Size220to240_anglcount
        LengthDist_angl[8, i] = Size240to260_anglcount
        LengthDist_angl[9, i] = Size260to280_anglcount
        LengthDist_angl[10, i] = Size280to300_anglcount
        LengthDist_angl[11, i] = Size300to320_anglcount
        LengthDist_angl[12, i] = Size320to340_anglcount
        LengthDist_angl[13, i] = Size340to360_anglcount
        LengthDist_angl[14, i] = Size360to380_anglcount
        LengthDist_angl[15, i] = Size380to400_anglcount
        LengthDist_angl[16, i] = Size400to420_anglcount
        LengthDist_angl[17, i] = Size420to440_anglcount
        LengthDist_angl[18, i] = Size440to460_anglcount
        LengthDist_angl[19, i] = Size460to480_anglcount
        LengthDist_angl[20, i] = Size480to500_anglcount
        LengthDist_angl[21, i] = Size500to520_anglcount
        LengthDist_angl[22, i] = Size520to540_anglcount
        LengthDist_angl[23, i] = Size540to560_anglcount
        LengthDist_angl[24, i] = Size560to580_anglcount
        LengthDist_angl[25, i] = Size580to600_anglcount
        LengthDist_angl[26, i] = Size600to620_anglcount
        LengthDist_angl[27, i] = Size620to640_anglcount
        LengthDist_angl[28, i] = Size640to660_anglcount
        LengthDist_angl[29, i] = Size660to680_anglcount
        LengthDist_angl[30, i] = Size680to700_anglcount
        LengthDist_angl[31, i] = Size700to720_anglcount
        LengthDist_angl[32, i] = Size720to740_anglcount
        LengthDist_angl[33, i] = Size740to760_anglcount
        LengthDist_angl[34, i] = Size760to780_anglcount
        LengthDist_angl[35, i] = Size780to800_anglcount
        LengthDist_angl[36, i] = SizeGE800_anglcount
        PRINT, 'length distribution - angling (bin size = 20mm)', LengthDist_angl[0:36, i]
        LengthDist_angl[37, i] = paramset_angl[1, i]; WBIC
        LengthDist_angl[38, i] = paramset_angl[2, i]; year
        LengthDist_angl[39, i] = paramset_angl[3, i]; sample size
        LengthDist_angl[40, i] = adultPE_angl[INDEX_lengthdataAngl[0]]; adult PE
        LengthDist_angl[41, i] = HarvRate_angl[INDEX_lengthdataAngl[0]]; harvest rate
        
        ; identify empty length bins in spring surveys
        IF (SizeLT100_anglcount GT 0) AND (LengthDist[0, i] LE 0) THEN LengthDist_angl_PLUS[0, i] = SizeLT100_anglcount
        IF (Size100to120_anglcount GT 0) AND (LengthDist[1, i] LE 0) THEN LengthDist_angl_PLUS[1, i] = Size100to120_anglcount
        IF (Size120to140_anglcount GT 0) AND (LengthDist[2, i] LE 0) THEN LengthDist_angl_PLUS[2, i] = Size120to140_anglcount
        IF (Size140to160_anglcount GT 0) AND (LengthDist[3, i] LE 0) THEN LengthDist_angl_PLUS[3, i] = Size140to160_anglcount
        IF (Size160to180_anglcount GT 0) AND (LengthDist[4, i] LE 0) THEN LengthDist_angl_PLUS[4, i] = Size160to180_anglcount
        IF (Size180to200_anglcount GT 0) AND (LengthDist[5, i] LE 0) THEN LengthDist_angl_PLUS[5, i] = Size180to200_anglcount
        IF (Size200to220_anglcount GT 0) AND (LengthDist[6, i] LE 0) THEN LengthDist_angl_PLUS[6, i] = Size200to220_anglcount
        IF (Size220to240_anglcount GT 0) AND (LengthDist[7, i] LE 0) THEN LengthDist_angl_PLUS[7, i] = Size220to240_anglcount
        IF (Size240to260_anglcount GT 0) AND (LengthDist[8, i] LE 0) THEN LengthDist_angl_PLUS[8, i] = Size240to260_anglcount
        IF (Size260to280_anglcount GT 0) AND (LengthDist[9, i] LE 0) THEN LengthDist_angl_PLUS[9, i] = Size260to280_anglcount
        IF (Size280to300_anglcount GT 0) AND (LengthDist[10, i] LE 0) THEN LengthDist_angl_PLUS[10, i] = Size280to300_anglcount
        IF (Size300to320_anglcount GT 0) AND (LengthDist[11, i] LE 0) THEN LengthDist_angl_PLUS[11, i] = Size300to320_anglcount
        IF (Size320to340_anglcount GT 0) AND (LengthDist[12, i] LE 0) THEN LengthDist_angl_PLUS[12, i] = Size320to340_anglcount
        IF (Size340to360_anglcount GT 0) AND (LengthDist[13, i] LE 0) THEN LengthDist_angl_PLUS[13, i] = Size340to360_anglcount
        IF (Size360to380_anglcount GT 0) AND (LengthDist[14, i] LE 0) THEN LengthDist_angl_PLUS[14, i] = Size360to380_anglcount
        IF (Size380to400_anglcount GT 0) AND (LengthDist[15, i] LE 0) THEN LengthDist_angl_PLUS[15, i] = Size380to400_anglcount
        IF (Size400to420_anglcount GT 0) AND (LengthDist[16, i] LE 0) THEN LengthDist_angl_PLUS[16, i] = Size400to420_anglcount
        IF (Size420to440_anglcount GT 0) AND (LengthDist[17, i] LE 0) THEN LengthDist_angl_PLUS[17, i] = Size420to440_anglcount
        IF (Size440to460_anglcount GT 0) AND (LengthDist[18, i] LE 0) THEN LengthDist_angl_PLUS[18, i] = Size440to460_anglcount
        IF (Size460to480_anglcount GT 0) AND (LengthDist[19, i] LE 0) THEN LengthDist_angl_PLUS[19, i] = Size460to480_anglcount
        IF (Size480to500_anglcount GT 0) AND (LengthDist[20, i] LE 0) THEN LengthDist_angl_PLUS[20, i] = Size480to500_anglcount
        IF (Size500to520_anglcount GT 0) AND (LengthDist[21, i] LE 0) THEN LengthDist_angl_PLUS[21, i] = Size500to520_anglcount
        IF (Size520to540_anglcount GT 0) AND (LengthDist[22, i] LE 0) THEN LengthDist_angl_PLUS[22, i] = Size520to540_anglcount
        IF (Size540to560_anglcount GT 0) AND (LengthDist[23, i] LE 0) THEN LengthDist_angl_PLUS[23, i] = Size540to560_anglcount
        IF (Size560to580_anglcount GT 0) AND (LengthDist[24, i] LE 0) THEN LengthDist_angl_PLUS[24, i] = Size560to580_anglcount
        IF (Size580to600_anglcount GT 0) AND (LengthDist[25, i] LE 0) THEN LengthDist_angl_PLUS[25, i] = Size580to600_anglcount
        IF (Size600to620_anglcount GT 0) AND (LengthDist[26, i] LE 0) THEN LengthDist_angl_PLUS[26, i] = Size600to620_anglcount
        IF (Size620to640_anglcount GT 0) AND (LengthDist[27, i] LE 0) THEN LengthDist_angl_PLUS[27, i] = Size620to640_anglcount
        IF (Size640to660_anglcount GT 0) AND (LengthDist[28, i] LE 0) THEN LengthDist_angl_PLUS[28, i] = Size640to660_anglcount
        IF (Size660to680_anglcount GT 0) AND (LengthDist[29, i] LE 0) THEN LengthDist_angl_PLUS[29, i] = Size660to680_anglcount
        IF (Size680to700_anglcount GT 0) AND (LengthDist[30, i] LE 0) THEN LengthDist_angl_PLUS[30, i] = Size680to700_anglcount
        IF (Size700to720_anglcount GT 0) AND (LengthDist[31, i] LE 0) THEN LengthDist_angl_PLUS[31, i] = Size700to720_anglcount
        IF (Size720to740_anglcount GT 0) AND (LengthDist[32, i] LE 0) THEN LengthDist_angl_PLUS[32, i] = Size720to740_anglcount
        IF (Size740to760_anglcount GT 0) AND (LengthDist[33, i] LE 0) THEN LengthDist_angl_PLUS[33, i] = Size740to760_anglcount
        IF (Size760to780_anglcount GT 0) AND (LengthDist[34, i] LE 0) THEN LengthDist_angl_PLUS[34, i] = Size760to780_anglcount
        IF (Size780to800_anglcount GT 0) AND (LengthDist[35, i] LE 0) THEN LengthDist_angl_PLUS[35, i] = Size780to800_anglcount
        IF (SizeGE800_anglcount GT 0) AND (LengthDist[36, i] LE 0) THEN LengthDist_angl_PLUS[36, i] = SizeGE800_anglcount
        IF TOTAL(LengthDist_angl_PLUS[*, i]) GT 0 THEN PRINT, 'length bins w/o spring survey data (bin size = 20mm)', LengthDist_angl_PLUS[0:36, i]
        Prop_LengthDist_angl_PLUS[i] = TOTAL(LengthDist_angl_PLUS[*, i]) / TOTAL(LengthDist_angl[*, i])                      
                      
        ; If fish some elngth bins were not sampled in spring surveys, they were not included in age structure analysis
        IF LengthDist_angl_PLUS[0, i] GT 0 THEN SizeLT100_anglcount = 0
        IF LengthDist_angl_PLUS[1, i] GT 0 THEN Size100to120_anglcount = 0
        IF LengthDist_angl_PLUS[2, i] GT 0 THEN Size120to140_anglcount = 0
        IF LengthDist_angl_PLUS[3, i] GT 0 THEN Size140to160_anglcount = 0
        IF LengthDist_angl_PLUS[4, i] GT 0 THEN Size160to180_anglcount = 0
        IF LengthDist_angl_PLUS[5, i] GT 0 THEN Size180to200_anglcount = 0
        IF LengthDist_angl_PLUS[6, i] GT 0 THEN Size200to220_anglcount = 0
        IF LengthDist_angl_PLUS[7, i] GT 0 THEN Size220to240_anglcount = 0
        IF LengthDist_angl_PLUS[8, i] GT 0 THEN Size240to260_anglcount = 0
        IF LengthDist_angl_PLUS[9, i] GT 0 THEN Size260to280_anglcount = 0
        IF LengthDist_angl_PLUS[10, i] GT 0 THEN Size280to300_anglcount = 0
        IF LengthDist_angl_PLUS[11, i] GT 0 THEN Size300to320_anglcount = 0
        IF LengthDist_angl_PLUS[12, i] GT 0 THEN Size320to340_anglcount = 0
        IF LengthDist_angl_PLUS[13, i] GT 0 THEN Size340to360_anglcount = 0
        IF LengthDist_angl_PLUS[14, i] GT 0 THEN Size360to380_anglcount = 0
        IF LengthDist_angl_PLUS[15, i] GT 0 THEN Size380to400_anglcount = 0
        IF LengthDist_angl_PLUS[16, i] GT 0 THEN Size400to420_anglcount = 0
        IF LengthDist_angl_PLUS[17, i] GT 0 THEN Size420to440_anglcount = 0
        IF LengthDist_angl_PLUS[18, i] GT 0 THEN Size440to460_anglcount = 0
        IF LengthDist_angl_PLUS[19, i] GT 0 THEN Size460to480_anglcount = 0
        IF LengthDist_angl_PLUS[20, i] GT 0 THEN Size480to500_anglcount = 0
        IF LengthDist_angl_PLUS[21, i] GT 0 THEN Size500to520_anglcount = 0
        IF LengthDist_angl_PLUS[22, i] GT 0 THEN Size520to540_anglcount = 0
        IF LengthDist_angl_PLUS[23, i] GT 0 THEN Size540to560_anglcount = 0
        IF LengthDist_angl_PLUS[24, i] GT 0 THEN Size560to580_anglcount = 0
        IF LengthDist_angl_PLUS[25, i] GT 0 THEN Size580to600_anglcount = 0
        IF LengthDist_angl_PLUS[26, i] GT 0 THEN Size600to620_anglcount = 0
        IF LengthDist_angl_PLUS[27, i] GT 0 THEN Size620to640_anglcount = 0
        IF LengthDist_angl_PLUS[28, i] GT 0 THEN Size640to660_anglcount = 0
        IF LengthDist_angl_PLUS[29, i] GT 0 THEN Size660to680_anglcount = 0
        IF LengthDist_angl_PLUS[30, i] GT 0 THEN Size680to700_anglcount = 0
        IF LengthDist_angl_PLUS[31, i] GT 0 THEN Size700to720_anglcount = 0
        IF LengthDist_angl_PLUS[32, i] GT 0 THEN Size720to740_anglcount = 0
        IF LengthDist_angl_PLUS[33, i] GT 0 THEN Size740to760_anglcount = 0
        IF LengthDist_angl_PLUS[34, i] GT 0 THEN Size760to780_anglcount = 0
        IF LengthDist_angl_PLUS[35, i] GT 0 THEN Size780to800_anglcount = 0
        IF LengthDist_angl_PLUS[36, i] GT 0 THEN SizeGE800_anglcount = 0             
                      
        ; array index for WBIC years w/ key
        INDEX_lengthdataAngl3 = WHERE((WBIC_key[*] EQ WBIC_angl[INDEX_lengthdataAngl[0]]), INDEX_lengthdataAngl3count)

        IF (INDEX_lengthdataAngl3count GT 0) THEN BEGIN
          
          length_key_check_angl = fltarr(37)
          IF (SizeLT100_anglcount GT 0) AND (Length_N_fish[INDEX_lengthdataAngl3[0]] LE 0) THEN length_key_check_angl[0] = SizeLT100_anglcount
          IF (Size100to120_anglcount GT 0) AND (Length_N_fish[INDEX_lengthdataAngl3[1]] LE 0) THEN length_key_check_angl[1] = Size100to120_anglcount
          IF (Size120to140_anglcount GT 0) AND (Length_N_fish[INDEX_lengthdataAngl3[2]] LE 0) THEN length_key_check_angl[2] = Size120to140_anglcount
          IF (Size140to160_anglcount GT 0) AND (Length_N_fish[INDEX_lengthdataAngl3[3]] LE 0) THEN length_key_check_angl[3] = Size140to160_anglcount
          IF (Size160to180_anglcount GT 0) AND (Length_N_fish[INDEX_lengthdataAngl3[4]] LE 0) THEN length_key_check_angl[4] = Size160to180_anglcount
          IF (Size180to200_anglcount GT 0) AND (Length_N_fish[INDEX_lengthdataAngl3[5]] LE 0) THEN length_key_check_angl[5] = Size180to200_anglcount
          IF (Size200to220_anglcount GT 0) AND (Length_N_fish[INDEX_lengthdataAngl3[6]] LE 0) THEN length_key_check_angl[6] = Size200to220_anglcount
          IF (Size220to240_anglcount GT 0) AND (Length_N_fish[INDEX_lengthdataAngl3[7]] LE 0) THEN length_key_check_angl[7] = Size220to240_anglcount
          IF (Size240to260_anglcount GT 0) AND (Length_N_fish[INDEX_lengthdataAngl3[8]] LE 0) THEN length_key_check_angl[8] = Size240to260_anglcount
          IF (Size260to280_anglcount GT 0) AND (Length_N_fish[INDEX_lengthdataAngl3[9]] LE 0) THEN length_key_check_angl[9] = Size260to280_anglcount
          IF (Size280to300_anglcount GT 0) AND (Length_N_fish[INDEX_lengthdataAngl3[10]] LE 0) THEN length_key_check_angl[10] = Size280to300_anglcount
          IF (Size300to320_anglcount GT 0) AND (Length_N_fish[INDEX_lengthdataAngl3[11]] LE 0) THEN length_key_check_angl[11] = Size300to320_anglcount
          IF (Size320to340_anglcount GT 0) AND (Length_N_fish[INDEX_lengthdataAngl3[12]] LE 0) THEN length_key_check_angl[12] = Size320to340_anglcount
          IF (Size340to360_anglcount GT 0) AND (Length_N_fish[INDEX_lengthdataAngl3[13]] LE 0) THEN length_key_check_angl[13] = Size340to360_anglcount
          IF (Size360to380_anglcount GT 0) AND (Length_N_fish[INDEX_lengthdataAngl3[14]] LE 0) THEN length_key_check_angl[14] = Size360to380_anglcount
          IF (Size380to400_anglcount GT 0) AND (Length_N_fish[INDEX_lengthdataAngl3[15]] LE 0) THEN length_key_check_angl[15] = Size380to400_anglcount
          IF (Size400to420_anglcount GT 0) AND (Length_N_fish[INDEX_lengthdataAngl3[16]] LE 0) THEN length_key_check_angl[16] = Size400to420_anglcount
          IF (Size420to440_anglcount GT 0) AND (Length_N_fish[INDEX_lengthdataAngl3[17]] LE 0) THEN length_key_check_angl[17] = Size420to440_anglcount
          IF (Size440to460_anglcount GT 0) AND (Length_N_fish[INDEX_lengthdataAngl3[18]] LE 0) THEN length_key_check_angl[18] = Size440to460_anglcount
          IF (Size460to480_anglcount GT 0) AND (Length_N_fish[INDEX_lengthdataAngl3[19]] LE 0) THEN length_key_check_angl[19] = Size460to480_anglcount
          IF (Size480to500_anglcount GT 0) AND (Length_N_fish[INDEX_lengthdataAngl3[20]] LE 0) THEN length_key_check_angl[20] = Size480to500_anglcount
          IF (Size500to520_anglcount GT 0) AND (Length_N_fish[INDEX_lengthdataAngl3[21]] LE 0) THEN length_key_check_angl[21] = Size500to520_anglcount
          IF (Size520to540_anglcount GT 0) AND (Length_N_fish[INDEX_lengthdataAngl3[22]] LE 0) THEN length_key_check_angl[22] = Size520to540_anglcount
          IF (Size540to560_anglcount GT 0) AND (Length_N_fish[INDEX_lengthdataAngl3[23]] LE 0) THEN length_key_check_angl[23] = Size540to560_anglcount
          IF (Size560to580_anglcount GT 0) AND (Length_N_fish[INDEX_lengthdataAngl3[24]] LE 0) THEN length_key_check_angl[24] = Size560to580_anglcount
          IF (Size580to600_anglcount GT 0) AND (Length_N_fish[INDEX_lengthdataAngl3[25]] LE 0) THEN length_key_check_angl[25] = Size580to600_anglcount
          IF (Size600to620_anglcount GT 0) AND (Length_N_fish[INDEX_lengthdataAngl3[26]] LE 0) THEN length_key_check_angl[26] = Size600to620_anglcount
          IF (Size620to640_anglcount GT 0) AND (Length_N_fish[INDEX_lengthdataAngl3[27]] LE 0) THEN length_key_check_angl[27] = Size620to640_anglcount
          IF (Size640to660_anglcount GT 0) AND (Length_N_fish[INDEX_lengthdataAngl3[28]] LE 0) THEN length_key_check_angl[28] = Size640to660_anglcount
          IF (Size660to680_anglcount GT 0) AND (Length_N_fish[INDEX_lengthdataAngl3[29]] LE 0) THEN length_key_check_angl[29] = Size660to680_anglcount
          IF (Size680to700_anglcount GT 0) AND (Length_N_fish[INDEX_lengthdataAngl3[30]] LE 0) THEN length_key_check_angl[30] = Size680to700_anglcount
          IF (Size700to720_anglcount GT 0) AND (Length_N_fish[INDEX_lengthdataAngl3[31]] LE 0) THEN length_key_check_angl[31] = Size700to720_anglcount
          IF (Size720to740_anglcount GT 0) AND (Length_N_fish[INDEX_lengthdataAngl3[32]] LE 0) THEN length_key_check_angl[32] = Size720to740_anglcount
          IF (Size740to760_anglcount GT 0) AND (Length_N_fish[INDEX_lengthdataAngl3[33]] LE 0) THEN length_key_check_angl[33] = Size740to760_anglcount
          IF (Size760to780_anglcount GT 0) AND (Length_N_fish[INDEX_lengthdataAngl3[34]] LE 0) THEN length_key_check_angl[34] = Size760to780_anglcount
          IF (Size780to800_anglcount GT 0) AND (Length_N_fish[INDEX_lengthdataAngl3[35]] LE 0) THEN length_key_check_angl[35] = Size780to800_anglcount
          IF (SizeGE800_anglcount GT 0) AND (Length_N_fish[INDEX_lengthdataAngl3[36]] LE 0) THEN length_key_check_angl[36] = SizeGE800_anglcount
          PRINT, 'total N of fish w/o key', TOTAL(length_key_check_angl)
          paramset[212, i] = TOTAL(length_key_check_angl)
          PRINT, 'size bins w/o key', length_key_check_angl

          AgeLengthKeyCheck_angl2 = (TOTAL(length_key_check_angl)/N_ELEMENTS(Length_prod_angl))
          PRINT, 'AgeLengthKeyCheck_angl2', AgeLengthKeyCheck_angl1

          IF AgeLengthKeyCheck_angl2 LT AgeLengthKeyLevel THEN BEGIN
            
                ; 1.Assign age semi-randomly to lengths - all fish
                IF SizeLT100_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 0
                  LengthBinIndex2 = SizeLT100_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl3, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                  , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                  , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size100to120_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 1
                  LengthBinIndex2 = Size100to120_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl3, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                  , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                  , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size120to140_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 2
                  LengthBinIndex2 = Size120to140_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl3, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                  , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                  , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size140to160_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 3
                  LengthBinIndex2 = Size140to160_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl3, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                  , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                  , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size160to180_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 4
                  LengthBinIndex2 = Size160to180_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl3, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                  , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                  , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size180to200_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 5
                  LengthBinIndex2 = Size180to200_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl3, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                  , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                  , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size200to220_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 6
                  LengthBinIndex2 = Size200to220_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl3, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                  , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                  , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size220to240_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 7
                  LengthBinIndex2 = Size220to240_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl3, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                  , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                  , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size240to260_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 8
                  LengthBinIndex2 = Size240to260_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl3, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                  , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                  , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size260to280_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 9
                  LengthBinIndex2 = Size260to280_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl3, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                  , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                  , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size280to300_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 10
                  LengthBinIndex2 = Size280to300_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl3, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                  , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                  , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size300to320_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 11
                  LengthBinIndex2 = Size300to320_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl3, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                  , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                  , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size320to340_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 12
                  LengthBinIndex2 = Size320to340_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl3, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                  , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                  , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size340to360_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 13
                  LengthBinIndex2 = Size340to360_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl3, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                  , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                  , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size360to380_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 14
                  LengthBinIndex2 = Size360to380_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl3, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                  , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                  , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size380to400_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 15
                  LengthBinIndex2 = Size380to400_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl3, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                  , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                  , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size400to420_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 16
                  LengthBinIndex2 = Size400to420_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl3, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                  , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                  , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size420to440_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 17
                  LengthBinIndex2 = Size420to440_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl3, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                  , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                  , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size440to460_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 18
                  LengthBinIndex2 = Size440to460_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl3, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                  , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                  , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size460to480_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 19
                  LengthBinIndex2 = Size460to480_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl3, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                  , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                  , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size480to500_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 20
                  LengthBinIndex2 = Size480to500_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl3, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                  , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                  , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size500to520_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 21
                  LengthBinIndex2 = Size500to520_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl3, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                  , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                  , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size520to540_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 22
                  LengthBinIndex2 = Size520to540_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl3, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                  , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                  , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size540to560_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 23
                  LengthBinIndex2 = Size540to560_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl3, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                  , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                  , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size560to580_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 24
                  LengthBinIndex2 = Size560to580_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl3, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                  , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                  , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size580to600_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 25
                  LengthBinIndex2 = Size580to600_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl3, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                  , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                  , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size600to620_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 26
                  LengthBinIndex2 = Size600to620_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl3, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                  , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                  , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size620to640_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 27
                  LengthBinIndex2 = Size620to640_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl3, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                  , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                  , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size640to660_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 28
                  LengthBinIndex2 = Size640to660_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl3, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                  , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                  , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size660to680_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 29
                  LengthBinIndex2 = Size660to680_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl3, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                  , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                  , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size680to700_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 30
                  LengthBinIndex2 = Size680to700_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl3, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                  , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                  , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size700to720_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 31
                  LengthBinIndex2 = Size700to720_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl3, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                  , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                  , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size720to740_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 32
                  LengthBinIndex2 = Size720to740_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl3, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                  , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                  , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size740to760_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 33
                  LengthBinIndex2 = Size740to760_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl3, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                  , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                  , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size760to780_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 34
                  LengthBinIndex2 = Size760to780_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl3, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                  , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                  , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size780to800_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 35
                  LengthBinIndex2 = Size780to800_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl3, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                  , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                  , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Sizege800_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 36
                  LengthBinIndex2 = SizeGE800_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl3, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                  , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                  , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
        
                PRINT, "Age of fish harvested by anglers (FishAgeAngl)", FishAgeAngl
                PRINT, "Length of fish harvested by anglers (FishLengthAngl)", FishLengthAngl
        
                AgeAnglAll = WHERE(FishAgeAngl GE 0, AgeAnglAllCOUNT)
                IF AgeAnglAllCOUNT GT 0 THEN BEGIN
                  paramset_angl[220, i] = MEAN(FishAgeAngl[AgeAnglAll]); mean age for all fish
                  paramset_angl[221, i] = STDDEV(FishAgeAngl[AgeAnglAll]); SD age for all fish
                ENDIF
        
                ; Age structure of harvested fish (angling)
                Total_N_ageclass_angl = FLTARR(27L, 2L)
                Total_N_ageclass_angl[0, 0] = TOTAL(WAE_length_bin_angl[10, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 0
                Total_N_ageclass_angl[1, 0] = TOTAL(WAE_length_bin_angl[11, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 1
                Total_N_ageclass_angl[2, 0] = TOTAL(WAE_length_bin_angl[12, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 2
                Total_N_ageclass_angl[3, 0] = TOTAL(WAE_length_bin_angl[13, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 3
                Total_N_ageclass_angl[4, 0] = TOTAL(WAE_length_bin_angl[14, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 4
                Total_N_ageclass_angl[5, 0] = TOTAL(WAE_length_bin_angl[15, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 5
                Total_N_ageclass_angl[6, 0] = TOTAL(WAE_length_bin_angl[16, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 6
                Total_N_ageclass_angl[7, 0] = TOTAL(WAE_length_bin_angl[17, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 7
                Total_N_ageclass_angl[8, 0] = TOTAL(WAE_length_bin_angl[18, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 8
                Total_N_ageclass_angl[9, 0] = TOTAL(WAE_length_bin_angl[19, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 9
                Total_N_ageclass_angl[10, 0] = TOTAL(WAE_length_bin_angl[20, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 10
                Total_N_ageclass_angl[11, 0] = TOTAL(WAE_length_bin_angl[21, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 11
                Total_N_ageclass_angl[12, 0] = TOTAL(WAE_length_bin_angl[22, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 12
                Total_N_ageclass_angl[13, 0] = TOTAL(WAE_length_bin_angl[23, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 13
                Total_N_ageclass_angl[14, 0] = TOTAL(WAE_length_bin_angl[24, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 14
                Total_N_ageclass_angl[15, 0] = TOTAL(WAE_length_bin_angl[25, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 15
                Total_N_ageclass_angl[16, 0] = TOTAL(WAE_length_bin_angl[26, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 16
                Total_N_ageclass_angl[17, 0] = TOTAL(WAE_length_bin_angl[27, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 17
                Total_N_ageclass_angl[18, 0] = TOTAL(WAE_length_bin_angl[28, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 18
                Total_N_ageclass_angl[19, 0] = TOTAL(WAE_length_bin_angl[29, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 19
                Total_N_ageclass_angl[20, 0] = TOTAL(WAE_length_bin_angl[30, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 20
                Total_N_ageclass_angl[21, 0] = TOTAL(WAE_length_bin_angl[31, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 21
                Total_N_ageclass_angl[22, 0] = TOTAL(WAE_length_bin_angl[32, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 22
                Total_N_ageclass_angl[23, 0] = TOTAL(WAE_length_bin_angl[33, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 23
                Total_N_ageclass_angl[24, 0] = TOTAL(WAE_length_bin_angl[34, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 24
                Total_N_ageclass_angl[25, 0] = TOTAL(WAE_length_bin_angl[35, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 25
                Total_N_ageclass_angl[26, 0] = TOTAL(WAE_length_bin_angl[36, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 26
                PRINT, 'Derived age distribution of harvested fish'
                PRINT, Total_N_ageclass_angl[*, 0]
                PRINT, 'Total number of harvested fish samples', TOTAL(Total_N_ageclass_angl[*, 0])
        
                ; Estimate age structure of harvested fish
                Total_prop_ageclass_angl = FLTARR(27L, 2L)
                IF TOTAL(Total_N_ageclass_angl[*, 0]) GT 0 THEN Total_prop_ageclass_angl[*, 0] = Total_N_ageclass_angl[*, 0]/TOTAL(Total_N_ageclass_angl[*, 0])
                PRINT, 'Relative age distribution'
                PRINT, Total_prop_ageclass_angl[*, 0]
                PRINT, 'N of harvested fish (angling)', N_harv_angl[INDEX_lengthdataAngl[0]] $ 
                  , HarvRate_angl[INDEX_lengthdataAngl[0]] * adultPE_angl[INDEX_lengthdataAngl[0]]
                IF TOTAL(Total_N_ageclass_angl[*, 0]) GT 0 THEN paramset_angl[13:39, i] = ROUND(Total_prop_ageclass_angl[*, 0] $
                  * HarvRate_angl[INDEX_lengthdataAngl[0]] * adultPE_angl[INDEX_lengthdataAngl[0]])
                PRINT, 'Estimated age distribution of harvested fish'
                PRINT, paramset_angl[13:39, i]
        
                ; Calculate mean length-at-age for harvested fish
                mean_length_at_age_angl = FLTARR(27L, 37L)
                mean_length_at_age_angl[0, *] = (WAE_length_mean_angl[10, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
                mean_length_at_age_angl[1, *] = (WAE_length_mean_angl[11, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
                mean_length_at_age_angl[2, *] = (WAE_length_mean_angl[12, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
                mean_length_at_age_angl[3, *] = (WAE_length_mean_angl[13, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
                mean_length_at_age_angl[4, *] = (WAE_length_mean_angl[14, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
                mean_length_at_age_angl[5, *] = (WAE_length_mean_angl[15, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
                mean_length_at_age_angl[6, *] = (WAE_length_mean_angl[16, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
                mean_length_at_age_angl[7, *] = (WAE_length_mean_angl[17, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
                mean_length_at_age_angl[8, *] = (WAE_length_mean_angl[18, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
                mean_length_at_age_angl[9, *] = (WAE_length_mean_angl[19, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
                mean_length_at_age_angl[10, *] = (WAE_length_mean_angl[20, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
                mean_length_at_age_angl[11, *] = (WAE_length_mean_angl[21, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
                mean_length_at_age_angl[12, *] = (WAE_length_mean_angl[22, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
                mean_length_at_age_angl[13, *] = (WAE_length_mean_angl[23, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
                mean_length_at_age_angl[14, *] = (WAE_length_mean_angl[24, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
                mean_length_at_age_angl[15, *] = (WAE_length_mean_angl[25, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
                mean_length_at_age_angl[16, *] = (WAE_length_mean_angl[26, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
                mean_length_at_age_angl[17, *] = (WAE_length_mean_angl[27, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
                mean_length_at_age_angl[18, *] = (WAE_length_mean_angl[28, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
                mean_length_at_age_angl[19, *] = (WAE_length_mean_angl[29, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
                mean_length_at_age_angl[20, *] = (WAE_length_mean_angl[30, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
                mean_length_at_age_angl[21, *] = (WAE_length_mean_angl[31, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
                mean_length_at_age_angl[22, *] = (WAE_length_mean_angl[32, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
                mean_length_at_age_angl[23, *] = (WAE_length_mean_angl[33, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
                mean_length_at_age_angl[24, *] = (WAE_length_mean_angl[34, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
                mean_length_at_age_angl[25, *] = (WAE_length_mean_angl[35, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
                mean_length_at_age_angl[26, *] = (WAE_length_mean_angl[36, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
                age0mean_angl = where(mean_length_at_age_angl[0, *] GT 0, age0mean_anglcount)
                age1mean_angl = where(mean_length_at_age_angl[1, *] GT 0, age1mean_anglcount)
                age2mean_angl = where(mean_length_at_age_angl[2, *] GT 0, age2mean_anglcount)
                age3mean_angl = where(mean_length_at_age_angl[3, *] GT 0, age3mean_anglcount)
                age4mean_angl = where(mean_length_at_age_angl[4, *] GT 0, age4mean_anglcount)
                age5mean_angl = where(mean_length_at_age_angl[5, *] GT 0, age5mean_anglcount)
                age6mean_angl = where(mean_length_at_age_angl[6, *] GT 0, age6mean_anglcount)
                age7mean_angl = where(mean_length_at_age_angl[7, *] GT 0, age7mean_anglcount)
                age8mean_angl = where(mean_length_at_age_angl[8, *] GT 0, age8mean_anglcount)
                age9mean_angl = where(mean_length_at_age_angl[9, *] GT 0, age9mean_anglcount)
                age10mean_angl = where(mean_length_at_age_angl[10, *] GT 0, age10mean_anglcount)
                age11mean_angl = where(mean_length_at_age_angl[11, *] GT 0, age11mean_anglcount)
                age12mean_angl = where(mean_length_at_age_angl[12, *] GT 0, age12mean_anglcount)
                age13mean_angl = where(mean_length_at_age_angl[13, *] GT 0, age13mean_anglcount)
                age14mean_angl = where(mean_length_at_age_angl[14, *] GT 0, age14mean_anglcount)
                age15mean_angl = where(mean_length_at_age_angl[15, *] GT 0, age15mean_anglcount)
                age16mean_angl = where(mean_length_at_age_angl[16, *] GT 0, age16mean_anglcount)
                age17mean_angl = where(mean_length_at_age_angl[17, *] GT 0, age17mean_anglcount)
                age18mean_angl = where(mean_length_at_age_angl[18, *] GT 0, age18mean_anglcount)
                age19mean_angl = where(mean_length_at_age_angl[19, *] GT 0, age19mean_anglcount)
                age20mean_angl = where(mean_length_at_age_angl[20, *] GT 0, age20mean_anglcount)
                age21mean_angl = where(mean_length_at_age_angl[21, *] GT 0, age21mean_anglcount)
                age22mean_angl = where(mean_length_at_age_angl[22, *] GT 0, age22mean_anglcount)
                age23mean_angl = where(mean_length_at_age_angl[23, *] GT 0, age23mean_anglcount)
                age24mean_angl = where(mean_length_at_age_angl[24, *] GT 0, age24mean_anglcount)
                age25mean_angl = where(mean_length_at_age_angl[25, *] GT 0, age25mean_anglcount)
                age26mean_angl = where(mean_length_at_age_angl[26, *] GT 0, age26mean_anglcount)
                IF age0mean_anglcount GT 0 THEN Total_N_ageclass_angl[0, 1] = TOTAL(WAE_length_mean_angl[10, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age0mean_anglcount
                IF age1mean_anglcount GT 0 THEN Total_N_ageclass_angl[1, 1] = TOTAL(WAE_length_mean_angl[11, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age1mean_anglcount
                IF age2mean_anglcount GT 0 THEN Total_N_ageclass_angl[2, 1] = TOTAL(WAE_length_mean_angl[12, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age2mean_anglcount
                IF age3mean_anglcount GT 0 THEN Total_N_ageclass_angl[3, 1] = TOTAL(WAE_length_mean_angl[13, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age3mean_anglcount
                IF age4mean_anglcount GT 0 THEN Total_N_ageclass_angl[4, 1] = TOTAL(WAE_length_mean_angl[14, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age4mean_anglcount
                IF age5mean_anglcount GT 0 THEN Total_N_ageclass_angl[5, 1] = TOTAL(WAE_length_mean_angl[15, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age5mean_anglcount
                IF age6mean_anglcount GT 0 THEN Total_N_ageclass_angl[6, 1] = TOTAL(WAE_length_mean_angl[16, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age6mean_anglcount
                IF age7mean_anglcount GT 0 THEN Total_N_ageclass_angl[7, 1] = TOTAL(WAE_length_mean_angl[17, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age7mean_anglcount
                IF age8mean_anglcount GT 0 THEN Total_N_ageclass_angl[8, 1] = TOTAL(WAE_length_mean_angl[18, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age8mean_anglcount
                IF age9mean_anglcount GT 0 THEN Total_N_ageclass_angl[9, 1] = TOTAL(WAE_length_mean_angl[19, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age9mean_anglcount
                IF age10mean_anglcount GT 0 THEN Total_N_ageclass_angl[10, 1] = TOTAL(WAE_length_mean_angl[20, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age10mean_anglcount
                IF age11mean_anglcount GT 0 THEN Total_N_ageclass_angl[11, 1] = TOTAL(WAE_length_mean_angl[21, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age11mean_anglcount
                IF age12mean_anglcount GT 0 THEN Total_N_ageclass_angl[12, 1] = TOTAL(WAE_length_mean_angl[22, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age12mean_anglcount
                IF age13mean_anglcount GT 0 THEN Total_N_ageclass_angl[13, 1] = TOTAL(WAE_length_mean_angl[23, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age13mean_anglcount
                IF age14mean_anglcount GT 0 THEN Total_N_ageclass_angl[14, 1] = TOTAL(WAE_length_mean_angl[24, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age14mean_anglcount
                IF age15mean_anglcount GT 0 THEN Total_N_ageclass_angl[15, 1] = TOTAL(WAE_length_mean_angl[25, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age15mean_anglcount
                IF age16mean_anglcount GT 0 THEN Total_N_ageclass_angl[16, 1] = TOTAL(WAE_length_mean_angl[26, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age16mean_anglcount
                IF age17mean_anglcount GT 0 THEN Total_N_ageclass_angl[17, 1] = TOTAL(WAE_length_mean_angl[27, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age17mean_anglcount
                IF age18mean_anglcount GT 0 THEN Total_N_ageclass_angl[18, 1] = TOTAL(WAE_length_mean_angl[28, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age18mean_anglcount
                IF age19mean_anglcount GT 0 THEN Total_N_ageclass_angl[19, 1] = TOTAL(WAE_length_mean_angl[29, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age19mean_anglcount
                IF age20mean_anglcount GT 0 THEN Total_N_ageclass_angl[20, 1] = TOTAL(WAE_length_mean_angl[30, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age20mean_anglcount
                IF age21mean_anglcount GT 0 THEN Total_N_ageclass_angl[21, 1] = TOTAL(WAE_length_mean_angl[31, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age21mean_anglcount
                IF age22mean_anglcount GT 0 THEN Total_N_ageclass_angl[22, 1] = TOTAL(WAE_length_mean_angl[32, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age22mean_anglcount
                IF age23mean_anglcount GT 0 THEN Total_N_ageclass_angl[23, 1] = TOTAL(WAE_length_mean_angl[33, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age23mean_anglcount
                IF age24mean_anglcount GT 0 THEN Total_N_ageclass_angl[24, 1] = TOTAL(WAE_length_mean_angl[34, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age24mean_anglcount
                IF age25mean_anglcount GT 0 THEN Total_N_ageclass_angl[25, 1] = TOTAL(WAE_length_mean_angl[35, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age25mean_anglcount
                IF age26mean_anglcount GT 0 THEN Total_N_ageclass_angl[26, 1] = TOTAL(WAE_length_mean_angl[36, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age26mean_anglcount
                PRINT, 'Mean length-at-age of harvested fish'
                PRINT, Total_N_ageclass_angl[*, 1]
                paramset_angl[40L:66, i] = Total_N_ageclass_angl[*, 1]
        
        
                ; convert fish length to mass
                Mean_mass_angl = FLTARR(27L, 1)
                Mean_mass_angl = 1.5868E-006*Total_N_ageclass_angl[*, 1]^3.2962
                PRINT, 'Mean mass-at-age of harvested fish'
                PRINT, Mean_mass_angl
                paramset_angl[67L:93, i] = Mean_mass_angl
        
                Age_NOmass_angl = WHERE(Mean_mass LE 0, Age_NOmass_anglcount)
                Age_Wmass_angl = WHERE(Mean_mass_angl GT 0, Age_Wmass_anglcount)
                IF Age_Wmass_anglcount GT 0. THEN PRINT, 'age class with mass data for harvested fish', Age_Wmass_angl
                IF Age_NOmass_anglcount GT 0. THEN PRINT, 'age class without mass data of harvested fish', Age_NOmass_angl
                PRINT, 'max age class with mass of harvested fish', MAX(Age_Wmass_angl)
                PRINT, 'min age class with mass of harvested fish', MIN(Age_Wmass_angl)
        
                Age_mass_angl_index = INDGEN(27)
                Age_NOmass_angl_Intrpl = WHERE((Age_NOmass_angl GT min(Age_Wmass_angl)) AND (Age_NOmass_angl LT max(Age_Wmass_angl)), Age_NOmass_angl_Intrplcount)
                IF Age_NOmass_angl_Intrplcount GT 0 THEN PRINT, 'age class mass need interpolation', Age_NOmass_angl[Age_NOmass_angl_Intrpl]
        
                Biomass_ageclass_angl = FLTARR(27L, 1)
                Biomass_ageclass_angl = Mean_mass*ROUND(Total_prop_ageclass_angl[*, 0] $
                  * HarvRate_angl[INDEX_lengthdataAngl[0]] * adultPE_angl[INDEX_lengthdataAngl[0]]); growth and mass are the same as the original lstocks
                PRINT, 'Biomass-at-age of harvested fish'
                PRINT, Biomass_ageclass_angl
                PRINT, 'Max biomass', MAX(Biomass_ageclass_angl)
                paramset_angl[94L:120, i] = Biomass_ageclass_angl

                ; total adult biomass based on mean mass
                Pos_length_ageclass = WHERE(Total_N_ageclass[3:26, 1] GT 0, Pos_length_ageclassCount)
                Pos_length_ageclass_angl = WHERE(Total_N_ageclass_angl[3:26, 1] GT 0, Pos_length_ageclass_anglCount)
                ; biomass
                IF Pos_length_ageclassCount GT 0 THEN paramset_angl[223, i] = adultPE_angl[INDEX_lengthdataAngl[0]] $
                  * MEAN(1.5868E-006*Total_N_ageclass[Pos_length_ageclass, 1]^3.2962) $
                  /LakeArea[INDEX_lengthdata[0]]*1000000./1000.
                ; harvested biomass
                ;IF Pos_length_ageclassCount GT 0 THEN paramset_angl[223, i] = HarvRate_angl[INDEX_lengthdataAngl[0]]
                ;  * adultPE_angl[INDEX_lengthdataAngl[0]* MEAN(1.5868E-006*Total_N_ageclass[Pos_length_ageclass, i]^3.2962)
                IF Pos_length_ageclass_anglCount GT 0 THEN paramset_angl[224, i] = HarvRate_angl[INDEX_lengthdataAngl[0]] $
                * adultPE_angl[INDEX_lengthdataAngl[0]] * MEAN(1.5868E-006*Total_N_ageclass_angl[Pos_length_ageclass_angl, 1]^3.2962) $
                /LakeArea[INDEX_lengthdata[0]]*1000000./1000.
                ; harvestable biomass (35%)
                IF Pos_length_ageclassCount GT 0 THEN paramset_angl[225, i] = TotAlowCat[INDEX_lengthdataAngl[0]] $
                  * MEAN(1.5868E-006*Total_N_ageclass[Pos_length_ageclass, 1]^3.2962) $ 
                  /LakeArea[INDEX_lengthdata[0]]*1000000./1000.
       
                ; create age-specific biomass plots
                Biomass_ageclass_anglAll=Biomass_ageclass_angl/1000.
                ;femaleBiomass=Biomass_ageclassF/1000.
                ;unknownBiomass=Biomass_ageclassU/1000.
                !p.font=0
                ;Device, Set_Character_Size=[8,12]
                Device, Get_Decomposed=currentState
                DEVICE, SET_FONT='Courier', /TT_FONT
                DEVICE, DECOMPOSED=0
                cgDisplay, 750, 400, WID=4
                ;!P.Multi = [0,2,1]
                labels = INDGEN(27); ['Exp 1', 'Exp 2', 'Exp 3', 'Exp 4', 'Exp 5']
                cgLoadct, 33, Clip=[10,245]
                cgBarPlot, Biomass_ageclass_anglAll,  YRange=[0,MAX(Biomass_ageclass_anglALL)*1.2], Colors='DARKGRAY', BarNames=labels $
                  , xtitle='Age (years)'$
                  , ytitle='Biomass (Kg)' $;, xrange=[0, 25]
                  , title='Harvested (ANGL) biomass distribution of WI walleye stocks - '+'WBIC: '+STRING(WBIC[INDEX_lengthdata[0]], FORMAT = '(I7)') $
                  +'_Year: '+STRING(fix(SurveyYear[INDEX_lengthdata[0]]), FORMAT = '(I4)')
                ;XYOutS, ROUND(MEDIAN(INDGEN(27))), ROUND(0.5*(MAX(paramset[13:39, i]))*1.3), Orientation=90.0, /DEVICE
                ;cgBarPlot, femaleBiomass, Colors='RED', /Overplot, BaseLines=maleBiomass
                ;cgBarPlot, unknownBiomass, Colors='dark green', /Overplot, BaseLines=maleBiomass+femaleBiomass
                ;items = ['Male', 'Female', 'Unknown']
                ;colors = ['BLUE', 'RED', 'dark green']
                ;AL_Legend, items, Colors=colors, PSym=Replicate(15,3), SymSize=Replicate(1.75,3), $
                ;  Charsize=cgDefCharsize(), Position=[0.75, 0.85], /Normal
        
                ; file name for WBIC-year-specific age structure
                filename='Walleye harveseted (ANGL) biomass'+ STRING(WBIC[INDEX_lengthdata[0]], FORMAT = '(I7)') $
                  +'_'+STRING(fix(SurveyYear[INDEX_lengthdata[0]]), FORMAT = '(I4)')+'.png'
                WRITE_PNG, filename, TVRD(/TRUE)
                DEVICE, DECOMPOSED=old_decomposed
                !p.font=1
        
;                ;Growth_mass = fltarr(27L, 1); ??? USE VALUES FROM TOTAL POPULATIONS????
;                Mean_biomass_angl = FLTARR(27L, 1)
;                Production_angl = FLTARR(27L, 1)
;                ;IF (Mean_mass[3, 0] GT 0) AND (Mean_mass[4, 0] GT 0) THEN Growth_mass[0, 0] = Mean_mass[4, 0] - Mean_mass[3, 0]
;                FOR Agei = 1L, 26L DO BEGIN
;                  IF (Agei GE MIN(Age_Wmass_angl)) AND (Agei LT MAX(Age_Wmass_angl)) THEN BEGIN
;                    ;print, 'agei', agei
;                    IF (Mean_mass_angl[Agei-1L, 0] GT 0.) AND (Mean_mass_angl[Agei, 0] GT 0.) THEN BEGIN
;                      ;Growth_mass[Agei, 0] = ALOG(Mean_mass[Agei, 0]/Mean_mass[Agei-1L, 0])
;                      Mean_biomass_angl[Agei, 0] = MEAN(Biomass_ageclass_angl[Agei-1L:Agei, 0])
;                      Production_angl[Agei, 0] = Growth_mass[Agei, 0] * Mean_biomass_angl[Agei, 0]
;                    ENDIF
;                  ENDIF
;                ENDFOR
;                PRINT, 'Mean growth in mass'
;                PRINT, Growth_mass
;                PRINT, 'Mean biomass (Bhat) of harvested fish'
;                PRINT, Mean_biomass_angl
;                PRINT, 'Harvested production'
;                PRINT, Production_angl
;                paramset_angl[121L:147, i] = Growth_mass
;                paramset_angl[148L:174, i] = Mean_biomass_angl
;                paramset_angl[175L:201, i] = Production_angl
        
                ; *******GAPS IN AGE CLASSS STILL NEED TO be INTERPOLATED!!!!!!!!!!!!!!!!!
        
                PRINT, 'Total number of harvested fish (angling)', N_harv_angl[INDEX_lengthdataAngl[0]] $ 
                  , HarvRate_angl[INDEX_lengthdataAngl[0]] * adultPE_angl[INDEX_lengthdataAngl[0]]
                PRINT, 'Lake area (km2)', LakeArea[INDEX_lengthdata[0]]/1000000.; lake area (km2)
        
                IF (LakeArea[INDEX_lengthdata[0]] GT 0.) THEN Total_biomass_angl[i] = TOTAL(Biomass_ageclass_angl[*, 0]) / LakeArea[INDEX_lengthdata[0]]*1000000./1000.
                PRINT, 'Total harvested biomass (kg/km2)'
                PRINT, Total_biomass_angl[i]
                paramset_angl[202, i] = Total_biomass_angl[i]
        
;                Pos_production_angl = WHERE(Production_angl[*, 0] GT 0., Pos_production_anglcount); negative age-specific production is converted to 0
;                IF (Pos_production_anglcount GT 0.) AND (LakeArea[INDEX_lengthdata[0]] GT 0.) THEN $
;                  Total_production_angl[i] = TOTAL(Production_angl[Pos_production_angl, 0]) $
;                  / LakeArea[INDEX_lengthdata[0]]*1000000./1000.
;                PRINT, 'Total harvested production (kg/km2/year)'
;                PRINT, Total_production_angl[i]
;                paramset_angl[203, i] = Total_production_angl[i]
;                IF (Total_production[i] GT 0.) THEN Ecotroph[i] = Total_production_angl[i]/Total_production[i]
;                PRINT, 'harvested production/total production'
;                PRINT, Ecotroph[i]
;                paramset_angl[208L, i] = Ecotroph[i]
;        
;                Pos_biomass_angl = WHERE(Total_biomass_angl[i] GT 0., Pos_biomass_anglcount); negative age-specific production is converted to 0
;                IF Pos_biomass_anglcount GT 0. THEN P_over_B_angl[i] = Total_production_angl[i] / Total_biomass_angl[i]
;                PRINT, 'Harvested P/B'
;                PRINT, P_over_B_angl[i]
;                paramset_angl[204L, i] = P_over_B_angl[i]
        
                ; Estimates with only >age 3
                IF (LakeArea[INDEX_lengthdata[0]] GT 0.) THEN Total_biomass_adult_angl[i] = TOTAL(Biomass_ageclass_angl[3L:26L, 0]) $
                  / LakeArea[INDEX_lengthdata[0]]*1000000./1000.
                PRINT, 'Total harvested adult biomass (kg/km2)'
                PRINT, Total_biomass_adult_angl[i]
                paramset_angl[205L, i] = Total_biomass_adult_angl[i]
        
;                ;Growth_mass_adult = fltarr(27L, 1)
;                Mean_biomass_adult_angl = fltarr(27L, 1)
;                Production_adult_angl = fltarr(27L, 1)
;                FOR Agei = 1L, 26L DO BEGIN
;                  IF (Agei GE 3L) AND (Agei LT MAX(Age_Wmass_angl)) THEN BEGIN
;                    ;print, 'agei', agei
;                    IF (Mean_mass_angl[Agei-1L, 0] GT 0.) AND (Mean_mass_angl[Agei, 0] GT 0.) THEN BEGIN
;                      ;Growth_mass_adult[Agei, 0] = ALOG(Mean_mass[Agei, 0]/Mean_mass[Agei-1L, 0])
;                      Mean_biomass_adult_angl[Agei, 0] = MEAN(Biomass_ageclass_angl[Agei-1L:Agei, 0])
;                      Production_adult_angl[Agei, 0] = Growth_mass_adult[Agei, 0] * Mean_biomass_adult_angl[Agei, 0]
;                    ENDIF
;                  ENDIF
;                ENDFOR
;        
;                Pos_production_adult_angl = WHERE(Production_adult_angl[*, 0] GT 0., Pos_production_adult_anglcount); ***negative age-specific production is converted to 0
;                PRINT, 'Array index for positive harvested adult production', Pos_production_adult_angl
;                IF (Pos_production_adult_anglcount GT 0.) AND (LakeArea[INDEX_lengthdata[0]] GT 0.)  THEN $
;                  Total_production_adult_angl[i] = TOTAL(Production_adult_angl[Pos_production_adult, 0]) $
;                  / LakeArea[INDEX_lengthdata[0]]*1000000./1000.
;                PRINT, 'Total harvested adult Production (kg/km2/year)'
;                PRINT, Total_production_adult_angl[i]
;                paramset_angl[206L, i] = Total_production_adult_angl[i]
        
;                ;IF (Total_production_adult[i] GT 0.) THEN Adult_ecotroph[i] = Total_production_adult_angl[i]/Total_production_adult[i]
;                ;IF Biomass_ageclass_angl[3,1] LE 0 THEN Biomass_ageclass_angl[3,1] = 0
;                IF (Total_production_adult[i] GT 0.) THEN Adult_ecotroph[i] = Total_biomass_adult_angl[i] $
;                  /(Total_production_adult[i]+(Biomass_ageclass[3,0]/1000.)/(LakeArea[INDEX_lengthdata[0]]/1000000.))
;                PRINT, 'harvested adult production/total production'
;                PRINT, Adult_ecotroph[i]
;                paramset_angl[209L, i] = Adult_ecotroph[i]
;        
;                Pos_biomass_adult_angl = WHERE(Total_biomass_adult_angl[i] GT 0., Pos_biomass_adult_anglcount); negative age-specific production is converted to 0
;                IF Pos_biomass_adult_anglcount GT 0. THEN P_over_B_adult_angl[i] = Total_production_adult_angl[i] / Total_biomass_adult_angl[i]
;                PRINT, 'Harvested adult P/B'
;                PRINT, P_over_B_adult_angl[i]
;                paramset_angl[207L, i] = P_over_B_adult_angl[i]
        
                 ;****calculate % harvested production****
                ;IF (Total_production_adult[i] GT 0.) THEN Adult_ecotroph[i] = Total_production_adult_angl[i]/Total_production_adult[i]
                IF (Total_production_adult[i] GT 0.) THEN Adult_ecotroph[i] = Total_biomass_adult_angl[i] $
                  /(Total_production_adult[i]+(Biomass_ageclass[3,0]/1000.)/(LakeArea[INDEX_lengthdata[0]]/1000000.))
                PRINT, 'harvested adult biomass/total adult production'
                PRINT, Adult_ecotroph[i]
                paramset_angl[209L, i] = Adult_ecotroph[i]

                ;IF adultPE_angl[INDEX_lengthdataAngl[0]] GT 0 THEN paramset_angl[210L, i] = N_harv_angl[INDEX_lengthdataAngl[0]]/adultPE_angl[INDEX_lengthdataAngl[0]]
                paramset_angl[210L, i] =HarvRate_angl[INDEX_lengthdataAngl[0]]
 
                 ENDIF
               ENDIF
             ENDIF; END OF INDEX_lengthdataAngl3count
            ENDIF
              ;IF INDEX_lengthdataAnglcount LE 0 THEN PRINT, 'Harvest data not availabile'

            ENDIF; END of lake-specific key
          ENDIF
        ENDIF



        IF (INDEX_lengthdata2Bcount LE 0) OR (AgeLengthKeyCheck2 GE AgeLengthKeyLevel) THEN BEGIN; if length-age key does not exist...
          INDEX_lengthdata2C = WHERE((WBIC_key[*] NE WBIC2), INDEX_lengthdata2Ccount)

          IF INDEX_lengthdata2Ccount GT 0 THEN BEGIN
            PRINT, 'No length-age key available'
            WBIC_year_key = Length_key3[0, *]
            WBIC_key = Length_key3[1, *]
            sample_year_key = Length_key3[2, *]
            total_N_fish = Length_key3[3, *]
            max_length = Length_key3[4, *]
            min_length = Length_key3[5, *]
            max_age = Length_key3[6, *]
            min_age = Length_key3[7, *]
            Length_bin_low = Length_key3[8, *]
            Length_N_fish = Length_key3[9, *]
            prop_age0 = Length_key3[10, *]
            prop_age1 = Length_key3[11, *]
            prop_age2 = Length_key3[12, *]
            prop_age3 = Length_key3[13, *]
            prop_age4 = Length_key3[14, *]
            prop_age5 = Length_key3[15, *]
            prop_age6 = Length_key3[16, *]
            prop_age7 = Length_key3[17, *]
            prop_age8 = Length_key3[18, *]
            prop_age9 = Length_key3[19, *]
            prop_age10 = Length_key3[20, *]
            prop_age11 = Length_key3[21, *]
            prop_age12 = Length_key3[22, *]
            prop_age13 = Length_key3[23, *]
            prop_age14 = Length_key3[24, *]
            prop_age15 = Length_key3[25, *]
            prop_age16 = Length_key3[26, *]
            prop_age17 = Length_key3[27, *]
            prop_age18 = Length_key3[28, *]
            prop_age19 = Length_key3[29, *]
            prop_age20 = Length_key3[30, *]
            prop_age21 = Length_key3[31, *]
            prop_age22 = Length_key3[32, *]
            prop_age23 = Length_key3[33, *]
            prop_age24 = Length_key3[34, *]
            prop_age25 = Length_key3[35, *]
            prop_age26 = Length_key3[36, *]

            Length_N_fishM = Length_key3[37, *]
            prop_age0M = Length_key3[38, *]
            prop_age1M = Length_key3[39, *]
            prop_age2M = Length_key3[40, *]
            prop_age3M = Length_key3[41, *]
            prop_age4M = Length_key3[42, *]
            prop_age5M = Length_key3[43, *]
            prop_age6M = Length_key3[44, *]
            prop_age7M = Length_key3[45, *]
            prop_age8M = Length_key3[46, *]
            prop_age9M = Length_key3[47, *]
            prop_age10M = Length_key3[48, *]
            prop_age11M = Length_key3[49, *]
            prop_age12M = Length_key3[50, *]
            prop_age13M = Length_key3[51, *]
            prop_age14M = Length_key3[52, *]
            prop_age15M = Length_key3[53, *]
            prop_age16M = Length_key3[54, *]
            prop_age17M = Length_key3[55, *]
            prop_age18M = Length_key3[56, *]
            prop_age19M = Length_key3[57, *]
            prop_age20M = Length_key3[58, *]
            prop_age21M = Length_key3[59, *]
            prop_age22M = Length_key3[60, *]
            prop_age23M = Length_key3[61, *]
            prop_age24M = Length_key3[62, *]
            prop_age25M = Length_key3[63, *]
            prop_age26M = Length_key3[64, *]

            Length_N_fishF = Length_key3[65, *]
            prop_age0F = Length_key3[66, *]
            prop_age1F = Length_key3[67, *]
            prop_age2F = Length_key3[68, *]
            prop_age3F = Length_key3[69, *]
            prop_age4F = Length_key3[70, *]
            prop_age5F = Length_key3[71, *]
            prop_age6F = Length_key3[72, *]
            prop_age7F = Length_key3[73, *]
            prop_age8F = Length_key3[74, *]
            prop_age9F = Length_key3[75, *]
            prop_age10F = Length_key3[76, *]
            prop_age11F = Length_key3[77, *]
            prop_age12F = Length_key3[78, *]
            prop_age13F = Length_key3[79, *]
            prop_age14F = Length_key3[80, *]
            prop_age15F = Length_key3[81, *]
            prop_age16F = Length_key3[82, *]
            prop_age17F = Length_key3[83, *]
            prop_age18F = Length_key3[84, *]
            prop_age19F = Length_key3[85, *]
            prop_age20F = Length_key3[86, *]
            prop_age21F = Length_key3[87, *]
            prop_age22F = Length_key3[88, *]
            prop_age23F = Length_key3[89, *]
            prop_age24F = Length_key3[90, *]
            prop_age25F = Length_key3[91, *]
            prop_age26F = Length_key3[92, *]
            PRINT, 'WBIC', WBIC[INDEX_lengthdata[0]]

            paramset[211, i] = 3; age-length key type
            print, paramset[211, i]
            ;INDEX_lengthdata2C = WHERE((WBIC_key[*] NE WBIC2), INDEX_lengthdata2Ccount)
            ;IF INDEX_lengthdata2Ccount GT 0 THEN BEGIN; if lake-specific key exists...
            ;IF INDEX_lengthdata2bcount GT 0 THEN BEGIN; if lake-specific key exists...
            PRINT, 'Lake key available'
            PRINT, 'WBIC', WBIC[INDEX_lengthdata[0]]

            N_Lake_WOkeys = N_Lake_WOkeys + 1L
            PRINT, 'N of lakes without key', N_Lake_WOkeys

            ; Check if age-key for all fish exist for size bins with data...
            length_key_check = fltarr(37)
            IF (SizeLT100count GT 0) AND (Length_N_fish[INDEX_lengthdata2C[0]] LE 0) THEN length_key_check[0] = SizeLT100count
            IF (Size100to120count GT 0) AND (Length_N_fish[INDEX_lengthdata2C[1]] LE 0) THEN length_key_check[1] = Size100to120count
            IF (Size120to140count GT 0) AND (Length_N_fish[INDEX_lengthdata2C[2]] LE 0) THEN length_key_check[2] = Size120to140count
            IF (Size140to160count GT 0) AND (Length_N_fish[INDEX_lengthdata2C[3]] LE 0) THEN length_key_check[3] = Size140to160count
            IF (Size160to180count GT 0) AND (Length_N_fish[INDEX_lengthdata2C[4]] LE 0) THEN length_key_check[4] = Size160to180count
            IF (Size180to200count GT 0) AND (Length_N_fish[INDEX_lengthdata2C[5]] LE 0) THEN length_key_check[5] = Size180to200count
            IF (Size200to220count GT 0) AND (Length_N_fish[INDEX_lengthdata2C[6]] LE 0) THEN length_key_check[6] = Size200to220count
            IF (Size220to240count GT 0) AND (Length_N_fish[INDEX_lengthdata2C[7]] LE 0) THEN length_key_check[7] = Size220to240count
            IF (Size240to260count GT 0) AND (Length_N_fish[INDEX_lengthdata2C[8]] LE 0) THEN length_key_check[8] = Size240to260count
            IF (Size260to280count GT 0) AND (Length_N_fish[INDEX_lengthdata2C[9]] LE 0) THEN length_key_check[9] = Size260to280count
            IF (Size280to300count GT 0) AND (Length_N_fish[INDEX_lengthdata2C[10]] LE 0) THEN length_key_check[10] = Size280to300count
            IF (Size300to320count GT 0) AND (Length_N_fish[INDEX_lengthdata2C[11]] LE 0) THEN length_key_check[11] = Size300to320count
            IF (Size320to340count GT 0) AND (Length_N_fish[INDEX_lengthdata2C[12]] LE 0) THEN length_key_check[12] = Size320to340count
            IF (Size340to360count GT 0) AND (Length_N_fish[INDEX_lengthdata2C[13]] LE 0) THEN length_key_check[13] = Size340to360count
            IF (Size360to380count GT 0) AND (Length_N_fish[INDEX_lengthdata2C[14]] LE 0) THEN length_key_check[14] = Size360to380count
            IF (Size380to400count GT 0) AND (Length_N_fish[INDEX_lengthdata2C[15]] LE 0) THEN length_key_check[15] = Size380to400count
            IF (Size400to420count GT 0) AND (Length_N_fish[INDEX_lengthdata2C[16]] LE 0) THEN length_key_check[16] = Size400to420count
            IF (Size420to440count GT 0) AND (Length_N_fish[INDEX_lengthdata2C[17]] LE 0) THEN length_key_check[17] = Size420to440count
            IF (Size440to460count GT 0) AND (Length_N_fish[INDEX_lengthdata2C[18]] LE 0) THEN length_key_check[18] = Size440to460count
            IF (Size460to480count GT 0) AND (Length_N_fish[INDEX_lengthdata2C[19]] LE 0) THEN length_key_check[19] = Size460to480count
            IF (Size480to500count GT 0) AND (Length_N_fish[INDEX_lengthdata2C[20]] LE 0) THEN length_key_check[20] = Size480to500count
            IF (Size500to520count GT 0) AND (Length_N_fish[INDEX_lengthdata2C[21]] LE 0) THEN length_key_check[21] = Size500to520count
            IF (Size520to540count GT 0) AND (Length_N_fish[INDEX_lengthdata2C[22]] LE 0) THEN length_key_check[22] = Size520to540count
            IF (Size540to560count GT 0) AND (Length_N_fish[INDEX_lengthdata2C[23]] LE 0) THEN length_key_check[23] = Size540to560count
            IF (Size560to580count GT 0) AND (Length_N_fish[INDEX_lengthdata2C[24]] LE 0) THEN length_key_check[24] = Size560to580count
            IF (Size580to600count GT 0) AND (Length_N_fish[INDEX_lengthdata2C[25]] LE 0) THEN length_key_check[25] = Size580to600count
            IF (Size600to620count GT 0) AND (Length_N_fish[INDEX_lengthdata2C[26]] LE 0) THEN length_key_check[26] = Size600to620count
            IF (Size620to640count GT 0) AND (Length_N_fish[INDEX_lengthdata2C[27]] LE 0) THEN length_key_check[27] = Size620to640count
            IF (Size640to660count GT 0) AND (Length_N_fish[INDEX_lengthdata2C[28]] LE 0) THEN length_key_check[28] = Size640to660count
            IF (Size660to680count GT 0) AND (Length_N_fish[INDEX_lengthdata2C[29]] LE 0) THEN length_key_check[29] = Size660to680count
            IF (Size680to700count GT 0) AND (Length_N_fish[INDEX_lengthdata2C[30]] LE 0) THEN length_key_check[30] = Size680to700count
            IF (Size700to720count GT 0) AND (Length_N_fish[INDEX_lengthdata2C[31]] LE 0) THEN length_key_check[31] = Size700to720count
            IF (Size720to740count GT 0) AND (Length_N_fish[INDEX_lengthdata2C[32]] LE 0) THEN length_key_check[32] = Size720to740count
            IF (Size740to760count GT 0) AND (Length_N_fish[INDEX_lengthdata2C[33]] LE 0) THEN length_key_check[33] = Size740to760count
            IF (Size760to780count GT 0) AND (Length_N_fish[INDEX_lengthdata2C[34]] LE 0) THEN length_key_check[34] = Size760to780count
            IF (Size780to800count GT 0) AND (Length_N_fish[INDEX_lengthdata2C[35]] LE 0) THEN length_key_check[35] = Size780to800count
            IF (SizeGE800count GT 0) AND (Length_N_fish[INDEX_lengthdata2C[36]] LE 0) THEN length_key_check[36] = SizeGE800count
            print, 'total N of fish w/o key', TOTAL(length_key_check)
            paramset[212, i] = TOTAL(length_key_check)
            print, 'size bins w/o key', length_key_check

            ;          ; if age-length key does not exist - males
            ;          IF (SizeLT100Mcount GT 0) AND (Length_N_fishM[INDEX_lengthdata2C[0]] LE 0) THEN $
            ;            Length_key3[38L:64L, INDEX_lengthdata2C[0]] = Length_key3[10L:36L, INDEX_lengthdata2C[0]]
            ;          IF (Size100to120Mcount GT 0) AND (Length_N_fishM[INDEX_lengthdata2C[1]] LE 0) THEN $
            ;            Length_key3[38L:64L, INDEX_lengthdata2C[1]] = Length_key3[10L:36L, INDEX_lengthdata2C[1]]
            ;          IF (Size120to140Mcount GT 0) AND (Length_N_fishM[INDEX_lengthdata2C[2]] LE 0) THEN $
            ;            Length_key3[38L:64L, INDEX_lengthdata2C[2]] = Length_key3[10L:36L, INDEX_lengthdata2C[2]]
            ;          IF (Size140to160Mcount GT 0) AND (Length_N_fishM[INDEX_lengthdata2C[3]] LE 0) THEN $
            ;            Length_key3[38L:64L, INDEX_lengthdata2C[3]] = Length_key3[10L:36L, INDEX_lengthdata2C[3]]
            ;          IF (Size160to180Mcount GT 0) AND (Length_N_fishM[INDEX_lengthdata2C[4]] LE 0) THEN $
            ;            Length_key3[38L:64L, INDEX_lengthdata2C[4]] = Length_key3[10L:36L, INDEX_lengthdata2C[4]]
            ;          IF (Size180to200Mcount GT 0) AND (Length_N_fishM[INDEX_lengthdata2C[5]] LE 0) THEN $
            ;            Length_key3[38L:64L, INDEX_lengthdata2C[5]] = Length_key3[10L:36L, INDEX_lengthdata2C[5]]
            ;          IF (Size200to220Mcount GT 0) AND (Length_N_fishM[INDEX_lengthdata2C[6]] LE 0) THEN $
            ;            Length_key3[38L:64L, INDEX_lengthdata2C[6]] = Length_key3[10L:36L, INDEX_lengthdata2C[6]]
            ;          IF (Size220to240Mcount GT 0) AND (Length_N_fishM[INDEX_lengthdata2C[7]] LE 0) THEN $
            ;            Length_key3[38L:64L, INDEX_lengthdata2C[7]] = Length_key3[10L:36L, INDEX_lengthdata2C[7]]
            ;          IF (Size240to260Mcount GT 0) AND (Length_N_fishM[INDEX_lengthdata2C[8]] LE 0) THEN $
            ;            Length_key3[38L:64L, INDEX_lengthdata2C[8]] = Length_key3[10L:36L, INDEX_lengthdata2C[8]]
            ;          IF (Size260to280Mcount GT 0) AND (Length_N_fishM[INDEX_lengthdata2C[9]] LE 0) THEN $
            ;            Length_key3[38L:64L, INDEX_lengthdata2C[9]] = Length_key3[10L:36L, INDEX_lengthdata2C[9]]
            ;          IF (Size280to300Mcount GT 0) AND (Length_N_fishM[INDEX_lengthdata2C[10]] LE 0) THEN $
            ;            Length_key3[38L:64L, INDEX_lengthdata2C[10]] = Length_key3[10L:36L, INDEX_lengthdata2C[10]]
            ;          IF (Size300to320Mcount GT 0) AND (Length_N_fishM[INDEX_lengthdata2C[11]] LE 0) THEN $
            ;            Length_key3[38L:64L, INDEX_lengthdata2C[11]] = Length_key3[10L:36L, INDEX_lengthdata2C[11]]
            ;          IF (Size320to340Mcount GT 0) AND (Length_N_fishM[INDEX_lengthdata2C[12]] LE 0) THEN $
            ;            Length_key3[38L:64L, INDEX_lengthdata2C[12]] = Length_key3[10L:36L, INDEX_lengthdata2C[12]]
            ;          IF (Size340to360Mcount GT 0) AND (Length_N_fishM[INDEX_lengthdata2C[13]] LE 0) THEN $
            ;            Length_key3[38L:64L, INDEX_lengthdata2C[13]] = Length_key3[10L:36L, INDEX_lengthdata2C[13]]
            ;          IF (Size360to380Mcount GT 0) AND (Length_N_fishM[INDEX_lengthdata2C[14]] LE 0) THEN $
            ;            Length_key3[38L:64L, INDEX_lengthdata2C[14]] = Length_key3[10L:36L, INDEX_lengthdata2C[14]]
            ;          IF (Size380to400Mcount GT 0) AND (Length_N_fishM[INDEX_lengthdata2C[15]] LE 0) THEN $
            ;            Length_key3[38L:64L, INDEX_lengthdata2C[15]] = Length_key3[10L:36L, INDEX_lengthdata2C[15]]
            ;          IF (Size400to420Mcount GT 0) AND (Length_N_fishM[INDEX_lengthdata2C[16]] LE 0) THEN $
            ;            Length_key3[38L:64L, INDEX_lengthdata2C[16]] = Length_key3[10L:36L, INDEX_lengthdata2C[16]]
            ;          IF (Size420to440Mcount GT 0) AND (Length_N_fishM[INDEX_lengthdata2C[17]] LE 0) THEN $
            ;            Length_key3[38L:64L, INDEX_lengthdata2C[17]] = Length_key3[10L:36L, INDEX_lengthdata2C[17]]
            ;          IF (Size440to460Mcount GT 0) AND (Length_N_fishM[INDEX_lengthdata2C[18]] LE 0) THEN $
            ;            Length_key3[38L:64L, INDEX_lengthdata2C[18]] = Length_key3[10L:36L, INDEX_lengthdata2C[18]]
            ;          IF (Size460to480Mcount GT 0) AND (Length_N_fishM[INDEX_lengthdata2C[19]] LE 0) THEN $
            ;            Length_key3[38L:64L, INDEX_lengthdata2C[19]] = Length_key3[10L:36L, INDEX_lengthdata2C[19]]
            ;          IF (Size480to500Mcount GT 0) AND (Length_N_fishM[INDEX_lengthdata2C[20]] LE 0) THEN $
            ;            Length_key3[38L:64L, INDEX_lengthdata2C[20]] = Length_key3[10L:36L, INDEX_lengthdata2C[20]]
            ;          IF (Size500to520Mcount GT 0) AND (Length_N_fishM[INDEX_lengthdata2C[21]] LE 0) THEN $
            ;            Length_key3[38L:64L, INDEX_lengthdata2C[21]] = Length_key3[10L:36L, INDEX_lengthdata2C[21]]
            ;          IF (Size520to540Mcount GT 0) AND (Length_N_fishM[INDEX_lengthdata2C[22]] LE 0) THEN $
            ;            Length_key3[38L:64L, INDEX_lengthdata2C[22]] = Length_key3[10L:36L, INDEX_lengthdata2C[22]]
            ;          IF (Size540to560Mcount GT 0) AND (Length_N_fishM[INDEX_lengthdata2C[23]] LE 0) THEN $
            ;            Length_key3[38L:64L, INDEX_lengthdata2C[23]] = Length_key3[10L:36L, INDEX_lengthdata2C[23]]
            ;          IF (Size560to580Mcount GT 0) AND (Length_N_fishM[INDEX_lengthdata2C[24]] LE 0) THEN $
            ;            Length_key3[38L:64L, INDEX_lengthdata2C[24]] = Length_key3[10L:36L, INDEX_lengthdata2C[24]]
            ;          IF (Size580to600Mcount GT 0) AND (Length_N_fishM[INDEX_lengthdata2C[25]] LE 0) THEN $
            ;            Length_key3[38L:64L, INDEX_lengthdata2C[25]] = Length_key3[10L:36L, INDEX_lengthdata2C[25]]
            ;          IF (Size600to620Mcount GT 0) AND (Length_N_fishM[INDEX_lengthdata2C[26]] LE 0) THEN $
            ;            Length_key3[38L:64L, INDEX_lengthdata2C[26]] = Length_key3[10L:36L, INDEX_lengthdata2C[26]]
            ;          IF (Size620to640Mcount GT 0) AND (Length_N_fishM[INDEX_lengthdata2C[27]] LE 0) THEN $
            ;            Length_key3[38L:64L, INDEX_lengthdata2C[27]] = Length_key3[10L:36L, INDEX_lengthdata2C[27]]
            ;          IF (Size640to660Mcount GT 0) AND (Length_N_fishM[INDEX_lengthdata2C[28]] LE 0) THEN $
            ;            Length_key3[38L:64L, INDEX_lengthdata2C[28]] = Length_key3[10L:36L, INDEX_lengthdata2C[28]]
            ;          IF (Size660to680Mcount GT 0) AND (Length_N_fishM[INDEX_lengthdata2C[29]] LE 0) THEN $
            ;            Length_key3[38L:64L, INDEX_lengthdata2C[29]] = Length_key3[10L:36L, INDEX_lengthdata2C[29]]
            ;          IF (Size680to700Mcount GT 0) AND (Length_N_fishM[INDEX_lengthdata2C[30]] LE 0) THEN $
            ;            Length_key3[38L:64L, INDEX_lengthdata2C[30]] = Length_key3[10L:36L, INDEX_lengthdata2C[30]]
            ;          IF (Size700to720Mcount GT 0) AND (Length_N_fishM[INDEX_lengthdata2C[31]] LE 0) THEN $
            ;            Length_key3[38L:64L, INDEX_lengthdata2C[31]] = Length_key3[10L:36L, INDEX_lengthdata2C[31]]
            ;          IF (Size720to740Mcount GT 0) AND (Length_N_fishM[INDEX_lengthdata2C[32]] LE 0) THEN $
            ;            Length_key3[38L:64L, INDEX_lengthdata2C[32]] = Length_key3[10L:36L, INDEX_lengthdata2C[32]]
            ;          IF (Size740to760Mcount GT 0) AND (Length_N_fishM[INDEX_lengthdata2C[33]] LE 0) THEN $
            ;            Length_key3[38L:64L, INDEX_lengthdata2C[33]] = Length_key3[10L:36L, INDEX_lengthdata2C[33]]
            ;          IF (Size760to780Mcount GT 0) AND (Length_N_fishM[INDEX_lengthdata2C[34]] LE 0) THEN $
            ;            Length_key3[38L:64L, INDEX_lengthdata2C[34]] = Length_key3[10L:36L, INDEX_lengthdata2C[34]]
            ;          IF (Size780to800Mcount GT 0) AND (Length_N_fishM[INDEX_lengthdata2C[35]] LE 0) THEN $
            ;            Length_key3[38L:64L, INDEX_lengthdata2C[35]] = Length_key3[10L:36L, INDEX_lengthdata2C[35]]
            ;          IF (SizeGE800Mcount GT 0) AND (Length_N_fishM[INDEX_lengthdata2C[36]] LE 0) THEN $
            ;            Length_key3[38L:64L, INDEX_lengthdata2C[36]] = Length_key3[10L:36L, INDEX_lengthdata2C[36]]
            ;
            ;          prop_age0M[INDEX_lengthdata2C] = Length_key3[38, INDEX_lengthdata2C]
            ;          prop_age1M[INDEX_lengthdata2C] = Length_key3[39, INDEX_lengthdata2C]
            ;          prop_age2M[INDEX_lengthdata2C] = Length_key3[40, INDEX_lengthdata2C]
            ;          prop_age3M[INDEX_lengthdata2C] = Length_key3[41, INDEX_lengthdata2C]
            ;          prop_age4M[INDEX_lengthdata2C] = Length_key3[42, INDEX_lengthdata2C]
            ;          prop_age5M[INDEX_lengthdata2C] = Length_key3[43, INDEX_lengthdata2C]
            ;          prop_age6M[INDEX_lengthdata2C] = Length_key3[44, INDEX_lengthdata2C]
            ;          prop_age7M[INDEX_lengthdata2C] = Length_key3[45, INDEX_lengthdata2C]
            ;          prop_age8M[INDEX_lengthdata2C] = Length_key3[46, INDEX_lengthdata2C]
            ;          prop_age9M[INDEX_lengthdata2C] = Length_key3[47, INDEX_lengthdata2C]
            ;          prop_age10M[INDEX_lengthdata2C] = Length_key3[48, INDEX_lengthdata2C]
            ;          prop_age11M[INDEX_lengthdata2C] = Length_key3[49, INDEX_lengthdata2C]
            ;          prop_age12M[INDEX_lengthdata2C] = Length_key3[50, INDEX_lengthdata2C]
            ;          prop_age13M[INDEX_lengthdata2C] = Length_key3[51, INDEX_lengthdata2C]
            ;          prop_age14M[INDEX_lengthdata2C] = Length_key3[52, INDEX_lengthdata2C]
            ;          prop_age15M[INDEX_lengthdata2C] = Length_key3[53, INDEX_lengthdata2C]
            ;          prop_age16M[INDEX_lengthdata2C] = Length_key3[54, INDEX_lengthdata2C]
            ;          prop_age17M[INDEX_lengthdata2C] = Length_key3[55, INDEX_lengthdata2C]
            ;          prop_age18M[INDEX_lengthdata2C] = Length_key3[56, INDEX_lengthdata2C]
            ;          prop_age19M[INDEX_lengthdata2C] = Length_key3[57, INDEX_lengthdata2C]
            ;          prop_age20M[INDEX_lengthdata2C] = Length_key3[58, INDEX_lengthdata2C]
            ;          prop_age21M[INDEX_lengthdata2C] = Length_key3[59, INDEX_lengthdata2C]
            ;          prop_age22M[INDEX_lengthdata2C] = Length_key3[60, INDEX_lengthdata2C]
            ;          prop_age23M[INDEX_lengthdata2C] = Length_key3[61, INDEX_lengthdata2C]
            ;          prop_age24M[INDEX_lengthdata2C] = Length_key3[62, INDEX_lengthdata2C]
            ;          prop_age25M[INDEX_lengthdata2C] = Length_key3[63, INDEX_lengthdata2C]
            ;          prop_age26M[INDEX_lengthdata2C] = Length_key3[64, INDEX_lengthdata2C]
            ;
            ;          ; if age-length key does not exist - females
            ;          IF (SizeLT100Fcount GT 0) AND (Length_N_fishF[INDEX_lengthdata2C[0]] LE 0) THEN $
            ;            Length_key3[66L:92L, INDEX_lengthdata2C[0]] = Length_key3[10L:36L, INDEX_lengthdata2C[0]]
            ;          IF (Size100to120Fcount GT 0) AND (Length_N_fishF[INDEX_lengthdata2C[1]] LE 0) THEN $
            ;            Length_key3[66L:92L, INDEX_lengthdata2C[1]] = Length_key3[10L:36L, INDEX_lengthdata2C[1]]
            ;          IF (Size120to140Fcount GT 0) AND (Length_N_fishF[INDEX_lengthdata2C[2]] LE 0) THEN $
            ;            Length_key3[66L:92L, INDEX_lengthdata2C[2]] = Length_key3[10L:36L, INDEX_lengthdata2C[2]]
            ;          IF (Size140to160Fcount GT 0) AND (Length_N_fishF[INDEX_lengthdata2C[3]] LE 0) THEN $
            ;            Length_key3[66L:92L, INDEX_lengthdata2C[3]] = Length_key3[10L:36L, INDEX_lengthdata2C[3]]
            ;          IF (Size160to180Fcount GT 0) AND (Length_N_fishF[INDEX_lengthdata2C[4]] LE 0) THEN $
            ;            Length_key3[66L:92L, INDEX_lengthdata2C[4]] = Length_key3[10L:36L, INDEX_lengthdata2C[4]]
            ;          IF (Size180to200Fcount GT 0) AND (Length_N_fishF[INDEX_lengthdata2C[5]] LE 0) THEN $
            ;            Length_key3[66L:92L, INDEX_lengthdata2C[5]] = Length_key3[10L:36L, INDEX_lengthdata2C[5]]
            ;          IF (Size200to220Fcount GT 0) AND (Length_N_fishF[INDEX_lengthdata2C[6]] LE 0) THEN $
            ;            Length_key3[66L:92L, INDEX_lengthdata2C[6]] = Length_key3[10L:36L, INDEX_lengthdata2C[6]]
            ;          IF (Size220to240Fcount GT 0) AND (Length_N_fishF[INDEX_lengthdata2C[7]] LE 0) THEN $
            ;            Length_key3[66L:92L, INDEX_lengthdata2C[7]] = Length_key3[10L:36L, INDEX_lengthdata2C[7]]
            ;          IF (Size240to260Fcount GT 0) AND (Length_N_fishF[INDEX_lengthdata2C[8]] LE 0) THEN $
            ;            Length_key3[66L:92L, INDEX_lengthdata2C[8]] = Length_key3[10L:36L, INDEX_lengthdata2C[8]]
            ;          IF (Size260to280Fcount GT 0) AND (Length_N_fishF[INDEX_lengthdata2C[9]] LE 0) THEN $
            ;            Length_key3[66L:92L, INDEX_lengthdata2C[9]] = Length_key3[10L:36L, INDEX_lengthdata2C[9]]
            ;          IF (Size280to300Fcount GT 0) AND (Length_N_fishF[INDEX_lengthdata2C[10]] LE 0) THEN $
            ;            Length_key3[66L:92L, INDEX_lengthdata2C[10]] = Length_key3[10L:36L, INDEX_lengthdata2C[10]]
            ;          IF (Size300to320Fcount GT 0) AND (Length_N_fishF[INDEX_lengthdata2C[11]] LE 0) THEN $
            ;            Length_key3[66L:92L, INDEX_lengthdata2C[11]] = Length_key3[10L:36L, INDEX_lengthdata2C[11]]
            ;          IF (Size320to340Fcount GT 0) AND (Length_N_fishF[INDEX_lengthdata2C[12]] LE 0) THEN $
            ;            Length_key3[66L:92L, INDEX_lengthdata2C[12]] = Length_key3[10L:36L, INDEX_lengthdata2C[12]]
            ;          IF (Size340to360Fcount GT 0) AND (Length_N_fishF[INDEX_lengthdata2C[13]] LE 0) THEN $
            ;            Length_key3[66L:92L, INDEX_lengthdata2C[13]] = Length_key3[10L:36L, INDEX_lengthdata2C[13]]
            ;          IF (Size360to380Fcount GT 0) AND (Length_N_fishF[INDEX_lengthdata2C[14]] LE 0) THEN $
            ;            Length_key3[66L:92L, INDEX_lengthdata2C[14]] = Length_key3[10L:36L, INDEX_lengthdata2C[14]]
            ;          IF (Size380to400Fcount GT 0) AND (Length_N_fishF[INDEX_lengthdata2C[15]] LE 0) THEN $
            ;            Length_key3[66L:92L, INDEX_lengthdata2C[15]] = Length_key3[10L:36L, INDEX_lengthdata2C[15]]
            ;          IF (Size400to420Fcount GT 0) AND (Length_N_fishF[INDEX_lengthdata2C[16]] LE 0) THEN $
            ;            Length_key3[66L:92L, INDEX_lengthdata2C[16]] = Length_key3[10L:36L, INDEX_lengthdata2C[16]]
            ;          IF (Size420to440Fcount GT 0) AND (Length_N_fishF[INDEX_lengthdata2C[17]] LE 0) THEN $
            ;            Length_key3[66L:92L, INDEX_lengthdata2C[17]] = Length_key3[10L:36L, INDEX_lengthdata2C[17]]
            ;          IF (Size440to460Fcount GT 0) AND (Length_N_fishF[INDEX_lengthdata2C[18]] LE 0) THEN $
            ;            Length_key3[66L:92L, INDEX_lengthdata2C[18]] = Length_key3[10L:36L, INDEX_lengthdata2C[18]]
            ;          IF (Size460to480Fcount GT 0) AND (Length_N_fishF[INDEX_lengthdata2C[19]] LE 0) THEN $
            ;            Length_key3[66L:92L, INDEX_lengthdata2C[19]] = Length_key3[10L:36L, INDEX_lengthdata2C[19]]
            ;          IF (Size480to500Fcount GT 0) AND (Length_N_fishF[INDEX_lengthdata2C[20]] LE 0) THEN $
            ;            Length_key3[66L:92L, INDEX_lengthdata2C[20]] = Length_key3[10L:36L, INDEX_lengthdata2C[20]]
            ;          IF (Size500to520Fcount GT 0) AND (Length_N_fishF[INDEX_lengthdata2C[21]] LE 0) THEN $
            ;            Length_key3[66L:92L, INDEX_lengthdata2C[21]] = Length_key3[10L:36L, INDEX_lengthdata2C[21]]
            ;          IF (Size520to540Fcount GT 0) AND (Length_N_fishF[INDEX_lengthdata2C[22]] LE 0) THEN $
            ;            Length_key3[66L:92L, INDEX_lengthdata2C[22]] = Length_key3[10L:36L, INDEX_lengthdata2C[22]]
            ;          IF (Size540to560Fcount GT 0) AND (Length_N_fishF[INDEX_lengthdata2C[23]] LE 0) THEN $
            ;            Length_key3[66L:92L, INDEX_lengthdata2C[23]] = Length_key3[10L:36L, INDEX_lengthdata2C[23]]
            ;          IF (Size560to580Fcount GT 0) AND (Length_N_fishF[INDEX_lengthdata2C[24]] LE 0) THEN $
            ;            Length_key3[66L:92L, INDEX_lengthdata2C[24]] = Length_key3[10L:36L, INDEX_lengthdata2C[24]]
            ;          IF (Size580to600Fcount GT 0) AND (Length_N_fishF[INDEX_lengthdata2C[25]] LE 0) THEN $
            ;            Length_key3[66L:92L, INDEX_lengthdata2C[25]] = Length_key3[10L:36L, INDEX_lengthdata2C[25]]
            ;          IF (Size600to620Fcount GT 0) AND (Length_N_fishF[INDEX_lengthdata2C[26]] LE 0) THEN $
            ;            Length_key3[66L:92L, INDEX_lengthdata2C[26]] = Length_key3[10L:36L, INDEX_lengthdata2C[26]]
            ;          IF (Size620to640Mcount GT 0) AND (Length_N_fishF[INDEX_lengthdata2C[27]] LE 0) THEN $
            ;            Length_key3[66L:92L, INDEX_lengthdata2C[27]] = Length_key3[10L:36L, INDEX_lengthdata2C[27]]
            ;          IF (Size640to660Fcount GT 0) AND (Length_N_fishF[INDEX_lengthdata2C[28]] LE 0) THEN $
            ;            Length_key3[66L:92L, INDEX_lengthdata2C[28]] = Length_key3[10L:36L, INDEX_lengthdata2C[28]]
            ;          IF (Size660to680Fcount GT 0) AND (Length_N_fishF[INDEX_lengthdata2C[29]] LE 0) THEN $
            ;            Length_key3[66L:92L, INDEX_lengthdata2C[29]] = Length_key3[10L:36L, INDEX_lengthdata2C[29]]
            ;          IF (Size680to700Fcount GT 0) AND (Length_N_fishF[INDEX_lengthdata2C[30]] LE 0) THEN $
            ;            Length_key3[66L:92L, INDEX_lengthdata2C[30]] = Length_key3[10L:36L, INDEX_lengthdata2C[30]]
            ;          IF (Size700to720Fcount GT 0) AND (Length_N_fishF[INDEX_lengthdata2C[31]] LE 0) THEN $
            ;            Length_key3[66L:92L, INDEX_lengthdata2C[31]] = Length_key3[10L:36L, INDEX_lengthdata2C[31]]
            ;          IF (Size720to740Fcount GT 0) AND (Length_N_fishF[INDEX_lengthdata2C[32]] LE 0) THEN $
            ;            Length_key3[66L:92L, INDEX_lengthdata2C[32]] = Length_key3[10L:36L, INDEX_lengthdata2C[32]]
            ;          IF (Size740to760Fcount GT 0) AND (Length_N_fishF[INDEX_lengthdata2C[33]] LE 0) THEN $
            ;            Length_key3[66L:92L, INDEX_lengthdata2C[33]] = Length_key3[10L:36L, INDEX_lengthdata2C[33]]
            ;          IF (Size760to780Fcount GT 0) AND (Length_N_fishF[INDEX_lengthdata2C[34]] LE 0) THEN $
            ;            Length_key3[66L:92L, INDEX_lengthdata2C[34]] = Length_key3[10L:36L, INDEX_lengthdata2C[34]]
            ;          IF (Size780to800Fcount GT 0) AND (Length_N_fishF[INDEX_lengthdata2C[35]] LE 0) THEN $
            ;            Length_key3[66L:92L, INDEX_lengthdata2C[35]] = Length_key3[10L:36L, INDEX_lengthdata2C[35]]
            ;          IF (SizeGE800Fcount GT 0) AND (Length_N_fishF[INDEX_lengthdata2C[36]] LE 0) THEN $
            ;            Length_key3[66L:92L, INDEX_lengthdata2C[36]] = Length_key3[10L:36L, INDEX_lengthdata2C[36]]
            ;
            ;          prop_age0F[INDEX_lengthdata2C] = Length_key3[66, INDEX_lengthdata2C]
            ;          prop_age1F[INDEX_lengthdata2C] = Length_key3[67, INDEX_lengthdata2C]
            ;          prop_age2F[INDEX_lengthdata2C] = Length_key3[68, INDEX_lengthdata2C]
            ;          prop_age3F[INDEX_lengthdata2C] = Length_key3[69, INDEX_lengthdata2C]
            ;          prop_age4F[INDEX_lengthdata2C] = Length_key3[70, INDEX_lengthdata2C]
            ;          prop_age5F[INDEX_lengthdata2C] = Length_key3[71, INDEX_lengthdata2C]
            ;          prop_age6F[INDEX_lengthdata2C] = Length_key3[72, INDEX_lengthdata2C]
            ;          prop_age7F[INDEX_lengthdata2C] = Length_key3[73, INDEX_lengthdata2C]
            ;          prop_age8F[INDEX_lengthdata2C] = Length_key3[74, INDEX_lengthdata2C]
            ;          prop_age9F[INDEX_lengthdata2C] = Length_key3[75, INDEX_lengthdata2C]
            ;          prop_age10F[INDEX_lengthdata2C] = Length_key3[76, INDEX_lengthdata2C]
            ;          prop_age11F[INDEX_lengthdata2C] = Length_key3[77, INDEX_lengthdata2C]
            ;          prop_age12F[INDEX_lengthdata2C] = Length_key3[78, INDEX_lengthdata2C]
            ;          prop_age13F[INDEX_lengthdata2C] = Length_key3[79, INDEX_lengthdata2C]
            ;          prop_age14F[INDEX_lengthdata2C] = Length_key3[80, INDEX_lengthdata2C]
            ;          prop_age15F[INDEX_lengthdata2C] = Length_key3[81, INDEX_lengthdata2C]
            ;          prop_age16F[INDEX_lengthdata2C] = Length_key3[82, INDEX_lengthdata2C]
            ;          prop_age17F[INDEX_lengthdata2C] = Length_key3[83, INDEX_lengthdata2C]
            ;          prop_age18F[INDEX_lengthdata2C] = Length_key3[84, INDEX_lengthdata2C]
            ;          prop_age19F[INDEX_lengthdata2C] = Length_key3[85, INDEX_lengthdata2C]
            ;          prop_age20F[INDEX_lengthdata2C] = Length_key3[86, INDEX_lengthdata2C]
            ;          prop_age21F[INDEX_lengthdata2C] = Length_key3[87, INDEX_lengthdata2C]
            ;          prop_age22F[INDEX_lengthdata2C] = Length_key3[88, INDEX_lengthdata2C]
            ;          prop_age23F[INDEX_lengthdata2C] = Length_key3[89, INDEX_lengthdata2C]
            ;          prop_age24F[INDEX_lengthdata2C] = Length_key3[90, INDEX_lengthdata2C]
            ;          prop_age25F[INDEX_lengthdata2C] = Length_key3[91, INDEX_lengthdata2C]
            ;          prop_age26F[INDEX_lengthdata2C] = Length_key3[92, INDEX_lengthdata2C]


            ; 1.Assign age semi-randomly to lengths - all fish
            IF SizeLT100count GT 0 then begin
              LengthBinIndex1 = 0
              LengthBinIndex2 = SizeLT100
              FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                , prop_age26, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb 
              AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, $
                FishProb, FishAge[LengthBinIndex2] $
                , i+NumLengthBin+adj)
              WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
              WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
              AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2 $
                , FishProb, FishAge[LengthBinIndex2] $
                , i+NumLengthBin+adj)
              ;FishAge[LengthBinIndex2]= AgeAssignInd
            ENDIF
            IF Size100to120count GT 0 then begin
              LengthBinIndex1 = 1
              LengthBinIndex2 = Size100to120
              FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                , prop_age26, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                , i+NumLengthBin+adj)
              WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
              WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
              AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                , i+NumLengthBin+adj)
              ;FishAge[LengthBinIndex2]= AgeAssignInd
            ENDIF
            IF Size120to140count GT 0 then begin
              LengthBinIndex1 = 2
              LengthBinIndex2 = Size120to140
              FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                , prop_age26, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
                
              AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                , i+NumLengthBin+adj)
              WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
              WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
              AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                , i+NumLengthBin+adj)
              ;FishAge[LengthBinIndex2]= AgeAssignInd
            ENDIF
            IF Size140to160count GT 0 then begin
              LengthBinIndex1 = 3
              LengthBinIndex2 = Size140to160
              FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                , prop_age26, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                , i+NumLengthBin+adj)
              WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
              WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
              AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                , i+NumLengthBin+adj)
              ;FishAge[LengthBinIndex2]= AgeAssignInd
            ENDIF
            IF Size160to180count GT 0 THEN BEGIN
              LengthBinIndex1 = 4
              LengthBinIndex2 = Size160to180
              FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                , prop_age26, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                , i+NumLengthBin+adj)
              WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
              WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
              AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                , i+NumLengthBin+adj)
              ;FishAge[LengthBinIndex2]= AgeAssignInd
            ENDIF
            IF Size180to200count GT 0 then begin
              LengthBinIndex1 = 5
              LengthBinIndex2 = Size180to200
              FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                , prop_age26, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
                
              AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                , i+NumLengthBin+adj)
              WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
              WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
              AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                , i+NumLengthBin+adj)
              ;FishAge[LengthBinIndex2]= AgeAssignInd
            ENDIF
            IF Size200to220count GT 0 then begin
              LengthBinIndex1 = 6
              LengthBinIndex2 = Size200to220
                FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                , prop_age26, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
                
              AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                , i+NumLengthBin+adj)
              WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
              WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
              AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                , i+NumLengthBin+adj)
              ;FishAge[LengthBinIndex2]= AgeAssignInd
            ENDIF
            IF Size220to240count GT 0 then begin
              LengthBinIndex1 = 7
              LengthBinIndex2 = Size220to240
              FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                , prop_age26, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
                
              AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                , i+NumLengthBin+adj)
              WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
              WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
              AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                , i+NumLengthBin+adj)
              ;FishAge[LengthBinIndex2]= AgeAssignInd
            ENDIF
            IF Size240to260count GT 0 then begin
              LengthBinIndex1 = 8
              LengthBinIndex2 = Size240to260
              FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                , prop_age26, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb

              AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                , i+NumLengthBin+adj)
              WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
              WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
              AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                , i+NumLengthBin+adj)
              ;FishAge[LengthBinIndex2]= AgeAssignInd
            ENDIF
            IF Size260to280count GT 0 then begin
              LengthBinIndex1 = 9
              LengthBinIndex2 = Size260to280
              FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                , prop_age26, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              
              AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                , i+NumLengthBin+adj)
              WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
              WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
              AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                , i+NumLengthBin+adj)
              ;FishAge[LengthBinIndex2]= AgeAssignInd
            ENDIF
            IF Size280to300count GT 0 then begin
              LengthBinIndex1 = 10
              LengthBinIndex2 = Size280to300
              FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                , prop_age26, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              
              AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                , i+NumLengthBin+adj)
              WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
              WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
              AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                , i+NumLengthBin+adj)
              ;FishAge[LengthBinIndex2]= AgeAssignInd
            ENDIF
            IF Size300to320count GT 0 then begin
              LengthBinIndex1 = 11
              LengthBinIndex2 = Size300to320
               FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                , prop_age26, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              
              AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                , i+NumLengthBin+adj)
              WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
              WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
              AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                , i+NumLengthBin+adj)
              ;FishAge[LengthBinIndex2]= AgeAssignInd
            ENDIF
            IF Size320to340count GT 0 then begin
              LengthBinIndex1 = 12
              LengthBinIndex2 = Size320to340
               FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                , prop_age26, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              
              AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                , i+NumLengthBin+adj)
              WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
              WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
              AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                , i+NumLengthBin+adj)
              ;FishAge[LengthBinIndex2]= AgeAssignInd
            ENDIF
            IF Size340to360count GT 0 then begin
              LengthBinIndex1 = 13
              LengthBinIndex2 = Size340to360
              FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                , prop_age26, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              
              AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                , i+NumLengthBin+adj)
              WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
              WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
              AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                , i+NumLengthBin+adj)
              ;FishAge[LengthBinIndex2]= AgeAssignInd
            ENDIF
            IF Size360to380count GT 0 then begin
              LengthBinIndex1 = 14
              LengthBinIndex2 = Size360to380
              FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                , prop_age26, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              
              AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                , i+NumLengthBin+adj)
              WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
              WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
              AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                , i+NumLengthBin+adj)
              ;FishAge[LengthBinIndex2]= AgeAssignInd
            ENDIF
            IF Size380to400count GT 0 then begin
              LengthBinIndex1 = 15
              LengthBinIndex2 = Size380to400
              FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                , prop_age26, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              
              AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                , i+NumLengthBin+adj)
              WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
              WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
              AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                , i+NumLengthBin+adj)
              ;FishAge[LengthBinIndex2]= AgeAssignInd
            ENDIF
            IF Size400to420count GT 0 then begin
              LengthBinIndex1 = 16
              LengthBinIndex2 = Size400to420
              FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                , prop_age26, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              
              AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                , i+NumLengthBin+adj)
              WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
              WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
              AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                , i+NumLengthBin+adj)
              ;FishAge[LengthBinIndex2]= AgeAssignInd
            ENDIF
            IF Size420to440count GT 0 then begin
              LengthBinIndex1 = 17
              LengthBinIndex2 = Size420to440
              FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                , prop_age26, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                , i+NumLengthBin+adj)
              WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
              WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
              AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                , i+NumLengthBin+adj)
              ;FishAge[LengthBinIndex2]= AgeAssignInd
            ENDIF
            IF Size440to460count GT 0 then begin
              LengthBinIndex1 = 18
              LengthBinIndex2 = Size440to460
              FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                , prop_age26, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                , i+NumLengthBin+adj)
              WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
              WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
              AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                , i+NumLengthBin+adj)
              ;FishAge[LengthBinIndex2]= AgeAssignInd
            ENDIF
            IF Size460to480count GT 0 then begin
              LengthBinIndex1 = 19
              LengthBinIndex2 = Size460to480
              FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                , prop_age26, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                , i+NumLengthBin+adj)
              WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
              WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
              AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                , i+NumLengthBin+adj)
              ;FishAge[LengthBinIndex2]= AgeAssignInd
            ENDIF
            IF Size480to500count GT 0 then begin
              LengthBinIndex1 = 20
              LengthBinIndex2 = Size480to500
               FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                , prop_age26, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                , i+NumLengthBin+adj)
              WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
              WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
              AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                , i+NumLengthBin+adj)
              ;FishAge[LengthBinIndex2]= AgeAssignInd
            ENDIF
            IF Size500to520count GT 0 then begin
              LengthBinIndex1 = 21
              LengthBinIndex2 = Size500to520
              FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                , prop_age26, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                , i+NumLengthBin+adj)
              WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
              WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
              AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                , i+NumLengthBin+adj)
              ;FishAge[LengthBinIndex2]= AgeAssignInd
            ENDIF
            IF Size520to540count GT 0 then begin
              LengthBinIndex1 = 22
              LengthBinIndex2 = Size520to540
              FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                , prop_age26, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                , i+NumLengthBin+adj)
              WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
              WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
              AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                , i+NumLengthBin+adj)
              ;FishAge[LengthBinIndex2]= AgeAssignInd
            ENDIF
            IF Size540to560count GT 0 then begin
              LengthBinIndex1 = 23
              LengthBinIndex2 = Size540to560
              FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                , prop_age26, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                , i+NumLengthBin+adj)
              WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
              WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
              AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                , i+NumLengthBin+adj)
              ;FishAge[LengthBinIndex2]= AgeAssignInd
            ENDIF
            IF Size560to580count GT 0 then begin
              LengthBinIndex1 = 24
              LengthBinIndex2 = Size560to580
              FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                , prop_age26, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                , i+NumLengthBin+adj)
              WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
              WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
              AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                , i+NumLengthBin+adj)
              ;FishAge[LengthBinIndex2]= AgeAssignInd
            ENDIF
            IF Size580to600count GT 0 then begin
              LengthBinIndex1 = 25
              LengthBinIndex2 = Size580to600
              FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                , prop_age26, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                , i+NumLengthBin+adj)
              WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
              WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
              AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                , i+NumLengthBin+adj)
              ;FishAge[LengthBinIndex2]= AgeAssignInd
            ENDIF
            IF Size600to620count GT 0 then begin
              LengthBinIndex1 = 26
              LengthBinIndex2 = Size600to620
              FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                , prop_age26, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                , i+NumLengthBin+adj)
              WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
              WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
              AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                , i+NumLengthBin+adj)
              ;FishAge[LengthBinIndex2]= AgeAssignInd
            ENDIF
            IF Size620to640count GT 0 then begin
              LengthBinIndex1 = 27
              LengthBinIndex2 = Size620to640
              FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                , prop_age26, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                , i+NumLengthBin+adj)
              WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
              WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
              AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                , i+NumLengthBin+adj)
              ;FishAge[LengthBinIndex2]= AgeAssignInd
            ENDIF
            IF Size640to660count GT 0 then begin
              LengthBinIndex1 = 28
              LengthBinIndex2 = Size640to660
              FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                , prop_age26, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                , i+NumLengthBin+adj)
              WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
              WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
              AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                , i+NumLengthBin+adj)
              ;FishAge[LengthBinIndex2]= AgeAssignInd
            ENDIF
            IF Size660to680count GT 0 then begin
              LengthBinIndex1 = 29
              LengthBinIndex2 = Size660to680
              FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                , prop_age26, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                , i+NumLengthBin+adj)
              WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
              WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
              AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                , i+NumLengthBin+adj)
              ;FishAge[LengthBinIndex2]= AgeAssignInd
            ENDIF
            IF Size680to700count GT 0 then begin
              LengthBinIndex1 = 30
              LengthBinIndex2 = Size680to700
               FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                , prop_age26, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                , i+NumLengthBin+adj)
              WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
              WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
              AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                , i+NumLengthBin+adj)
              ;FishAge[LengthBinIndex2]= AgeAssignInd
            ENDIF
            IF Size700to720count GT 0 then begin
              LengthBinIndex1 = 31
              LengthBinIndex2 = Size700to720
              FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                , prop_age26, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb

              AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                , i+NumLengthBin+adj)
              WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
              WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
              AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                , i+NumLengthBin+adj)
              ;FishAge[LengthBinIndex2]= AgeAssignInd
            ENDIF
            IF Size720to740count GT 0 then begin
              LengthBinIndex1 = 32
              LengthBinIndex2 = Size720to740
               FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                , prop_age26, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                , i+NumLengthBin+adj)
              WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
              WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
              AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                , i+NumLengthBin+adj)
              ;FishAge[LengthBinIndex2]= AgeAssignInd
            ENDIF
            IF Size740to760count GT 0 then begin
              LengthBinIndex1 = 33
              LengthBinIndex2 = Size740to760
              FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                , prop_age26, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                , i+NumLengthBin+adj)
              WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
              WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
              AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                , i+NumLengthBin+adj)
              ;FishAge[LengthBinIndex2]= AgeAssignInd
            ENDIF
            IF Size760to780count GT 0 then begin
              LengthBinIndex1 = 34
              LengthBinIndex2 = Size760to780
              FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                , prop_age26, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                , i+NumLengthBin+adj)
              WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
              WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
              AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                , i+NumLengthBin+adj)
              ;FishAge[LengthBinIndex2]= AgeAssignInd
            ENDIF
            IF Size780to800count GT 0 then begin
              LengthBinIndex1 = 35
              LengthBinIndex2 = Size780to800
              FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                , prop_age26, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                , i+NumLengthBin+adj)
              WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
              WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
              AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                , i+NumLengthBin+adj)
              ;FishAge[LengthBinIndex2]= AgeAssignInd
            ENDIF
            IF Sizege800count GT 0 then begin
              LengthBinIndex1 = 36
              LengthBinIndex2 = SizeGE800
              FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                , prop_age26, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              AgeAssign = WalleyeAgeAssign(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                , i+NumLengthBin+adj)
              WAE_length_mean[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[0, *]
              WAE_length_bin[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssign[1, *]
              AgeAssignInd = WalleyeAgeAssignInd(Length_prod[LengthBinIndex2], LengthBinIndex2, FishProb, FishAge[LengthBinIndex2] $
                , i+NumLengthBin+adj)
              ;FishAge[LengthBinIndex2]= AgeAssignInd
            ENDIF

            ; 1. Assign age semi-randomly to lengths - MALES
            IF SizeLT100Mcount GT 0 THEN BEGIN
              LengthBinIndex1 = 0
              LengthBinIndex2 = SizeLT100M
              FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
                , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
                , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
                , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
                , prop_age26M, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
                , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
              WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
              ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
              AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
              FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
              FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
            ENDIF
            IF Size100to120Mcount GT 0 THEN BEGIN
              LengthBinIndex1 = 1
              LengthBinIndex2 = Size100to120M
              FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
                , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
                , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
                , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
                , prop_age26M, INDEX_lengthdata2C, LengthBinIndex1)
              AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
                , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
              WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
              ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
              AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
              FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
              FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
            ENDIF
            IF Size120to140Mcount GT 0 THEN BEGIN
              LengthBinIndex1 = 2
              LengthBinIndex2 = Size120to140M
              FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
                , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
                , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
                , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
                , prop_age26M, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              
              AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
                , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
              WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
              ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
              AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
              FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
              FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
            ENDIF
            IF Size140to160Mcount GT 0 THEN BEGIN
              LengthBinIndex1 = 3
              LengthBinIndex2 = Size140to160M
              FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
                , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
                , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
                , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
                , prop_age26M, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              
              AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
                , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
              WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
              ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
              AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
              FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
              FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
            ENDIF
            IF Size160to180Mcount GT 0 THEN BEGIN
              LengthBinIndex1 = 4
              LengthBinIndex2 = Size160to180M
               FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
                , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
                , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
                , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
                , prop_age26M, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              
              AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
                , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
              WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
              ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
              AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
              FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
              FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
            ENDIF
            IF Size180to200Mcount GT 0 THEN BEGIN
              LengthBinIndex1 = 5
              LengthBinIndex2 = Size180to200M
               FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
                , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
                , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
                , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
                , prop_age26M, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              
              AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
                , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
              WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
              ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
              AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
              FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
              FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
            ENDIF
            IF Size200to220Mcount GT 0 THEN BEGIN
              LengthBinIndex1 = 6
              LengthBinIndex2 = Size200to220M
               FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
                , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
                , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
                , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
                , prop_age26M, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              
              AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
                , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
              WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
              ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
              AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
              FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
              FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
            ENDIF
            IF Size220to240Mcount GT 0 THEN BEGIN
              LengthBinIndex1 = 7
              LengthBinIndex2 = Size220to240M
               FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
                , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
                , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
                , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
                , prop_age26M, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              
              AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
                , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
              WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
              ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
              AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
              FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
              FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
            ENDIF
            IF Size240to260Mcount GT 0 THEN BEGIN
              LengthBinIndex1 = 8
              LengthBinIndex2 = Size240to260M
              FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
                , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
                , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
                , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
                , prop_age26M, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              
              AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
                , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
              WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
              ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
              AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
              FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
              FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
            ENDIF
            IF Size260to280Mcount GT 0 THEN BEGIN
              LengthBinIndex1 = 9
              LengthBinIndex2 = Size260to280M
               FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
                , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
                , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
                , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
                , prop_age26M, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
                , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
              WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
              ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
              AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
              FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
              FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
            ENDIF
            IF Size280to300Mcount GT 0 THEN BEGIN
              LengthBinIndex1 = 10
              LengthBinIndex2 = Size280to300M
               FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
                , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
                , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
                , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
                , prop_age26M, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              
              AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
                , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
              WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
              ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
              AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
              FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
              FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
            ENDIF
            IF Size300to320Mcount GT 0 THEN BEGIN
              LengthBinIndex1 = 11
              LengthBinIndex2 = Size300to320M
               FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
                , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
                , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
                , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
                , prop_age26M, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              
              AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
                , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
              WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
              ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
              AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
              FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
              FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
            ENDIF
            IF Size320to340Mcount GT 0 THEN BEGIN
              LengthBinIndex1 = 12
              LengthBinIndex2 = Size320to340M
               FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
                , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
                , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
                , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
                , prop_age26M, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb

              AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
                , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
              WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
              ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
              AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
              FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
              FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
            ENDIF
            IF Size340to360Mcount GT 0 THEN BEGIN
              LengthBinIndex1 = 13
              LengthBinIndex2 = Size340to360M
               FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
                , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
                , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
                , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
                , prop_age26M, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              
              AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
                , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
              WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
              ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
              AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
              FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
              FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
            ENDIF
            IF Size360to380Mcount GT 0 THEN BEGIN
              LengthBinIndex1 = 14
              LengthBinIndex2 = Size360to380M
               FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
                , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
                , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
                , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
                , prop_age26M, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              
              AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
                , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
              WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
              ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
              AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
              FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
              FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
            ENDIF
            IF Size380to400Mcount GT 0 THEN BEGIN
              LengthBinIndex1 = 15
              LengthBinIndex2 = Size380to400M
               FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
                , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
                , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
                , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
                , prop_age26M, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              
              AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
                , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
              WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
              ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
              AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
              FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
              FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
            ENDIF
            IF Size400to420Mcount GT 0 THEN BEGIN
              LengthBinIndex1 = 16
              LengthBinIndex2 = Size400to420M
               FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
                , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
                , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
                , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
                , prop_age26M, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb

              AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
                , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
              WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
              ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
              AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
              FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
              FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
            ENDIF
            IF Size420to440Mcount GT 0 THEN BEGIN
              LengthBinIndex1 = 17
              LengthBinIndex2 = Size420to440M
               FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
                , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
                , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
                , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
                , prop_age26M, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              
              AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
                , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
              WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
              ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
              AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
              FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
              FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
            ENDIF
            IF Size440to460Mcount GT 0 THEN BEGIN
              LengthBinIndex1 = 18
              LengthBinIndex2 = Size440to460M
                            FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
                , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
                , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
                , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
                , prop_age26M, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              
              AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
                , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
              WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
              ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
              AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
              FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
              FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
            ENDIF
            IF Size460to480Mcount GT 0 THEN BEGIN
              LengthBinIndex1 = 19
              LengthBinIndex2 = Size460to480M
               FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
                , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
                , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
                , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
                , prop_age26M, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              
              AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
                , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
              WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
              ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
              AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
              FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
              FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
            ENDIF
            IF Size480to500Mcount GT 0 THEN BEGIN
              LengthBinIndex1 = 20
              LengthBinIndex2 = Size480to500M
               FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
                , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
                , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
                , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
                , prop_age26M, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              
              AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
                , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
              WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
              ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
              AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
              FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
              FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
            ENDIF
            IF Size500to520Mcount GT 0 THEN BEGIN
              LengthBinIndex1 = 21
              LengthBinIndex2 = Size500to520M
               FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
                , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
                , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
                , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
                , prop_age26M, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              
              AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
                , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
              WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
              ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
              AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
              FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
              FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
            ENDIF
            IF Size520to540Mcount GT 0 THEN BEGIN
              LengthBinIndex1 = 22
              LengthBinIndex2 = Size520to540M
              FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
                , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
                , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
                , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
                , prop_age26M, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              
              AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
                , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
              WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
              ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
              AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
              FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
              FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
            ENDIF
            IF Size540to560Mcount GT 0 THEN BEGIN
              LengthBinIndex1 = 23
              LengthBinIndex2 = Size540to560M
               FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
                , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
                , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
                , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
                , prop_age26M, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              
              AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
                , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
              WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
              ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
              AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
              FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
              FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
            ENDIF
            IF Size560to580Mcount GT 0 THEN BEGIN
              LengthBinIndex1 = 24
              LengthBinIndex2 = Size560to580M
               FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
                , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
                , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
                , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
                , prop_age26M, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              
              AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
                , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
              WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
              ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
              AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
              FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
              FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
            ENDIF
            IF Size580to600Mcount GT 0 THEN BEGIN
              LengthBinIndex1 = 25
              LengthBinIndex2 = Size580to600M
                FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
                , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
                , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
                , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
                , prop_age26M, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              
              AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
                , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
              WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
              ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
              AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
              FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
              FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
            ENDIF
            IF Size600to620Mcount GT 0 THEN BEGIN
              LengthBinIndex1 = 26
              LengthBinIndex2 = Size600to620M
                 FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
                , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
                , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
                , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
                , prop_age26M, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              
              AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
                , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
              WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
              ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
              AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
              FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
              FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
            ENDIF
            IF Size620to640Mcount GT 0 THEN BEGIN
              LengthBinIndex1 = 27
              LengthBinIndex2 = Size620to640M
               FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
                , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
                , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
                , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
                , prop_age26M, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              
              AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
                , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
              WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
              ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
              AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
              FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
              FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
            ENDIF
            IF Size640to660Mcount GT 0 THEN BEGIN
              LengthBinIndex1 = 28
              LengthBinIndex2 = Size640to660M
              FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
                , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
                , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
                , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
                , prop_age26M, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              
              AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
                , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
              WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
              ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
              AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
              FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
              FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
            ENDIF
            IF Size660to680Mcount GT 0 THEN BEGIN
              LengthBinIndex1 = 29
              LengthBinIndex2 = Size660to680M
               FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
                , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
                , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
                , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
                , prop_age26M, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              
              AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
                , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
              WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
              ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
              AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
              FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
              FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
            ENDIF
            IF Size680to700Mcount GT 0 THEN BEGIN
              LengthBinIndex1 = 30
              LengthBinIndex2 = Size680to700M
              FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
                , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
                , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
                , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
                , prop_age26M, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
                , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
              WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
              ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
              AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
              FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
              FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
            ENDIF
            IF Size700to720Mcount GT 0 THEN BEGIN
              LengthBinIndex1 = 31
              LengthBinIndex2 = Size700to720M
               FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
                , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
                , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
                , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
                , prop_age26M, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
                , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
              WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
              ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
              AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
              FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
              FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
            ENDIF
            IF Size720to740Mcount GT 0 THEN BEGIN
              LengthBinIndex1 = 32
              LengthBinIndex2 = Size720to740M
               FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
                , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
                , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
                , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
                , prop_age26M, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
                , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
              WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
              ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
              AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
              FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
              FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
            ENDIF
            IF Size740to760Mcount GT 0 THEN BEGIN
              LengthBinIndex1 = 33
              LengthBinIndex2 = Size740to760M
               FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
                , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
                , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
                , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
                , prop_age26M, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
                , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
              WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
              ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
              AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
              FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
              FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
            ENDIF
            IF Size760to780Mcount GT 0 THEN BEGIN
              LengthBinIndex1 = 34
              LengthBinIndex2 = Size760to780M
                FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
                , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
                , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
                , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
                , prop_age26M, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
                , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
              WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
              ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
              AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
              FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
              FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
            ENDIF
            IF Size780to800Mcount GT 0 THEN BEGIN
              LengthBinIndex1 = 35
              LengthBinIndex2 = Size780to800M
                      FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
                , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
                , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
                , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
                , prop_age26M, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              
              AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
                , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
              WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
              ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
              AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
              FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
              FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
            ENDIF
            IF Sizege800Mcount GT 0 THEN BEGIN
              LengthBinIndex1 = 36
              LengthBinIndex2 = SizeGE800M
              FishProb = AgeLengthKey(prop_age0M, prop_age1M, prop_age2M, prop_age3M, prop_age4M, prop_age5M $
                , prop_age6M, prop_age7M, prop_age8M, prop_age9M, prop_age10M, prop_age11M, prop_age12M $
                , prop_age13M, prop_age14M, prop_age15M, prop_age16M, prop_age17M, prop_age18M, prop_age19M $
                , prop_age20M, prop_age21M, prop_age22M, prop_age23M, prop_age24M, prop_age25M $
                , prop_age26M, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              
              AgeAssignM = WalleyeAgeAssign(Length_prod[male[LengthBinIndex2]] $
                , male[LengthBinIndex2], FishProb, FishAge[male[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[0, *]
              WAE_length_binM[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignM[1, *]
              ;PRINT, 'AgeAssignM[1, *]',TRANSPOSE(AgeAssignM[1, *])
              AgeAssignIndM = WalleyeAgeAssignInd(Length_prod[male[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[male[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndM[0,*]',TRANSPOSE(AgeAssignIndM[0,*])
              FishAge[male[LengthBinIndex2]] = AgeAssignIndM[0,*]
              FishLength[male[LengthBinIndex2]] = AgeAssignIndM[1,*]
            ENDIF

            ; 1.Assign age semi-randomly to lengths - females
            IF SizeLT100Fcount GT 0 THEN BEGIN
              LengthBinIndex1 = 0
              LengthBinIndex2 = SizeLT100F
              FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
                , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
                , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
                , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
                , prop_age26F, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
      
              AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
                , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
              WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
              ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
              AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
              FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
              FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
            ENDIF
            IF Size100to120Fcount GT 0 THEN BEGIN
              LengthBinIndex1 = 1
              LengthBinIndex2 = Size100to120F
               FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
                , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
                , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
                , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
                , prop_age26F, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              
              AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
                , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
              WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
              ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
              AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
              FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
              FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
            ENDIF
            IF Size120to140Fcount GT 0 THEN BEGIN
              LengthBinIndex1 = 2
              LengthBinIndex2 = Size120to140F
               FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
                , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
                , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
                , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
                , prop_age26F, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              
              AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
                , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
              WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
              ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
              AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
              FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
              FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
            ENDIF
            IF Size140to160Fcount GT 0 THEN BEGIN
              LengthBinIndex1 = 3
              LengthBinIndex2 = Size140to160F
                FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
                , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
                , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
                , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
                , prop_age26F, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
                , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
              WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
              ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
              AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
              FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
              FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
            ENDIF
            IF Size160to180Fcount GT 0 THEN BEGIN
              LengthBinIndex1 = 4
              LengthBinIndex2 = Size160to180F
               FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
                , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
                , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
                , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
                , prop_age26F, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
                , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
              WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
              ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
              AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
              FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
              FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
            ENDIF
            IF Size180to200Fcount GT 0 THEN BEGIN
              LengthBinIndex1 = 5
              LengthBinIndex2 = Size180to200F
                FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
                , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
                , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
                , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
                , prop_age26F, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
                , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
              WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
              ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
              AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
              FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
              FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
            ENDIF
            IF Size200to220Fcount GT 0 THEN BEGIN
              LengthBinIndex1 = 6
              LengthBinIndex2 = Size200to220F
              FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
                , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
                , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
                , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
                , prop_age26F, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              
              AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
                , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
              WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
              ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
              AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
              FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
              FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
            ENDIF
            IF Size220to240Fcount GT 0 THEN BEGIN
              LengthBinIndex1 = 7
              LengthBinIndex2 = Size220to240F
              FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
                , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
                , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
                , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
                , prop_age26F, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb

              AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
                , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
              WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
              ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
              AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
              FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
              FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
            ENDIF
            IF Size240to260Fcount GT 0 THEN BEGIN
              LengthBinIndex1 = 8
              LengthBinIndex2 = Size240to260F
              FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
                , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
                , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
                , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
                , prop_age26F, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              
              AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
                , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
              WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
              ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
              AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
              FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
              FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
            ENDIF
            IF Size260to280Fcount GT 0 THEN BEGIN
              LengthBinIndex1 = 9
              LengthBinIndex2 = Size260to280F
              FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
                , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
                , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
                , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
                , prop_age26F, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              
              AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
                , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
              WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
              ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
              AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
              FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
              FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
            ENDIF
            IF Size280to300Fcount GT 0 THEN BEGIN
              LengthBinIndex1 = 10
              LengthBinIndex2 = Size280to300F
                FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
                , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
                , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
                , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
                , prop_age26F, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              
              AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
                , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
              WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
              ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
              AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
              FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
              FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
            ENDIF
            IF Size300to320Fcount GT 0 THEN BEGIN
              LengthBinIndex1 = 11
              LengthBinIndex2 = Size300to320F
              FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
                , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
                , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
                , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
                , prop_age26F, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
                , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
              WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
              ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
              AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
              FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
              FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
            ENDIF
            IF Size320to340Fcount GT 0 THEN BEGIN
              LengthBinIndex1 = 12
              LengthBinIndex2 = Size320to340F
              FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
                , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
                , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
                , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
                , prop_age26F, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              
              AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
                , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
              WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
              ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
              AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
              FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
              FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
            ENDIF
            IF Size340to360Fcount GT 0 THEN BEGIN
              LengthBinIndex1 = 13
              LengthBinIndex2 = Size340to360F
                FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
                , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
                , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
                , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
                , prop_age26F, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              
              AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
                , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
              WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
              ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
              AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
              FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
              FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
            ENDIF
            IF Size360to380Fcount GT 0 THEN BEGIN
              LengthBinIndex1 = 14
              LengthBinIndex2 = Size360to380F
              FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
                , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
                , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
                , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
                , prop_age26F, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              
              AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
                , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
              WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
              ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
              AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
              FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
              FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
            ENDIF
            IF Size380to400Fcount GT 0 THEN BEGIN
              LengthBinIndex1 = 15
              LengthBinIndex2 = Size380to400F
                FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
                , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
                , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
                , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
                , prop_age26F, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
                , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
              WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
              ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
              AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
              FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
              FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
            ENDIF
            IF Size400to420Fcount GT 0 THEN BEGIN
              LengthBinIndex1 = 16
              LengthBinIndex2 = Size400to420F
               FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
                , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
                , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
                , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
                , prop_age26F, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              
              AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
                , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
              WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
              ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
              AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
              FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
              FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
            ENDIF
            IF Size420to440Fcount GT 0 THEN BEGIN
              LengthBinIndex1 = 17
              LengthBinIndex2 = Size420to440F
              FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
                , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
                , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
                , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
                , prop_age26F, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
  
              AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
                , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
              WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
              ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
              AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
              FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
              FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
            ENDIF
            IF Size440to460Fcount GT 0 THEN BEGIN
              LengthBinIndex1 = 18
              LengthBinIndex2 = Size440to460F
                FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
                , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
                , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
                , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
                , prop_age26F, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
                , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
              WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
              ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
              AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
              FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
              FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
            ENDIF
            IF Size460to480Fcount GT 0 THEN BEGIN
              LengthBinIndex1 = 19
              LengthBinIndex2 = Size460to480F
                    FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
                , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
                , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
                , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
                , prop_age26F, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
                , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
              WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
              ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
              AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
              FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
              FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
            ENDIF
            IF Size480to500Fcount GT 0 THEN BEGIN
              LengthBinIndex1 = 20
              LengthBinIndex2 = Size480to500F
                FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
                , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
                , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
                , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
                , prop_age26F, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb              
              AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
                , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
              WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
              ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
              AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
              FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
              FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
            ENDIF
            IF Size500to520Fcount GT 0 THEN BEGIN
              LengthBinIndex1 = 21
              LengthBinIndex2 = Size500to520F
              FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
                , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
                , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
                , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
                , prop_age26F, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
                , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
              WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
              ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
              AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
              FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
              FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
            ENDIF
            IF Size520to540Fcount GT 0 THEN BEGIN
              LengthBinIndex1 = 22
              LengthBinIndex2 = Size520to540F
               FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
                , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
                , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
                , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
                , prop_age26F, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
                , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
              WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
              ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
              AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
              FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
              FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
            ENDIF
            IF Size540to560Fcount GT 0 THEN BEGIN
              LengthBinIndex1 = 23
              LengthBinIndex2 = Size540to560F
                FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
                , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
                , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
                , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
                , prop_age26F, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
                , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
              WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
              ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
              AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
              FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
              FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
            ENDIF
            IF Size560to580Fcount GT 0 THEN BEGIN
              LengthBinIndex1 = 24
              LengthBinIndex2 = Size560to580F
               FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
                , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
                , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
                , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
                , prop_age26F, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
                , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
              WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
              ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
              AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
              FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
              FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
            ENDIF
            IF Size580to600Fcount GT 0 THEN BEGIN
              LengthBinIndex1 = 25
              LengthBinIndex2 = Size580to600F
                FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
                , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
                , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
                , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
                , prop_age26F, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
                , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
              WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
              ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
              AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
              FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
              FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
            ENDIF
            IF Size600to620Fcount GT 0 THEN BEGIN
              LengthBinIndex1 = 26
              LengthBinIndex2 = Size600to620F
              FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
                , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
                , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
                , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
                , prop_age26F, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
                , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
              WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
              ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
              AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
              FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
              FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
            ENDIF
            IF Size620to640Fcount GT 0 THEN BEGIN
              LengthBinIndex1 = 27
              LengthBinIndex2 = Size620to640F
               FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
                , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
                , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
                , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
                , prop_age26F, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb    
              AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
                , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
              WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
              ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
              AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
              FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
              FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
            ENDIF
            IF Size640to660Fcount GT 0 THEN BEGIN
              LengthBinIndex1 = 28
              LengthBinIndex2 = Size640to660F
               FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
                , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
                , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
                , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
                , prop_age26F, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb        
              AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
                , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
              WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
              ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
              AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
              FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
              FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
            ENDIF
            IF Size660to680Fcount GT 0 THEN BEGIN
              LengthBinIndex1 = 29
              LengthBinIndex2 = Size660to680F
               FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
                , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
                , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
                , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
                , prop_age26F, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
                , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
              WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
              ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
              AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
              FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
              FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
            ENDIF
            IF Size680to700Fcount GT 0 THEN BEGIN
              LengthBinIndex1 = 30
              LengthBinIndex2 = Size680to700F
                        FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
                , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
                , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
                , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
                , prop_age26F, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
                , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
              WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
              ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
              AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
              FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
              FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
            ENDIF
            IF Size700to720Fcount GT 0 THEN BEGIN
              LengthBinIndex1 = 31
              LengthBinIndex2 = Size700to720F
              FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
                , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
                , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
                , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
                , prop_age26F, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
                , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
              WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
              ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
              AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
              FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
              FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
            ENDIF
            IF Size720to740Fcount GT 0 THEN BEGIN
              LengthBinIndex1 = 32
              LengthBinIndex2 = Size720to740F
              FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
                , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
                , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
                , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
                , prop_age26F, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
                , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
              WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
              ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
              AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
              FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
              FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
            ENDIF
            IF Size740to760Fcount GT 0 THEN BEGIN
              LengthBinIndex1 = 33
              LengthBinIndex2 = Size740to760F
               FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
                , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
                , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
                , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
                , prop_age26F, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
                , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
              WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
              ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
              AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
              FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
              FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
            ENDIF
            IF Size760to780Fcount GT 0 THEN BEGIN
              LengthBinIndex1 = 34
              LengthBinIndex2 = Size760to780F
                FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
                , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
                , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
                , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
                , prop_age26F, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              
              AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
                , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
              WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
              ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
              AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
              FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
              FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
            ENDIF
            IF Size780to800Fcount GT 0 THEN BEGIN
              LengthBinIndex1 = 35
              LengthBinIndex2 = Size780to800F
                   FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
                , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
                , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
                , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
                , prop_age26F, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
                , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
              WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
              ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
              AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
              FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
              FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
            ENDIF
            IF Sizege800Fcount GT 0 THEN BEGIN
              LengthBinIndex1 = 36
              LengthBinIndex2 = SizeGE800F
              FishProb = AgeLengthKey(prop_age0F, prop_age1F, prop_age2F, prop_age3F, prop_age4F, prop_age5F $
                , prop_age6F, prop_age7F, prop_age8F, prop_age9F, prop_age10F, prop_age11F, prop_age12F $
                , prop_age13F, prop_age14F, prop_age15F, prop_age16F, prop_age17F, prop_age18F, prop_age19F $
                , prop_age20F, prop_age21F, prop_age22F, prop_age23F, prop_age24F, prop_age25F $
                , prop_age26F, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              AgeAssignF = WalleyeAgeAssign(Length_prod[female[LengthBinIndex2]] $
                , female[LengthBinIndex2], FishProb, FishAge[female[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[0, *]
              WAE_length_binF[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignF[1, *]
              ;PRINT, 'AgeAssignf[1, *]',TRANSPOSE(AgeAssignf[1, *])
              AgeAssignIndF = WalleyeAgeAssignInd(Length_prod[female[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[female[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndf[0,*]',TRANSPOSE(AgeAssignIndF[0,*])
              FishAge[female[LengthBinIndex2]] = AgeAssignIndF[0,*]
              FishLength[female[LengthBinIndex2]] = AgeAssignIndF[1,*]
            ENDIF

            ; 1.Assign age semi-randomly to lengths - UNKNOWNS
            IF SizeLT100Ucount GT 0 THEN BEGIN
              LengthBinIndex1 = 0
              LengthBinIndex2 = SizeLT100U
              FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                , prop_age26, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
      
              AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
                , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
              WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
              ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
              AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
              FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
              FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
            ENDIF
            IF Size100to120Ucount GT 0 THEN BEGIN
              LengthBinIndex1 = 1
              LengthBinIndex2 = Size100to120U
              FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                , prop_age26, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
      
              AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
                , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
              WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
              ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
              AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
              FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
              FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
            ENDIF
            IF Size120to140Ucount GT 0 THEN BEGIN
              LengthBinIndex1 = 2
              LengthBinIndex2 = Size120to140U
              FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                , prop_age26, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              
              AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
                , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
              WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
              ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
              AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
              FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
              FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
            ENDIF
            IF Size140to160Ucount GT 0 THEN BEGIN
              LengthBinIndex1 = 3
              LengthBinIndex2 = Size140to160U
                FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                , prop_age26, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
                , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
              WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
              ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
              AgeAssignIndu = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
              FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
              FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
            ENDIF
            IF Size160to180Ucount GT 0 THEN BEGIN
              LengthBinIndex1 = 4
              LengthBinIndex2 = Size160to180U
               FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                , prop_age26, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
                , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
              WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
              ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
              AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
              FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
              FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
            ENDIF
            IF Size180to200Ucount GT 0 THEN BEGIN
              LengthBinIndex1 = 5
              LengthBinIndex2 = Size180to200U
               FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                , prop_age26, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
                , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
              WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
              ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
              AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
              FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
              FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
            ENDIF
            IF Size200to220Ucount GT 0 THEN BEGIN
              LengthBinIndex1 = 6
              LengthBinIndex2 = Size200to220U
              FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                , prop_age26, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
                , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
              WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
              ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
              AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
              FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
              FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
            ENDIF
            IF Size220to240Ucount GT 0 THEN BEGIN
              LengthBinIndex1 = 7
              LengthBinIndex2 = Size220to240U
               FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                , prop_age26, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              
              AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
                , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
              WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
              ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
              AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
              FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
              FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
            ENDIF
            IF Size240to260Ucount GT 0 THEN BEGIN
              LengthBinIndex1 = 8
              LengthBinIndex2 = Size240to260U
              FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                , prop_age26, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
                , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
              WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
              ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
              AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
              FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
              FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
            ENDIF
            IF Size260to280Ucount GT 0 THEN BEGIN
              LengthBinIndex1 = 9
              LengthBinIndex2 = Size260to280U
               FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                , prop_age26, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
                , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
              WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
              ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
              AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
              FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
              FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
            ENDIF
            IF Size280to300Ucount GT 0 THEN BEGIN
              LengthBinIndex1 = 10
              LengthBinIndex2 = Size280to300U
              FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                , prop_age26, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
                , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
              WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
              ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
              AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
              FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
              FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
            ENDIF
            IF Size300to320Ucount GT 0 THEN BEGIN
              LengthBinIndex1 = 11
              LengthBinIndex2 = Size300to320U
               FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                , prop_age26, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
                , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
              WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
              ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
              AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
              FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
              FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
            ENDIF
            IF Size320to340Ucount GT 0 THEN BEGIN
              LengthBinIndex1 = 12
              LengthBinIndex2 = Size320to340U
                FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                , prop_age26, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
                , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
              WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
              ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
              AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
              FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
              FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
            ENDIF
            IF Size340to360Ucount GT 0 THEN BEGIN
              LengthBinIndex1 = 13
              LengthBinIndex2 = Size340to360U
                FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                , prop_age26, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
                , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
              WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
              ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
              AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
              FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
              FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
            ENDIF
            IF Size360to380Ucount GT 0 THEN BEGIN
              LengthBinIndex1 = 14
              LengthBinIndex2 = Size360to380U
                 FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                , prop_age26, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
                , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
              WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
              ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
              AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
              FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
              FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
            ENDIF
            IF Size380to400Ucount GT 0 THEN BEGIN
              LengthBinIndex1 = 15
              LengthBinIndex2 = Size380to400U
                FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                , prop_age26, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
                , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
              WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
              ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
              AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
              FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
              FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
            ENDIF
            IF Size400to420Ucount GT 0 THEN BEGIN
              LengthBinIndex1 = 16
              LengthBinIndex2 = Size400to420U
                FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                , prop_age26, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
                , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
              WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
              ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
              AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
              FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
              FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
            ENDIF
            IF Size420to440Ucount GT 0 THEN BEGIN
              LengthBinIndex1 = 17
              LengthBinIndex2 = Size420to440U
               FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                , prop_age26, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
                , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
              WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
              ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
              AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
              FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
              FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
            ENDIF
            IF Size440to460Ucount GT 0 THEN BEGIN
              LengthBinIndex1 = 18
              LengthBinIndex2 = Size440to460U
               FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                , prop_age26, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
                , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
              WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
              ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
              AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
              FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
              FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
            ENDIF
            IF Size460to480Ucount GT 0 THEN BEGIN
              LengthBinIndex1 = 19
              LengthBinIndex2 = Size460to480U
              FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                , prop_age26, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
                , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
              WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
              ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
              AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
              FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
              FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
            ENDIF
            IF Size480to500Ucount GT 0 THEN BEGIN
              LengthBinIndex1 = 20
              LengthBinIndex2 = Size480to500U
                FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                , prop_age26, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
                , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
              WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
              ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
              AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
              FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
              FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
            ENDIF
            IF Size500to520Ucount GT 0 THEN BEGIN
              LengthBinIndex1 = 21
              LengthBinIndex2 = Size500to520U
                FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                , prop_age26, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
                , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
              WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
              ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
              AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
              FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
              FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
            ENDIF
            IF Size520to540Ucount GT 0 THEN BEGIN
              LengthBinIndex1 = 22
              LengthBinIndex2 = Size520to540U
               FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                , prop_age26, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
                , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
              WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
              ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
              AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
              FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
              FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
            ENDIF
            IF Size540to560Ucount GT 0 THEN BEGIN
              LengthBinIndex1 = 23
              LengthBinIndex2 = Size540to560U
               FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                , prop_age26, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
                , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
              WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
              ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
              AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
              FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
              FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
            ENDIF
            IF Size560to580Ucount GT 0 THEN BEGIN
              LengthBinIndex1 = 24
              LengthBinIndex2 = Size560to580U
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                , prop_age26, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
                , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
              WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
              ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
              AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
              FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
              FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
            ENDIF
            IF Size580to600Ucount GT 0 THEN BEGIN
              LengthBinIndex1 = 25
              LengthBinIndex2 = Size580to600U
                 FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                , prop_age26, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
                , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
              WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
              ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
              AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
              FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
              FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
            ENDIF
            IF Size600to620Ucount GT 0 THEN BEGIN
              LengthBinIndex1 = 26
              LengthBinIndex2 = Size600to620U
                 FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                , prop_age26, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              
              AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
                , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
              WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
              ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
              AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
              FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
              FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
            ENDIF
            IF Size620to640Ucount GT 0 THEN BEGIN
              LengthBinIndex1 = 27
              LengthBinIndex2 = Size620to640U
                FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                , prop_age26, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              
              AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
                , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
              WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
              ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
              AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
              FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
              FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
            ENDIF
            IF Size640to660Ucount GT 0 THEN BEGIN
              LengthBinIndex1 = 28
              LengthBinIndex2 = Size640to660U
                FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                , prop_age26, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              
              AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
                , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
              WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
              ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
              AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
              FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
              FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
            ENDIF
            IF Size660to680Ucount GT 0 THEN BEGIN
              LengthBinIndex1 = 29
              LengthBinIndex2 = Size660to680U
               FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                , prop_age26, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              
              AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
                , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
              WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
              ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
              AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
              FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
              FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
            ENDIF
            IF Size680to700Ucount GT 0 THEN BEGIN
              LengthBinIndex1 = 30
              LengthBinIndex2 = Size680to700U
                   FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                , prop_age26, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              
              AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
                , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
              WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
              ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
              AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
              FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
              FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
            ENDIF
            IF Size700to720Ucount GT 0 THEN BEGIN
              LengthBinIndex1 = 31
              LengthBinIndex2 = Size700to720U
                 FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                , prop_age26, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              
              AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
                , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
              WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
              ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
              AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
              FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
              FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
            ENDIF
            IF Size720to740Ucount GT 0 THEN BEGIN
              LengthBinIndex1 = 32
              LengthBinIndex2 = Size720to740U
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                , prop_age26, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
   
              AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
                , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
              WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
              ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
              AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
              FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
              FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
            ENDIF
            IF Size740to760Ucount GT 0 THEN BEGIN
              LengthBinIndex1 = 33
              LengthBinIndex2 = Size740to760U
                 FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                , prop_age26, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
                , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
              WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
              ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
              AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
              FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
              FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
            ENDIF
            IF Size760to780Ucount GT 0 THEN BEGIN
              LengthBinIndex1 = 34
              LengthBinIndex2 = Size760to780U
                FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                , prop_age26, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
                , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
              WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
              ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
              AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
              FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
              FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
            ENDIF
            IF Size780to800Ucount GT 0 THEN BEGIN
              LengthBinIndex1 = 35
              LengthBinIndex2 = Size780to800U
               FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                , prop_age26, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
                , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
              WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
              ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
              AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
              FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
              FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
            ENDIF
            IF Sizege800Ucount GT 0 THEN BEGIN
              LengthBinIndex1 = 36
              LengthBinIndex2 = SizeGE800U
                FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                , prop_age26, INDEX_lengthdata2C, LengthBinIndex1)
              ;PRINT, 'FishProb', FishProb
              AgeAssignU = WalleyeAgeAssign(Length_prod[unknown[LengthBinIndex2]] $
                , unknown[LengthBinIndex2], FishProb, FishAge[unknown[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              WAE_length_meanU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[0, *]
              WAE_length_binU[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignU[1, *]
              ;PRINT, 'AgeAssignU[1, *]',TRANSPOSE(AgeAssignU[1, *])
              AgeAssignIndU = WalleyeAgeAssignInd(Length_prod[unknown[LengthBinIndex2]] $
                , LengthBinIndex2, FishProb, FishAge[unknown[LengthBinIndex2]] $
                , i+NumLengthBin+adj)
              ;PRINT, 'AgeAssignIndU[0,*]',TRANSPOSE(AgeAssignIndU[0,*])
              FishAge[unknown[LengthBinIndex2]] = AgeAssignIndU[0,*]
              FishLength[unknown[LengthBinIndex2]] = AgeAssignIndU[1,*]
            ENDIF
            
            PRINT, "Age of fish (FishAge)", FishAge
            PRINT, "Length of fish (FishLength)", FishLength
            
            PRINT, 'WBIC_year', WBIC_year_key[INDEX_lengthdata2C[0]]
            PRINT, 'WBIC', WBIC_year_key[INDEX_lengthdata2C[0]]

            Age3plus = WHERE(FishAge GE 3, Age3plusCOUNT)
            IF Age3plusCOUNT GT 0 THEN BEGIN
              paramset[225, i] = MEAN(FishAge[Age3plus]); mean age for all fish
              paramset[226, i] = STDDEV(FishAge[Age3plus]); SD age for all fish
            ENDIF
            Age3Mplus = WHERE(FishAge[male] GE 3, Age3MplusCOUNT)
            IF Age3MplusCOUNT GT 0 THEN BEGIN
              paramset[227, i] = MEAN(FishAge[male[Age3Mplus]]); min age for males
              paramset[228, i] = STDDEV(FishAge[male[Age3Mplus]]); min age for males
            ENDIF
            Age3Fplus = WHERE(FishAge[female] GE 3, Age3FplusCOUNT)
            IF Age3FplusCOUNT GT 0 THEN BEGIN
              paramset[229, i] = MEAN(FishAge[female[Age3Fplus]]); max age for females
              paramset[230, i] = STDDEV(FishAge[female[Age3Fplus]]); min age for females
            ENDIF

           ; Summary estimated age distribution data - SPRING SURVEY
          ; Allocate estimated age data to an array - ALL FISH
          Total_N_ageclass = fltarr(27L, 2L); all
          Total_N_ageclass[0, 0] = TOTAL(WAE_length_bin[10, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 0
          Total_N_ageclass[1, 0] = TOTAL(WAE_length_bin[11, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 1
          Total_N_ageclass[2, 0] = TOTAL(WAE_length_bin[12, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 2
          Total_N_ageclass[3, 0] = TOTAL(WAE_length_bin[13, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 3
          Total_N_ageclass[4, 0] = TOTAL(WAE_length_bin[14, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 4
          Total_N_ageclass[5, 0] = TOTAL(WAE_length_bin[15, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 5
          Total_N_ageclass[6, 0] = TOTAL(WAE_length_bin[16, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 6
          Total_N_ageclass[7, 0] = TOTAL(WAE_length_bin[17, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 7
          Total_N_ageclass[8, 0] = TOTAL(WAE_length_bin[18, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 8
          Total_N_ageclass[9, 0] = TOTAL(WAE_length_bin[19, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 9
          Total_N_ageclass[10, 0] = TOTAL(WAE_length_bin[20, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 10
          Total_N_ageclass[11, 0] = TOTAL(WAE_length_bin[21, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 11
          Total_N_ageclass[12, 0] = TOTAL(WAE_length_bin[22, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 12
          Total_N_ageclass[13, 0] = TOTAL(WAE_length_bin[23, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 13
          Total_N_ageclass[14, 0] = TOTAL(WAE_length_bin[24, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 14
          Total_N_ageclass[15, 0] = TOTAL(WAE_length_bin[25, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 15
          Total_N_ageclass[16, 0] = TOTAL(WAE_length_bin[26, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 16
          Total_N_ageclass[17, 0] = TOTAL(WAE_length_bin[27, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 17
          Total_N_ageclass[18, 0] = TOTAL(WAE_length_bin[28, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 18
          Total_N_ageclass[19, 0] = TOTAL(WAE_length_bin[29, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 19
          Total_N_ageclass[20, 0] = TOTAL(WAE_length_bin[30, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 20
          Total_N_ageclass[21, 0] = TOTAL(WAE_length_bin[31, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 21
          Total_N_ageclass[22, 0] = TOTAL(WAE_length_bin[32, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 22
          Total_N_ageclass[23, 0] = TOTAL(WAE_length_bin[33, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 23
          Total_N_ageclass[24, 0] = TOTAL(WAE_length_bin[34, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 24
          Total_N_ageclass[25, 0] = TOTAL(WAE_length_bin[35, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 25
          Total_N_ageclass[26, 0] = TOTAL(WAE_length_bin[36, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 26
          PRINT, 'Derived age distribution for all fish'
          PRINT, Total_N_ageclass[*, 0]
          PRINT, 'Total number of all fish', TOTAL(Total_N_ageclass[*, 0])

          ; Identify the number of age classes in the data set
          NumAgeClass = WHERE(Total_N_ageclass[*, 0] GT 0, NumAgeClasscount)
          paramset[213, i] = NumAgeClasscount
          PRINT, 'Number of age classes', NumAgeClasscount
          paramset[216, i] = MAX(NumAgeClass)
          PRINT, 'Maximum age classes', MAX(NumAgeClass)

          ; Identify the peak age class (age >3) used for estimating mortality rates with catch curves
          PeakAgeClass = WHERE(Total_N_ageclass[*, 0] EQ MAX(Total_N_ageclass[3:26, 0]), PeakAgeClasscount)
          PRINT, 'Peak age of fully recruited to fishery', PeakAgeClass
          PeakAgeClassLimit = where(PeakAgeClass GE 3, PeakAgeClassLimitcount)
          IF PeakAgeClassLimitcount GT 0 THEN paramset[214, i] = MIN(PeakAgeClass[PeakAgeClassLimit]) $
          ELSE paramset[214, i] = -1
          PRINT, 'Initial age of fully recruited to fishery', PeakAgeClass

          Total_N_ageclass2 = fltarr(27L, 4L); all
          print, 'FishAge[*]', n_elements(FishAge[INDEX_lengthdata2])
          print, 'FishAge[*]', (FishAge[INDEX_lengthdata2])

          age0Num = where(FishAge[*] EQ 0, age0Numcount)
          age1Num = where(FishAge[*] EQ 1, age1Numcount)
          age2Num = where(FishAge[*] EQ 2, age2Numcount)
          age3Num = where(FishAge[*] EQ 3, age3Numcount)
          age4Num = where(FishAge[*] EQ 4, age4Numcount)
          age5Num = where(FishAge[*] EQ 5, age5Numcount)
          age6Num = where(FishAge[*] EQ 6, age6Numcount)
          age7Num = where(FishAge[*] EQ 7, age7Numcount)
          age8Num = where(FishAge[*] EQ 8, age8Numcount)
          age9Num = where(FishAge[*] EQ 9, age9Numcount)
          age10Num = where(FishAge[*] EQ 10, age10Numcount)
          age11Num = where(FishAge[*] EQ 11, age11Numcount)
          age12Num = where(FishAge[*] EQ 12, age12Numcount)
          age13Num = where(FishAge[*] EQ 13, age13Numcount)
          age14Num = where(FishAge[*] EQ 14, age14Numcount)
          age15Num = where(FishAge[*] EQ 15, age15Numcount)
          age16Num = where(FishAge[*] EQ 16, age16Numcount)
          age17Num = where(FishAge[*] EQ 17, age17Numcount)
          age18Num = where(FishAge[*] EQ 18, age18Numcount)
          age19Num = where(FishAge[*] EQ 19, age19Numcount)
          age20Num = where(FishAge[*] EQ 20, age20Numcount)
          age21Num = where(FishAge[*] EQ 21, age21Numcount)
          age22Num = where(FishAge[*] EQ 22, age22Numcount)
          age23Num = where(FishAge[*] EQ 23, age23Numcount)
          age24Num = where(FishAge[*] EQ 24, age24Numcount)
          age25Num = where(FishAge[*] EQ 25, age25Numcount)
          age26Num = where(FishAge[*] EQ 26, age26Numcount)
          IF age0Numcount GT 0 THEN Total_N_ageclass2[0, 0] = age0Numcount
          IF age1Numcount GT 0 THEN Total_N_ageclass2[1, 0] = age1Numcount
          IF age2Numcount GT 0 THEN Total_N_ageclass2[2, 0] = age2Numcount
          IF age3Numcount GT 0 THEN Total_N_ageclass2[3, 0] = age3Numcount
          IF age4Numcount GT 0 THEN Total_N_ageclass2[4, 0] = age4Numcount
          IF age5Numcount GT 0 THEN Total_N_ageclass2[5, 0] = age5Numcount
          IF age6Numcount GT 0 THEN Total_N_ageclass2[6, 0] = age6Numcount
          IF age7Numcount GT 0 THEN Total_N_ageclass2[7, 0] = age7Numcount
          IF age8Numcount GT 0 THEN Total_N_ageclass2[8, 0] = age8Numcount
          IF age9Numcount GT 0 THEN Total_N_ageclass2[9, 0] = age9Numcount
          IF age10Numcount GT 0 THEN Total_N_ageclass2[10, 0] = age10Numcount
          IF age11Numcount GT 0 THEN Total_N_ageclass2[11, 0] = age11Numcount
          IF age12Numcount GT 0 THEN Total_N_ageclass2[12, 0] = age12Numcount
          IF age13Numcount GT 0 THEN Total_N_ageclass2[13, 0] = age13Numcount
          IF age14Numcount GT 0 THEN Total_N_ageclass2[14, 0] = age14Numcount
          IF age15Numcount GT 0 THEN Total_N_ageclass2[15, 0] = age15Numcount
          IF age16Numcount GT 0 THEN Total_N_ageclass2[16, 0] = age16Numcount
          IF age17Numcount GT 0 THEN Total_N_ageclass2[17, 0] = age17Numcount
          IF age18Numcount GT 0 THEN Total_N_ageclass2[18, 0] = age18Numcount
          IF age19Numcount GT 0 THEN Total_N_ageclass2[19, 0] = age19Numcount
          IF age20Numcount GT 0 THEN Total_N_ageclass2[20, 0] = age20Numcount
          IF age21Numcount GT 0 THEN Total_N_ageclass2[21, 0] = age21Numcount
          IF age22Numcount GT 0 THEN Total_N_ageclass2[22, 0] = age22Numcount
          IF age23Numcount GT 0 THEN Total_N_ageclass2[23, 0] = age23Numcount
          IF age24Numcount GT 0 THEN Total_N_ageclass2[24, 0] = age24Numcount
          IF age25Numcount GT 0 THEN Total_N_ageclass2[25, 0] = age25Numcount
          IF age26Numcount GT 0 THEN Total_N_ageclass2[26, 0] = age26Numcount
          PRINT, 'Derived age distribution for all fish (individual-based)'
          PRINT, Total_N_ageclass2[*, 0]
          PRINT, 'Total number of all fish (INDIVIDUAL-BASED)', total(Total_N_ageclass2[*, 0])

          ; allocate estimated age data to an array - MALES
          Male_N_ageclass = fltarr(27L, 2L); all
          Male_N_ageclass[0, 0] = TOTAL(WAE_length_binM[10, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 0
          Male_N_ageclass[1, 0] = TOTAL(WAE_length_binM[11, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 1
          Male_N_ageclass[2, 0] = TOTAL(WAE_length_binM[12, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 2
          Male_N_ageclass[3, 0] = TOTAL(WAE_length_binM[13, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 3
          Male_N_ageclass[4, 0] = TOTAL(WAE_length_binM[14, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 4
          Male_N_ageclass[5, 0] = TOTAL(WAE_length_binM[15, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 5
          Male_N_ageclass[6, 0] = TOTAL(WAE_length_binM[16, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 6
          Male_N_ageclass[7, 0] = TOTAL(WAE_length_binM[17, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 7
          Male_N_ageclass[8, 0] = TOTAL(WAE_length_binM[18, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 8
          Male_N_ageclass[9, 0] = TOTAL(WAE_length_binM[19, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 9
          Male_N_ageclass[10, 0] = TOTAL(WAE_length_binM[20, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 10
          Male_N_ageclass[11, 0] = TOTAL(WAE_length_binM[21, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 11
          Male_N_ageclass[12, 0] = TOTAL(WAE_length_binM[22, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 12
          Male_N_ageclass[13, 0] = TOTAL(WAE_length_binM[23, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 13
          Male_N_ageclass[14, 0] = TOTAL(WAE_length_binM[24, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 14
          Male_N_ageclass[15, 0] = TOTAL(WAE_length_binM[25, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 15
          Male_N_ageclass[16, 0] = TOTAL(WAE_length_binM[26, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 16
          Male_N_ageclass[17, 0] = TOTAL(WAE_length_binM[27, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 17
          Male_N_ageclass[18, 0] = TOTAL(WAE_length_binM[28, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 18
          Male_N_ageclass[19, 0] = TOTAL(WAE_length_binM[29, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 19
          Male_N_ageclass[20, 0] = TOTAL(WAE_length_binM[30, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 20
          Male_N_ageclass[21, 0] = TOTAL(WAE_length_binM[31, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 21
          Male_N_ageclass[22, 0] = TOTAL(WAE_length_binM[32, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 22
          Male_N_ageclass[23, 0] = TOTAL(WAE_length_binM[33, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 23
          Male_N_ageclass[24, 0] = TOTAL(WAE_length_binM[34, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 24
          Male_N_ageclass[25, 0] = TOTAL(WAE_length_binM[35, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 25
          Male_N_ageclass[26, 0] = TOTAL(WAE_length_binM[36, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 26
          PRINT, 'Derived age distribution for males'
          PRINT, Male_N_ageclass[*, 0]
          PRINT, 'Total number of males', TOTAL(Male_N_ageclass[*, 0])

          age0MNum = where(FishAge[*] EQ 0 AND Sex_prod[*] EQ 0, age0MNumcount)
          age1MNum = where(FishAge[*] EQ 1 AND Sex_prod[*] EQ 0, age1MNumcount)
          age2MNum = where(FishAge[*] EQ 2 AND Sex_prod[*] EQ 0, age2MNumcount)
          age3MNum = where(FishAge[*] EQ 3 AND Sex_prod[*] EQ 0, age3MNumcount)
          age4MNum = where(FishAge[*] EQ 4 AND Sex_prod[*] EQ 0, age4MNumcount)
          age5MNum = where(FishAge[*] EQ 5 AND Sex_prod[*] EQ 0, age5MNumcount)
          age6MNum = where(FishAge[*] EQ 6 AND Sex_prod[*] EQ 0, age6MNumcount)
          age7MNum = where(FishAge[*] EQ 7 AND Sex_prod[*] EQ 0, age7MNumcount)
          age8MNum = where(FishAge[*] EQ 8 AND Sex_prod[*] EQ 0, age8MNumcount)
          age9MNum = where(FishAge[*] EQ 9 AND Sex_prod[*] EQ 0, age9MNumcount)
          age10MNum = where(FishAge[*] EQ 10 AND Sex_prod[*] EQ 0, age10MNumcount)
          age11MNum = where(FishAge[*] EQ 11 AND Sex_prod[*] EQ 0, age11MNumcount)
          age12MNum = where(FishAge[*] EQ 12 AND Sex_prod[*] EQ 0, age12MNumcount)
          age13MNum = where(FishAge[*] EQ 13 AND Sex_prod[*] EQ 0, age13MNumcount)
          age14MNum = where(FishAge[*] EQ 14 AND Sex_prod[*] EQ 0, age14MNumcount)
          age15MNum = where(FishAge[*] EQ 15 AND Sex_prod[*] EQ 0, age15MNumcount)
          age16MNum = where(FishAge[*] EQ 16 AND Sex_prod[*] EQ 0, age16MNumcount)
          age17MNum = where(FishAge[*] EQ 17 AND Sex_prod[*] EQ 0, age17MNumcount)
          age18MNum = where(FishAge[*] EQ 18 AND Sex_prod[*] EQ 0, age18MNumcount)
          age19MNum = where(FishAge[*] EQ 19 AND Sex_prod[*] EQ 0, age19MNumcount)
          age20MNum = where(FishAge[*] EQ 20 AND Sex_prod[*] EQ 0, age20MNumcount)
          age21MNum = where(FishAge[*] EQ 21 AND Sex_prod[*] EQ 0, age21MNumcount)
          age22MNum = where(FishAge[*] EQ 22 AND Sex_prod[*] EQ 0, age22MNumcount)
          age23MNum = where(FishAge[*] EQ 23 AND Sex_prod[*] EQ 0, age23MNumcount)
          age24MNum = where(FishAge[*] EQ 24 AND Sex_prod[*] EQ 0, age24MNumcount)
          age25MNum = where(FishAge[*] EQ 25 AND Sex_prod[*] EQ 0, age25MNumcount)
          age26MNum = where(FishAge[*] EQ 26 AND Sex_prod[*] EQ 0, age26MNumcount)
          IF age0MNumcount GT 0 THEN Total_N_ageclass2[0, 1] = age0MNumcount
          IF age1MNumcount GT 0 THEN Total_N_ageclass2[1, 1] = age1MNumcount
          IF age2MNumcount GT 0 THEN Total_N_ageclass2[2, 1] = age2MNumcount
          IF age3MNumcount GT 0 THEN Total_N_ageclass2[3, 1] = age3MNumcount
          IF age4MNumcount GT 0 THEN Total_N_ageclass2[4, 1] = age4MNumcount
          IF age5MNumcount GT 0 THEN Total_N_ageclass2[5, 1] = age5MNumcount
          IF age6MNumcount GT 0 THEN Total_N_ageclass2[6, 1] = age6MNumcount
          IF age7MNumcount GT 0 THEN Total_N_ageclass2[7, 1] = age7MNumcount
          IF age8MNumcount GT 0 THEN Total_N_ageclass2[8, 1] = age8MNumcount
          IF age9MNumcount GT 0 THEN Total_N_ageclass2[9, 1] = age9MNumcount
          IF age10MNumcount GT 0 THEN Total_N_ageclass2[10, 1] = age10MNumcount
          IF age11MNumcount GT 0 THEN Total_N_ageclass2[11, 1] = age11MNumcount
          IF age12MNumcount GT 0 THEN Total_N_ageclass2[12, 1] = age12MNumcount
          IF age13MNumcount GT 0 THEN Total_N_ageclass2[13, 1] = age13MNumcount
          IF age14MNumcount GT 0 THEN Total_N_ageclass2[14, 1] = age14MNumcount
          IF age15MNumcount GT 0 THEN Total_N_ageclass2[15, 1] = age15MNumcount
          IF age16MNumcount GT 0 THEN Total_N_ageclass2[16, 1] = age16MNumcount
          IF age17MNumcount GT 0 THEN Total_N_ageclass2[17, 1] = age17MNumcount
          IF age18MNumcount GT 0 THEN Total_N_ageclass2[18, 1] = age18MNumcount
          IF age19MNumcount GT 0 THEN Total_N_ageclass2[19, 1] = age19MNumcount
          IF age20MNumcount GT 0 THEN Total_N_ageclass2[20, 1] = age20MNumcount
          IF age21MNumcount GT 0 THEN Total_N_ageclass2[21, 1] = age21MNumcount
          IF age22MNumcount GT 0 THEN Total_N_ageclass2[22, 1] = age22MNumcount
          IF age23MNumcount GT 0 THEN Total_N_ageclass2[23, 1] = age23MNumcount
          IF age24MNumcount GT 0 THEN Total_N_ageclass2[24, 1] = age24MNumcount
          IF age25MNumcount GT 0 THEN Total_N_ageclass2[25, 1] = age25MNumcount
          IF age26MNumcount GT 0 THEN Total_N_ageclass2[26, 1] = age26MNumcount
          PRINT, 'Derived age distribution for MALES (individual-based)'
          PRINT, Total_N_ageclass2[*, 1]
          PRINT, 'Total number of MALES (INDIVIDUAL-BASED)'
          PRINT, total(Total_N_ageclass2[*, 1])

          ; allocate estimated age data to an array -FEMALES
          Female_N_ageclass = fltarr(27L, 2L); all
          Female_N_ageclass[0, 0] = TOTAL(WAE_length_binF[10, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 0
          Female_N_ageclass[1, 0] = TOTAL(WAE_length_binF[11, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 1
          Female_N_ageclass[2, 0] = TOTAL(WAE_length_binF[12, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 2
          Female_N_ageclass[3, 0] = TOTAL(WAE_length_binF[13, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 3
          Female_N_ageclass[4, 0] = TOTAL(WAE_length_binF[14, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 4
          Female_N_ageclass[5, 0] = TOTAL(WAE_length_binF[15, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 5
          Female_N_ageclass[6, 0] = TOTAL(WAE_length_binF[16, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 6
          Female_N_ageclass[7, 0] = TOTAL(WAE_length_binF[17, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 7
          Female_N_ageclass[8, 0] = TOTAL(WAE_length_binF[18, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 8
          Female_N_ageclass[9, 0] = TOTAL(WAE_length_binF[19, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 9
          Female_N_ageclass[10, 0] = TOTAL(WAE_length_binF[20, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 10
          Female_N_ageclass[11, 0] = TOTAL(WAE_length_binF[21, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 11
          Female_N_ageclass[12, 0] = TOTAL(WAE_length_binF[22, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 12
          Female_N_ageclass[13, 0] = TOTAL(WAE_length_binF[23, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 13
          Female_N_ageclass[14, 0] = TOTAL(WAE_length_binF[24, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 14
          Female_N_ageclass[15, 0] = TOTAL(WAE_length_binF[25, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 15
          Female_N_ageclass[16, 0] = TOTAL(WAE_length_binF[26, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 16
          Female_N_ageclass[17, 0] = TOTAL(WAE_length_binF[27, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 17
          Female_N_ageclass[18, 0] = TOTAL(WAE_length_binF[28, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 18
          Female_N_ageclass[19, 0] = TOTAL(WAE_length_binF[29, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 19
          Female_N_ageclass[20, 0] = TOTAL(WAE_length_binF[30, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 20
          Female_N_ageclass[21, 0] = TOTAL(WAE_length_binF[31, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 21
          Female_N_ageclass[22, 0] = TOTAL(WAE_length_binF[32, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 22
          Female_N_ageclass[23, 0] = TOTAL(WAE_length_binF[33, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 23
          Female_N_ageclass[24, 0] = TOTAL(WAE_length_binF[34, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 24
          Female_N_ageclass[25, 0] = TOTAL(WAE_length_binF[35, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 25
          Female_N_ageclass[26, 0] = TOTAL(WAE_length_binF[36, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 26
          PRINT, 'Derived age distribution for females'
          PRINT, Female_N_ageclass[*, 0]
          PRINT, 'Total number of females', total(Female_N_ageclass[*, 0])

          age0FNum = where(FishAge[*] EQ 0 AND Sex_prod[*] EQ 1, age0FNumcount)
          age1FNum = where(FishAge[*] EQ 1 AND Sex_prod[*] EQ 1, age1FNumcount)
          age2FNum = where(FishAge[*] EQ 2 AND Sex_prod[*] EQ 1, age2FNumcount)
          age3FNum = where(FishAge[*] EQ 3 AND Sex_prod[*] EQ 1, age3FNumcount)
          age4FNum = where(FishAge[*] EQ 4 AND Sex_prod[*] EQ 1, age4FNumcount)
          age5FNum = where(FishAge[*] EQ 5 AND Sex_prod[*] EQ 1, age5FNumcount)
          age6FNum = where(FishAge[*] EQ 6 AND Sex_prod[*] EQ 1, age6FNumcount)
          age7FNum = where(FishAge[*] EQ 7 AND Sex_prod[*] EQ 1, age7FNumcount)
          age8FNum = where(FishAge[*] EQ 8 AND Sex_prod[*] EQ 1, age8FNumcount)
          age9FNum = where(FishAge[*] EQ 9 AND Sex_prod[*] EQ 1, age9FNumcount)
          age10FNum = where(FishAge[*] EQ 10 AND Sex_prod[*] EQ 1, age10FNumcount)
          age11FNum = where(FishAge[*] EQ 11 AND Sex_prod[*] EQ 1, age11FNumcount)
          age12FNum = where(FishAge[*] EQ 12 AND Sex_prod[*] EQ 1, age12FNumcount)
          age13FNum = where(FishAge[*] EQ 13 AND Sex_prod[*] EQ 1, age13FNumcount)
          age14FNum = where(FishAge[*] EQ 14 AND Sex_prod[*] EQ 1, age14FNumcount)
          age15FNum = where(FishAge[*] EQ 15 AND Sex_prod[*] EQ 1, age15FNumcount)
          age16FNum = where(FishAge[*] EQ 16 AND Sex_prod[*] EQ 1, age16FNumcount)
          age17FNum = where(FishAge[*] EQ 17 AND Sex_prod[*] EQ 1, age17FNumcount)
          age18FNum = where(FishAge[*] EQ 18 AND Sex_prod[*] EQ 1, age18FNumcount)
          age19FNum = where(FishAge[*] EQ 19 AND Sex_prod[*] EQ 1, age19FNumcount)
          age20FNum = where(FishAge[*] EQ 20 AND Sex_prod[*] EQ 1, age20FNumcount)
          age21FNum = where(FishAge[*] EQ 21 AND Sex_prod[*] EQ 1, age21FNumcount)
          age22FNum = where(FishAge[*] EQ 22 AND Sex_prod[*] EQ 1, age22FNumcount)
          age23FNum = where(FishAge[*] EQ 23 AND Sex_prod[*] EQ 1, age23FNumcount)
          age24FNum = where(FishAge[*] EQ 24 AND Sex_prod[*] EQ 1, age24FNumcount)
          age25FNum = where(FishAge[*] EQ 25 AND Sex_prod[*] EQ 1, age25FNumcount)
          age26FNum = where(FishAge[*] EQ 26 AND Sex_prod[*] EQ 1, age26FNumcount)
          IF age0FNumcount GT 0 THEN Total_N_ageclass2[0, 2] = age0FNumcount
          IF age1FNumcount GT 0 THEN Total_N_ageclass2[1, 2] = age1FNumcount
          IF age2FNumcount GT 0 THEN Total_N_ageclass2[2, 2] = age2FNumcount
          IF age3FNumcount GT 0 THEN Total_N_ageclass2[3, 2] = age3FNumcount
          IF age4FNumcount GT 0 THEN Total_N_ageclass2[4, 2] = age4FNumcount
          IF age5FNumcount GT 0 THEN Total_N_ageclass2[5, 2] = age5FNumcount
          IF age6FNumcount GT 0 THEN Total_N_ageclass2[6, 2] = age6FNumcount
          IF age7FNumcount GT 0 THEN Total_N_ageclass2[7, 2] = age7FNumcount
          IF age8FNumcount GT 0 THEN Total_N_ageclass2[8, 2] = age8FNumcount
          IF age9FNumcount GT 0 THEN Total_N_ageclass2[9, 2] = age9FNumcount
          IF age10FNumcount GT 0 THEN Total_N_ageclass2[10, 2] = age10FNumcount
          IF age11FNumcount GT 0 THEN Total_N_ageclass2[11, 2] = age11FNumcount
          IF age12FNumcount GT 0 THEN Total_N_ageclass2[12, 2] = age12FNumcount
          IF age13FNumcount GT 0 THEN Total_N_ageclass2[13, 2] = age13FNumcount
          IF age14FNumcount GT 0 THEN Total_N_ageclass2[14, 2] = age14FNumcount
          IF age15FNumcount GT 0 THEN Total_N_ageclass2[15, 2] = age15FNumcount
          IF age16FNumcount GT 0 THEN Total_N_ageclass2[16, 2] = age16FNumcount
          IF age17FNumcount GT 0 THEN Total_N_ageclass2[17, 2] = age17FNumcount
          IF age18FNumcount GT 0 THEN Total_N_ageclass2[18, 2] = age18FNumcount
          IF age19FNumcount GT 0 THEN Total_N_ageclass2[19, 2] = age19FNumcount
          IF age20FNumcount GT 0 THEN Total_N_ageclass2[20, 2] = age20FNumcount
          IF age21FNumcount GT 0 THEN Total_N_ageclass2[21, 2] = age21FNumcount
          IF age22FNumcount GT 0 THEN Total_N_ageclass2[22, 2] = age22FNumcount
          IF age23FNumcount GT 0 THEN Total_N_ageclass2[23, 2] = age23FNumcount
          IF age24FNumcount GT 0 THEN Total_N_ageclass2[24, 2] = age24FNumcount
          IF age25FNumcount GT 0 THEN Total_N_ageclass2[25, 2] = age25FNumcount
          IF age26FNumcount GT 0 THEN Total_N_ageclass2[26, 2] = age26FNumcount
          PRINT, 'Derived age distribution for FEMALES (individual-based)'
          PRINT, Total_N_ageclass2[*, 2]
          PRINT, 'Total number of FEMALES (INDIVIDUAL-BASED)'
          PRINT, total(Total_N_ageclass2[*, 2])

          ; allocate estimated age data to an array - unknowns
          Unknown_N_ageclass = fltarr(27L, 2L)
          Unknown_N_ageclass[0, 0] = TOTAL(WAE_length_binU[10, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 0
          Unknown_N_ageclass[1, 0] = TOTAL(WAE_length_binU[11, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 1
          Unknown_N_ageclass[2, 0] = TOTAL(WAE_length_binU[12, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 2
          Unknown_N_ageclass[3, 0] = TOTAL(WAE_length_binU[13, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 3
          Unknown_N_ageclass[4, 0] = TOTAL(WAE_length_binU[14, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 4
          Unknown_N_ageclass[5, 0] = TOTAL(WAE_length_binU[15, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 5
          Unknown_N_ageclass[6, 0] = TOTAL(WAE_length_binU[16, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 6
          Unknown_N_ageclass[7, 0] = TOTAL(WAE_length_binU[17, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 7
          Unknown_N_ageclass[8, 0] = TOTAL(WAE_length_binU[18, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 8
          Unknown_N_ageclass[9, 0] = TOTAL(WAE_length_binU[19, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 9
          Unknown_N_ageclass[10, 0] = TOTAL(WAE_length_binU[20, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 10
          Unknown_N_ageclass[11, 0] = TOTAL(WAE_length_binU[21, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 11
          Unknown_N_ageclass[12, 0] = TOTAL(WAE_length_binU[22, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 12
          Unknown_N_ageclass[13, 0] = TOTAL(WAE_length_binU[23, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 13
          Unknown_N_ageclass[14, 0] = TOTAL(WAE_length_binU[24, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 14
          Unknown_N_ageclass[15, 0] = TOTAL(WAE_length_binU[25, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 15
          Unknown_N_ageclass[16, 0] = TOTAL(WAE_length_binU[26, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 16
          Unknown_N_ageclass[17, 0] = TOTAL(WAE_length_binU[27, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 17
          Unknown_N_ageclass[18, 0] = TOTAL(WAE_length_binU[28, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 18
          Unknown_N_ageclass[19, 0] = TOTAL(WAE_length_binU[29, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 19
          Unknown_N_ageclass[20, 0] = TOTAL(WAE_length_binU[30, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 20
          Unknown_N_ageclass[21, 0] = TOTAL(WAE_length_binU[31, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 21
          Unknown_N_ageclass[22, 0] = TOTAL(WAE_length_binU[32, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 22
          Unknown_N_ageclass[23, 0] = TOTAL(WAE_length_binU[33, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 23
          Unknown_N_ageclass[24, 0] = TOTAL(WAE_length_binU[34, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 24
          Unknown_N_ageclass[25, 0] = TOTAL(WAE_length_binU[35, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 25
          Unknown_N_ageclass[26, 0] = TOTAL(WAE_length_binU[36, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 26
          PRINT, 'Derived age distribution for unknowns'
          PRINT, Unknown_N_ageclass[*, 0]
          PRINT, 'Total number of unknowns', total(Unknown_N_ageclass[*, 0])
          age0UNum = where(FishAge[*] EQ 0 AND Sex_prod[*] EQ 2, age0UNumcount)
          age1UNum = where(FishAge[*] EQ 1 AND Sex_prod[*] EQ 2, age1UNumcount)
          age2UNum = where(FishAge[*] EQ 2 AND Sex_prod[*] EQ 2, age2UNumcount)
          age3UNum = where(FishAge[*] EQ 3 AND Sex_prod[*] EQ 2, age3UNumcount)
          age4UNum = where(FishAge[*] EQ 4 AND Sex_prod[*] EQ 2, age4UNumcount)
          age5UNum = where(FishAge[*] EQ 5 AND Sex_prod[*] EQ 2, age5UNumcount)
          age6UNum = where(FishAge[*] EQ 6 AND Sex_prod[*] EQ 2, age6UNumcount)
          age7UNum = where(FishAge[*] EQ 7 AND Sex_prod[*] EQ 2, age7UNumcount)
          age8UNum = where(FishAge[*] EQ 8 AND Sex_prod[*] EQ 2, age8UNumcount)
          age9UNum = where(FishAge[*] EQ 9 AND Sex_prod[*] EQ 2, age9UNumcount)
          age10UNum = where(FishAge[*] EQ 10 AND Sex_prod[*] EQ 2, age10UNumcount)
          age11UNum = where(FishAge[*] EQ 11 AND Sex_prod[*] EQ 2, age11UNumcount)
          age12UNum = where(FishAge[*] EQ 12 AND Sex_prod[*] EQ 2, age12UNumcount)
          age13UNum = where(FishAge[*] EQ 13 AND Sex_prod[*] EQ 2, age13UNumcount)
          age14UNum = where(FishAge[*] EQ 14 AND Sex_prod[*] EQ 2, age14UNumcount)
          age15UNum = where(FishAge[*] EQ 15 AND Sex_prod[*] EQ 2, age15UNumcount)
          age16UNum = where(FishAge[*] EQ 16 AND Sex_prod[*] EQ 2, age16UNumcount)
          age17UNum = where(FishAge[*] EQ 17 AND Sex_prod[*] EQ 2, age17UNumcount)
          age18UNum = where(FishAge[*] EQ 18 AND Sex_prod[*] EQ 2, age18UNumcount)
          age19UNum = where(FishAge[*] EQ 19 AND Sex_prod[*] EQ 2, age19UNumcount)
          age20UNum = where(FishAge[*] EQ 20 AND Sex_prod[*] EQ 2, age20UNumcount)
          age21UNum = where(FishAge[*] EQ 21 AND Sex_prod[*] EQ 2, age21UNumcount)
          age22UNum = where(FishAge[*] EQ 22 AND Sex_prod[*] EQ 2, age22UNumcount)
          age23UNum = where(FishAge[*] EQ 23 AND Sex_prod[*] EQ 2, age23UNumcount)
          age24UNum = where(FishAge[*] EQ 24 AND Sex_prod[*] EQ 2, age24UNumcount)
          age25UNum = where(FishAge[*] EQ 25 AND Sex_prod[*] EQ 2, age25UNumcount)
          age26UNum = where(FishAge[*] EQ 26 AND Sex_prod[*] EQ 2, age26UNumcount)
          IF age0UNumcount GT 0 THEN Total_N_ageclass2[0, 3] = age0UNumcount
          IF age1UNumcount GT 0 THEN Total_N_ageclass2[1, 3] = age1UNumcount
          IF age2UNumcount GT 0 THEN Total_N_ageclass2[2, 3] = age2UNumcount
          IF age3UNumcount GT 0 THEN Total_N_ageclass2[3, 3] = age3UNumcount
          IF age4UNumcount GT 0 THEN Total_N_ageclass2[4, 3] = age4UNumcount
          IF age5UNumcount GT 0 THEN Total_N_ageclass2[5, 3] = age5UNumcount
          IF age6UNumcount GT 0 THEN Total_N_ageclass2[6, 3] = age6UNumcount
          IF age7UNumcount GT 0 THEN Total_N_ageclass2[7, 3] = age7UNumcount
          IF age8UNumcount GT 0 THEN Total_N_ageclass2[8, 3] = age8UNumcount
          IF age9UNumcount GT 0 THEN Total_N_ageclass2[9, 3] = age9UNumcount
          IF age10UNumcount GT 0 THEN Total_N_ageclass2[10, 3] = age10UNumcount
          IF age11UNumcount GT 0 THEN Total_N_ageclass2[11, 3] = age11UNumcount
          IF age12UNumcount GT 0 THEN Total_N_ageclass2[12, 3] = age12UNumcount
          IF age13UNumcount GT 0 THEN Total_N_ageclass2[13, 3] = age13UNumcount
          IF age14UNumcount GT 0 THEN Total_N_ageclass2[14, 3] = age14UNumcount
          IF age15UNumcount GT 0 THEN Total_N_ageclass2[15, 3] = age15UNumcount
          IF age16UNumcount GT 0 THEN Total_N_ageclass2[16, 3] = age16UNumcount
          IF age17UNumcount GT 0 THEN Total_N_ageclass2[17, 3] = age17UNumcount
          IF age18UNumcount GT 0 THEN Total_N_ageclass2[18, 3] = age18UNumcount
          IF age19UNumcount GT 0 THEN Total_N_ageclass2[19, 3] = age19UNumcount
          IF age20UNumcount GT 0 THEN Total_N_ageclass2[20, 3] = age20UNumcount
          IF age21UNumcount GT 0 THEN Total_N_ageclass2[21, 3] = age21UNumcount
          IF age22UNumcount GT 0 THEN Total_N_ageclass2[22, 3] = age22UNumcount
          IF age23UNumcount GT 0 THEN Total_N_ageclass2[23, 3] = age23UNumcount
          IF age24UNumcount GT 0 THEN Total_N_ageclass2[24, 3] = age24UNumcount
          IF age25UNumcount GT 0 THEN Total_N_ageclass2[25, 3] = age25UNumcount
          IF age26UNumcount GT 0 THEN Total_N_ageclass2[26, 3] = age26UNumcount
          PRINT, 'Derived age distribution for UNKNOWN (individual-based)'
          PRINT, Total_N_ageclass2[*, 3]
          PRINT, 'Total number of UNKNOWN (INDIVIDUAL-BASED)'
          PRINT, total(Total_N_ageclass2[*, 3])

          ; Estimate age structure using PE- ALL FISH
          Prop_ageclass = fltarr(27L, 4L)
          IF TOTAL(Total_N_ageclass[*, 0]) GT 0. THEN Prop_ageclass[*, 0] = Total_N_ageclass[*, 0]/TOTAL(Total_N_ageclass[*, 0])
          PRINT, 'Relative age distribution - ALL FISH'
          PRINT, Prop_ageclass[*, 0]
          ; Estimate age structure - MALES
          IF TOTAL(Total_N_ageclass[*, 0]) GT 0. THEN Prop_ageclass[*, 1] = Male_N_ageclass[*, 0]/TOTAL(Total_N_ageclass[*, 0])
          PRINT, 'Relative age distribution - MALES'
          PRINT, Prop_ageclass[*, 1]
          ; Estimate age structure - FEMALES
          IF TOTAL(Total_N_ageclass[*, 0]) GT 0. THEN Prop_ageclass[*, 2] = Female_N_ageclass[*, 0]/TOTAL(Total_N_ageclass[*, 0])
          PRINT, 'Relative age distribution - FEMALES'
          PRINT, Prop_ageclass[*, 2]
          ; Estimate age structure - UNKNOWNS
          IF TOTAL(Total_N_ageclass[*, 0]) GT 0. THEN Prop_ageclass[*, 3] = Unknown_N_ageclass[*, 0]/TOTAL(Total_N_ageclass[*, 0])
          PRINT, 'Relative age distribution - UNKNOWN'
          PRINT, Prop_ageclass[*, 3]

          ; Estimate age structure 2 - ALL FISH
          Prop_ageclass2 = fltarr(27L, 4L)
          IF TOTAL(Total_N_ageclass2[*, 0]) GT 0. THEN Prop_ageclass2[*, 0] = Total_N_ageclass2[*, 0]/TOTAL(Total_N_ageclass[*, 0])
          PRINT, 'Relative age distribution2 - ALL FISH'
          PRINT, Prop_ageclass2[*, 0]
          ; Estimate age structure - MALES
          IF TOTAL(Total_N_ageclass2[*, 0]) GT 0. THEN Prop_ageclass2[*, 1] = Total_N_ageclass2[*, 1]/TOTAL(Total_N_ageclass[*, 0])
          PRINT, 'Relative age distribution2 - MALES'
          PRINT, Prop_ageclass2[*, 1]
          ; Estimate age structure - FEMALES
          IF TOTAL(Total_N_ageclass2[*, 0]) GT 0. THEN Prop_ageclass2[*, 2] = Total_N_ageclass2[*, 2]/TOTAL(Total_N_ageclass[*, 0])
          PRINT, 'Relative age distribution2 - FEMALES'
          PRINT, Prop_ageclass2[*, 2]
          ; Estimate age structure - UNKNOWNS
          IF TOTAL(Total_N_ageclass2[*, 0]) GT 0. THEN Prop_ageclass2[*, 3] = Total_N_ageclass2[*, 3]/TOTAL(Total_N_ageclass[*, 0])
          PRINT, 'Relative age distribution2 - UNKNOWN'
          PRINT, Prop_ageclass2[*, 3]

          PRINT, 'Population estimate (PE)', PE[INDEX_lengthdata[0]]
          paramset[13:39, i] = ROUND(Prop_ageclass[*, 0]*PE[INDEX_lengthdata[0]])
          paramset[13, i] = YOY_PE[i]
          PRINT, 'Estimated age distribution - ALL FISH'
          PRINT, paramset[13:39, i]
          paramsetM[13:39, i] = ROUND(Prop_ageclass[*, 1]*PE[INDEX_lengthdata[0]])
          PRINT, 'Estimated age distribution - MALES'
          PRINT, ROUND(Prop_ageclass[*, 1]*PE[INDEX_lengthdata[0]])
          paramsetF[13:39, i] = ROUND(Prop_ageclass[*, 2]*PE[INDEX_lengthdata[0]])
          PRINT, 'Estimated age distribution - FEMALES'
          PRINT, ROUND(Prop_ageclass[*, 2]*PE[INDEX_lengthdata[0]])
          paramsetU[13:39, i] = ROUND(Prop_ageclass[*, 3]*PE[INDEX_lengthdata[0]])
          PRINT, 'Estimated age distribution - UNKNOWNS'
          PRINT, ROUND(Prop_ageclass[*, 3]*PE[INDEX_lengthdata[0]])

          ; Plot estimated age structure
          maleage=ROUND(Prop_ageclass[*, 1]*PE[INDEX_lengthdata[0]])
          femaleage=ROUND(Prop_ageclass[*, 2]*PE[INDEX_lengthdata[0]])
          unknownage=ROUND(Prop_ageclass[*, 3]*PE[INDEX_lengthdata[0]])
          unknownage[0]=YOY_PE[i]
          maleage2=ROUND(Prop_ageclass2[*, 1]*PE[INDEX_lengthdata[0]])
          femaleage2=ROUND(Prop_ageclass2[*, 2]*PE[INDEX_lengthdata[0]])
          unknownage2=ROUND(Prop_ageclass2[*, 3]*PE[INDEX_lengthdata[0]])
          unknownage2[0]=YOY_PE[i]

          !p.font=0
          ;Device, Set_Character_Size=[8,12]
          DEVICE, Get_Decomposed=currentState
          DEVICE, SET_FONT='Courier', /TT_FONT
          DEVICE, DECOMPOSED=0
          cgDisplay, 750, 400, WID=1
          ;!P.Multi = [0,2,1]
          labels = INDGEN(27);
          cgLoadct, 33, Clip=[10,245]
          cgBarPlot, maleage,  YRange=[0,ROUND(MAX(maleage+femaleage+unknownage))*1.3], Colors='BLUE', BarNames=labels $
            , xtitle='Age (years)' $
            , ytitle='Number of fish' $;, xrange=[0, 25]
            , title='Age structure of WI walleye - '+'WBIC: '+STRING(paramset[1, i], FORMAT = '(I7)') $
            +'_Year: '+STRING(fix(paramset[2, i]), FORMAT = '(I4)')+' PE='+STRING(PE[INDEX_lengthdata[0]], FORMAT = '(I5)')+stock
          cgBarPlot, femaleage, Colors='RED', /Overplot, BaseLines=maleage
          cgBarPlot, unknownage, Colors='dark green', /Overplot, BaseLines=maleage+femaleage
          items = ['Male', 'Female', 'Unknown']
          colors = ['BLUE', 'RED', 'dark green']
          AL_Legend, items, Colors=colors, PSym=Replicate(15,3), SymSize=Replicate(1.75,3), $
            Charsize=cgDefCharsize(), Position=[0.75, 0.85], /Normal
          filename='Walleye age structure' + STRING(paramset[1, i], FORMAT = '(I7)') $
            + '_'+STRING(fix(paramset[2, i]), FORMAT = '(I4)') + '.png'
          WRITE_PNG, filename, TVRD(/TRUE)
          DEVICE, DECOMPOSED=old_decomposed
          !p.font=1

          !p.font=0
          ;Device, Set_Character_Size=[8,12]
          DEVICE, Get_Decomposed=currentState
          DEVICE, SET_FONT='Courier', /TT_FONT
          DEVICE, DECOMPOSED=0
          cgDisplay, 750, 400, WID=1
          ;!P.Multi = [0,2,1]
          labels = INDGEN(27);
          cgLoadct, 33, Clip=[10,245]
          cgBarPlot, maleage,  YRange=[0,ROUND(MAX(maleage2+femaleage2+unknownage2))*1.3], Colors='BLUE', BarNames=labels $
            , xtitle='Age (years)' $
            , ytitle='Number of fish' $;, xrange=[0, 25]
            , title='Age structure of WI walleye2 - '+'WBIC: '+STRING(paramset[1, i], FORMAT = '(I7)') $
            +'_Year: '+STRING(fix(paramset[2, i]), FORMAT = '(I4)')+' PE='+STRING(PE[INDEX_lengthdata[0]], FORMAT = '(I5)')+stock
          cgBarPlot, femaleage, Colors='RED', /Overplot, BaseLines=maleage
          cgBarPlot, unknownage, Colors='dark green', /Overplot, BaseLines=maleage+femaleage
          items = ['Male', 'Female', 'Unknown']
          colors = ['BLUE', 'RED', 'dark green']
          AL_Legend, items, Colors=colors, PSym=Replicate(15,3), SymSize=Replicate(1.75,3), $
            Charsize=cgDefCharsize(), Position=[0.75, 0.85], /Normal
          filename='Walleye age structure2' + STRING(paramset[1, i], FORMAT = '(I7)') $
            + '_'+STRING(fix(paramset[2, i]), FORMAT = '(I4)') + '.png'
          WRITE_PNG, filename, TVRD(/TRUE)
          DEVICE, DECOMPOSED=old_decomposed
          !p.font=1

          ; Mean length-at-age from estiamted age structure (meas of mean length-at-age from each length bins) - ALL FISH
          mean_length_at_age = FLTARR(27L, 37L)
          mean_length_at_age[0, *] = (WAE_length_mean[10, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_age[1, *] = (WAE_length_mean[11, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_age[2, *] = (WAE_length_mean[12, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_age[3, *] = (WAE_length_mean[13, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_age[4, *] = (WAE_length_mean[14, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_age[5, *] = (WAE_length_mean[15, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_age[6, *] = (WAE_length_mean[16, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_age[7, *] = (WAE_length_mean[17, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_age[8, *] = (WAE_length_mean[18, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_age[9, *] = (WAE_length_mean[19, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_age[10, *] = (WAE_length_mean[20, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_age[11, *] = (WAE_length_mean[21, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_age[12, *] = (WAE_length_mean[22, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_age[13, *] = (WAE_length_mean[23, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_age[14, *] = (WAE_length_mean[24, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_age[15, *] = (WAE_length_mean[25, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_age[16, *] = (WAE_length_mean[26, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_age[17, *] = (WAE_length_mean[27, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_age[18, *] = (WAE_length_mean[28, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_age[19, *] = (WAE_length_mean[29, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_age[20, *] = (WAE_length_mean[30, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_age[21, *] = (WAE_length_mean[31, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_age[22, *] = (WAE_length_mean[32, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_age[23, *] = (WAE_length_mean[33, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_age[24, *] = (WAE_length_mean[34, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_age[25, *] = (WAE_length_mean[35, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_age[26, *] = (WAE_length_mean[36, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          age0mean = where(mean_length_at_age[0, *] GT 0, age0meancount)
          age1mean = where(mean_length_at_age[1, *] GT 0, age1meancount)
          age2mean = where(mean_length_at_age[2, *] GT 0, age2meancount)
          age3mean = where(mean_length_at_age[3, *] GT 0, age3meancount)
          age4mean = where(mean_length_at_age[4, *] GT 0, age4meancount)
          age5mean = where(mean_length_at_age[5, *] GT 0, age5meancount)
          age6mean = where(mean_length_at_age[6, *] GT 0, age6meancount)
          age7mean = where(mean_length_at_age[7, *] GT 0, age7meancount)
          age8mean = where(mean_length_at_age[8, *] GT 0, age8meancount)
          age9mean = where(mean_length_at_age[9, *] GT 0, age9meancount)
          age10mean = where(mean_length_at_age[10, *] GT 0, age10meancount)
          age11mean = where(mean_length_at_age[11, *] GT 0, age11meancount)
          age12mean = where(mean_length_at_age[12, *] GT 0, age12meancount)
          age13mean = where(mean_length_at_age[13, *] GT 0, age13meancount)
          age14mean = where(mean_length_at_age[14, *] GT 0, age14meancount)
          age15mean = where(mean_length_at_age[15, *] GT 0, age15meancount)
          age16mean = where(mean_length_at_age[16, *] GT 0, age16meancount)
          age17mean = where(mean_length_at_age[17, *] GT 0, age17meancount)
          age18mean = where(mean_length_at_age[18, *] GT 0, age18meancount)
          age19mean = where(mean_length_at_age[19, *] GT 0, age19meancount)
          age20mean = where(mean_length_at_age[20, *] GT 0, age20meancount)
          age21mean = where(mean_length_at_age[21, *] GT 0, age21meancount)
          age22mean = where(mean_length_at_age[22, *] GT 0, age22meancount)
          age23mean = where(mean_length_at_age[23, *] GT 0, age23meancount)
          age24mean = where(mean_length_at_age[24, *] GT 0, age24meancount)
          age25mean = where(mean_length_at_age[25, *] GT 0, age25meancount)
          age26mean = where(mean_length_at_age[26, *] GT 0, age26meancount)
          IF age0meancount GT 0 THEN Total_N_ageclass[0, 1] = TOTAL(WAE_length_mean[10, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age0meancount
          IF age1meancount GT 0 THEN Total_N_ageclass[1, 1] = TOTAL(WAE_length_mean[11, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age1meancount
          IF age2meancount GT 0 THEN Total_N_ageclass[2, 1] = TOTAL(WAE_length_mean[12, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age2meancount
          IF age3meancount GT 0 THEN Total_N_ageclass[3, 1] = TOTAL(WAE_length_mean[13, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age3meancount
          IF age4meancount GT 0 THEN Total_N_ageclass[4, 1] = TOTAL(WAE_length_mean[14, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age4meancount
          IF age5meancount GT 0 THEN Total_N_ageclass[5, 1] = TOTAL(WAE_length_mean[15, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age5meancount
          IF age6meancount GT 0 THEN Total_N_ageclass[6, 1] = TOTAL(WAE_length_mean[16, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age6meancount
          IF age7meancount GT 0 THEN Total_N_ageclass[7, 1] = TOTAL(WAE_length_mean[17, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age7meancount
          IF age8meancount GT 0 THEN Total_N_ageclass[8, 1] = TOTAL(WAE_length_mean[18, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age8meancount
          IF age9meancount GT 0 THEN Total_N_ageclass[9, 1] = TOTAL(WAE_length_mean[19, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age9meancount
          IF age10meancount GT 0 THEN Total_N_ageclass[10, 1] = TOTAL(WAE_length_mean[20, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age10meancount
          IF age11meancount GT 0 THEN Total_N_ageclass[11, 1] = TOTAL(WAE_length_mean[21, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age11meancount
          IF age12meancount GT 0 THEN Total_N_ageclass[12, 1] = TOTAL(WAE_length_mean[22, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age12meancount
          IF age13meancount GT 0 THEN Total_N_ageclass[13, 1] = TOTAL(WAE_length_mean[23, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age13meancount
          IF age14meancount GT 0 THEN Total_N_ageclass[14, 1] = TOTAL(WAE_length_mean[24, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age14meancount
          IF age15meancount GT 0 THEN Total_N_ageclass[15, 1] = TOTAL(WAE_length_mean[25, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age15meancount
          IF age16meancount GT 0 THEN Total_N_ageclass[16, 1] = TOTAL(WAE_length_mean[26, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age16meancount
          IF age17meancount GT 0 THEN Total_N_ageclass[17, 1] = TOTAL(WAE_length_mean[27, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age17meancount
          IF age18meancount GT 0 THEN Total_N_ageclass[18, 1] = TOTAL(WAE_length_mean[28, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age18meancount
          IF age19meancount GT 0 THEN Total_N_ageclass[19, 1] = TOTAL(WAE_length_mean[29, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age19meancount
          IF age20meancount GT 0 THEN Total_N_ageclass[20, 1] = TOTAL(WAE_length_mean[30, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age20meancount
          IF age21meancount GT 0 THEN Total_N_ageclass[21, 1] = TOTAL(WAE_length_mean[31, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age21meancount
          IF age22meancount GT 0 THEN Total_N_ageclass[22, 1] = TOTAL(WAE_length_mean[32, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age22meancount
          IF age23meancount GT 0 THEN Total_N_ageclass[23, 1] = TOTAL(WAE_length_mean[33, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age23meancount
          IF age24meancount GT 0 THEN Total_N_ageclass[24, 1] = TOTAL(WAE_length_mean[34, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age24meancount
          IF age25meancount GT 0 THEN Total_N_ageclass[25, 1] = TOTAL(WAE_length_mean[35, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age25meancount
          IF age26meancount GT 0 THEN Total_N_ageclass[26, 1] = TOTAL(WAE_length_mean[36, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age26meancount

          ; Body length (mm) of YOY - ******NEED TO CHANGE IT TO LAKE-YEAR-SPECIFIC
          YOYNOlength = where((Total_N_ageclass[0, 0] GT 0.) AND (Total_N_ageclass[0, 1] LE 0.), YOYNOlengthcount)
          IF paramset[40, i] LE 0 THEN paramset[40, i] = 104.5
          IF YOYNOlengthcount GT 0 THEN Total_N_ageclass[YOYNOlength, 1] = paramset[40, i]
          PRINT, 'Mean length-at-age'
          PRINT, Total_N_ageclass[*, 1]

          ; Mean length-at-age from estiamted age structure - males
          mean_length_at_ageM = FLTARR(27L, 37L)
          mean_length_at_ageM[0, *] = (WAE_length_meanM[10, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageM[1, *] = (WAE_length_meanM[11, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageM[2, *] = (WAE_length_meanM[12, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageM[3, *] = (WAE_length_meanM[13, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageM[4, *] = (WAE_length_meanM[14, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageM[5, *] = (WAE_length_meanM[15, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageM[6, *] = (WAE_length_meanM[16, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageM[7, *] = (WAE_length_meanM[17, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageM[8, *] = (WAE_length_meanM[18, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageM[9, *] = (WAE_length_meanM[19, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageM[10, *] = (WAE_length_meanM[20, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageM[11, *] = (WAE_length_meanM[21, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageM[12, *] = (WAE_length_meanM[22, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageM[13, *] = (WAE_length_meanM[23, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageM[14, *] = (WAE_length_meanM[24, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageM[15, *] = (WAE_length_meanM[25, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageM[16, *] = (WAE_length_meanM[26, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageM[17, *] = (WAE_length_meanM[27, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageM[18, *] = (WAE_length_meanM[28, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageM[19, *] = (WAE_length_meanM[29, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageM[20, *] = (WAE_length_meanM[30, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageM[21, *] = (WAE_length_meanM[31, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageM[22, *] = (WAE_length_meanM[32, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageM[23, *] = (WAE_length_meanM[33, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageM[24, *] = (WAE_length_meanM[34, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageM[25, *] = (WAE_length_meanM[35, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageM[26, *] = (WAE_length_meanM[36, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          age0Mmean = where(mean_length_at_ageM[0, *] GT 0, age0meanMcount)
          age1Mmean = where(mean_length_at_ageM[1, *] GT 0, age1meanMcount)
          age2Mmean = where(mean_length_at_ageM[2, *] GT 0, age2meanMcount)
          age3Mmean = where(mean_length_at_ageM[3, *] GT 0, age3meanMcount)
          age4Mmean = where(mean_length_at_ageM[4, *] GT 0, age4meanMcount)
          age5Mmean = where(mean_length_at_ageM[5, *] GT 0, age5meanMcount)
          age6Mmean = where(mean_length_at_ageM[6, *] GT 0, age6meanMcount)
          age7Mmean = where(mean_length_at_ageM[7, *] GT 0, age7meanMcount)
          age8Mmean = where(mean_length_at_ageM[8, *] GT 0, age8meanMcount)
          age9Mmean = where(mean_length_at_ageM[9, *] GT 0, age9meanMcount)
          age10Mmean = where(mean_length_at_ageM[10, *] GT 0, age10meanMcount)
          age11Mmean = where(mean_length_at_ageM[11, *] GT 0, age11meanMcount)
          age12Mmean = where(mean_length_at_ageM[12, *] GT 0, age12meanMcount)
          age13Mmean = where(mean_length_at_ageM[13, *] GT 0, age13meanMcount)
          age14Mmean = where(mean_length_at_ageM[14, *] GT 0, age14meanMcount)
          age15Mmean = where(mean_length_at_ageM[15, *] GT 0, age15meanMcount)
          age16Mmean = where(mean_length_at_ageM[16, *] GT 0, age16meanMcount)
          age17Mmean = where(mean_length_at_ageM[17, *] GT 0, age17meanMcount)
          age18Mmean = where(mean_length_at_ageM[18, *] GT 0, age18meanMcount)
          age19Mmean = where(mean_length_at_ageM[19, *] GT 0, age19meanMcount)
          age20Mmean = where(mean_length_at_ageM[20, *] GT 0, age20meanMcount)
          age21Mmean = where(mean_length_at_ageM[21, *] GT 0, age21meanMcount)
          age22Mmean = where(mean_length_at_ageM[22, *] GT 0, age22meanMcount)
          age23Mmean = where(mean_length_at_ageM[23, *] GT 0, age23meanMcount)
          age24Mmean = where(mean_length_at_ageM[24, *] GT 0, age24meanMcount)
          age25Mmean = where(mean_length_at_ageM[25, *] GT 0, age25meanMcount)
          age26Mmean = where(mean_length_at_ageM[26, *] GT 0, age26meanMcount)
          IF age0meanMcount GT 0 THEN Male_N_ageclass[0, 1] = TOTAL(WAE_length_meanM[10, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age0meanMcount
          IF age1meanMcount GT 0 THEN Male_N_ageclass[1, 1] = TOTAL(WAE_length_meanM[11, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age1meanMcount
          IF age2meanMcount GT 0 THEN Male_N_ageclass[2, 1] = TOTAL(WAE_length_meanM[12, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age2meanMcount
          IF age3meanMcount GT 0 THEN Male_N_ageclass[3, 1] = TOTAL(WAE_length_meanM[13, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age3meanMcount
          IF age4meanMcount GT 0 THEN Male_N_ageclass[4, 1] = TOTAL(WAE_length_meanM[14, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age4meanMcount
          IF age5meanMcount GT 0 THEN Male_N_ageclass[5, 1] = TOTAL(WAE_length_meanM[15, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age5meanMcount
          IF age6meanMcount GT 0 THEN Male_N_ageclass[6, 1] = TOTAL(WAE_length_meanM[16, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age6meanMcount
          IF age7meanMcount GT 0 THEN Male_N_ageclass[7, 1] = TOTAL(WAE_length_meanM[17, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age7meanMcount
          IF age8meanMcount GT 0 THEN Male_N_ageclass[8, 1] = TOTAL(WAE_length_meanM[18, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age8meanMcount
          IF age9meanMcount GT 0 THEN Male_N_ageclass[9, 1] = TOTAL(WAE_length_meanM[19, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age9meanMcount
          IF age10meanMcount GT 0 THEN Male_N_ageclass[10, 1] = TOTAL(WAE_length_meanM[20, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age10meanMcount
          IF age11meanMcount GT 0 THEN Male_N_ageclass[11, 1] = TOTAL(WAE_length_meanM[21, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age11meanMcount
          IF age12meanMcount GT 0 THEN Male_N_ageclass[12, 1] = TOTAL(WAE_length_meanM[22, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age12meanMcount
          IF age13meanMcount GT 0 THEN Male_N_ageclass[13, 1] = TOTAL(WAE_length_meanM[23, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age13meanMcount
          IF age14meanMcount GT 0 THEN Male_N_ageclass[14, 1] = TOTAL(WAE_length_meanM[24, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age14meanMcount
          IF age15meanMcount GT 0 THEN Male_N_ageclass[15, 1] = TOTAL(WAE_length_meanM[25, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age15meanMcount
          IF age16meanMcount GT 0 THEN Male_N_ageclass[16, 1] = TOTAL(WAE_length_meanM[26, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age16meanMcount
          IF age17meanMcount GT 0 THEN Male_N_ageclass[17, 1] = TOTAL(WAE_length_meanM[27, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age17meanMcount
          IF age18meanMcount GT 0 THEN Male_N_ageclass[18, 1] = TOTAL(WAE_length_meanM[28, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age18meanMcount
          IF age19meanMcount GT 0 THEN Male_N_ageclass[19, 1] = TOTAL(WAE_length_meanM[29, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age19meanMcount
          IF age20meanMcount GT 0 THEN Male_N_ageclass[20, 1] = TOTAL(WAE_length_meanM[30, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age20meanMcount
          IF age21meanMcount GT 0 THEN Male_N_ageclass[21, 1] = TOTAL(WAE_length_meanM[31, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age21meanMcount
          IF age22meanMcount GT 0 THEN Male_N_ageclass[22, 1] = TOTAL(WAE_length_meanM[32, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age22meanMcount
          IF age23meanMcount GT 0 THEN Male_N_ageclass[23, 1] = TOTAL(WAE_length_meanM[33, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age23meanMcount
          IF age24meanMcount GT 0 THEN Male_N_ageclass[24, 1] = TOTAL(WAE_length_meanM[34, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age24meanMcount
          IF age25meanMcount GT 0 THEN Male_N_ageclass[25, 1] = TOTAL(WAE_length_meanM[35, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age25meanMcount
          IF age26meanMcount GT 0 THEN Male_N_ageclass[26, 1] = TOTAL(WAE_length_meanM[36, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age26meanMcount
          PRINT, 'Mean length-at-age for males'
          PRINT, Male_N_ageclass[*, 1]

          ; Mean length-at-age from estiamted age structure - females
          mean_length_at_ageF = FLTARR(27L, 37L)
          mean_length_at_ageF[0, *] = (WAE_length_meanF[10, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageF[1, *] = (WAE_length_meanF[11, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageF[2, *] = (WAE_length_meanF[12, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageF[3, *] = (WAE_length_meanF[13, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageF[4, *] = (WAE_length_meanF[14, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageF[5, *] = (WAE_length_meanF[15, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageF[6, *] = (WAE_length_meanF[16, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageF[7, *] = (WAE_length_meanF[17, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageF[8, *] = (WAE_length_meanF[18, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageF[9, *] = (WAE_length_meanF[19, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageF[10, *] = (WAE_length_meanF[20, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageF[11, *] = (WAE_length_meanF[21, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageF[12, *] = (WAE_length_meanF[22, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageF[13, *] = (WAE_length_meanF[23, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageF[14, *] = (WAE_length_meanF[24, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageF[15, *] = (WAE_length_meanF[25, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageF[16, *] = (WAE_length_meanF[26, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageF[17, *] = (WAE_length_meanF[27, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageF[18, *] = (WAE_length_meanF[28, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageF[19, *] = (WAE_length_meanF[29, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageF[20, *] = (WAE_length_meanF[30, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageF[21, *] = (WAE_length_meanF[31, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageF[22, *] = (WAE_length_meanF[32, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageF[23, *] = (WAE_length_meanF[33, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageF[24, *] = (WAE_length_meanF[34, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageF[25, *] = (WAE_length_meanF[35, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          mean_length_at_ageF[26, *] = (WAE_length_meanF[36, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
          age0Mmean = where(mean_length_at_ageF[0, *] GT 0, age0meanFcount)
          age1Mmean = where(mean_length_at_ageF[1, *] GT 0, age1meanFcount)
          age2Mmean = where(mean_length_at_ageF[2, *] GT 0, age2meanFcount)
          age3Mmean = where(mean_length_at_ageF[3, *] GT 0, age3meanFcount)
          age4Mmean = where(mean_length_at_ageF[4, *] GT 0, age4meanFcount)
          age5Mmean = where(mean_length_at_ageF[5, *] GT 0, age5meanFcount)
          age6Mmean = where(mean_length_at_ageF[6, *] GT 0, age6meanFcount)
          age7Mmean = where(mean_length_at_ageF[7, *] GT 0, age7meanFcount)
          age8Mmean = where(mean_length_at_ageF[8, *] GT 0, age8meanFcount)
          age9Mmean = where(mean_length_at_ageF[9, *] GT 0, age9meanFcount)
          age10Mmean = where(mean_length_at_ageF[10, *] GT 0, age10meanFcount)
          age11Mmean = where(mean_length_at_ageF[11, *] GT 0, age11meanFcount)
          age12Mmean = where(mean_length_at_ageF[12, *] GT 0, age12meanFcount)
          age13Mmean = where(mean_length_at_ageF[13, *] GT 0, age13meanFcount)
          age14Mmean = where(mean_length_at_ageF[14, *] GT 0, age14meanFcount)
          age15Mmean = where(mean_length_at_ageF[15, *] GT 0, age15meanFcount)
          age16Mmean = where(mean_length_at_ageF[16, *] GT 0, age16meanFcount)
          age17Mmean = where(mean_length_at_ageF[17, *] GT 0, age17meanFcount)
          age18Mmean = where(mean_length_at_ageF[18, *] GT 0, age18meanFcount)
          age19Mmean = where(mean_length_at_ageF[19, *] GT 0, age19meanFcount)
          age20Mmean = where(mean_length_at_ageF[20, *] GT 0, age20meanFcount)
          age21Mmean = where(mean_length_at_ageF[21, *] GT 0, age21meanFcount)
          age22Mmean = where(mean_length_at_ageF[22, *] GT 0, age22meanFcount)
          age23Mmean = where(mean_length_at_ageF[23, *] GT 0, age23meanFcount)
          age24Mmean = where(mean_length_at_ageF[24, *] GT 0, age24meanFcount)
          age25Mmean = where(mean_length_at_ageF[25, *] GT 0, age25meanFcount)
          age26Mmean = where(mean_length_at_ageF[26, *] GT 0, age26meanFcount)
          IF age0meanFcount GT 0 THEN Female_N_ageclass[0, 1] = TOTAL(WAE_length_meanF[10, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age0meanFcount
          IF age1meanFcount GT 0 THEN Female_N_ageclass[1, 1] = TOTAL(WAE_length_meanF[11, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age1meanFcount
          IF age2meanFcount GT 0 THEN Female_N_ageclass[2, 1] = TOTAL(WAE_length_meanF[12, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age2meanFcount
          IF age3meanFcount GT 0 THEN Female_N_ageclass[3, 1] = TOTAL(WAE_length_meanF[13, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age3meanFcount
          IF age4meanFcount GT 0 THEN Female_N_ageclass[4, 1] = TOTAL(WAE_length_meanF[14, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age4meanFcount
          IF age5meanFcount GT 0 THEN Female_N_ageclass[5, 1] = TOTAL(WAE_length_meanF[15, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age5meanFcount
          IF age6meanFcount GT 0 THEN Female_N_ageclass[6, 1] = TOTAL(WAE_length_meanF[16, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age6meanFcount
          IF age7meanFcount GT 0 THEN Female_N_ageclass[7, 1] = TOTAL(WAE_length_meanF[17, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age7meanFcount
          IF age8meanFcount GT 0 THEN Female_N_ageclass[8, 1] = TOTAL(WAE_length_meanF[18, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age8meanFcount
          IF age9meanFcount GT 0 THEN Female_N_ageclass[9, 1] = TOTAL(WAE_length_meanF[19, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age9meanFcount
          IF age10meanFcount GT 0 THEN Female_N_ageclass[10, 1] = TOTAL(WAE_length_meanF[20, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age10meanFcount
          IF age11meanFcount GT 0 THEN Female_N_ageclass[11, 1] = TOTAL(WAE_length_meanF[21, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age11meanFcount
          IF age12meanFcount GT 0 THEN Female_N_ageclass[12, 1] = TOTAL(WAE_length_meanF[22, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age12meanFcount
          IF age13meanFcount GT 0 THEN Female_N_ageclass[13, 1] = TOTAL(WAE_length_meanF[23, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age13meanFcount
          IF age14meanFcount GT 0 THEN Female_N_ageclass[14, 1] = TOTAL(WAE_length_meanF[24, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age14meanFcount
          IF age15meanFcount GT 0 THEN Female_N_ageclass[15, 1] = TOTAL(WAE_length_meanF[25, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age15meanFcount
          IF age16meanFcount GT 0 THEN Female_N_ageclass[16, 1] = TOTAL(WAE_length_meanF[26, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age16meanFcount
          IF age17meanFcount GT 0 THEN Female_N_ageclass[17, 1] = TOTAL(WAE_length_meanF[27, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age17meanFcount
          IF age18meanFcount GT 0 THEN Female_N_ageclass[18, 1] = TOTAL(WAE_length_meanF[28, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age18meanFcount
          IF age19meanFcount GT 0 THEN Female_N_ageclass[19, 1] = TOTAL(WAE_length_meanF[29, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age19meanFcount
          IF age20meanFcount GT 0 THEN Female_N_ageclass[20, 1] = TOTAL(WAE_length_meanF[30, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age20meanFcount
          IF age21meanFcount GT 0 THEN Female_N_ageclass[21, 1] = TOTAL(WAE_length_meanF[31, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age21meanFcount
          IF age22meanFcount GT 0 THEN Female_N_ageclass[22, 1] = TOTAL(WAE_length_meanF[32, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age22meanFcount
          IF age23meanFcount GT 0 THEN Female_N_ageclass[23, 1] = TOTAL(WAE_length_meanF[33, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age23meanFcount
          IF age24meanFcount GT 0 THEN Female_N_ageclass[24, 1] = TOTAL(WAE_length_meanF[34, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age24meanFcount
          IF age25meanFcount GT 0 THEN Female_N_ageclass[25, 1] = TOTAL(WAE_length_meanF[35, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age25meanFcount
          IF age26meanFcount GT 0 THEN Female_N_ageclass[26, 1] = TOTAL(WAE_length_meanF[36, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age26meanFcount
          PRINT, 'Mean length-at-age for females'
          PRINT, Female_N_ageclass[*, 1]

          ; Store mean length-at-age in output arrays
          paramset[40L:66, i] = Total_N_ageclass[*, 1]
          paramsetM[40L:66, i] = Male_N_ageclass[*, 1]
          paramsetF[40L:66, i] = Female_N_ageclass[*, 1]
          paramsetU[40L:66, i] = Total_N_ageclass[*, 1]


          ; Convert mean length-at-age to mass-at-age - use population-level length-mass function
          ;Mean_mass = FLTARR(27L, 1)
          Mean_mass = 1.5868E-006*Total_N_ageclass[*, 1]^3.2962
          Mean_massM = 2.7673E-006*Male_N_ageclass[*, 1]^3.1984
          Mean_massF = 3.0031E-006*Female_N_ageclass[*, 1]^3.1988
          Mean_massU = 1.5868E-006*Total_N_ageclass[*, 1]^3.2962
          PRINT, 'Mean mass-at-age'
          PRINT, Mean_mass
          PRINT, 'Mean mass-at-age for males'
          PRINT, Mean_massM
          PRINT, 'Mean mass-at-age for females'
          PRINT, Mean_massF

          ; Store in the output arrays
          paramset[67L:93, i] = Mean_mass
          paramsetM[67L:93, i] = Mean_massM
          paramsetF[67L:93, i] = Mean_massF
          paramsetU[67L:93, i] = Mean_massU

          ; check if there is mass-at-age exists
          ; ALL FISH
          Age_NOmass = WHERE(Mean_mass LE 0, Age_NOmasscount)
          Age_Wmass = WHERE(Mean_mass GT 0, Age_Wmasscount)
          IF Age_Wmasscount GT 0. THEN PRINT, 'age class with mass data', Age_Wmass
          IF Age_NOmasscount GT 0. THEN PRINT, 'age class without mass data', Age_NOmass
          PRINT, 'max age class with mass', max(Age_Wmass)
          PRINT, 'min age class with mass', min(Age_Wmass)
          Age_mass_index = INDGEN(27)
          Age_NOmass_Intrpl = WHERE((Age_NOmass GT MIN(Age_Wmass)) AND (Age_NOmass LT MAX(Age_Wmass)), Age_NOmass_Intrplcount)
          IF Age_NOmass_Intrplcount GT 0 THEN PRINT, 'age class mass need interpolation', Age_NOmass[Age_NOmass_Intrpl]
          ; MALE
          Age_NOmassM = WHERE(Mean_massM LE 0, Age_NOmassMcount)
          Age_WmassM = WHERE(Mean_massM GT 0, Age_WmassMcount)
          IF Age_WmassMcount GT 0. THEN PRINT, 'age class with mass data', Age_WmassM
          IF Age_NOmassMcount GT 0. THEN PRINT, 'age class without mass data', Age_NOmassM
          PRINT, 'max age class with mass', max(Age_WmassM)
          PRINT, 'min age class with mass', min(Age_WmassM)
          Age_mass_indexM = INDGEN(27)
          Age_NOmass_IntrplM = WHERE((Age_NOmassM GT min(Age_WmassM)) AND (Age_NOmassM LT max(Age_WmassM)), Age_NOmass_IntrplMcount)
          IF Age_NOmass_IntrplMcount GT 0 THEN PRINT, 'age class mass need interpolation', Age_NOmassM[Age_NOmass_IntrplM]
          ; FEMALE
          Age_NOmassF = WHERE(Mean_massF LE 0, Age_NOmassFcount)
          Age_WmassF = WHERE(Mean_massF GT 0, Age_WmassFcount)
          IF Age_WmassFcount GT 0. THEN PRINT, 'age class with mass data', Age_WmassF
          IF Age_NOmassFcount GT 0. THEN PRINT, 'age class without mass data', Age_NOmassF
          PRINT, 'max age class with mass', max(Age_WmassF)
          PRINT, 'min age class with mass', min(Age_WmassF)
          Age_mass_indexF = INDGEN(27)
          Age_NOmass_IntrplF = WHERE((Age_NOmassF GT min(Age_WmassF)) AND (Age_NOmassF LT max(Age_WmassF)), Age_NOmass_IntrplFcount)
          IF Age_NOmass_IntrplFcount GT 0 THEN PRINT, 'age class mass need interpolation', Age_NOmassF[Age_NOmass_IntrplF]

          ; calculate biomass-at-age - BIOMASS = MASS x N 
          ;Biomass_ageclass = fltarr(27L, 1)
          Biomass_ageclass = Mean_mass*ROUND(Prop_ageclass[*, 0]*PE[INDEX_lengthdata[0]])
          Biomass_ageclass[0] = Mean_mass[0]*YOY_PE[i]
          PRINT, 'Biomass-at-age -ALL FISH'
          PRINT, Biomass_ageclass
          Biomass_ageclassM = Mean_massM*ROUND(Prop_ageclass[*, 1]*PE[INDEX_lengthdata[0]])
          PRINT, 'Biomass-at-age - MALE'
          PRINT, Biomass_ageclassM
          Biomass_ageclassF = Mean_massF*ROUND(Prop_ageclass[*, 2]*PE[INDEX_lengthdata[0]])
          PRINT, 'Biomass-at-age FEMALE'
          PRINT, Biomass_ageclassF
          Biomass_ageclassU = Mean_massU*ROUND(Prop_ageclass[*, 3]*PE[INDEX_lengthdata[0]])
          Biomass_ageclassU[0] = Mean_massU[0]*YOY_PE[i]
          PRINT, 'Biomass-at-age - UNKNOWN'
          PRINT, Biomass_ageclassU
          ; Store in the output arrays
          paramset[94L:120, i] = Biomass_ageclass
          paramsetM[94L:120, i] = Biomass_ageclassM
          paramsetF[94L:120, i] = Biomass_ageclassF
          paramsetU[94L:120, i] = Biomass_ageclassU

          ; calculate total and age-specific growth production
          ; total
          Growth_mass = fltarr(27L, 1)
          Mean_biomass = fltarr(27L, 1)
          Production = fltarr(27L, 1)
          FOR Agei = 1L, 26L DO BEGIN
            IF (Agei GE MIN(Age_Wmass)) AND (Agei LT MAX(Age_Wmass)) THEN BEGIN
              IF (Mean_mass[Agei-1L, 0] GT 0.) AND (Mean_mass[Agei, 0] GT 0.) THEN BEGIN
                Growth_mass[Agei, 0] = ALOG(Mean_mass[Agei, 0]/Mean_mass[Agei-1L, 0]); instantanepous rate of growth
                Mean_biomass[Agei, 0] = MEAN(Biomass_ageclass[Agei-1L:Agei, 0]); B hat
                Production[Agei, 0] = Growth_mass[Agei, 0] * Mean_biomass[Agei, 0]; PRODUCTION = B HAT x GROWTH 
              ENDIF
            ENDIF
          ENDFOR
          PRINT, 'Mean growth in mass'
          PRINT, Growth_mass
          PRINT, 'Mean biomass (Bhat)'
          PRINT, Mean_biomass
          PRINT, 'Production'
          PRINT, Production
          paramset[121L:147, i] = Growth_mass
          paramset[148L:174, i] = Mean_biomass
          paramset[175L:201, i] = Production

          ; male
          Growth_massM = fltarr(27L, 1)
          Mean_biomassM = fltarr(27L, 1)
          ProductionM = fltarr(27L, 1)
          ;IF (Mean_mass[3, 0] GT 0) AND (Mean_mass[4, 0] GT 0) THEN Growth_mass[0, 0] = Mean_mass[4, 0] - Mean_mass[3, 0]
          FOR Agei = 1L, 26L DO BEGIN
            IF (Agei GE MIN(Age_WmassM)) AND (Agei LT MAX(Age_WmassM)) THEN BEGIN
              ;print, 'agei', agei
              IF (Mean_massM[Agei-1L, 0] GT 0.) AND (Mean_massM[Agei, 0] GT 0.) THEN BEGIN
                Growth_massM[Agei, 0] = ALOG(Mean_massM[Agei, 0]/Mean_massM[Agei-1L, 0])
                Mean_biomassM[Agei, 0] = MEAN(Biomass_ageclassM[Agei-1L:Agei, 0])
                ProductionM[Agei, 0] = Growth_massM[Agei, 0] * Mean_biomassM[Agei, 0]
              ENDIF
            ENDIF
          ENDFOR
          PRINT, 'Mean growth in mass - MALES'
          PRINT, Growth_massM
          PRINT, 'Mean biomass (Bhat) - MALE'
          PRINT, Mean_biomassM
          PRINT, 'Production - MALE'
          PRINT, ProductionM
          paramsetM[121L:147, i] = Growth_massM
          paramsetM[148L:174, i] = Mean_biomassM
          paramsetM[175L:201, i] = ProductionM

          ; female
          Growth_massF = fltarr(27L, 1)
          Mean_biomassF = fltarr(27L, 1)
          ProductionF = fltarr(27L, 1)
          FOR Agei = 1L, 26L DO BEGIN
            IF (Agei GE MIN(Age_WmassF)) AND (Agei LT MAX(Age_WmassF)) THEN BEGIN
              ;print, 'agei', agei
              IF (Mean_massF[Agei-1L, 0] GT 0.) AND (Mean_massF[Agei, 0] GT 0.) THEN BEGIN
                Growth_massF[Agei, 0] = ALOG(Mean_massF[Agei, 0]/Mean_massF[Agei-1L, 0])
                Mean_biomassF[Agei, 0] = MEAN(Biomass_ageclassF[Agei-1L:Agei, 0])
                ProductionF[Agei, 0] = Growth_massF[Agei, 0] * Mean_biomassM[Agei, 0]
              ENDIF
            ENDIF
          ENDFOR
          PRINT, 'Mean growth in mass - FEMALES'
          PRINT, Growth_massF
          PRINT, 'Mean biomass (Bhat) - FEMALE'
          PRINT, Mean_biomassF
          PRINT, 'Production - FEMALE'
          PRINT, ProductionF
          paramsetF[121L:147, i] = Growth_massF
          paramsetF[148L:174, i] = Mean_biomassF
          paramsetF[175L:201, i] = ProductionF

          ; unknown
          Growth_massU = fltarr(27L, 1)
          Mean_biomassU = fltarr(27L, 1)
          ProductionU = fltarr(27L, 1)
          FOR Agei = 1L, 26L DO BEGIN
            IF (Agei GE MIN(Age_Wmass)) AND (Agei LT MAX(Age_Wmass)) THEN BEGIN
              ;print, 'agei', agei
              IF (Mean_mass[Agei-1L, 0] GT 0.) AND (Mean_mass[Agei, 0] GT 0.) THEN BEGIN
                Growth_massU[Agei, 0] = ALOG(Mean_mass[Agei, 0]/Mean_mass[Agei-1L, 0])
                Mean_biomassU[Agei, 0] = MEAN(Biomass_ageclassU[Agei-1L:Agei, 0])
                ProductionU[Agei, 0] = Growth_massU[Agei, 0] * Mean_biomassU[Agei, 0]
              ENDIF
            ENDIF
          ENDFOR
          PRINT, 'Mean growth in mass - UNKNOWN'
          PRINT, Growth_massU
          PRINT, 'Mean biomass (Bhat) - UNKNOWN'
          PRINT, Mean_biomassU
          PRINT, 'Production - UNKOWN'
          PRINT, ProductionU
          paramsetU[121L:147, i] = Growth_massU
          paramsetU[148L:174, i] = Mean_biomassU
          paramsetU[175L:201, i] = ProductionU

          ; create age-specific biomass plots
          maleBiomass=Biomass_ageclassM/1000.
          femaleBiomass=Biomass_ageclassF/1000.
          unknownBiomass=Biomass_ageclassU/1000.

          !p.font=0
          ;Device, Set_Character_Size=[8,12]
          Device, Get_Decomposed=currentState
          DEVICE, SET_FONT='Courier', /TT_FONT
          DEVICE, DECOMPOSED=0
          cgDisplay, 750, 400, WID=0
          ;!P.Multi = [0,2,1]
          labels = INDGEN(27); ['Exp 1', 'Exp 2', 'Exp 3', 'Exp 4', 'Exp 5']
          cgLoadct, 33, Clip=[10,245]
          cgBarPlot, maleBiomass,  YRange=[0,MAX(maleBiomass+femaleBiomass+unknownBiomass)*1.3], Colors='BLUE', BarNames=labels $
            , xtitle='Age (years)'$
            , ytitle='Biomass (Kg)' $;, xrange=[0, 25]
            , title='Biomass distribution of WI walleye - '+'WBIC: '+STRING(WBIC[INDEX_lengthdata[0]], FORMAT = '(I7)') $
            +'_Year: '+STRING(fix(SurveyYear[INDEX_lengthdata[0]]), FORMAT = '(I4)')+STOCK
          ;XYOutS, ROUND(MEDIAN(INDGEN(27))), ROUND(0.5*(MAX(paramset[13:39, i]))*1.3), Orientation=90.0, /DEVICE
          cgBarPlot, femaleBiomass, Colors='RED', /Overplot, BaseLines=maleBiomass
          cgBarPlot, unknownBiomass, Colors='dark green', /Overplot, BaseLines=maleBiomass+femaleBiomass
          items = ['Male', 'Female', 'Unknown']
          colors = ['BLUE', 'RED', 'dark green']
          AL_Legend, items, Colors=colors, PSym=Replicate(15,3), SymSize=Replicate(1.75,3), $
            Charsize=cgDefCharsize(), Position=[0.75, 0.85], /Normal
          ; file name for WBIC-year-specific age structure
          filename='Walleye biomass'+ STRING(WBIC[INDEX_lengthdata[0]], FORMAT = '(I7)') $
            +'_'+STRING(fix(SurveyYear[INDEX_lengthdata[0]]), FORMAT = '(I4)')+'.png'
          WRITE_PNG, filename, TVRD(/TRUE)
          DEVICE, DECOMPOSED=old_decomposed
          !p.font=1

          paramset[94L:120, i] = Biomass_ageclass

          Growth_mass = fltarr(27L, 1)
          Mean_biomass = fltarr(27L, 1)
          Production = fltarr(27L, 1)
          FOR Agei = 1L, 26L DO BEGIN
            IF (Agei GE MIN(Age_Wmass)) AND (Agei LT MAX(Age_Wmass)) THEN BEGIN
              ;print, 'agei', agei
              IF (Mean_mass[Agei-1L, 0] GT 0.) AND (Mean_mass[Agei, 0] GT 0.) THEN BEGIN
                Growth_mass[Agei, 0] = ALOG(Mean_mass[Agei, 0]/Mean_mass[Agei-1L, 0])
                Mean_biomass[Agei, 0] = MEAN(Biomass_ageclass[Agei-1L:Agei, 0])
                Production[Agei, 0] = Growth_mass[Agei, 0] * Mean_biomass[Agei, 0]
              ENDIF
            ENDIF
          ENDFOR
          PRINT, 'Mean growth in mass'
          PRINT, Growth_mass
          PRINT, 'Mean biomass (Bhat)'
          PRINT, Mean_biomass
          PRINT, 'Production'
          PRINT, Production
          paramset[121L:147, i] = Growth_mass; mean growth w/o sex-specific conversion
          paramset[148L:174, i] = Mean_biomassM + Mean_biomassF + Mean_biomassU
          paramset[175L:201, i] = ProductionM + ProductionF + ProductionU  
          ; *******GAPS IN AGE CLASSS STILL NEED TO be INTERPOLATED!!!!!!!!!!!!!!!!!
          
          ; Total biomass
          PRINT, 'Population estimate (PE)', PE[INDEX_lengthdata[0]]
          PRINT, 'Lake area (km2)', LakeArea[INDEX_lengthdata[0]]/1000000.; lake area (km2)
          ; Total biomass - ALL FISH
          IF (LakeArea[INDEX_lengthdata[0]] GT 0.) THEN Total_biomass[i] = TOTAL(Biomass_ageclass[*, 0]) / LakeArea[INDEX_lengthdata[0]]*1000000./1000.
          ; MALE
          IF (LakeArea[INDEX_lengthdata[0]] GT 0.) THEN Total_biomassM[i] = TOTAL(Biomass_ageclassM[*, 0]) / LakeArea[INDEX_lengthdata[0]]*1000000./1000.
          PRINT, 'Total biomass - MALE (kg/km2)'
          PRINT, Total_biomassM[i]
          ; FEMLAE
          IF (LakeArea[INDEX_lengthdata[0]] GT 0.) THEN Total_biomassF[i] = TOTAL(Biomass_ageclassF[*, 0]) / LakeArea[INDEX_lengthdata[0]]*1000000./1000.
          PRINT, 'Total biomass - FEMALE (kg/km2)'
          PRINT, Total_biomassF[i]
          ; UNKNOWN
          IF (LakeArea[INDEX_lengthdata[0]] GT 0.) THEN Total_biomassU[i] = TOTAL(Biomass_ageclassU[*, 0]) / LakeArea[INDEX_lengthdata[0]]*1000000./1000.
          PRINT, 'Total biomass - UNKWON (kg/km2)'
          PRINT, Total_biomassU[i]        
          
          paramset[202, i] = Total_biomassM[i] +  Total_biomassF[i] + Total_biomassU[i]
          PRINT, 'Total biomass (kg/km2)'
          PRINT, Total_biomass[i], paramset[202, i]

          ; Total production
          ; ALL FISH
          Pos_production = WHERE(Production[*, 0] GT 0., Pos_productioncount); negative age-specific production is converted to 0
          IF (Pos_productioncount GT 0.) AND (LakeArea[INDEX_lengthdata[0]] GT 0.) THEN Total_production[i] = TOTAL(Production[Pos_production, 0]) $
            / LakeArea[INDEX_lengthdata[0]]*1000000./1000.
          ; MALE
          Pos_productionM = WHERE(ProductionM[*, 0] GT 0., Pos_productionMcount); negative age-specific production is converted to 0
          IF (Pos_productionMcount GT 0.) AND (LakeArea[INDEX_lengthdata[0]] GT 0.) THEN Total_productionM[i] = TOTAL(ProductionM[Pos_productionM, 0]) $
            / LakeArea[INDEX_lengthdata[0]]*1000000./1000.
          ; FEMALE
          Pos_productionF = WHERE(ProductionF[*, 0] GT 0., Pos_productionFcount); negative age-specific production is converted to 0
          IF (Pos_productionFcount GT 0.) AND (LakeArea[INDEX_lengthdata[0]] GT 0.) THEN Total_productionF[i] = TOTAL(ProductionF[Pos_productionF, 0]) $
            / LakeArea[INDEX_lengthdata[0]]*1000000./1000.           
           ; UNKNOWN
          Pos_productionU = WHERE(ProductionU[*, 0] GT 0., Pos_productionUcount); negative age-specific production is converted to 0
          IF (Pos_productionMcount GT 0.) AND (LakeArea[INDEX_lengthdata[0]] GT 0.) THEN Total_productionU[i] = TOTAL(ProductionU[Pos_productionU, 0]) $
            / LakeArea[INDEX_lengthdata[0]]*1000000./1000. 
          
          paramset[203, i] = Total_productionM[i] + Total_productionF[i] + Total_productionU[i]
          PRINT, 'Total Production (kg/km2/year)'
          PRINT, Total_production[i], paramset[203, i]
          
          ; PRODUCTION/BIOMASS
          Pos_biomass = WHERE(Total_biomass[i] GT 0., Pos_biomasscount); negative age-specific production is converted to 0
          IF Pos_biomasscount GT 0. THEN P_over_B[i] = Total_production[i] / Total_biomass[i]
          PRINT, 'P/B'
          PRINT, P_over_B[i]
          IF Pos_biomasscount GT 0. THEN P_over_B[i] = paramset[203, i] / paramset[202, i]
          PRINT, 'P/B'
          PRINT, P_over_B[i]          
          paramset[204L, i] = P_over_B[i]

          ; Adult estimates (w/ only >age 3)
          ; Biomass - ALL FISH
          IF (LakeArea[INDEX_lengthdata[0]] GT 0.) THEN Total_biomass_adult[i] = TOTAL(Biomass_ageclass[3L:26L, 0]) / LakeArea[INDEX_lengthdata[0]]*1000000./1000.
          PRINT, 'Total adult biomass (kg/km2)'
          PRINT, Total_biomass_adult[i]
          ; Biomass - MALE
          IF (LakeArea[INDEX_lengthdata[0]] GT 0.) THEN Total_biomass_adultM[i] $
            = TOTAL(Biomass_ageclassM[3L:26L, 0]) / LakeArea[INDEX_lengthdata[0]]*1000000./1000.
          PRINT, 'Total adult biomass - MALE (kg/km2)'
          PRINT, Total_biomass_adultM[i]
          ; Biomass - FEMALE
          IF (LakeArea[INDEX_lengthdata[0]] GT 0.) THEN Total_biomass_adultF[i] $
            = TOTAL(Biomass_ageclassF[3L:26L, 0]) / LakeArea[INDEX_lengthdata[0]]*1000000./1000.
          PRINT, 'Total adult biomass - FEMALE (kg/km2)'
          PRINT, Total_biomass_adultF[i]          
          ; Biomass - UNKWON
          IF (LakeArea[INDEX_lengthdata[0]] GT 0.) THEN Total_biomass_adultU[i] $
            = TOTAL(Biomass_ageclassU[3L:26L, 0]) / LakeArea[INDEX_lengthdata[0]]*1000000./1000.
          PRINT, 'Total adult biomass - UNKNOWN (kg/km2)'
          PRINT, Total_biomass_adultU[i]    

          paramset[205, i] = Total_biomass_adultM[i] +  Total_biomass_adultF[i] + Total_biomass_adultU[i]
          PRINT, 'Total biomass (kg/km2)'
          PRINT, Total_biomass_adult[i], paramset[205, i]

          ; Adult production estimates - ALL FISH
          Growth_mass_adult = fltarr(27L, 1)
          Mean_biomass_adult = fltarr(27L, 1)
          Production_adult = fltarr(27L, 1)
          FOR Agei = 0L, 26L DO BEGIN
            IF (Agei GE 3L) AND (Agei LT MAX(Age_Wmass)) THEN BEGIN
              IF (Mean_mass[Agei-1L, 0] GT 0.) AND (Mean_mass[Agei, 0] GT 0.) THEN BEGIN
                Growth_mass_adult[Agei, 0] = ALOG(Mean_mass[Agei, 0]/Mean_mass[Agei-1L, 0])
                Mean_biomass_adult[Agei, 0] = MEAN(Biomass_ageclass[Agei-1L:Agei, 0])
                Production_adult[Agei, 0] = Growth_mass_adult[Agei, 0] * Mean_biomass_adult[Agei, 0]
              ENDIF
            ENDIF
          ENDFOR
          ; Adult production estimates - MALE
          Growth_mass_adultM = fltarr(27L, 1)
          Mean_biomass_adultM = fltarr(27L, 1)
          Production_adultM = fltarr(27L, 1)
          FOR Agei = 0L, 26L DO BEGIN
            IF (Agei GE 3L) AND (Agei LT MAX(Age_WmassM)) THEN BEGIN
              IF (Mean_massM[Agei-1L, 0] GT 0.) AND (Mean_massM[Agei, 0] GT 0.) THEN BEGIN
                Growth_mass_adultM[Agei, 0] = ALOG(Mean_massM[Agei, 0]/Mean_massM[Agei-1L, 0])
                Mean_biomass_adultM[Agei, 0] = MEAN(Biomass_ageclassM[Agei-1L:Agei, 0])
                Production_adultM[Agei, 0] = Growth_mass_adultM[Agei, 0] * Mean_biomass_adultM[Agei, 0]
              ENDIF
            ENDIF
          ENDFOR
          ; Adult production estimates - FEMALE
          Growth_mass_adultF = fltarr(27L, 1)
          Mean_biomass_adultF = fltarr(27L, 1)
          Production_adultF = fltarr(27L, 1)
          FOR Agei = 0L, 26L DO BEGIN
            IF (Agei GE 3L) AND (Agei LT MAX(Age_WmassF)) THEN BEGIN
              IF (Mean_massF[Agei-1L, 0] GT 0.) AND (Mean_massF[Agei, 0] GT 0.) THEN BEGIN
                Growth_mass_adultF[Agei, 0] = ALOG(Mean_massF[Agei, 0]/Mean_massF[Agei-1L, 0])
                Mean_biomass_adultF[Agei, 0] = MEAN(Biomass_ageclassF[Agei-1L:Agei, 0])
                Production_adultF[Agei, 0] = Growth_mass_adultF[Agei, 0] * Mean_biomass_adultF[Agei, 0]
              ENDIF
            ENDIF
          ENDFOR
          ; Adult production estimates - UNKNOWN
            Growth_mass_adultU = fltarr(27L, 1)
            Mean_biomass_adultU = fltarr(27L, 1)
            Production_adultU = fltarr(27L, 1)
            FOR Agei = 0L, 26L DO BEGIN
              IF (Agei GE 3L) AND (Agei LT MAX(Age_Wmass)) THEN BEGIN
                IF (Mean_massU[Agei-1L, 0] GT 0.) AND (Mean_massU[Agei, 0] GT 0.) THEN BEGIN
                  Growth_mass_adultU[Agei, 0] = ALOG(Mean_massU[Agei, 0]/Mean_massU[Agei-1L, 0])
                  Mean_biomass_adultU[Agei, 0] = MEAN(Biomass_ageclassU[Agei-1L:Agei, 0])
                  Production_adultU[Agei, 0] = Growth_mass_adultU[Agei, 0] * Mean_biomass_adultU[Agei, 0]
                ENDIF
              ENDIF
            ENDFOR

          ; ALL FISH
          Pos_production_adult = WHERE(Production_adult[*, 0] GT 0., Pos_production_adultcount); ***negative age-specific production is converted to 0
          PRINT, 'Array index for positive adult production', Pos_production_adult
          IF (Pos_production_adultcount GT 0.) AND (LakeArea[INDEX_lengthdata[0]] GT 0.)  THEN Total_production_adult[i] = TOTAL(Production_adult[Pos_production_adult, 0]) $
            / LakeArea[INDEX_lengthdata[0]]*1000000./1000.
          ; MALE
          Pos_production_adultM = WHERE(Production_adultM[*, 0] GT 0., Pos_production_adultMcount); ***negative age-specific production is converted to 0
          PRINT, 'Array index for positive adult production - MALE', Pos_production_adultM
          IF (Pos_production_adultMcount GT 0.) AND (LakeArea[INDEX_lengthdata[0]] GT 0.)  THEN Total_production_adultM[i] $
              = TOTAL(Production_adultM[Pos_production_adultM, 0]) / LakeArea[INDEX_lengthdata[0]]*1000000./1000.           
          ; FEMALE
          Pos_production_adultF = WHERE(Production_adultF[*, 0] GT 0., Pos_production_adultFcount); ***negative age-specific production is converted to 0
          PRINT, 'Array index for positive adult production - FEMALE', Pos_production_adultF
          IF (Pos_production_adultFcount GT 0.) AND (LakeArea[INDEX_lengthdata[0]] GT 0.)  THEN Total_production_adultF[i] $
              = TOTAL(Production_adultF[Pos_production_adultF, 0]) / LakeArea[INDEX_lengthdata[0]]*1000000./1000.           
          ; UNKNOWN
          Pos_production_adultU = WHERE(Production_adultU[*, 0] GT 0., Pos_production_adultUcount); ***negative age-specific production is converted to 0
          PRINT, 'Array index for positive adult production - UNKNOWN', Pos_production_adultU
          IF (Pos_production_adultUcount GT 0.) AND (LakeArea[INDEX_lengthdata[0]] GT 0.)  THEN Total_production_adultU[i] $
              = TOTAL(Production_adultU[Pos_production_adultU, 0]) / LakeArea[INDEX_lengthdata[0]]*1000000./1000.
            
          paramset[206L, i] = Total_production_adultM[i] + Total_production_adultF[i] + Total_production_adultU[i]
          PRINT, 'Total adult Production (kg/km2/year)'
          PRINT, Total_production_adult[i], paramset[206L, i]
          IF LakeArea[INDEX_lengthdata[0]] GT 0 THEN paramset[217, i] = Total_production[i] + Biomass_ageclass[3,0]/LakeArea[INDEX_lengthdata[0]]*1000000./1000.
          PRINT, 'Surplus adult production (kg/km2/year)'
          PRINT, paramset[217L, i]

          ; PRODUCTION / BIOMASS
          ; ALL FISH
          Pos_biomass_adult = WHERE(Total_biomass_adult[i] GT 0., Pos_biomass_adultcount); negative age-specific production is converted to 0
          IF Pos_biomass_adultcount GT 0. THEN P_over_B_adult[i] = Total_production_adult[i] / Total_biomass_adult[i]
          PRINT, 'Adult P/B'
          PRINT, P_over_B_adult[i]
          IF Pos_biomass_adultcount GT 0. THEN P_over_B_adult[i] = paramset[206, i] / paramset[205, i]
          PRINT, 'Adult P/B'
          PRINT, P_over_B_adult[i]
          
          paramset[207L, i] = P_over_B_adult[i]
          paramset[208L, i] = PE[INDEX_lengthdata[0]]; population estimate
          paramset[209L, i] = LakeArea[INDEX_lengthdata[0]]/1000000.; lake area (km2)



          ;#########################################################
          ;#Calculate harvested fish age structure for production
          ;#########################################################
          ; array index for angling data
          INDEX_lengthdataAngl = WHERE((WBIC_year_angl[*] EQ WBIC_year[INDEX_lengthdata[0]]), INDEX_lengthdataAnglcount)
          INDEX_lengthdataAngl3 = WHERE((WBIC_key[*] EQ WBIC_angl[INDEX_lengthdataAngl[0]]), INDEX_lengthdataAngl2count)

          IF (INDEX_lengthdataAngl3count LE 0) OR (AgeLengthKeyCheck_angl2 GE AgeLengthKeyLevel) THEN BEGIN
        
            IF INDEX_lengthdataAnglcount GT 0 THEN BEGIN; if angling data exist...
              PRINT, 'WBIC_angl', WBIC_year_angl[INDEX_lengthdataAngl[0]]
              PRINT, 'Harvest data availabile'
              ;N_Lake_year_angl = N_Lake_year_angl + 1L
              ;PRINT, 'N of lake-year with harvest data', N_Lake_year_angl
              N_Lake_WOkeys_angl = N_Lake_WOkeys+angl + 1L
              PRINT, 'N of lakes without key', N_Lake_WOkeys_angl
              
              ;IF INDEX_lengthdataAnglcount GT 0 then begin
              Length_prod_angl = Length_angl[INDEX_lengthdataAngl]; WBIC_year data
              FishAgeAngl = AgeArrayAngl[INDEX_lengthdataAngl]; assigned age
              FishLengthAngl = LengthArrayAngl[INDEX_lengthdataAngl]; length check
              ;PRINT, 'Length_prod_angl', length[INDEX_lengthdata]

              paramset_angl[0, i] = uniqWBIC_Year[i]; WBIC_year (abbrev)
              paramset_angl[1, i] = WBIC_angl[INDEX_lengthdataAngl[0]]; WBIC
              paramset_angl[2, i] = SurveyYear_angl[INDEX_lengthdataAngl[0]]; year
              paramset_angl[3, i] = N_ELements(Length_prod_angl); N of fish
              paramset_angl[7, i] = Max(length_angl[INDEX_lengthdataAngl])
              paramset_angl[8, i] = Min(length_angl[INDEX_lengthdataAngl])

              paramset_angl[218, i] = MEAN(length_angl[INDEX_lengthdataAngl]); mean length for all fish
              paramset_angl[219, i] = STDDEV(length_angl[INDEX_lengthdataAngl]); SD length for all fish
              paramset_angl[222, i] = legal_size[INDEX_lengthdataAngl[0]]; legal size
              
              print, 'N of fish', paramset_angl[3, i];, malecount+femalecount+unknowncount
              print, 'WBIC', paramset_angl[1, i]
              print, 'Year', paramset_angl[2, i]
              print, 'Max length (mm)', Max(length_angl[INDEX_lengthdataAngl])
              print, 'Min length (mm)', Min(length_angl[INDEX_lengthdataAngl])

              ; Length group distributions - all fish
              SizeLT100_angl = WHERE(Length_prod_angl LT 100., SizeLT100_anglcount)
              Size100to120_angl = WHERE((Length_prod_angl GE 100.) AND (Length_prod_angl LT 120.), Size100to120_anglcount)
              Size120to140_angl = WHERE((Length_prod_angl GE 120.) AND (Length_prod_angl LT 140.), Size120to140_anglcount)
              Size140to160_angl = WHERE((Length_prod_angl GE 140.) AND (Length_prod_angl LT 160.), Size140to160_anglcount)
              Size160to180_angl = WHERE((Length_prod_angl GE 160.) AND (Length_prod_angl LT 180.), Size160to180_anglcount)
              Size180to200_angl = WHERE((Length_prod_angl GE 180.) AND (Length_prod_angl LT 200.), Size180to200_anglcount)
              Size200to220_angl = WHERE((Length_prod_angl GE 200.) AND (Length_prod_angl LT 220.), Size200to220_anglcount)
              Size220to240_angl = WHERE((Length_prod_angl GE 220.) AND (Length_prod_angl LT 240.), Size220to240_anglcount)
              Size240to260_angl = WHERE((Length_prod_angl GE 240.) AND (Length_prod_angl LT 260.), Size240to260_anglcount)
              Size260to280_angl = WHERE((Length_prod_angl GE 260.) AND (Length_prod_angl LT 280.), Size260to280_anglcount)
              Size280to300_angl = WHERE((Length_prod_angl GE 280.) AND (Length_prod_angl LT 300.), Size280to300_anglcount)
              Size300to320_angl = WHERE((Length_prod_angl GE 300.) AND (Length_prod_angl LT 320.), Size300to320_anglcount)
              Size320to340_angl = WHERE((Length_prod_angl GE 320.) AND (Length_prod_angl LT 340.), Size320to340_anglcount)
              Size340to360_angl = WHERE((Length_prod_angl GE 340.) AND (Length_prod_angl LT 360.), Size340to360_anglcount)
              Size360to380_angl = WHERE((Length_prod_angl GE 360.) AND (Length_prod_angl LT 380.), Size360to380_anglcount)
              Size380to400_angl = WHERE((Length_prod_angl GE 380.) AND (Length_prod_angl LT 400.), Size380to400_anglcount)
              Size400to420_angl = WHERE((Length_prod_angl GE 400.) AND (Length_prod_angl LT 420.), Size400to420_anglcount)
              Size420to440_angl = WHERE((Length_prod_angl GE 420.) AND (Length_prod_angl LT 440.), Size420to440_anglcount)
              Size440to460_angl = WHERE((Length_prod_angl GE 440.) AND (Length_prod_angl LT 460.), Size440to460_anglcount)
              Size460to480_angl = WHERE((Length_prod_angl GE 460.) AND (Length_prod_angl LT 480.), Size460to480_anglcount)
              Size480to500_angl = WHERE((Length_prod_angl GE 480.) AND (Length_prod_angl LT 500.), Size480to500_anglcount)
              Size500to520_angl = WHERE((Length_prod_angl GE 500.) AND (Length_prod_angl LT 520.), Size500to520_anglcount)
              Size520to540_angl = WHERE((Length_prod_angl GE 520.) AND (Length_prod_angl LT 540.), Size520to540_anglcount)
              Size540to560_angl = WHERE((Length_prod_angl GE 540.) AND (Length_prod_angl LT 560.), Size540to560_anglcount)
              Size560to580_angl = WHERE((Length_prod_angl GE 560.) AND (Length_prod_angl LT 580.), Size560to580_anglcount)
              Size580to600_angl = WHERE((Length_prod_angl GE 580.) AND (Length_prod_angl LT 600.), Size580to600_anglcount)
              Size600to620_angl = WHERE((Length_prod_angl GE 600.) AND (Length_prod_angl LT 620.), Size600to620_anglcount)
              Size620to640_angl = WHERE((Length_prod_angl GE 620.) AND (Length_prod_angl LT 640.), Size620to640_anglcount)
              Size640to660_angl = WHERE((Length_prod_angl GE 640.) AND (Length_prod_angl LT 660.), Size640to660_anglcount)
              Size660to680_angl = WHERE((Length_prod_angl GE 660.) AND (Length_prod_angl LT 680.), Size660to680_anglcount)
              Size680to700_angl = WHERE((Length_prod_angl GE 680.) AND (Length_prod_angl LT 700.), Size680to700_anglcount)
              Size700to720_angl = WHERE((Length_prod_angl GE 700.) AND (Length_prod_angl LT 720.), Size700to720_anglcount)
              Size720to740_angl = WHERE((Length_prod_angl GE 720.) AND (Length_prod_angl LT 740.), Size720to740_anglcount)
              Size740to760_angl = WHERE((Length_prod_angl GE 740.) AND (Length_prod_angl LT 760.), Size740to760_anglcount)
              Size760to780_angl = WHERE((Length_prod_angl GE 760.) AND (Length_prod_angl LT 780.), Size760to780_anglcount)
              Size780to800_angl = WHERE((Length_prod_angl GE 780.) AND (Length_prod_angl LT 800.), Size780to800_anglcount)
              SizeGE800_angl = WHERE((Length_prod_angl GE 800.), SizeGE800_anglcount)
              LengthDist_angl[0, i] = SizeLT100_anglcount
              LengthDist_angl[1, i] = Size100to120_anglcount
              LengthDist_angl[2, i] = Size120to140_anglcount
              LengthDist_angl[3, i] = Size140to160_anglcount
              LengthDist_angl[4, i] = Size160to180_anglcount
              LengthDist_angl[5, i] = Size180to200_anglcount
              LengthDist_angl[6, i] = Size200to220_anglcount
              LengthDist_angl[7, i] = Size220to240_anglcount
              LengthDist_angl[8, i] = Size240to260_anglcount
              LengthDist_angl[9, i] = Size260to280_anglcount
              LengthDist_angl[10, i] = Size280to300_anglcount
              LengthDist_angl[11, i] = Size300to320_anglcount
              LengthDist_angl[12, i] = Size320to340_anglcount
              LengthDist_angl[13, i] = Size340to360_anglcount
              LengthDist_angl[14, i] = Size360to380_anglcount
              LengthDist_angl[15, i] = Size380to400_anglcount
              LengthDist_angl[16, i] = Size400to420_anglcount
              LengthDist_angl[17, i] = Size420to440_anglcount
              LengthDist_angl[18, i] = Size440to460_anglcount
              LengthDist_angl[19, i] = Size460to480_anglcount
              LengthDist_angl[20, i] = Size480to500_anglcount
              LengthDist_angl[21, i] = Size500to520_anglcount
              LengthDist_angl[22, i] = Size520to540_anglcount
              LengthDist_angl[23, i] = Size540to560_anglcount
              LengthDist_angl[24, i] = Size560to580_anglcount
              LengthDist_angl[25, i] = Size580to600_anglcount
              LengthDist_angl[26, i] = Size600to620_anglcount
              LengthDist_angl[27, i] = Size620to640_anglcount
              LengthDist_angl[28, i] = Size640to660_anglcount
              LengthDist_angl[29, i] = Size660to680_anglcount
              LengthDist_angl[30, i] = Size680to700_anglcount
              LengthDist_angl[31, i] = Size700to720_anglcount
              LengthDist_angl[32, i] = Size720to740_anglcount
              LengthDist_angl[33, i] = Size740to760_anglcount
              LengthDist_angl[34, i] = Size760to780_anglcount
              LengthDist_angl[35, i] = Size780to800_anglcount
              LengthDist_angl[36, i] = SizeGE800_anglcount
              PRINT, 'length distribution - angling (bin size = 20mm)', LengthDist_angl[0:36, i]
              LengthDist_angl[37, i] = paramset_angl[1, i]; WBIC
              LengthDist_angl[38, i] = paramset_angl[2, i]; year
              LengthDist_angl[39, i] = paramset_angl[3, i]; sample size
              LengthDist_angl[40, i] = adultPE_angl[INDEX_lengthdataAngl[0]]; adult PE
              LengthDist_angl[41, i] = HarvRate_angl[INDEX_lengthdataAngl[0]]; harvest rate
              
              ; identify empty length bins in spring surveys
              IF (SizeLT100_anglcount GT 0) AND (LengthDist[0, i] LE 0) THEN LengthDist_angl_PLUS[0, i] = SizeLT100_anglcount
              IF (Size100to120_anglcount GT 0) AND (LengthDist[1, i] LE 0) THEN LengthDist_angl_PLUS[1, i] = Size100to120_anglcount
              IF (Size120to140_anglcount GT 0) AND (LengthDist[2, i] LE 0) THEN LengthDist_angl_PLUS[2, i] = Size120to140_anglcount
              IF (Size140to160_anglcount GT 0) AND (LengthDist[3, i] LE 0) THEN LengthDist_angl_PLUS[3, i] = Size140to160_anglcount
              IF (Size160to180_anglcount GT 0) AND (LengthDist[4, i] LE 0) THEN LengthDist_angl_PLUS[4, i] = Size160to180_anglcount
              IF (Size180to200_anglcount GT 0) AND (LengthDist[5, i] LE 0) THEN LengthDist_angl_PLUS[5, i] = Size180to200_anglcount
              IF (Size200to220_anglcount GT 0) AND (LengthDist[6, i] LE 0) THEN LengthDist_angl_PLUS[6, i] = Size200to220_anglcount
              IF (Size220to240_anglcount GT 0) AND (LengthDist[7, i] LE 0) THEN LengthDist_angl_PLUS[7, i] = Size220to240_anglcount
              IF (Size240to260_anglcount GT 0) AND (LengthDist[8, i] LE 0) THEN LengthDist_angl_PLUS[8, i] = Size240to260_anglcount
              IF (Size260to280_anglcount GT 0) AND (LengthDist[9, i] LE 0) THEN LengthDist_angl_PLUS[9, i] = Size260to280_anglcount
              IF (Size280to300_anglcount GT 0) AND (LengthDist[10, i] LE 0) THEN LengthDist_angl_PLUS[10, i] = Size280to300_anglcount
              IF (Size300to320_anglcount GT 0) AND (LengthDist[11, i] LE 0) THEN LengthDist_angl_PLUS[11, i] = Size300to320_anglcount
              IF (Size320to340_anglcount GT 0) AND (LengthDist[12, i] LE 0) THEN LengthDist_angl_PLUS[12, i] = Size320to340_anglcount
              IF (Size340to360_anglcount GT 0) AND (LengthDist[13, i] LE 0) THEN LengthDist_angl_PLUS[13, i] = Size340to360_anglcount
              IF (Size360to380_anglcount GT 0) AND (LengthDist[14, i] LE 0) THEN LengthDist_angl_PLUS[14, i] = Size360to380_anglcount
              IF (Size380to400_anglcount GT 0) AND (LengthDist[15, i] LE 0) THEN LengthDist_angl_PLUS[15, i] = Size380to400_anglcount
              IF (Size400to420_anglcount GT 0) AND (LengthDist[16, i] LE 0) THEN LengthDist_angl_PLUS[16, i] = Size400to420_anglcount
              IF (Size420to440_anglcount GT 0) AND (LengthDist[17, i] LE 0) THEN LengthDist_angl_PLUS[17, i] = Size420to440_anglcount
              IF (Size440to460_anglcount GT 0) AND (LengthDist[18, i] LE 0) THEN LengthDist_angl_PLUS[18, i] = Size440to460_anglcount
              IF (Size460to480_anglcount GT 0) AND (LengthDist[19, i] LE 0) THEN LengthDist_angl_PLUS[19, i] = Size460to480_anglcount
              IF (Size480to500_anglcount GT 0) AND (LengthDist[20, i] LE 0) THEN LengthDist_angl_PLUS[20, i] = Size480to500_anglcount
              IF (Size500to520_anglcount GT 0) AND (LengthDist[21, i] LE 0) THEN LengthDist_angl_PLUS[21, i] = Size500to520_anglcount
              IF (Size520to540_anglcount GT 0) AND (LengthDist[22, i] LE 0) THEN LengthDist_angl_PLUS[22, i] = Size520to540_anglcount
              IF (Size540to560_anglcount GT 0) AND (LengthDist[23, i] LE 0) THEN LengthDist_angl_PLUS[23, i] = Size540to560_anglcount
              IF (Size560to580_anglcount GT 0) AND (LengthDist[24, i] LE 0) THEN LengthDist_angl_PLUS[24, i] = Size560to580_anglcount
              IF (Size580to600_anglcount GT 0) AND (LengthDist[25, i] LE 0) THEN LengthDist_angl_PLUS[25, i] = Size580to600_anglcount
              IF (Size600to620_anglcount GT 0) AND (LengthDist[26, i] LE 0) THEN LengthDist_angl_PLUS[26, i] = Size600to620_anglcount
              IF (Size620to640_anglcount GT 0) AND (LengthDist[27, i] LE 0) THEN LengthDist_angl_PLUS[27, i] = Size620to640_anglcount
              IF (Size640to660_anglcount GT 0) AND (LengthDist[28, i] LE 0) THEN LengthDist_angl_PLUS[28, i] = Size640to660_anglcount
              IF (Size660to680_anglcount GT 0) AND (LengthDist[29, i] LE 0) THEN LengthDist_angl_PLUS[29, i] = Size660to680_anglcount
              IF (Size680to700_anglcount GT 0) AND (LengthDist[30, i] LE 0) THEN LengthDist_angl_PLUS[30, i] = Size680to700_anglcount
              IF (Size700to720_anglcount GT 0) AND (LengthDist[31, i] LE 0) THEN LengthDist_angl_PLUS[31, i] = Size700to720_anglcount
              IF (Size720to740_anglcount GT 0) AND (LengthDist[32, i] LE 0) THEN LengthDist_angl_PLUS[32, i] = Size720to740_anglcount
              IF (Size740to760_anglcount GT 0) AND (LengthDist[33, i] LE 0) THEN LengthDist_angl_PLUS[33, i] = Size740to760_anglcount
              IF (Size760to780_anglcount GT 0) AND (LengthDist[34, i] LE 0) THEN LengthDist_angl_PLUS[34, i] = Size760to780_anglcount
              IF (Size780to800_anglcount GT 0) AND (LengthDist[35, i] LE 0) THEN LengthDist_angl_PLUS[35, i] = Size780to800_anglcount
              IF (SizeGE800_anglcount GT 0) AND (LengthDist[36, i] LE 0) THEN LengthDist_angl_PLUS[36, i] = SizeGE800_anglcount
              IF TOTAL(LengthDist_angl_PLUS[*, i]) GT 0 THEN PRINT, 'length bins w/o spring survey data (bin size = 20mm)', LengthDist_angl_PLUS[0:36, i]
              Prop_LengthDist_angl_PLUS[i] = TOTAL(LengthDist_angl_PLUS[*, i]) / TOTAL(LengthDist_angl[*, i])

              ; If fish some elngth bins were not sampled in spring surveys, they were not included in age structure analysis
              IF LengthDist_angl_PLUS[0, i] GT 0 THEN SizeLT100_anglcount = 0
              IF LengthDist_angl_PLUS[1, i] GT 0 THEN Size100to120_anglcount = 0
              IF LengthDist_angl_PLUS[2, i] GT 0 THEN Size120to140_anglcount = 0
              IF LengthDist_angl_PLUS[3, i] GT 0 THEN Size140to160_anglcount = 0
              IF LengthDist_angl_PLUS[4, i] GT 0 THEN Size160to180_anglcount = 0
              IF LengthDist_angl_PLUS[5, i] GT 0 THEN Size180to200_anglcount = 0
              IF LengthDist_angl_PLUS[6, i] GT 0 THEN Size200to220_anglcount = 0
              IF LengthDist_angl_PLUS[7, i] GT 0 THEN Size220to240_anglcount = 0
              IF LengthDist_angl_PLUS[8, i] GT 0 THEN Size240to260_anglcount = 0
              IF LengthDist_angl_PLUS[9, i] GT 0 THEN Size260to280_anglcount = 0
              IF LengthDist_angl_PLUS[10, i] GT 0 THEN Size280to300_anglcount = 0
              IF LengthDist_angl_PLUS[11, i] GT 0 THEN Size300to320_anglcount = 0
              IF LengthDist_angl_PLUS[12, i] GT 0 THEN Size320to340_anglcount = 0
              IF LengthDist_angl_PLUS[13, i] GT 0 THEN Size340to360_anglcount = 0
              IF LengthDist_angl_PLUS[14, i] GT 0 THEN Size360to380_anglcount = 0
              IF LengthDist_angl_PLUS[15, i] GT 0 THEN Size380to400_anglcount = 0
              IF LengthDist_angl_PLUS[16, i] GT 0 THEN Size400to420_anglcount = 0
              IF LengthDist_angl_PLUS[17, i] GT 0 THEN Size420to440_anglcount = 0
              IF LengthDist_angl_PLUS[18, i] GT 0 THEN Size440to460_anglcount = 0
              IF LengthDist_angl_PLUS[19, i] GT 0 THEN Size460to480_anglcount = 0
              IF LengthDist_angl_PLUS[20, i] GT 0 THEN Size480to500_anglcount = 0
              IF LengthDist_angl_PLUS[21, i] GT 0 THEN Size500to520_anglcount = 0
              IF LengthDist_angl_PLUS[22, i] GT 0 THEN Size520to540_anglcount = 0
              IF LengthDist_angl_PLUS[23, i] GT 0 THEN Size540to560_anglcount = 0
              IF LengthDist_angl_PLUS[24, i] GT 0 THEN Size560to580_anglcount = 0
              IF LengthDist_angl_PLUS[25, i] GT 0 THEN Size580to600_anglcount = 0
              IF LengthDist_angl_PLUS[26, i] GT 0 THEN Size600to620_anglcount = 0
              IF LengthDist_angl_PLUS[27, i] GT 0 THEN Size620to640_anglcount = 0
              IF LengthDist_angl_PLUS[28, i] GT 0 THEN Size640to660_anglcount = 0
              IF LengthDist_angl_PLUS[29, i] GT 0 THEN Size660to680_anglcount = 0
              IF LengthDist_angl_PLUS[30, i] GT 0 THEN Size680to700_anglcount = 0
              IF LengthDist_angl_PLUS[31, i] GT 0 THEN Size700to720_anglcount = 0
              IF LengthDist_angl_PLUS[32, i] GT 0 THEN Size720to740_anglcount = 0
              IF LengthDist_angl_PLUS[33, i] GT 0 THEN Size740to760_anglcount = 0
              IF LengthDist_angl_PLUS[34, i] GT 0 THEN Size760to780_anglcount = 0
              IF LengthDist_angl_PLUS[35, i] GT 0 THEN Size780to800_anglcount = 0
              IF LengthDist_angl_PLUS[36, i] GT 0 THEN SizeGE800_anglcount = 0
              
              INDEX_lengthdataAngl4 = WHERE((WBIC_key[*] NE WBIC_angl[INDEX_lengthdataAngl[0]]), INDEX_lengthdataAngl4count)

              IF (INDEX_lengthdataAngl4count GT 0)  THEN BEGIN

                ; 1.Assign age semi-randomly to lengths - all fish
                IF SizeLT100_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 0
                  LengthBinIndex2 = SizeLT100_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl3, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size100to120_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 1
                  LengthBinIndex2 = Size100to120_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl3, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size120to140_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 2
                  LengthBinIndex2 = Size120to140_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl3, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size140to160_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 3
                  LengthBinIndex2 = Size140to160_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl3, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size160to180_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 4
                  LengthBinIndex2 = Size160to180_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl3, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size180to200_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 5
                  LengthBinIndex2 = Size180to200_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl3, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size200to220_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 6
                  LengthBinIndex2 = Size200to220_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl3, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size220to240_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 7
                  LengthBinIndex2 = Size220to240_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl3, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size240to260_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 8
                  LengthBinIndex2 = Size240to260_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl3, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size260to280_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 9
                  LengthBinIndex2 = Size260to280_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl3, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size280to300_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 10
                  LengthBinIndex2 = Size280to300_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl3, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size300to320_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 11
                  LengthBinIndex2 = Size300to320_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl3, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size320to340_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 12
                  LengthBinIndex2 = Size320to340_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl3, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size340to360_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 13
                  LengthBinIndex2 = Size340to360_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl3, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size360to380_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 14
                  LengthBinIndex2 = Size360to380_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl3, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size380to400_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 15
                  LengthBinIndex2 = Size380to400_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl3, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size400to420_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 16
                  LengthBinIndex2 = Size400to420_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl3, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size420to440_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 17
                  LengthBinIndex2 = Size420to440_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl3, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size440to460_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 18
                  LengthBinIndex2 = Size440to460_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl3, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size460to480_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 19
                  LengthBinIndex2 = Size460to480_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl3, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size480to500_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 20
                  LengthBinIndex2 = Size480to500_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl3, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size500to520_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 21
                  LengthBinIndex2 = Size500to520_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl3, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size520to540_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 22
                  LengthBinIndex2 = Size520to540_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl3, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size540to560_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 23
                  LengthBinIndex2 = Size540to560_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl3, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size560to580_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 24
                  LengthBinIndex2 = Size560to580_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl3, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size580to600_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 25
                  LengthBinIndex2 = Size580to600_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl3, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size600to620_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 26
                  LengthBinIndex2 = Size600to620_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl3, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size620to640_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 27
                  LengthBinIndex2 = Size620to640_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl3, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size640to660_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 28
                  LengthBinIndex2 = Size640to660_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl3, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size660to680_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 29
                  LengthBinIndex2 = Size660to680_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl3, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size680to700_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 30
                  LengthBinIndex2 = Size680to700_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl3, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size700to720_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 31
                  LengthBinIndex2 = Size700to720_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl3, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size720to740_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 32
                  LengthBinIndex2 = Size720to740_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl3, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size740to760_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 33
                  LengthBinIndex2 = Size740to760_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl3, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size760to780_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 34
                  LengthBinIndex2 = Size760to780_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl3, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Size780to800_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 35
                  LengthBinIndex2 = Size780to800_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl3, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF
                IF Sizege800_anglcount GT 0 THEN BEGIN
                  LengthBinIndex1 = 36
                  LengthBinIndex2 = SizeGE800_angl
                  FishProb = AgeLengthKey(prop_age0, prop_age1, prop_age2, prop_age3, prop_age4, prop_age5 $
                    , prop_age6, prop_age7, prop_age8, prop_age9, prop_age10, prop_age11, prop_age12 $
                    , prop_age13, prop_age14, prop_age15, prop_age16, prop_age17, prop_age18, prop_age19 $
                    , prop_age20, prop_age21, prop_age22, prop_age23, prop_age24, prop_age25 $
                    , prop_age26, INDEX_lengthdataAngl3, LengthBinIndex1)
                  ;PRINT, 'FishProb', FishProb
                  AgeAssignAngl = WalleyeAgeAssign(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  WAE_length_mean_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[0, *]
                  WAE_length_bin_angl[10:36, i*NumLengthBin+adj+LengthBinIndex1] = AgeAssignAngl[1, *]
                  AgeAssignIndAngl = WalleyeAgeAssignInd(Length_prod_angl[LengthBinIndex2], LengthBinIndex2 $
                    , FishProb, FishAgeAngl[LengthBinIndex2], i+NumLengthBin+adj)
                  FishAgeAngl[LengthBinIndex2] = AgeAssignIndAngl[0,*]
                  FishLengthAngl[LengthBinIndex2] = AgeAssignIndAngl[1,*]
                ENDIF

                PRINT, "Age of fish harvested by anglers (FishAgeAngl)", FishAgeAngl
                PRINT, "Length of fish harvested by anglers (FishLengthAngl)", FishLengthAngl
                
                ; mean age (all fish in catch)
                AgeAnglAll = WHERE(FishAgeAngl GE 0, AgeAnglAllCOUNT)
                IF AgeAnglAllCOUNT GT 0 THEN BEGIN
                  paramset_angl[220, i] = MEAN(FishAgeAngl[AgeAnglAll]); mean age for all fish
                  paramset_angl[221, i] = STDDEV(FishAgeAngl[AgeAnglAll]); SD age for all fish
                ENDIF

                ; Age structure of harvested fish (angling)
                Total_N_ageclass_angl = FLTARR(27L, 2L)
                Total_N_ageclass_angl[0, 0] = TOTAL(WAE_length_bin_angl[10, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 0
                Total_N_ageclass_angl[1, 0] = TOTAL(WAE_length_bin_angl[11, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 1
                Total_N_ageclass_angl[2, 0] = TOTAL(WAE_length_bin_angl[12, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 2
                Total_N_ageclass_angl[3, 0] = TOTAL(WAE_length_bin_angl[13, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 3
                Total_N_ageclass_angl[4, 0] = TOTAL(WAE_length_bin_angl[14, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 4
                Total_N_ageclass_angl[5, 0] = TOTAL(WAE_length_bin_angl[15, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 5
                Total_N_ageclass_angl[6, 0] = TOTAL(WAE_length_bin_angl[16, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 6
                Total_N_ageclass_angl[7, 0] = TOTAL(WAE_length_bin_angl[17, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 7
                Total_N_ageclass_angl[8, 0] = TOTAL(WAE_length_bin_angl[18, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 8
                Total_N_ageclass_angl[9, 0] = TOTAL(WAE_length_bin_angl[19, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 9
                Total_N_ageclass_angl[10, 0] = TOTAL(WAE_length_bin_angl[20, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 10
                Total_N_ageclass_angl[11, 0] = TOTAL(WAE_length_bin_angl[21, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 11
                Total_N_ageclass_angl[12, 0] = TOTAL(WAE_length_bin_angl[22, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 12
                Total_N_ageclass_angl[13, 0] = TOTAL(WAE_length_bin_angl[23, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 13
                Total_N_ageclass_angl[14, 0] = TOTAL(WAE_length_bin_angl[24, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 14
                Total_N_ageclass_angl[15, 0] = TOTAL(WAE_length_bin_angl[25, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 15
                Total_N_ageclass_angl[16, 0] = TOTAL(WAE_length_bin_angl[26, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 16
                Total_N_ageclass_angl[17, 0] = TOTAL(WAE_length_bin_angl[27, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 17
                Total_N_ageclass_angl[18, 0] = TOTAL(WAE_length_bin_angl[28, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 18
                Total_N_ageclass_angl[19, 0] = TOTAL(WAE_length_bin_angl[29, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 19
                Total_N_ageclass_angl[20, 0] = TOTAL(WAE_length_bin_angl[30, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 20
                Total_N_ageclass_angl[21, 0] = TOTAL(WAE_length_bin_angl[31, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 21
                Total_N_ageclass_angl[22, 0] = TOTAL(WAE_length_bin_angl[32, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 22
                Total_N_ageclass_angl[23, 0] = TOTAL(WAE_length_bin_angl[33, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 23
                Total_N_ageclass_angl[24, 0] = TOTAL(WAE_length_bin_angl[34, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 24
                Total_N_ageclass_angl[25, 0] = TOTAL(WAE_length_bin_angl[35, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 25
                Total_N_ageclass_angl[26, 0] = TOTAL(WAE_length_bin_angl[36, i*NumLengthBin+adj:i*NumLengthBin+adj+36L]); age 26
                PRINT, 'Derived age distribution of harvested fish'
                PRINT, Total_N_ageclass_angl[*, 0]
                PRINT, 'Total number of harvested fish samples', TOTAL(Total_N_ageclass_angl[*, 0])

                ; Estimate age structure of harvested fish
                Total_prop_ageclass_angl = FLTARR(27L, 2L)
                IF TOTAL(Total_N_ageclass_angl[*, 0]) GT 0 THEN Total_prop_ageclass_angl[*, 0] = Total_N_ageclass_angl[*, 0]/TOTAL(Total_N_ageclass_angl[*, 0])
                PRINT, 'Relative age distribution'
                PRINT, Total_prop_ageclass_angl[*, 0]
                PRINT, 'N of harvested fish (angling)', N_harv_angl[INDEX_lengthdataAngl[0]] $
                  , HarvRate_angl[INDEX_lengthdataAngl[0]] * adultPE_angl[INDEX_lengthdataAngl[0]]
                IF TOTAL(Total_N_ageclass_angl[*, 0]) GT 0 THEN paramset_angl[13:39, i] = ROUND(Total_prop_ageclass_angl[*, 0] $
                  * HarvRate_angl[INDEX_lengthdataAngl[0]] * adultPE_angl[INDEX_lengthdataAngl[0]])
                PRINT, 'Estimated age distribution of harvested fish'
                PRINT, paramset_angl[13:39, i]

                ; Calculate mean length-at-age for harvested fish
                mean_length_at_age_angl = FLTARR(27L, 37L)
                mean_length_at_age_angl[0, *] = (WAE_length_mean_angl[10, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
                mean_length_at_age_angl[1, *] = (WAE_length_mean_angl[11, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
                mean_length_at_age_angl[2, *] = (WAE_length_mean_angl[12, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
                mean_length_at_age_angl[3, *] = (WAE_length_mean_angl[13, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
                mean_length_at_age_angl[4, *] = (WAE_length_mean_angl[14, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
                mean_length_at_age_angl[5, *] = (WAE_length_mean_angl[15, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
                mean_length_at_age_angl[6, *] = (WAE_length_mean_angl[16, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
                mean_length_at_age_angl[7, *] = (WAE_length_mean_angl[17, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
                mean_length_at_age_angl[8, *] = (WAE_length_mean_angl[18, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
                mean_length_at_age_angl[9, *] = (WAE_length_mean_angl[19, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
                mean_length_at_age_angl[10, *] = (WAE_length_mean_angl[20, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
                mean_length_at_age_angl[11, *] = (WAE_length_mean_angl[21, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
                mean_length_at_age_angl[12, *] = (WAE_length_mean_angl[22, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
                mean_length_at_age_angl[13, *] = (WAE_length_mean_angl[23, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
                mean_length_at_age_angl[14, *] = (WAE_length_mean_angl[24, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
                mean_length_at_age_angl[15, *] = (WAE_length_mean_angl[25, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
                mean_length_at_age_angl[16, *] = (WAE_length_mean_angl[26, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
                mean_length_at_age_angl[17, *] = (WAE_length_mean_angl[27, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
                mean_length_at_age_angl[18, *] = (WAE_length_mean_angl[28, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
                mean_length_at_age_angl[19, *] = (WAE_length_mean_angl[29, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
                mean_length_at_age_angl[20, *] = (WAE_length_mean_angl[30, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
                mean_length_at_age_angl[21, *] = (WAE_length_mean_angl[31, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
                mean_length_at_age_angl[22, *] = (WAE_length_mean_angl[32, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
                mean_length_at_age_angl[23, *] = (WAE_length_mean_angl[33, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
                mean_length_at_age_angl[24, *] = (WAE_length_mean_angl[34, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
                mean_length_at_age_angl[25, *] = (WAE_length_mean_angl[35, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
                mean_length_at_age_angl[26, *] = (WAE_length_mean_angl[36, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])
                age0mean_angl = where(mean_length_at_age_angl[0, *] GT 0, age0mean_anglcount)
                age1mean_angl = where(mean_length_at_age_angl[1, *] GT 0, age1mean_anglcount)
                age2mean_angl = where(mean_length_at_age_angl[2, *] GT 0, age2mean_anglcount)
                age3mean_angl = where(mean_length_at_age_angl[3, *] GT 0, age3mean_anglcount)
                age4mean_angl = where(mean_length_at_age_angl[4, *] GT 0, age4mean_anglcount)
                age5mean_angl = where(mean_length_at_age_angl[5, *] GT 0, age5mean_anglcount)
                age6mean_angl = where(mean_length_at_age_angl[6, *] GT 0, age6mean_anglcount)
                age7mean_angl = where(mean_length_at_age_angl[7, *] GT 0, age7mean_anglcount)
                age8mean_angl = where(mean_length_at_age_angl[8, *] GT 0, age8mean_anglcount)
                age9mean_angl = where(mean_length_at_age_angl[9, *] GT 0, age9mean_anglcount)
                age10mean_angl = where(mean_length_at_age_angl[10, *] GT 0, age10mean_anglcount)
                age11mean_angl = where(mean_length_at_age_angl[11, *] GT 0, age11mean_anglcount)
                age12mean_angl = where(mean_length_at_age_angl[12, *] GT 0, age12mean_anglcount)
                age13mean_angl = where(mean_length_at_age_angl[13, *] GT 0, age13mean_anglcount)
                age14mean_angl = where(mean_length_at_age_angl[14, *] GT 0, age14mean_anglcount)
                age15mean_angl = where(mean_length_at_age_angl[15, *] GT 0, age15mean_anglcount)
                age16mean_angl = where(mean_length_at_age_angl[16, *] GT 0, age16mean_anglcount)
                age17mean_angl = where(mean_length_at_age_angl[17, *] GT 0, age17mean_anglcount)
                age18mean_angl = where(mean_length_at_age_angl[18, *] GT 0, age18mean_anglcount)
                age19mean_angl = where(mean_length_at_age_angl[19, *] GT 0, age19mean_anglcount)
                age20mean_angl = where(mean_length_at_age_angl[20, *] GT 0, age20mean_anglcount)
                age21mean_angl = where(mean_length_at_age_angl[21, *] GT 0, age21mean_anglcount)
                age22mean_angl = where(mean_length_at_age_angl[22, *] GT 0, age22mean_anglcount)
                age23mean_angl = where(mean_length_at_age_angl[23, *] GT 0, age23mean_anglcount)
                age24mean_angl = where(mean_length_at_age_angl[24, *] GT 0, age24mean_anglcount)
                age25mean_angl = where(mean_length_at_age_angl[25, *] GT 0, age25mean_anglcount)
                age26mean_angl = where(mean_length_at_age_angl[26, *] GT 0, age26mean_anglcount)
                IF age0mean_anglcount GT 0 THEN Total_N_ageclass_angl[0, 1] = TOTAL(WAE_length_mean_angl[10, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age0mean_anglcount
                IF age1mean_anglcount GT 0 THEN Total_N_ageclass_angl[1, 1] = TOTAL(WAE_length_mean_angl[11, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age1mean_anglcount
                IF age2mean_anglcount GT 0 THEN Total_N_ageclass_angl[2, 1] = TOTAL(WAE_length_mean_angl[12, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age2mean_anglcount
                IF age3mean_anglcount GT 0 THEN Total_N_ageclass_angl[3, 1] = TOTAL(WAE_length_mean_angl[13, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age3mean_anglcount
                IF age4mean_anglcount GT 0 THEN Total_N_ageclass_angl[4, 1] = TOTAL(WAE_length_mean_angl[14, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age4mean_anglcount
                IF age5mean_anglcount GT 0 THEN Total_N_ageclass_angl[5, 1] = TOTAL(WAE_length_mean_angl[15, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age5mean_anglcount
                IF age6mean_anglcount GT 0 THEN Total_N_ageclass_angl[6, 1] = TOTAL(WAE_length_mean_angl[16, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age6mean_anglcount
                IF age7mean_anglcount GT 0 THEN Total_N_ageclass_angl[7, 1] = TOTAL(WAE_length_mean_angl[17, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age7mean_anglcount
                IF age8mean_anglcount GT 0 THEN Total_N_ageclass_angl[8, 1] = TOTAL(WAE_length_mean_angl[18, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age8mean_anglcount
                IF age9mean_anglcount GT 0 THEN Total_N_ageclass_angl[9, 1] = TOTAL(WAE_length_mean_angl[19, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age9mean_anglcount
                IF age10mean_anglcount GT 0 THEN Total_N_ageclass_angl[10, 1] = TOTAL(WAE_length_mean_angl[20, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age10mean_anglcount
                IF age11mean_anglcount GT 0 THEN Total_N_ageclass_angl[11, 1] = TOTAL(WAE_length_mean_angl[21, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age11mean_anglcount
                IF age12mean_anglcount GT 0 THEN Total_N_ageclass_angl[12, 1] = TOTAL(WAE_length_mean_angl[22, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age12mean_anglcount
                IF age13mean_anglcount GT 0 THEN Total_N_ageclass_angl[13, 1] = TOTAL(WAE_length_mean_angl[23, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age13mean_anglcount
                IF age14mean_anglcount GT 0 THEN Total_N_ageclass_angl[14, 1] = TOTAL(WAE_length_mean_angl[24, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age14mean_anglcount
                IF age15mean_anglcount GT 0 THEN Total_N_ageclass_angl[15, 1] = TOTAL(WAE_length_mean_angl[25, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age15mean_anglcount
                IF age16mean_anglcount GT 0 THEN Total_N_ageclass_angl[16, 1] = TOTAL(WAE_length_mean_angl[26, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age16mean_anglcount
                IF age17mean_anglcount GT 0 THEN Total_N_ageclass_angl[17, 1] = TOTAL(WAE_length_mean_angl[27, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age17mean_anglcount
                IF age18mean_anglcount GT 0 THEN Total_N_ageclass_angl[18, 1] = TOTAL(WAE_length_mean_angl[28, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age18mean_anglcount
                IF age19mean_anglcount GT 0 THEN Total_N_ageclass_angl[19, 1] = TOTAL(WAE_length_mean_angl[29, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age19mean_anglcount
                IF age20mean_anglcount GT 0 THEN Total_N_ageclass_angl[20, 1] = TOTAL(WAE_length_mean_angl[30, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age20mean_anglcount
                IF age21mean_anglcount GT 0 THEN Total_N_ageclass_angl[21, 1] = TOTAL(WAE_length_mean_angl[31, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age21mean_anglcount
                IF age22mean_anglcount GT 0 THEN Total_N_ageclass_angl[22, 1] = TOTAL(WAE_length_mean_angl[32, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age22mean_anglcount
                IF age23mean_anglcount GT 0 THEN Total_N_ageclass_angl[23, 1] = TOTAL(WAE_length_mean_angl[33, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age23mean_anglcount
                IF age24mean_anglcount GT 0 THEN Total_N_ageclass_angl[24, 1] = TOTAL(WAE_length_mean_angl[34, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age24mean_anglcount
                IF age25mean_anglcount GT 0 THEN Total_N_ageclass_angl[25, 1] = TOTAL(WAE_length_mean_angl[35, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age25mean_anglcount
                IF age26mean_anglcount GT 0 THEN Total_N_ageclass_angl[26, 1] = TOTAL(WAE_length_mean_angl[36, i*NumLengthBin+adj:i*NumLengthBin+adj+36L])/age26mean_anglcount
                PRINT, 'Mean length-at-age of harvested fish'
                PRINT, Total_N_ageclass_angl[*, 1]
                paramset_angl[40L:66, i] = Total_N_ageclass_angl[*, 1]

                Mean_mass_angl = FLTARR(27L, 1)
                Mean_mass_angl = 1.5868E-006*Total_N_ageclass_angl[*, 1]^3.2962
                PRINT, 'Mean mass-at-age of harvested fish'
                PRINT, Mean_mass_angl
                paramset_angl[67L:93, i] = Mean_mass_angl

                Age_NOmass_angl = WHERE(Mean_mass LE 0, Age_NOmass_anglcount)
                Age_Wmass_angl = WHERE(Mean_mass_angl GT 0, Age_Wmass_anglcount)
                IF Age_Wmass_anglcount GT 0. THEN PRINT, 'age class with mass data for harvested fish', Age_Wmass_angl
                IF Age_NOmass_anglcount GT 0. THEN PRINT, 'age class without mass data of harvested fish', Age_NOmass_angl
                PRINT, 'max age class with mass of harvested fish', MAX(Age_Wmass_angl)
                PRINT, 'min age class with mass of harvested fish', MIN(Age_Wmass_angl)

                Age_mass_angl_index = INDGEN(27)
                Age_NOmass_angl_Intrpl = WHERE((Age_NOmass_angl GT min(Age_Wmass_angl)) AND (Age_NOmass_angl LT max(Age_Wmass_angl)), Age_NOmass_angl_Intrplcount)
                IF Age_NOmass_angl_Intrplcount GT 0 THEN PRINT, 'age class mass need interpolation', Age_NOmass_angl[Age_NOmass_angl_Intrpl]

                Biomass_ageclass_angl = FLTARR(27L, 1)
                Biomass_ageclass_angl = Mean_mass*ROUND(Total_prop_ageclass_angl[*, 0] $
                  * HarvRate_angl[INDEX_lengthdataAngl[0]] * adultPE_angl[INDEX_lengthdataAngl[0]]); growth and mass are the same as the original lstocks
                PRINT, 'Biomass-at-age of harvested fish'
                PRINT, Biomass_ageclass_angl
                PRINT, 'Max biomass', MAX(Biomass_ageclass_angl)
                paramset_angl[94L:120, i] = Biomass_agelass_anglc

                 ; total adult biomass based on mean mass
                Pos_length_ageclass = WHERE(Total_N_ageclass[3:26, 1] GT 0, Pos_length_ageclassCount)
                Pos_length_ageclass_angl = WHERE(Total_N_ageclass_angl[3:26, 1] GT 0, Pos_length_ageclass_anglCount)
                ; biomass
                IF Pos_length_ageclassCount GT 0 THEN paramset_angl[223, i] = adultPE_angl[INDEX_lengthdataAngl[0]] $
                  * MEAN(1.5868E-006*Total_N_ageclass[Pos_length_ageclass, 1]^3.2962) $
                  /LakeArea[INDEX_lengthdata[0]]*1000000./1000.
                ; harvested biomass
                ;IF Pos_length_ageclassCount GT 0 THEN paramset_angl[223, i] = HarvRate_angl[INDEX_lengthdataAngl[0]]
                ;  * adultPE_angl[INDEX_lengthdataAngl[0]* MEAN(1.5868E-006*Total_N_ageclass[Pos_length_ageclass, i]^3.2962)
                IF Pos_length_ageclass_anglCount GT 0 THEN paramset_angl[224, i] = HarvRate_angl[INDEX_lengthdataAngl[0]] $
                * adultPE_angl[INDEX_lengthdataAngl[0]] * MEAN(1.5868E-006*Total_N_ageclass_angl[Pos_length_ageclass_angl, 1]^3.2962) $
                /LakeArea[INDEX_lengthdata[0]]*1000000./1000.
                ; harvestable biomass (35%)
                IF Pos_length_ageclassCount GT 0 THEN paramset_angl[225, i] = TotAlowCat[INDEX_lengthdataAngl[0]] $
                  * MEAN(1.5868E-006*Total_N_ageclass[Pos_length_ageclass, 1]^3.2962) $ 
                  /LakeArea[INDEX_lengthdata[0]]*1000000./1000.

                ; create age-specific biomass plots
                Biomass_ageclass_anglAll=Biomass_ageclass_angl/1000.
                ;femaleBiomass=Biomass_ageclassF/1000.
                ;unknownBiomass=Biomass_ageclassU/1000.
                !p.font=0
                ;Device, Set_Character_Size=[8,12]
                Device, Get_Decomposed=currentState
                DEVICE, SET_FONT='Courier', /TT_FONT
                DEVICE, DECOMPOSED=0
                cgDisplay, 750, 400, WID=4
                ;!P.Multi = [0,2,1]
                labels = INDGEN(27); ['Exp 1', 'Exp 2', 'Exp 3', 'Exp 4', 'Exp 5']
                cgLoadct, 33, Clip=[10,245]
                cgBarPlot, Biomass_ageclass_anglAll,  YRange=[0,MAX(Biomass_ageclass_anglALL)*1.2], Colors='DARKGRAY', BarNames=labels $
                  , xtitle='Age (years)'$
                  , ytitle='Biomass (Kg)' $;, xrange=[0, 25]
                  , title='Harvested (ANGL) biomass distribution of WI walleye stocks - '+'WBIC: '+STRING(WBIC[INDEX_lengthdata[0]], FORMAT = '(I7)') $
                  +'_Year: '+STRING(fix(SurveyYear[INDEX_lengthdata[0]]), FORMAT = '(I4)')
                ;XYOutS, ROUND(MEDIAN(INDGEN(27))), ROUND(0.5*(MAX(paramset[13:39, i]))*1.3), Orientation=90.0, /DEVICE
                ;cgBarPlot, femaleBiomass, Colors='RED', /Overplot, BaseLines=maleBiomass
                ;cgBarPlot, unknownBiomass, Colors='dark green', /Overplot, BaseLines=maleBiomass+femaleBiomass
                ;items = ['Male', 'Female', 'Unknown']
                ;colors = ['BLUE', 'RED', 'dark green']
                ;AL_Legend, items, Colors=colors, PSym=Replicate(15,3), SymSize=Replicate(1.75,3), $
                ;  Charsize=cgDefCharsize(), Position=[0.75, 0.85], /Normal

                ; file name for WBIC-year-specific age structure
                filename='Walleye harveseted (ANGL) biomass'+ STRING(WBIC[INDEX_lengthdata[0]], FORMAT = '(I7)') $
                  +'_'+STRING(fix(SurveyYear[INDEX_lengthdata[0]]), FORMAT = '(I4)')+'.png'
                WRITE_PNG, filename, TVRD(/TRUE)
                DEVICE, DECOMPOSED=old_decomposed
                !p.font=1

;                ;Growth_mass = fltarr(27L, 1); ??? USE VALUES FROM TOTAL POPULATIONS????
;                Mean_biomass_angl = FLTARR(27L, 1)
;                Production_angl = FLTARR(27L, 1)
;                ;IF (Mean_mass[3, 0] GT 0) AND (Mean_mass[4, 0] GT 0) THEN Growth_mass[0, 0] = Mean_mass[4, 0] - Mean_mass[3, 0]
;                FOR Agei = 1L, 26L DO BEGIN
;                  IF (Agei GE MIN(Age_Wmass_angl)) AND (Agei LT MAX(Age_Wmass_angl)) THEN BEGIN
;                    ;print, 'agei', agei
;                    IF (Mean_mass_angl[Agei-1L, 0] GT 0.) AND (Mean_mass_angl[Agei, 0] GT 0.) THEN BEGIN
;                      ;Growth_mass[Agei, 0] = ALOG(Mean_mass[Agei, 0]/Mean_mass[Agei-1L, 0])
;                      Mean_biomass_angl[Agei, 0] = MEAN(Biomass_ageclass_angl[Agei-1L:Agei, 0])
;                      Production_angl[Agei, 0] = Growth_mass[Agei, 0] * Mean_biomass_angl[Agei, 0]
;                    ENDIF
;                  ENDIF
;                ENDFOR
;                PRINT, 'Mean growth in mass'
;                PRINT, Growth_mass
;                PRINT, 'Mean biomass (Bhat) of harvested fish'
;                PRINT, Mean_biomass_angl
;                PRINT, 'Harvested production'
;                PRINT, Production_angl
;                paramset_angl[121L:147, i] = Growth_mass
;                paramset_angl[148L:174, i] = Mean_biomass_angl
                ;paramset_angl[175L:201, i] = Production_angl

                ; *******GAPS IN AGE CLASSS STILL NEED TO be INTERPOLATED!!!!!!!!!!!!!!!!!

                PRINT, 'Total number of harvested fish (angling)', N_harv_angl[INDEX_lengthdataAngl[0]] $
                  , HarvRate_angl[INDEX_lengthdataAngl[0]] * adultPE_angl[INDEX_lengthdataAngl[0]]
                PRINT, 'Lake area (km2)', LakeArea[INDEX_lengthdata[0]]/1000000.; lake area (km2)

                IF (LakeArea[INDEX_lengthdata[0]] GT 0.) THEN Total_biomass_angl[i] = TOTAL(Biomass_ageclass_angl[*, 0]) / LakeArea[INDEX_lengthdata[0]]*1000000./1000.
                PRINT, 'Total harvested biomass (kg/km2)'
                PRINT, Total_biomass_angl[i]
                paramset_angl[202, i] = Total_biomass_angl[i]

;                Pos_production_angl = WHERE(Production_angl[*, 0] GT 0., Pos_production_anglcount); negative age-specific production is converted to 0
;                IF (Pos_production_anglcount GT 0.) AND (LakeArea[INDEX_lengthdata[0]] GT 0.) THEN $
;                  Total_production_angl[i] = TOTAL(Production_angl[Pos_production_angl, 0]) $
;                  / LakeArea[INDEX_lengthdata[0]]*1000000./1000.
;                PRINT, 'Total harvested production (kg/km2/year)'
;                PRINT, Total_production_angl[i]
;                paramset_angl[203, i] = Total_production_angl[i]

;                IF (Total_production[i] GT 0.) THEN Ecotroph[i] = Total_production_angl[i]/Total_production[i]
;                PRINT, 'harvested production/total production'
;                PRINT, Ecotroph[i]
;                paramset_angl[208L, i] = Ecotroph[i]
;
;                Pos_biomass_angl = WHERE(Total_biomass_angl[i] GT 0., Pos_biomass_anglcount); negative age-specific production is converted to 0
;                IF Pos_biomass_anglcount GT 0. THEN P_over_B_angl[i] = Total_production_angl[i] / Total_biomass_angl[i]
;                PRINT, 'Harvested P/B'
;                PRINT, P_over_B_angl[i]
;                paramset_angl[204L, i] = P_over_B_angl[i]

                ; Estimates with only >age 3
                IF (LakeArea[INDEX_lengthdata[0]] GT 0.) THEN Total_biomass_adult_angl[i] = TOTAL(Biomass_ageclass_angl[3L:26L, 0]) $
                  / LakeArea[INDEX_lengthdata[0]]*1000000./1000.
                PRINT, 'Total harvested adult biomass (kg/km2)'
                PRINT, Total_biomass_adult_angl[i]
                paramset_angl[205L, i] = Total_biomass_adult_angl[i]

;                ;Growth_mass_adult = fltarr(27L, 1)
;                Mean_biomass_adult_angl = fltarr(27L, 1)
;                Production_adult_angl = fltarr(27L, 1)
;                FOR Agei = 1L, 26L DO BEGIN
;                  IF (Agei GE 3L) AND (Agei LT MAX(Age_Wmass_angl)) THEN BEGIN
;                    ;print, 'agei', agei
;                    IF (Mean_mass_angl[Agei-1L, 0] GT 0.) AND (Mean_mass_angl[Agei, 0] GT 0.) THEN BEGIN
;                      ;Growth_mass_adult[Agei, 0] = ALOG(Mean_mass[Agei, 0]/Mean_mass[Agei-1L, 0])
;                      Mean_biomass_adult_angl[Agei, 0] = MEAN(Biomass_ageclass_angl[Agei-1L:Agei, 0])
;                      Production_adult_angl[Agei, 0] = Growth_mass_adult[Agei, 0] * Mean_biomass_adult_angl[Agei, 0]
;                    ENDIF
;                  ENDIF
;                ENDFOR

;                Pos_production_adult_angl = WHERE(Production_adult_angl[*, 0] GT 0., Pos_production_adult_anglcount); ***negative age-specific production is converted to 0
;                PRINT, 'Array index for positive harvested adult production', Pos_production_adult_angl
;                IF (Pos_production_adult_anglcount GT 0.) AND (LakeArea[INDEX_lengthdata[0]] GT 0.)  THEN $
;                  Total_production_adult_angl[i] = TOTAL(Production_adult_angl[Pos_production_adult, 0]) $
;                  / LakeArea[INDEX_lengthdata[0]]*1000000./1000.
;                PRINT, 'Total harvested adult Production (kg/km2/year)'
;                PRINT, Total_production_adult_angl[i]
;                paramset_angl[206L, i] = Total_production_adult_angl[i]

;                ;IF (Total_production_adult[i] GT 0.) THEN Adult_ecotroph[i] = Total_production_adult_angl[i]/Total_production_adult[i]
;                IF (Total_production_adult[i] GT 0.) THEN Adult_ecotroph[i] = Total_biomass_adult_angl[i] $
;                      /(Total_production_adult[i]+(Biomass_ageclass[3,0]/1000.)/(LakeArea[INDEX_lengthdata[0]]/1000000.))
;                PRINT, 'harvested adult production/total production'
;                PRINT, Adult_ecotroph[i]
;                paramset_angl[209L, i] = Adult_ecotroph[i]
;
;                Pos_biomass_adult_angl = WHERE(Total_biomass_adult_angl[i] GT 0., Pos_biomass_adult_anglcount); negative age-specific production is converted to 0
;                IF Pos_biomass_adult_anglcount GT 0. THEN P_over_B_adult_angl[i] = Total_production_adult_angl[i] / Total_biomass_adult_angl[i]
;                PRINT, 'Harvested adult P/B'
;                PRINT, P_over_B_adult_angl[i]
;                paramset_angl[207L, i] = P_over_B_adult_angl[i]
;                ;IF adultPE_angl[INDEX_lengthdataAngl[0]] GT 0 THEN paramset_angl[210L, i] = N_harv_angl[INDEX_lengthdataAngl[0]]/adultPE_angl[INDEX_lengthdataAngl[0]]
;                paramset_angl[210L, i] = HarvRate_angl[INDEX_lengthdataAngl[0]]
               
               ;****calculate % harvested production****
              ;IF (Total_production_adult[i] GT 0.) THEN Adult_ecotroph[i] = Total_production_adult_angl[i]/Total_production_adult[i]
              IF (Total_production_adult[i] GT 0.) THEN Adult_ecotroph[i] = Total_biomass_adult_angl[i] $
                /(Total_production_adult[i]+(Biomass_ageclass[3,0]/1000.)/(LakeArea[INDEX_lengthdata[0]]/1000000.))
              PRINT, 'harvested adult biomass/total adult production'
              PRINT, Adult_ecotroph[i]
              paramset_angl[209L, i] = Adult_ecotroph[i]

              ENDIF; END OF REGION KEY FOR ANGLING
            ENDIF; END OF INDEX_lengthdataAngl4count
           ENDIF
          ENDIF
        ENDIF; END of region key

      ENDIF; END of no lake-year-specific key

      AgeArray[INDEX_lengthdata] = FishAge[*]
      LengthArray[INDEX_lengthdata] = Fishlength[*]


      ; 1.Create a table for biomass and production -at-age - based on spring monitoring surveys
      AgeBioProd[0, i*27L : i*27L+26L] = paramset[0, i]; wbic-year
      AgeBioProd[1, i*27L : i*27L+26L] = paramset[1, i]; wbic
      AgeBioProd[2, i*27L : i*27L+26L] = paramset[2, i]; year
      AgeBioProd[3, i*27L : i*27L+26L] = paramset[3, i]; N of fish sampels
      AgeBioProd[4, i*27L : i*27L+26L] = paramset[4, i]; N of males
      AgeBioProd[5, i*27L : i*27L+26L] = paramset[5, i]; N of females
      AgeBioProd[6, i*27L : i*27L+26L] = paramset[6, i]; N of unknown
      AgeBioProd[7, i*27L : i*27L+26L] = paramset[208, i]; PE
      AgeBioProd[8, i*27L : i*27L+26L] = paramset[209, i]; lake area (km2)
      AgeBioProd[9, i*27L : i*27L+26L] = paramset[231, i]; lake-size code
      AgeBioProd[10, i*27L : i*27L+26L] = paramset[232, i]; region code
      AgeBioProd[11, i*27L : i*27L+26L] = paramset[233, i]; lake code
      AgeBioProd[33, i*27L : i*27L+26L] = paramset[213, i] ; number of age class
      AgeBioProd[34, i*27L : i*27L+26L] = paramset[219, i] ; mean length of all fish
      AgeBioProd[35, i*27L : i*27L+26L] = paramset[221, i] ; mean length of female
      AgeBioProd[36, i*27L : i*27L+26L] = paramset[223, i] ; mean length of male
      
      IF TOTAL(Total_N_ageclass[*, 0]) GT 0 THEN AgeBioProd[37, i*27L : i*27L+26L] $ 
          = TOTAL(Total_N_ageclass[*, 0]*INDGEN(27))/ TOTAL(Total_N_ageclass[*, 0]); mean age of all fish
      IF TOTAL(Male_N_ageclass[*, 0]) GT 0 THEN AgeBioProd[38, i*27L : i*27L+26L] $
          = TOTAL(Male_N_ageclass[*, 0]*INDGEN(27))/ TOTAL(Male_N_ageclass[*, 0]); mean age of male
      IF TOTAL(Female_N_ageclass[*, 0]) GT 0 THEN AgeBioProd[39, i*27L : i*27L+26L] $
          = TOTAL(Female_N_ageclass[*, 0]*INDGEN(27))/ TOTAL(Female_N_ageclass[*, 0]); mean age of female
      
      All_biomass = Biomass_ageclassM + Biomass_ageclassF + Biomass_ageclassU
      IF LakeArea[INDEX_lengthdata[0]] GT 0 THEN BEGIN
      AgeBioProd[12, i*27L : i*27L+26L] = TOTAL(paramset[13:39, i])/LakeArea[INDEX_lengthdata[0]]*1000000./1000.; all
      AgeBioProd[13, i*27L : i*27L+26L] = TOTAL(All_biomass)/LakeArea[INDEX_lengthdata[0]]*1000000./1000.
      AgeBioProd[14, i*27L : i*27L+26L] = TOTAL(paramset[148:174, i])/LakeArea[INDEX_lengthdata[0]]*1000000./1000.
      AgeBioProd[15, i*27L : i*27L+26L] = TOTAL(paramset[175:201, i])/LakeArea[INDEX_lengthdata[0]]*1000000./1000.
      
      AgeBioProd[16, i*27L : i*27L+26L] = TOTAL(paramset[17:39, i])/LakeArea[INDEX_lengthdata[0]]*1000000./1000.; adult (age 4+)
      AgeBioProd[17, i*27L : i*27L+26L] = TOTAL(All_biomass[4:26L])/LakeArea[INDEX_lengthdata[0]]*1000000./1000.
      AgeBioProd[18, i*27L : i*27L+26L] = TOTAL(paramset[152:174, i])/LakeArea[INDEX_lengthdata[0]]*1000000./1000.
      AgeBioProd[19, i*27L : i*27L+26L] = TOTAL(paramset[179:201, i])/LakeArea[INDEX_lengthdata[0]]*1000000./1000.

      AgeBioProd[20, i*27L : i*27L+26L] = TOTAL(All_biomass[5:26L])/LakeArea[INDEX_lengthdata[0]]*1000000./1000.
      ; spawning biomass (age 5+)
      END

      AgeBioProd[21, i*27L : i*27L+26L] = INDGEN(27)                                                                                   
      AgeBioProd[22, i*27L : i*27L+26L] = paramset[40:66, i]; mean length 
      AgeBioProd[23, i*27L : i*27L+26L] = paramset[67:93, i]; mean mass
      AgeBioProd[24, i*27L : i*27L+26L] = paramset[121:147, i]; mean growth in mass

      IF TOTAL(paramset[13:39, i])GT 0 THEN AgeBioProd[25, i*27L : i*27L+26L] = paramset[13:39, i] $
                                                      / TOTAL(paramset[13:39, i]); relative abundance
      IF LakeArea[INDEX_lengthdata[0]] GT 0 THEN AgeBioProd[26, i*27L : i*27L+26L] = paramset[13:39, i] $
                                                      /  LakeArea[INDEX_lengthdata[0]]*1000000.;  abundance
        
      IF TOTAL(All_biomass) GT 0 THEN AgeBioProd[27, i*27L : i*27L+26L] = (Biomass_ageclassM + Biomass_ageclassF + Biomass_ageclassU) $
                                                                            / TOTAL(All_biomass); relative biomass
      IF LakeArea[INDEX_lengthdata[0]] GT 0 THEN AgeBioProd[28, i*27L : i*27L+26L] = (Biomass_ageclassM + Biomass_ageclassF + Biomass_ageclassU) / $
                                          LakeArea[INDEX_lengthdata[0]]*1000000./1000.; biomass
      
      IF TOTAL(paramset[148:174, i]) GT 0 THEN AgeBioProd[29, i*27L : i*27L+26L] = paramset[148:174, i] $
                                                / TOTAL(paramset[148:174, i]); relative mean biomass
      IF LakeArea[INDEX_lengthdata[0]] GT 0 THEN AgeBioProd[30, i*27L : i*27L+26L] = paramset[148:174, i] / LakeArea[INDEX_lengthdata[0]]*1000000./1000.; mean biomass
      
      IF TOTAL(paramset[175:201, i]) GT 0 THEN AgeBioProd[31, i*27L : i*27L+26L] = paramset[175:201, i] $
                                                / TOTAL(paramset[175:201, i]); relative production
      IF LakeArea[INDEX_lengthdata[0]] GT 0 THEN AgeBioProd[32, i*27L : i*27L+26L] = paramset[175:201, i] / LakeArea[INDEX_lengthdata[0]]*1000000./1000.; adult production


      ; 2.Create a table for biomass and production -at-age - based on angling 
      AgeBioProd_angl[0, i*27L : i*27L+26L] = paramset_angl[0, i]; wbic-year
      AgeBioProd_angl[1, i*27L : i*27L+26L] = paramset_angl[1, i]; wbic
      AgeBioProd_angl[2, i*27L : i*27L+26L] = paramset_angl[2, i]; year
      AgeBioProd_angl[3, i*27L : i*27L+26L] = paramset_angl[3, i]; N of fish

      IF N_harv_angl[INDEX_lengthdataAngl[0]] GT 0 THEN AgeBioProd_angl[4, i*27L : i*27L+26L] $
                  = N_harv_angl[INDEX_lengthdataAngl[0]]; N of harvested fish
      AgeBioProd_angl[5, i*27L : i*27L+26L] = paramset[209, i]; area
      AgeBioProd_angl[6, i*27L : i*27L+26L] = paramset_angl[218, i]; mean age
      AgeBioProd_angl[7, i*27L : i*27L+26L] = paramset_angl[220, i]; mean length
      AgeBioProd_angl[8, i*27L : i*27L+26L] = paramset_angl[222, i]; legal size

      IF LakeArea[INDEX_lengthdata[0]] GT 0 THEN BEGIN
        AgeBioProd_angl[9, i*27L : i*27L+26L] = TOTAL(paramset_angl[13:39, i])/LakeArea[INDEX_lengthdata[0]]*1000000.; harvested total abundance
        AgeBioProd_angl[10, i*27L : i*27L+26L] = TOTAL(paramset_angl[94:120, i])/LakeArea[INDEX_lengthdata[0]]*1000000./1000.; harvested total biomass
        AgeBioProd_angl[11, i*27L : i*27L+26L] = TOTAL(paramset_angl[17:39, i])/LakeArea[INDEX_lengthdata[0]]*1000000.; harvested adult (age 4+) abundance
        AgeBioProd_angl[12, i*27L : i*27L+26L] = TOTAL(paramset_angl[98:120, i])/LakeArea[INDEX_lengthdata[0]]*1000000./1000.; harvested adult biomass

        AgeBioProd_angl[13, i*27L : i*27L+26L] = TOTAL(paramset_angl[99:120, i])/LakeArea[INDEX_lengthdata[0]]*1000000./1000.; harvested spawning biomass
        ; spawning biomass (age 5+)
      END

      AgeBioProd_angl[14, i*27L : i*27L+26L] = INDGEN(27)
      AgeBioProd_angl[15, i*27L : i*27L+26L] = paramset_angl[40:66, i]; mean length of harvested fish
      AgeBioProd_angl[16, i*27L : i*27L+26L] = paramset_angl[67:93, i]; mean mass of harvested fish

      IF TOTAL(paramset_angl[13:39, i])GT 0 THEN AgeBioProd_angl[17, i*27L : i*27L+26L] = paramset_angl[13:39, i] $
        / TOTAL(paramset_angl[13:39, i]); relative abundance
      IF LakeArea[INDEX_lengthdata[0]] GT 0 THEN AgeBioProd_angl[18, i*27L : i*27L+26L] = paramset_angl[13:39, i] $
        /  LakeArea[INDEX_lengthdata[0]]*1000000.; abundance

      IF TOTAL(paramset_angl[94:120, i]) GT 0 THEN AgeBioProd_angl[19, i*27L : i*27L+26L] = paramset_angl[94:120, i] $
        / TOTAL(paramset_angl[94:120, i]); relative biomass
      IF LakeArea[INDEX_lengthdata[0]] GT 0 THEN AgeBioProd_angl[20, i*27L : i*27L+26L] = paramset_angl[94:120, i] / $
        LakeArea[INDEX_lengthdata[0]]*1000000./1000.; biomass
        
    ; create output arrays for length bins
    LengthSelect_Data[0, i*37L : i*37L+36L] = paramset[0, i]; wbic-year
    LengthSelect_Data[1, i*37L : i*37L+36L] = paramset[1, i]; wbic
    LengthSelect_Data[2, i*37L : i*37L+36L] = paramset[2, i]; year
    LengthSelect_Data[3, i*37L : i*37L+36L] = paramset[3, i]; N of fish
    LengthSelect_Data[4, i*37L : i*37L+36L] = PE[INDEX_lengthdata[0]]; adult PE
    IF LakeArea[INDEX_lengthdata[0]] GT 0 THEN LengthSelect_Data[5, i*37L : i*37L+36L] = TOTAL(LengthDist[0:36, i]); harvested total abundance
    LengthSelect_Data[6, i*37L : i*37L+36L] = INDGEN(37)
    IF LakeArea[INDEX_lengthdata[0]] GT 0 THEN LengthSelect_Data[7, i*37L : i*37L+36L] = LengthDist[0:36, i];  abundance
    IF LakeArea[INDEX_lengthdata[0]] GT 0 THEN LengthSelect_Data[8, i*37L : i*37L+36L] = LengthDist[0:36, i]/TOTAL(LengthDist[0:36, i]); relative abundance
    IF LakeArea[INDEX_lengthdata[0]] GT 0 THEN LengthSelect_Data[9, i*37L : i*37L+36L] $
      = LengthDist[0:36, i]/TOTAL(LengthDist[0:36, i])*PE[INDEX_lengthdata[0]];  abundance estiamtes

    LengthSelect_Data[10, i*37L : i*37L+36L] = paramset_angl[0, i]; wbic-year
    LengthSelect_Data[11, i*37L : i*37L+36L] = paramset_angl[1, i]; wbic
    LengthSelect_Data[12, i*37L : i*37L+36L] = paramset_angl[2, i]; year
    LengthSelect_Data[13, i*37L : i*37L+36L] = paramset_angl[3, i]; N of fish
    IF paramset_angl[3, i] GT 0 THEN $
      LengthSelect_Data[14, i*37L : i*37L+36L] = ROUND(adultPE_angl[INDEX_lengthdataAngl[0]]*HarvRate_angl[INDEX_lengthdataAngl[0]]); # harvested fish
    IF paramset_angl[3, i] GT 0 THEN LengthSelect_Data[15, i*37L : i*37L+36L] $
      = HarvRate_angl[INDEX_lengthdataAngl[0]]; harvest rate
    IF paramset_angl[3, i] GT 0 THEN LengthSelect_Data[16, i*37L : i*37L+36L] = TOTAL(LengthDist_angl[0:36, i]); harvested total abundance
    IF paramset_angl[3, i] GT 0 THEN LengthSelect_Data[17, i*37L : i*37L+36L] = LengthDist_angl[0:36, i]; abundance
    IF TOTAL(LengthDist_angl[0:36, i]) GT 0 THEN LengthSelect_Data[18, i*37L : i*37L+36L] $
      = LengthDist_angl[0:36, i]/TOTAL(LengthDist_Angl[0:36, i]); relative abundance
    IF TOTAL(LengthDist_angl[0:36, i]) GT 0 THEN $
      LengthSelect_Data[19, i*37L : i*37L+36L] = ROUND(LengthDist_angl[0:36, i]/TOTAL(LengthDist_angl[0:36, i]) $ 
      *adultPE_angl[INDEX_lengthdataAngl[0]]*HarvRate_Angl[INDEX_lengthdataAngl[0]]); abundance estimates

 
    ENDIF; END of length survey data
  ENDFOR; END OF WBIC_year loop
  PRINT, 'Total biomass (kg/km2)'
  PRINT, Total_biomass
  PRINT, 'Total Production (kg/km2/year)'
  PRINT, Total_Production
  PRINT, 'P/B'
  PRINT, P_over_B
  PRINT, 'Adult biomass (kg/km2)'
  PRINT, Total_biomass_adult
  PRINT, 'Net Adult Production (kg/km2/year)'
  PRINT, Total_Production_adult
  PRINT, 'Surplus adult Production (kg/km2/year)'
  PRINT, TRANSPOSE(paramset[217L, *])
  PRINT, 'Adult P/B'
  PRINT, P_over_B_adult

  PRINT, 'Total harvested biomass (kg/km2)'
  PRINT, Total_biomass_angl
  PRINT, 'harvested adult biomass (kg/km2)'
  PRINT, Total_biomass_adult_angl
  PRINT, 'Ecotrophic coefficient'
  PRINT, Adult_ecotroph
  PRINT, 'Proportion of unsampled fish in the spring surveys', Prop_LengthDist_angl_PLUS
  
  PRINT, 'Total N of production estiamtes', N_Lake_year_Wkeys+N_Lake_Wkeys+N_Lake_WOkeys
  PRINT, 'N of harvested (angling) production estiamtes', N_Lake_year_angl+N_Lake_angl
  PRINT, 'Total N of lake-years w/yoy data', N_Lake_year_yoy


  ; individual reconstructed length-at-age data
  Length_Age_Data = FLTARR(6, N)
  Length_Age_Data[0, *] = WBIC_Year
  Length_Age_Data[1, *] = WBIC
  Length_Age_Data[2, *] = SurveyYear
  Length_Age_Data[3, *] = SEX
  Length_Age_Data[4, *] = LengthArray
  Length_Age_Data[5, *] = AgeArray
  ;PRINT, 'Lenght-at-age'
  ;PRINT, (Length_Age_Data)


  ; Export the output to a file
  ; Output 1
  ParamsetWdata = WHERE(paramset[0, *] GT 0, ParamsetWdatacount)
  Data = paramset;[*, ParamsetWdata]
  ;INDEX_length_age = WHERE(WAE_length_bin[1, *] GT 0., INDEX_length_agecount)
  ;Data = WAE_length_bin[*, INDEX_length_age]
  filename1 = 'Output_walleye_production_lake_year.csv'
  ;****the files should be in the same directory as the "IDLWorksapce81" default folder.****
  s = Size(data, /Dimensions)
  xsize = s[0]
  lineWidth = 16000000
  comma = ","
  ; Open the data file for writing.
  OpenW, lun, filename1, /Get_Lun, Width=lineWidth
  ; Write the data to the file.
  sData = StrTrim(double(data), 2)
  sData[0:xsize-2, *] = sData[0:xsize-2, *] + comma
  PrintF, lun, sData
  ; Close the file.
  Free_Lun, lun

  ; Output 2
  ParamsetW_angldata = WHERE(paramset_angl[0, *] GT 0, ParamsetW_angldatacount)
  Data2 = paramset_angl;[*, ParamsetW_angldata]
  filename2 = 'Output_walleye_production_angl.csv'
  ;****the files should be in the same directory as the "IDLWorksapce81" default folder.****
  s = Size(data2, /Dimensions)
  xsize = s[0]
  lineWidth = 16000000
  comma = ","
  ; Open the data file for writing.
  OpenW, lun, filename2, /Get_Lun, Width=lineWidth
  ; Write the data to the file.
  sData2 = StrTrim(double(data2), 2)
  sData2[0:xsize-2, *] = sData2[0:xsize-2, *] + comma
  PrintF, lun, sData2
  ; Close the file.
  Free_Lun, lun

  ; Output 3
  ;ParamsetW_angldata = WHERE(paramset_angl[0, *] GT 0, ParamsetW_angldatacount)
  Data3 = LengthDist
  filename3 = 'Output_walleye_LengthDist.csv'
  ;****the files should be in the same directory as the "IDLWorksapce81" default folder.****
  s = Size(data3, /Dimensions)
  xsize = s[0]
  lineWidth = 16000000
  comma = ","
  ; Open the data file for writing.
  OpenW, lun, filename3, /Get_Lun, Width=lineWidth
  ; Write the data to the file.
  sData3 = StrTrim(double(data3), 2)
  sData3[0:xsize-2, *] = sData3[0:xsize-2, *] + comma
  PrintF, lun, sData3
  ; Close the file.
  Free_Lun, lun

  ; Output 4
  ;ParamsetW_angldata = WHERE(paramset_angl[0, *] GT 0, ParamsetW_angldatacount)
  Data4 = LengthDist_angl
  filename4 = 'Output_walleye_LengthDist_angl.csv'
  ;****the files should be in the same directory as the "IDLWorksapce81" default folder.****
  s = Size(data4, /Dimensions)
  xsize = s[0]
  lineWidth = 16000000
  comma = ","
  ; Open the data file for writing.
  OpenW, lun, filename4, /Get_Lun, Width=lineWidth
  ; Write the data to the file.
  sData4 = StrTrim(double(data4), 2)
  sData4[0:xsize-2, *] = sData4[0:xsize-2, *] + comma
  PrintF, lun, sData4
  ; Close the file.
  Free_Lun, lun
  
  ; Output 5
  ParamsetWdata = WHERE(paramset[0, *] GT 0, ParamsetWdatacount)
  Data5 = paramsetM;[*, ParamsetWdata]
  filename5 = 'Output_walleye_production_lake_year_M.csv'
  ;****the files should be in the same directory as the "IDLWorksapce81" default folder.****
  s = Size(data5, /Dimensions)
  xsize = s[0]
  lineWidth = 16000000
  comma = ","
  ; Open the data file for writing.
  OpenW, lun, filename5, /Get_Lun, Width=lineWidth
  ; Write the data to the file.
  sData5 = StrTrim(double(data5), 2)
  sData5[0:xsize-2, *] = sData5[0:xsize-2, *] + comma
  PrintF, lun, sData5
  ; Close the file
  Free_Lun, lun
  
  ; Output 6
  ParamsetWdata = WHERE(paramset[0, *] GT 0, ParamsetWdatacount)
  Data6 = paramsetF;[*, ParamsetWdata]
  filename6 = 'Output_walleye_production_lake_year_F.csv'
  ;****the files should be in the same directory as the "IDLWorksapce81" default folder.****
  s = Size(data6, /Dimensions)
  xsize = s[0]
  lineWidth = 16000000
  comma = ","
  ; Open the data file for writing.
  OpenW, lun, filename6, /Get_Lun, Width=lineWidth
  ; Write the data to the file.
  sData6 = StrTrim(double(data6), 2)
  sData6[0:xsize-2, *] = sData6[0:xsize-2, *] + comma
  PrintF, lun, sData6
  ; Close the file.
  Free_Lun, lun
  
  ; Output 7
  ;ParamsetWdata = WHERE(paramset[0, *] GT 0, ParamsetWdatacount)
  Data7 = AgeBioProd;[*, ParamsetWdata]
  filename7 = 'Output_walleye_prod_lake_year_age.csv'
  ;****the files should be in the same directory as the "IDLWorksapce81" default folder.****
  s = Size(data7, /Dimensions)
  xsize = s[0]
  lineWidth = 16000000
  comma = ","
  ; Open the data file for writing.
  OpenW, lun, filename7, /Get_Lun, Width=lineWidth
  ; Write the data to the file.
  sData7 = StrTrim(double(data7), 2)
  sData7[0:xsize-2, *] = sData7[0:xsize-2, *] + comma
  PrintF, lun, sData7
  ; Close the file.
  Free_Lun, lun

  ; Output 8
  ;ParamsetWdata = WHERE(paramset[0, *] GT 0, ParamsetWdatacount)
  Data8 = AgeBioProd_angl;[*, ParamsetWdata]
  filename8 = 'Output_walleye_prod_lake_year_age_angl.csv'
  ;****the files should be in the same directory as the "IDLWorksapce81" default folder.****
  s = Size(data8, /Dimensions)
  xsize = s[0]
  lineWidth = 16000000
  comma = ","
  ; Open the data file for writing.
  OpenW, lun, filename8, /Get_Lun, Width=lineWidth
  ; Write the data to the file.
  sData8 = StrTrim(double(data8), 2)
  sData8[0:xsize-2, *] = sData8[0:xsize-2, *] + comma
  PrintF, lun, sData8
  ; Close the file.
  Free_Lun, lun

  ; Output 9
  ;ParamsetWdata = WHERE(paramset[0, *] GT 0, ParamsetWdatacount)
  Data9 = LengthSelect_Data;[*, ParamsetWdata]
  filename9 = 'Output_walleye_lake_year_size_select_angl.csv'
  ;****the files should be in the same directory as the "IDLWorksapce81" default folder.****
  s = Size(data9, /Dimensions)
  xsize = s[0]
  lineWidth = 16000000
  comma = ","
  ; Open the data file for writing.
  OpenW, lun, filename9, /Get_Lun, Width=lineWidth
  ; Write the data to the file.
  sData9 = StrTrim(double(data9), 2)
  sData9[0:xsize-2, *] = sData9[0:xsize-2, *] + comma
  PrintF, lun, sData9
  ; Close the file.
  Free_Lun, lun
    
  ; Output 10
  Data10 = Length_Age_Data
  filename10 = 'Output_walleye_lake_year_Length.Age.csv'
  ;****the files should be in the same directory as the "IDLWorksapce81" default folder.****
  s = Size(data10, /Dimensions)
  xsize = s[0]
  lineWidth = 16000000
  comma = ","
  ; Open the data file for writing.
  OpenW, lun, filename10, /Get_Lun, Width=lineWidth
  ; Write the data to the file.
  sData10 = StrTrim(double(data10), 2)
  sData10[0:xsize-2, *] = sData10[0:xsize-2, *] + comma
  PrintF, lun, sData10
  ; Close the file.
  Free_Lun, lun
  
  ;    uniqWBIC_growth = paramset[2, UNIQ(paramset[2,*], SORT(paramset[2,*]))]
  ;    print, N_elements(uniqWBIC_growth)
  ;    NWBIC_growth = fltarr(5, N_elements(uniqWBIC_growth))
  ;    FOR i = 0L, N_ELEMENTS(uniqWBIC_growth)-1L DO BEGIN
  ;      WBIC_growth = WHERE(paramset[2,*] EQ uniqWBIC_growth[i], WBIC_growthcount)
  ;      NWBIC_growth[0, i] = uniqWBIC_growth[i]
  ;      NWBIC_growth[1, i] = WBIC_growthcount
  ;      NWBIC_growth[2, i] = max(paramset[3,WBIC_growth])
  ;      NWBIC_growth[3, i] = min(paramset[3,WBIC_growth])
  ;      NWBIC_growth[4, i] = max(paramset[3,WBIC_growth]) - min(paramset[3,WBIC_growth])
  ;      ;print,'Number of unique WBIC',WBIC_growthcount
  ;    ENDFOR
  ;    ;print,NWBIC_growth
  ;
  ;    NminYears = 4L
  ;    NWBIC_growthGEmin = where(NWBIC_growth[1, *] GE NminYears, NWBIC_growthGEmincount)
  ;    ;print, NWBIC_growthGEmincount, NWBIC_growth[*, NWBIC_growthGEmin]
  
  ;    Data2 = NWBIC_growth[*, NWBIC_growthGEmin]
  ;
  ;    filename2 = 'SelectOutput_Walleye_Growth.csv'
  ;    ;****the files should be in the same directory as the "IDLWorksapce81" default folder.****
  ;    s = Size(data2, /Dimensions)
  ;    xsize = s[0]
  ;    lineWidth = 16000000
  ;    comma = ","
  ;
  ;    ; Open the data file for writing.
  ;    OpenW, lun, filename2, /Get_Lun, Width=lineWidth
  ;
  ;    ; Write the data to the file.
  ;    sData2 = StrTrim(double(data2), 2)
  ;    sData2[0:xsize-2, *] = sData2[0:xsize-2, *] + comma
  ;    PrintF, lun, sData2
  ;
  ;    ; Close the file.
  ;    Free_Lun, lun
  ;
  ;    ;N = 107866L; 162 * 365
  ;    ;Data_Final = DOUBLE(FLTARR(8L, N)); WBIC = 1
  ;    ;NWBIC_growth = fltarr(5, N_elements(uniqWBIC_growth))
  ;
  ;    FOR i = 0L, N_ELEMENTS(Data2[0, *])-1L DO BEGIN
  ;      SelectData_Final = WHERE(Data_Final[1, *] EQ Data2[0, i], Data_Final2count)
  ;
  ;      IF i EQ 0L THEN SelectData_Final2 = Data_Final[*, SelectData_Final]
  ;      IF i GT 0L THEN SelectData_Final2 = TRANSPOSE([TRANSPOSE(SelectData_Final2), TRANSPOSE(Data_Final[*, SelectData_Final])])
  ;
  ;    ENDFOR
  ;    ;print,NWBIC_growth
  ;
  ;    Data3 = SelectData_Final2
  ;
  ;    filename3 = 'SelectOutput_Walleye_Growth_FULL.csv'
  ;    ;****the files should be in the same directory as the "IDLWorksapce81" default folder.****
  ;    s = Size(data3, /Dimensions)
  ;    xsize = s[0]
  ;    lineWidth = 16000000
  ;    comma = ","
  ;
  ;    ; Open the data file for writing.
  ;    OpenW, lun, filename3, /Get_Lun, Width=lineWidth
  ;
  ;    ; Write the data to the file.
  ;    sData3 = StrTrim(double(data3), 2)
  ;    sData3[0:xsize-2, *] = sData3[0:xsize-2, *] + comma
  ;    PrintF, lun, sData3
  ;
  ;    ; Close the file.
  ;    Free_Lun, lun
  ;
  ;    ; Age-specific size data for each lake
  ;    Data4 = WAE_size_age
  ;
  ;    filename4 = 'Walleye_size-at-age.csv'
  ;    ;****the files should be in the same directory as the "IDLWorksapce81" default folder.****
  ;    s = Size(data4, /Dimensions)
  ;    xsize = s[0]
  ;    lineWidth = 16000000
  ;    comma = ","
  ;
  ;    ; Open the data file for writing.
  ;    OpenW, lun, filename4, /Get_Lun, Width=lineWidth
  ;
  ;    ; Write the data to the file.
  ;    sData4 = StrTrim(double(data4), 2)
  ;    sData4[0:xsize-2, *] = sData4[0:xsize-2, *] + comma
  ;    PrintF, lun, sData4
  ;
  ;    ; Close the file.
  ;    Free_Lun, lun
  ;
  ;    ; Age-specific size data for each lake
  ;    Data5 = WAE_size_age_all
  ;
  ;    filename5 = 'Walleye_size-at-age-all.csv'
  ;    ;****the files should be in the same directory as the "IDLWorksapce81" default folder.****
  ;    s = Size(data5, /Dimensions)
  ;    xsize = s[0]
  ;    lineWidth = 16000000
  ;    comma = ","
  ;
  ;    ; Open the data file for writing.
  ;    OpenW, lun, filename5, /Get_Lun, Width=lineWidth
  ;
  ;    ; Write the data to the file.
  ;    sData5 = StrTrim(double(data5), 2)
  ;    sData5[0:xsize-2, *] = sData5[0:xsize-2, *] + comma
  ;    PrintF, lun, sData5
  ;
  ;    ; Close the file.
  ;    Free_Lun, lun

  t_elapsed = SYSTIME(/seconds) - tstart
  PRINT, 'Elapesed time (seconds):', t_elapsed
  PRINT, 'Elapesed time (minutes):', t_elapsed/60.
  ;RETURN, ???; TURN OFF WHEN TESTING
END